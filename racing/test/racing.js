window.BabylonToolkitLicense = "I-ABCDEF12345";

// Xbox Project Shim Services
var EnableXboxLiveServices = true;

// babylon.toolkit.js
var BABYLON;!function(e){var t=function(){function e(e){this.motion=e.motion,this.posX=e.posX||0,this.posY=e.posY,this.weight=e.weight||0}return e.GetIdleBlendTree=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(0===r.posX&&0===r.posY)return r}return null},e.GetDefaultIdleBlendTree=function(){return e.DefaultIdleBlendTree},e.DefaultIdleBlendTree=new e({motion:"Idle",posX:0,posY:0}),e}();e.BlendTreeValue=t;var i=function(){function t(){}return t.ZCross=function(e,t){return e.x*t.y-t.x*e.y},t.ClampValue=function(e,t,i){return e<=t?t:e>=i?i:e},t.ClampVector=function(i,r,s){var o=e.Vector3.Zero();return t.ClampVectorToRef(i,r,s,o),o},t.ClampVectorToRef=function(e,i,r,s){null!=s&&(s.x=t.ClampValue(e.x,i,r),s.y=t.ClampValue(e.y,i,r),s.z=t.ClampValue(e.z,i,r))},t.GetSignedAngle=function(e,t){return Math.atan2(e.x*t.y-e.y*t.x,e.x*t.x+e.y*t.y)},t.GetBarycentricVector=function(i,r,s,o){var n=e.Vector3.Zero();return t.GetBarycentricVectorToRef(i,r,s,o,n),n},t.GetBarycentricVectorToRef=function(e,i,r,s,o){t.TempVector2_AB.set(0,0),t.TempVector2_AB.set(0,0),t.TempVector2_AB.set(0,0),r.subtractToRef(i,t.TempVector2_AB),s.subtractToRef(i,t.TempVector2_AC),e.subtractToRef(i,t.TempVector2_AP);var n=1/t.ZCross(t.TempVector2_AB,t.TempVector2_AC),a=n*t.ZCross(t.TempVector2_AB,t.TempVector2_AP),l=n*t.ZCross(t.TempVector2_AP,t.TempVector2_AC),h=1-a-l;null!=o&&(o.x=h,o.y=a,o.z=l)},t.GetLinearInterpolation=function(e,t,i,r,s){return t+(s-e)*((r-t)/(i-e))},t.TempVector2_AB=new e.Vector2(0,0),t.TempVector2_AC=new e.Vector2(0,0),t.TempVector2_AP=new e.Vector2(0,0),t}();e.BlendTreeUtils=i;var r=function(){function r(){}return r.Calculate1DSimpleBlend=function(e,t){var s=t[0],o=t[t.length-1];if(e<=s.posY)s.weight=1;else if(e>=o.posY)o.weight=1;else{var n=r.GetRightNeighbourBlendTreeIndex(e,t),a=t[n-1],l=t[n],h=i.GetLinearInterpolation(a.posY,1,l.posY,0,e);a.weight=h,l.weight=1-a.weight}},r.Calculate2DSimpleDirectional=function(e,s,o){r.TempVector2_IP.set(e,s),r.TempVector2_TA.set(0,0),r.TempVector2_TB.set(0,0),r.TempVector2_TC.set(0,0),r.TempVector3_BARY.set(0,0,0);var n=!0,a=t.GetIdleBlendTree(o);if(a){var l=o.indexOf(a);o.splice(l,1)}else n=!1,a=t.GetDefaultIdleBlendTree();o.sort(function(e,t){return Math.atan2(e.posY,e.posX)-Math.atan2(t.posY,t.posX)}),o.unshift(a);for(var h=0,u=2;u<o.length;++u)r.TempVector2_TB.set(o[u-1].posX,o[u-1].posY),r.TempVector2_TC.set(o[u].posX,o[u].posY),i.GetBarycentricVectorToRef(r.TempVector2_IP,r.TempVector2_TA,r.TempVector2_TB,r.TempVector2_TC,r.TempVector3_BARY),i.ClampVectorToRef(r.TempVector3_BARY,0,1,r.TempVector3_BARY),r.TempVector3_BARY.z>0&&r.TempVector3_BARY.y>0&&(o[0].weight+=r.TempVector3_BARY.x,o[u-1].weight+=r.TempVector3_BARY.z,o[u].weight+=r.TempVector3_BARY.y,h+=r.TempVector3_BARY.x+r.TempVector3_BARY.y+r.TempVector3_BARY.z);r.TempVector2_TB.set(o[o.length-1].posX,o[o.length-1].posY),r.TempVector2_TC.set(o[1].posX,o[1].posY),i.GetBarycentricVectorToRef(r.TempVector2_IP,r.TempVector2_TA,r.TempVector2_TB,r.TempVector2_TC,r.TempVector3_BARY),i.ClampVectorToRef(r.TempVector3_BARY,0,1,r.TempVector3_BARY),r.TempVector3_BARY.z>0&&r.TempVector3_BARY.y>0&&(o[0].weight+=r.TempVector3_BARY.x,o[o.length-1].weight+=r.TempVector3_BARY.z,o[1].weight+=r.TempVector3_BARY.y,h+=r.TempVector3_BARY.x+r.TempVector3_BARY.y+r.TempVector3_BARY.z);for(var m=0,c=o;m<c.length;m++){var p=c[m];p.weight/=h}if(!n){o.shift();for(var f=a.weight/o.length,_=0,d=o;_<d.length;_++){var p=d[_];p.weight+=f}}},r.Calculate2DFreeformDirectional=function(t,s,o){r.TempVector2_IP.set(t,s),r.TempVector2_POSI.set(0,0),r.TempVector2_POSJ.set(0,0),r.TempVector2_POSIP.set(0,0),r.TempVector2_POSIJ.set(0,0);for(var n=2,a=0,l=r.TempVector2_IP.length(),h=0;h<o.length;++h){var u=o[h];r.TempVector2_POSI.set(u.posX,u.posY);for(var m=r.TempVector2_POSI.length(),c=l-m,p=i.GetSignedAngle(r.TempVector2_POSI,r.TempVector2_IP),f=1,_=0;_<o.length;++_)if(_!==h){r.TempVector2_POSJ.set(o[_].posX,o[_].posY);var d=r.TempVector2_POSJ.length(),y=(m+d)/2,v=c/y,g=(d-m)/y,C=i.GetSignedAngle(r.TempVector2_POSI,r.TempVector2_POSJ);r.TempVector2_POSIP.set(v,p*n),r.TempVector2_POSIJ.set(g,C*n);var S=r.TempVector2_POSIJ.lengthSquared(),b=e.Vector2.Dot(r.TempVector2_POSIP,r.TempVector2_POSIJ)/S;b=1-b,b=i.ClampValue(b,0,1),f=Math.min(b,f)}u.weight=f,a+=f}for(var x=0,T=o;x<T.length;x++){var u=T[x];u.weight/=a}},r.Calculate2DFreeformCartesian=function(t,s,o){r.TempVector2_IP.set(t,s),r.TempVector2_POSI.set(0,0),r.TempVector2_POSJ.set(0,0),r.TempVector2_POSIP.set(0,0),r.TempVector2_POSIJ.set(0,0);for(var n=0,a=0;a<o.length;++a){var l=o[a];r.TempVector2_POSI.set(l.posX,l.posY),r.TempVector2_IP.subtractToRef(r.TempVector2_POSI,r.TempVector2_POSIP);for(var h=1,u=0;u<o.length;++u)if(u!==a){r.TempVector2_POSJ.set(o[u].posX,o[u].posY),r.TempVector2_POSJ.subtractToRef(r.TempVector2_POSI,r.TempVector2_POSIJ);var m=r.TempVector2_POSIJ.lengthSquared(),c=e.Vector2.Dot(r.TempVector2_POSIP,r.TempVector2_POSIJ)/m;c=1-c,c=i.ClampValue(c,0,1),h=Math.min(h,c)}l.weight=h,n+=h}for(var p=0,f=o;p<f.length;p++){var l=f[p];l.weight/=n}},r.GetRightNeighbourBlendTreeIndex=function(e,t){t.sort(function(e,t){return e.posY-t.posY});for(var i=0;i<t.length;++i)if(t[i].posY>e)return i;return-1},r.TempVector2_IP=new e.Vector2(0,0),r.TempVector2_TA=new e.Vector2(0,0),r.TempVector2_TB=new e.Vector2(0,0),r.TempVector2_TC=new e.Vector2(0,0),r.TempVector2_POSI=new e.Vector2(0,0),r.TempVector2_POSJ=new e.Vector2(0,0),r.TempVector2_POSIP=new e.Vector2(0,0),r.TempVector2_POSIJ=new e.Vector2(0,0),r.TempVector3_BARY=new e.Vector3(0,0,0),r}();e.BlendTreeSystem=r}(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),BABYLON;!function(e){var t=function(e){function t(t,i,r){return void 0===r&&(r={}),e.call(this,t,i,r)||this}return __extends(t,e),t.prototype.start=function(){this.initAnimationState()},t.prototype.update=function(){},t.prototype.after=function(){},t.prototype.destroy=function(){},t.prototype.initAnimationState=function(){console.warn("Dump Animation State Machine: "+this.transform.name),console.log(this)},t}(e.ScriptComponent);e.AnimationState=t}(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),BABYLON;!function(e){var t=function(t){function i(e,i,r){void 0===r&&(r={});var s=t.call(this,e,i,r)||this;return s._audio=null,s._name=null,s._file=null,s._loop=!1,s._mute=!1,s._volume=1,s._pitch=1,s._priority=128,s._panstereo=0,s._mindistance=1,s._maxdistance=50,s._rolloffmode="linear",s._rollofffactor=1,s._playonawake=!0,s._spatialblend=0,s._reverbzonemix=1,s._bypasseffects=!1,s._bypassreverbzones=!1,s._bypasslistenereffects=!1,s._name=s.getEditorProperty("name",s._name),s._file=s.getEditorProperty("file",s._file),s._loop=s.getEditorProperty("loop",s._loop),s._mute=s.getEditorProperty("mute",s._mute),s._volume=s.getEditorProperty("volume",s._volume),s._pitch=s.getEditorProperty("pitch",s._pitch),s._priority=s.getEditorProperty("priority",s._priority),s._panstereo=s.getEditorProperty("panstereo",s._panstereo),s._playonawake=s.getEditorProperty("playonawake",s._playonawake),s._mindistance=s.getEditorProperty("mindistance",s._mindistance),s._maxdistance=s.getEditorProperty("maxdistance",s._maxdistance),s._rolloffmode=s.getEditorProperty("rolloffmode",s._rolloffmode),s._rollofffactor=s.getEditorProperty("rollofffactor",s._rollofffactor),s._spatialblend=s.getEditorProperty("spatialblend",s._spatialblend),s._reverbzonemix=s.getEditorProperty("reverbzonemix",s._reverbzonemix),s._bypasseffects=s.getEditorProperty("bypasseffects",s._bypasseffects),s._bypassreverbzones=s.getEditorProperty("bypassreverbzones",s._bypassreverbzones),s._bypasslistenereffects=s.getEditorProperty("bypasslistenereffects",s._bypasslistenereffects),s}return __extends(i,t),i.prototype.getSoundClip=function(){return this._audio},i.prototype.start=function(){this.initAudioSource()},i.prototype.destroy=function(){this.destroyAudioSource()},i.prototype.initAudioSource=function(){var t=this;if(null!=this._name&&""!==this._name||(this._name="Unknown"),null!=this._file&&""!==this._file){var i=e.SceneManager.GetRootUrl(this.scene),r=this._spatialblend>=.1,s="logarithmic"===this._rolloffmode?"exponential":"linear";this._audio=new e.Sound(this._name,i+this._file,this.scene,function(){t._audio.setVolume(t._mute===!0?0:t._volume),t._audio.setPlaybackRate(t._pitch)},{loop:this._loop,autoplay:this._playonawake,refDistance:this._mindistance,maxDistance:this._maxdistance,rolloffFactor:this._rollofffactor,spatialSound:r,distanceModel:s}),this._audio.setPosition(this.transform.position.clone()),r===!0&&this._audio.attachToMesh(this.transform)}},i.prototype.destroyAudioSource=function(){null!=this._audio&&(this._audio.dispose(),this._audio=null)},i}(e.ScriptComponent);e.AudioSource=t}(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),BABYLON;!function(e){var t=function(t){function i(i,r,s){void 0===s&&(s={});var o=t.call(this,i,r,s)||this;return o.cameraType=0,o.mainCamera=!1,o.virtualReality=null,o.multiPlayerSetup=null,o.m_cameraRig=null,o.mainCamera="MainCamera"===o.getTransformTag(),o.cameraType=o.getEditorProperty("mainCameraType",o.cameraType),o.virtualReality=o.getEditorProperty("webVirtualReality",o.virtualReality),o.multiPlayerSetup=o.getEditorProperty("multiPlayerSetup",o.multiPlayerSetup),null!=o.multiPlayerSetup&&(e.UniversalCameraSystem.startupMode=o.multiPlayerSetup.playerStartupMode,e.UniversalCameraSystem.stereoCameras=o.multiPlayerSetup.stereoSideBySide),o}return __extends(i,t),i.prototype.isMainCamera=function(){return this.mainCamera},i.prototype.getCameraType=function(){return this.cameraType},i.prototype.start=function(){this.initCameraSystemState()},i.prototype.update=function(){this.updateCameraSystemState()},i.prototype.destroy=function(){this.destroyCameraSystemState()},i.prototype.initCameraSystemState=function(){if(e.Utilities.ValidateTransformQuaternion(this.transform),this.m_cameraRig=this.getCameraRig(),null!=this.m_cameraRig)if(0===this.cameraType)null==e.UniversalCameraSystem.PlayerOneCamera&&(e.UniversalCameraSystem.PlayerOneCamera=this.m_cameraRig);else if(1===this.cameraType){if(null!=this.virtualReality&&this.virtualReality.experienceHelper===!0){var t=!1,i=null;if(this.virtualReality.useCustomButton===!0&&null!=this.virtualReality.buttonElementID&&""!==this.virtualReality.buttonElementID){var r=document.getElementById(this.virtualReality.buttonElementID);null!=r?(t=!0,i=r):e.Tools.Warn("Babylon.js failed to locate webvr button element id: "+this.virtualReality.buttonElementID)}var s=null,o=null;null!=this.virtualReality.floorMeshesTags&&""!==this.virtualReality.floorMeshesTags||(this.virtualReality.floorMeshesTags="Navigation"),this.virtualReality.enableTeleportation===!0&&(o=this.scene.getMeshesByTags(this.virtualReality.floorMeshesTags)),s=this.virtualReality.enableTeleportation===!0&&null!=o&&o.length>0?{createDeviceOrientationCamera:1===this.virtualReality.defaultCamera,createFallbackVRDeviceOrientationFreeCamera:this.virtualReality.fallbackCamera,laserToggle:this.virtualReality.displayLaserBeam,useCustomVRButton:t,customVRButton:i,rayLength:this.virtualReality.rayCastLength,defaultHeight:this.virtualReality.defaultHeight,positionScale:this.virtualReality.positionScale,floorMeshes:o}:{createDeviceOrientationCamera:1===this.virtualReality.defaultCamera,createFallbackVRDeviceOrientationFreeCamera:this.virtualReality.fallbackCamera,laserToggle:this.virtualReality.displayLaserBeam,useCustomVRButton:t,customVRButton:i,rayLength:this.virtualReality.rayCastLength,defaultHeight:this.virtualReality.defaultHeight,positionScale:this.virtualReality.positionScale},e.UniversalCameraSystem.DefaultControllers=!0;var n=this.scene.createDefaultVRExperience(s);null!=n&&(n.displayGaze=this.virtualReality.displayGazeIcon,this.virtualReality.enableInteractions===!0&&n.enableInteractions(),n.onControllerMeshLoadedObservable.add(function(t,i){"left"===t.hand?e.UniversalCameraSystem.LeftControllerStick=t:"right"===t.hand&&(e.UniversalCameraSystem.RightControllerStick=t)})),e.UniversalCameraSystem.VrCameraHelper=n}}else if(2===this.cameraType){var a=this.m_cameraRig.name;if(null==e.UniversalCameraSystem.PlayerOneCamera){var l=a+".1",h=this.m_cameraRig.clone(l);h.name=l,h.parent=null,h.position=this.transform.position.clone(),h.rotationQuaternion=this.transform.rotationQuaternion.clone(),h.viewport=new e.Viewport(0,0,0,0),h.setEnabled(!1),e.UniversalCameraSystem.PlayerOneCamera=h}if(null==e.UniversalCameraSystem.PlayerTwoCamera){var u=a+".2",m=this.m_cameraRig.clone(u);m.name=u,m.parent=null,m.position=this.transform.position.clone(),m.rotationQuaternion=this.transform.rotationQuaternion.clone(),m.viewport=new e.Viewport(0,0,0,0),m.setEnabled(!1),e.UniversalCameraSystem.PlayerTwoCamera=m}if(null==e.UniversalCameraSystem.PlayerThreeCamera){var c=a+".3",p=this.m_cameraRig.clone(c);p.name=c,p.parent=null,p.position=this.transform.position.clone(),p.rotationQuaternion=this.transform.rotationQuaternion.clone(),p.viewport=new e.Viewport(0,0,0,0),p.setEnabled(!1),e.UniversalCameraSystem.PlayerThreeCamera=p}if(null==e.UniversalCameraSystem.PlayerFourCamera){var f=a+".4",_=this.m_cameraRig.clone(f);_.name=f,_.parent=null,_.position=this.transform.position.clone(),_.rotationQuaternion=this.transform.rotationQuaternion.clone(),_.viewport=new e.Viewport(0,0,0,0),_.setEnabled(!1),e.UniversalCameraSystem.PlayerFourCamera=_}e.UniversalCameraSystem.multiPlayerView=!0,e.UniversalCameraSystem.SetMultiPlayerViewLayout(this.scene,e.UniversalCameraSystem.startupMode)}},i.prototype.updateCameraSystemState=function(){null!=this.m_cameraRig&&(0===this.cameraType||1===this.cameraType||2===this.cameraType)},i.prototype.destroyCameraSystemState=function(){this.virtualReality=null},i.GetPlayerCamera=function(t){return e.UniversalCameraSystem.IsMultiPlayerView()?t===e.PlayerNumber.One?e.UniversalCameraSystem.PlayerOneCamera:t===e.PlayerNumber.Two?e.UniversalCameraSystem.PlayerTwoCamera:t===e.PlayerNumber.Three?e.UniversalCameraSystem.PlayerThreeCamera:t===e.PlayerNumber.Four?e.UniversalCameraSystem.PlayerFourCamera:null:t===e.PlayerNumber.One?null!=e.UniversalCameraSystem.WebVR?e.UniversalCameraSystem.WebVR.currentVRCamera:e.UniversalCameraSystem.PlayerOneCamera:(e.Tools.Warn("Babylon.js multi player camera not available for player: "+t),null)},Object.defineProperty(i,"WebVR",{get:function(){return e.UniversalCameraSystem.VrCameraHelper},enumerable:!0,configurable:!0}),i.GetWebVRLeftController=function(){return e.UniversalCameraSystem.LeftControllerStick},i.GetWebVRRightController=function(){return e.UniversalCameraSystem.RightControllerStick},i.GetWebVRLeftControllerPrefab=function(){return e.UniversalCameraSystem.LeftControllerPrefab},i.GetWebVRRightControllerPrefab=function(){return e.UniversalCameraSystem.RightControllerPrefab},i.ShowWebVRDefaultControllers=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),null!=e.UniversalCameraSystem.LeftControllerStick&&(e.UniversalCameraSystem.LeftControllerStick.mesh.setEnabled(!1),e.UniversalCameraSystem.LeftControllerStick.attachToMesh(e.UniversalCameraSystem.LeftControllerStick.defaultModel),e.UniversalCameraSystem.LeftControllerStick.mesh.setEnabled(!0),e.UniversalCameraSystem.DefaultControllers=!0),null!=e.UniversalCameraSystem.RightControllerStick&&(e.UniversalCameraSystem.RightControllerStick.mesh.setEnabled(!1),e.UniversalCameraSystem.RightControllerStick.attachToMesh(e.UniversalCameraSystem.RightControllerStick.defaultModel),e.UniversalCameraSystem.RightControllerStick.mesh.setEnabled(!0),e.UniversalCameraSystem.DefaultControllers=!0),null!=e.UniversalCameraSystem.WebVR&&(null!=t&&(e.UniversalCameraSystem.WebVR.displayGaze=t),null!=i&&(e.UniversalCameraSystem.WebVR.displayLaserPointer=i))},i.ShowWebVRCustomControllers=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),null!=e.UniversalCameraSystem.LeftControllerStick&&(e.UniversalCameraSystem.LeftControllerStick.mesh.setEnabled(!1),e.UniversalCameraSystem.LeftControllerStick.attachToMesh(e.UniversalCameraSystem.LeftControllerPrefab),e.UniversalCameraSystem.LeftControllerStick.mesh.setEnabled(!0),e.UniversalCameraSystem.DefaultControllers=!1),null!=e.UniversalCameraSystem.RightControllerStick&&(e.UniversalCameraSystem.RightControllerStick.mesh.setEnabled(!1),e.UniversalCameraSystem.RightControllerStick.attachToMesh(e.UniversalCameraSystem.RightControllerPrefab),e.UniversalCameraSystem.RightControllerStick.mesh.setEnabled(!0),e.UniversalCameraSystem.DefaultControllers=!1),null!=e.UniversalCameraSystem.WebVR&&(null!=t&&(e.UniversalCameraSystem.WebVR.displayGaze=t),null!=i&&(e.UniversalCameraSystem.WebVR.displayLaserPointer=i))},i.IsStereoCameras=function(){return e.UniversalCameraSystem.stereoCameras},i.IsMultiPlayerView=function(){return e.UniversalCameraSystem.multiPlayerView},i.GetMultiPlayerCount=function(){return e.UniversalCameraSystem.multiPlayerCount},i.ActivateMultiPlayerCameras=function(t){var i=!1;return null!=e.UniversalCameraSystem.multiPlayerCameras&&e.UniversalCameraSystem.multiPlayerCameras.length>0&&(t.activeCameras=e.UniversalCameraSystem.multiPlayerCameras,i=!0),i},i.DisposeMultiPlayerCameras=function(){null!=e.UniversalCameraSystem.PlayerOneCamera&&(e.UniversalCameraSystem.PlayerOneCamera.dispose(),e.UniversalCameraSystem.PlayerOneCamera=null),null!=e.UniversalCameraSystem.PlayerTwoCamera&&(e.UniversalCameraSystem.PlayerTwoCamera.dispose(),e.UniversalCameraSystem.PlayerTwoCamera=null),null!=e.UniversalCameraSystem.PlayerThreeCamera&&(e.UniversalCameraSystem.PlayerThreeCamera.dispose(),e.UniversalCameraSystem.PlayerThreeCamera=null),null!=e.UniversalCameraSystem.PlayerFourCamera&&(e.UniversalCameraSystem.PlayerFourCamera.dispose(),e.UniversalCameraSystem.PlayerFourCamera=null)},i.SetMultiPlayerViewLayout=function(t,i){var r=!1,s=e.Scalar.Clamp(i,1,4);return e.UniversalCameraSystem.IsMultiPlayerView()?(null!=e.UniversalCameraSystem.PlayerOneCamera&&null!=e.UniversalCameraSystem.PlayerTwoCamera&&null!=e.UniversalCameraSystem.PlayerThreeCamera&&null!=e.UniversalCameraSystem.PlayerFourCamera?(e.UniversalCameraSystem.multiPlayerCameras=[],1===s?(e.UniversalCameraSystem.PlayerOneCamera.viewport=new e.Viewport(0,0,1,1),e.UniversalCameraSystem.PlayerTwoCamera.viewport=new e.Viewport(0,0,0,0),e.UniversalCameraSystem.PlayerTwoCamera.setEnabled(!1),e.UniversalCameraSystem.PlayerThreeCamera.viewport=new e.Viewport(0,0,0,0),e.UniversalCameraSystem.PlayerThreeCamera.setEnabled(!1),e.UniversalCameraSystem.PlayerFourCamera.viewport=new e.Viewport(0,0,0,0),e.UniversalCameraSystem.PlayerFourCamera.setEnabled(!1),e.UniversalCameraSystem.multiPlayerCameras.push(e.UniversalCameraSystem.PlayerOneCamera)):2===s?(e.UniversalCameraSystem.stereoCameras===!0?(e.UniversalCameraSystem.PlayerOneCamera.viewport=new e.Viewport(0,0,.5,1),e.UniversalCameraSystem.PlayerTwoCamera.viewport=new e.Viewport(.5,0,.5,1)):(e.UniversalCameraSystem.PlayerOneCamera.viewport=new e.Viewport(0,.5,1,.5),e.UniversalCameraSystem.PlayerTwoCamera.viewport=new e.Viewport(0,0,1,.5)),e.UniversalCameraSystem.PlayerTwoCamera.setEnabled(!0),e.UniversalCameraSystem.PlayerThreeCamera.viewport=new e.Viewport(0,0,0,0),e.UniversalCameraSystem.PlayerThreeCamera.setEnabled(!1),e.UniversalCameraSystem.PlayerFourCamera.viewport=new e.Viewport(0,0,0,0),e.UniversalCameraSystem.PlayerFourCamera.setEnabled(!1),e.UniversalCameraSystem.multiPlayerCameras.push(e.UniversalCameraSystem.PlayerOneCamera),e.UniversalCameraSystem.multiPlayerCameras.push(e.UniversalCameraSystem.PlayerTwoCamera)):3===s?(e.UniversalCameraSystem.PlayerOneCamera.viewport=new e.Viewport(0,0,.5,1),e.UniversalCameraSystem.PlayerTwoCamera.viewport=new e.Viewport(.5,.5,.5,.5),e.UniversalCameraSystem.PlayerTwoCamera.setEnabled(!0),e.UniversalCameraSystem.PlayerThreeCamera.viewport=new e.Viewport(.5,0,.5,.5),e.UniversalCameraSystem.PlayerThreeCamera.setEnabled(!0),e.UniversalCameraSystem.PlayerFourCamera.viewport=new e.Viewport(0,0,0,0),e.UniversalCameraSystem.PlayerFourCamera.setEnabled(!1),e.UniversalCameraSystem.multiPlayerCameras.push(e.UniversalCameraSystem.PlayerOneCamera),e.UniversalCameraSystem.multiPlayerCameras.push(e.UniversalCameraSystem.PlayerTwoCamera),e.UniversalCameraSystem.multiPlayerCameras.push(e.UniversalCameraSystem.PlayerThreeCamera)):4===s?(e.UniversalCameraSystem.PlayerOneCamera.viewport=new e.Viewport(0,.5,.5,.5),e.UniversalCameraSystem.PlayerTwoCamera.viewport=new e.Viewport(0,0,.5,.5),e.UniversalCameraSystem.PlayerTwoCamera.setEnabled(!0),e.UniversalCameraSystem.PlayerThreeCamera.viewport=new e.Viewport(.5,.5,.5,.5),e.UniversalCameraSystem.PlayerThreeCamera.setEnabled(!0),e.UniversalCameraSystem.PlayerFourCamera.viewport=new e.Viewport(.5,0,.5,.5),e.UniversalCameraSystem.PlayerFourCamera.setEnabled(!0),e.UniversalCameraSystem.multiPlayerCameras.push(e.UniversalCameraSystem.PlayerOneCamera),e.UniversalCameraSystem.multiPlayerCameras.push(e.UniversalCameraSystem.PlayerTwoCamera),e.UniversalCameraSystem.multiPlayerCameras.push(e.UniversalCameraSystem.PlayerThreeCamera),e.UniversalCameraSystem.multiPlayerCameras.push(e.UniversalCameraSystem.PlayerFourCamera)):e.Tools.Warn("Babylon.js camera rig invalid player count specified: "+s)):e.Tools.Warn("Babylon.js camera rig failed to initialize multi player cameras"),e.UniversalCameraSystem.multiPlayerCount=s,r=e.UniversalCameraSystem.ActivateMultiPlayerCameras(t),r===!1&&e.Tools.Warn("Babylon.js camera rig failed to initialize multi player views")):e.Tools.Warn("Babylon.js camera rig multi player view option not enabled"),r},i.VrCameraHelper=null,i.DefaultControllers=!0,i.LeftControllerStick=null,i.RightControllerStick=null,i.LeftControllerPrefab=null,i.RightControllerPrefab=null,i.PlayerOneCamera=null,i.PlayerTwoCamera=null,i.PlayerThreeCamera=null,i.PlayerFourCamera=null,i.multiPlayerView=!1,i.multiPlayerCount=1,i.multiPlayerCameras=null,i.stereoCameras=!0,i.startupMode=1,i}(e.ScriptComponent);e.UniversalCameraSystem=t;var i=function(){function t(t,i){void 0===t&&(t=null),void 0===i&&(i=null),this._rotationMatrix=e.Matrix.Zero(),this._targetPosition=e.Vector3.Zero(),this._distanceVector=e.Vector3.Zero(),this.followDistance=10,this.lowerDistanceLimit=null,this.upperDistanceLimit=null,this.rotationOffset=180,this.lowerRotationOffsetLimit=null,this.upperRotationOffsetLimit=null,this.heightOffset=2,this.lowerHeightOffsetLimit=null,this.upperHeightOffsetLimit=null,this.followAcceleration=.05,this.maxFollowSpeed=100,this.transformNode=t,this.lockedTarget=i,null!=this.lockedTarget&&(this._targetPosition=this.lockedTarget.getAbsolutePosition())}return t.prototype.getTargetDistance=function(){return null==this.transformNode||null==this.lockedTarget?0:(this._targetPosition.subtractToRef(this.transformNode.getAbsolutePosition(),this._distanceVector),this._distanceVector.length())},t.prototype.update=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),null!=this.lockedTarget&&(this._targetPosition=this.lockedTarget.getAbsolutePosition()),this._checkLimits(),this._followTarget(e,t)},t.prototype.dispose=function(){this.transformNode=null,this.lockedTarget=null},t.prototype._checkLimits=function(){null!==this.lowerDistanceLimit&&this.followDistance<this.lowerDistanceLimit&&(this.followDistance=this.lowerDistanceLimit),null!==this.upperDistanceLimit&&this.followDistance>this.upperDistanceLimit&&(this.followDistance=this.upperDistanceLimit),null!==this.lowerHeightOffsetLimit&&this.heightOffset<this.lowerHeightOffsetLimit&&(this.heightOffset=this.lowerHeightOffsetLimit),null!==this.upperHeightOffsetLimit&&this.heightOffset>this.upperHeightOffsetLimit&&(this.heightOffset=this.upperHeightOffsetLimit),null!==this.lowerRotationOffsetLimit&&this.rotationOffset<this.lowerRotationOffsetLimit&&(this.rotationOffset=this.lowerRotationOffsetLimit),null!==this.upperRotationOffsetLimit&&this.rotationOffset>this.upperRotationOffsetLimit&&(this.rotationOffset=this.upperRotationOffsetLimit)},t.prototype._followTarget=function(t,i){if(null!=this.transformNode&&null!=this.lockedTarget){var r=0;this.lockedTarget.rotationQuaternion?(this.lockedTarget.rotationQuaternion.toRotationMatrix(this._rotationMatrix),r=Math.atan2(this._rotationMatrix.m[8],this._rotationMatrix.m[10])):r=this.lockedTarget.rotation.y;var s=e.Tools.ToRadians(this.rotationOffset)+r,o=this._targetPosition.x+Math.sin(s)*this.followDistance,n=this._targetPosition.z+Math.cos(s)*this.followDistance,a=o-this.transformNode.position.x,l=this._targetPosition.y+this.heightOffset-this.transformNode.position.y,h=n-this.transformNode.position.z,u=a*this.followAcceleration*2,m=l*this.followAcceleration,c=h*this.followAcceleration*2;(u>this.maxFollowSpeed||u<-this.maxFollowSpeed)&&(u=u<1?-this.maxFollowSpeed:this.maxFollowSpeed),(m>this.maxFollowSpeed||m<-this.maxFollowSpeed)&&(m=m<1?-this.maxFollowSpeed:this.maxFollowSpeed),(c>this.maxFollowSpeed||c<-this.maxFollowSpeed)&&(c=c<1?-this.maxFollowSpeed:this.maxFollowSpeed),t===!0&&this.transformNode.position.set(this.transformNode.position.x+u,this.transformNode.position.y+m,this.transformNode.position.z+c),i===!0&&this.transformNode.lookAt(this._targetPosition)}},t}();e.FollowTargetManager=i}(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),BABYLON;!function(e){var t=function(t){function i(i,r,s){void 0===s&&(s={});var o=t.call(this,i,r,s)||this;return o._abstractMesh=null,o._avatarRadius=.5,o._avatarHeight=2,o._skinWidth=.08,o._stepOffset=.3,o._slopeLimit=45,o._minMoveDistance=.001,o._isPhysicsReady=!1,o._maxCollisions=4,o._useGhostSweepTest=!1,o._tmpAmmoQuaternion=null,o._tmpOriginQuaternion=null,o._tmpRotateQuaternion=null,o._tmpBabylonQuaternion=null,o._tmpBabylonEulerVector=null,o._tmpCollisionContacts=null,o.m_character=null,o.m_ghostShape=null,o.m_ghostObject=null,o.m_ghostCollision=null,o.m_ghostTransform=null,o.m_ghostPosition=null,o.m_ghostRotation=null,o.m_startPosition=null,o.m_startRotation=null,o.m_startTransform=null,o.m_walkDirection=null,o.m_warpPosition=null,o.m_turningRate=0,o.m_moveDeltaX=0,o.m_moveDeltaZ=0,o.m_physicsEngine=null,o._onCollisionEnterObservable=new e.Observable,o._onCollisionStayObservable=new e.Observable,o._onCollisionExitObservable=new e.Observable,o._abstractMesh=o.getAbstractMesh(),o._avatarRadius=o.getEditorProperty("avatarRadius",o._avatarRadius),o._avatarHeight=o.getEditorProperty("avatarHeight",o._avatarHeight),o._skinWidth=o.getEditorProperty("skinWidth",o._skinWidth),o._slopeLimit=o.getEditorProperty("slopeLimit",o._slopeLimit),o._stepOffset=o.getEditorProperty("stepOffset",o._stepOffset),o._minMoveDistance=o.getEditorProperty("minMoveDistance",o._minMoveDistance),o._useGhostSweepTest=o.getEditorProperty("useGhostSweepTest",o._useGhostSweepTest),o._tmpAmmoQuaternion=new Ammo.btQuaternion(0,0,0,1),o._tmpOriginQuaternion=new Ammo.btQuaternion(0,0,0,1),o._tmpRotateQuaternion=new Ammo.btQuaternion(0,0,0,1),o._tmpBabylonQuaternion=new e.Quaternion(0,0,0,1),o._tmpBabylonEulerVector=new e.Vector3(0,0,0),o._tmpBabylonQuaternion=new e.Quaternion(0,0,0,1),o.m_warpPosition=new Ammo.btVector3(0,0,0),o.m_walkDirection=new Ammo.btVector3(0,0,0),o.m_physicsEngine=e.SceneManager.GetPhysicsEngine(o.scene),o.setMaxNotifications(o._maxCollisions),o}return __extends(i,t),i.prototype.getAvatarRadius=function(){return this._avatarRadius},i.prototype.getAvatarHeight=function(){return this._avatarHeight},i.prototype.getSkinWidth=function(){return this._skinWidth},i.prototype.getStepOffset=function(){return this._stepOffset},i.prototype.getUseSweepTest=function(){return this._useGhostSweepTest},i.prototype.getMinMoveDistance=function(){return this._minMoveDistance},i.prototype.setMinMoveDistance=function(e){this._minMoveDistance=e},i.prototype.getVerticalVelocity=function(){return null!=this.m_character&&this.m_character.getVerticalVelocity?this.m_character.getVerticalVelocity():0},i.prototype.setMaxJumpHeight=function(e){null!=this.m_character&&this.m_character.setMaxJumpHeight(e)},i.prototype.setFallingSpeed=function(e){null!=this.m_character&&this.m_character.setFallSpeed(e)},i.prototype.getSlopeLimit=function(){return null!=this.m_character?this.m_character.getMaxSlope():0},i.prototype.setSlopeLimit=function(e){null!=this.m_character&&this.m_character.setMaxSlope(e)},i.prototype.setUpAxis=function(e){null!=this.m_character&&this.m_character.setUpAxis(e)},i.prototype.getGravity=function(){return null!=this.m_character?this.m_character.getGravity():0},i.prototype.setGravity=function(e){null!=this.m_character&&this.m_character.setGravity(e)},i.prototype.isGrounded=function(){return null!=this.m_character&&this.m_character.onGround()},i.prototype.isReady=function(){return null!=this.m_character},i.prototype.canJump=function(){return null!=this.m_character&&this.m_character.canJump()},i.prototype.internalWarp=function(e){null!=this.m_character&&this.m_character.warp(e)},i.prototype.internalJump=function(){null!=this.m_character&&this.m_character.jump()},i.prototype.internalSetJumpSpeed=function(e){null!=this.m_character&&this.m_character.setJumpSpeed(e)},i.prototype.internalSetWalkDirection=function(e){null!=this.m_character&&this.m_character.setWalkDirection(e)},i.prototype.internalSetVelocityForTimeInterval=function(e,t){null!=this.m_character&&this.m_character.setVelocityForTimeInterval(e,t)},i.prototype.start=function(){this.initMovementState()},i.prototype.update=function(){this.updateMovementState()},i.prototype.after=function(){this.afterMovementState()},i.prototype.destroy=function(){this.destroyMovementState()},i.prototype.initMovementState=function(){e.Utilities.ValidateTransformQuaternion(this.transform);var t=e.SceneManager.GetPhysicsWorld(this.scene);null!=t?(this.m_startPosition=new Ammo.btVector3(this.transform.position.x,this.transform.position.y,this.transform.position.z),this.m_startRotation=new Ammo.btQuaternion(this.transform.rotationQuaternion.x,this.transform.rotationQuaternion.y,this.transform.rotationQuaternion.z,this.transform.rotationQuaternion.w),this.m_startTransform=new Ammo.btTransform,this.m_startTransform.setIdentity(),this.m_startTransform.setOrigin(this.m_startPosition),this.m_startTransform.setRotation(this.m_startRotation),this.m_ghostShape=new Ammo.btCapsuleShape(this._avatarRadius,.5*this._avatarHeight),this.m_ghostShape.setMargin(this._skinWidth),this.m_ghostObject=new Ammo.btPairCachingGhostObject,this.m_ghostObject.setWorldTransform(this.m_startTransform),this.m_ghostObject.setCollisionShape(this.m_ghostShape),this.m_ghostObject.setCollisionFlags(e.CollisionFlags.CF_CHARACTER_OBJECT),this.m_ghostCollision=Ammo.castObject(this.m_ghostObject,Ammo.btCollisionObject),this.m_ghostCollision.setContactProcessingThreshold(0),this.m_ghostCollision.entity=this._abstractMesh,this.m_character=new Ammo.btKinematicCharacterController(this.m_ghostObject,this.m_ghostShape,this._stepOffset),
this.m_character.setUseGhostSweepTest(this._useGhostSweepTest),this.m_character.setUpInterpolate(!0),this.m_character.setMaxSlope(this._slopeLimit*e.System.Deg2Rad),this.m_character.setGravity(e.System.Gravity3G),t.addCollisionObject(this.m_ghostObject,e.CollisionFilters.CharacterFilter,e.CollisionFilters.StaticFilter|e.CollisionFilters.DefaultFilter|e.CollisionFilters.CharacterFilter),t.addAction(this.m_character)):e.Tools.Warn("Null physics world detected. Failed to create character controller: "+this.transform.name),this._isPhysicsReady=null!=this.m_physicsEngine&&null!=this._tmpCollisionContacts&&null!=this.m_ghostObject&&null!=this._abstractMesh,this.updateMovementState(),this.afterMovementState()},i.prototype.syncMovementState=function(){this._isPhysicsReady===!0&&(this.m_ghostTransform=this.m_ghostObject.getWorldTransform(),null!=this.m_ghostTransform?(this.m_ghostPosition=this.m_ghostTransform.getOrigin(),this.m_ghostRotation=this.m_ghostTransform.getRotation()):(this.m_ghostPosition=null,this.m_ghostRotation=null))},i.prototype.updateMovementState=function(){this.syncMovementState(),this._isPhysicsReady===!0&&(0!==this.m_turningRate&&null!=this.m_ghostTransform&&null!=this.m_ghostRotation&&(this._tmpBabylonQuaternion.set(this.m_ghostRotation.x(),this.m_ghostRotation.y(),this.m_ghostRotation.z(),this.m_ghostRotation.w()),e.Utilities.ToEulerToRef(this._tmpBabylonQuaternion,this._tmpBabylonEulerVector),this._tmpBabylonEulerVector.y+=this.m_turningRate,e.Utilities.FromEulerToRef(this._tmpBabylonEulerVector.x,this._tmpBabylonEulerVector.y,this._tmpBabylonEulerVector.z,this._tmpBabylonQuaternion),this._tmpAmmoQuaternion.setValue(this._tmpBabylonQuaternion.x,this._tmpBabylonQuaternion.y,this._tmpBabylonQuaternion.z,this._tmpBabylonQuaternion.w),this.m_ghostTransform.setRotation(this._tmpAmmoQuaternion),this.m_ghostObject.setWorldTransform(this.m_ghostTransform)),null!=this.m_walkDirection&&this.internalSetWalkDirection(this.m_walkDirection))},i.prototype.afterMovementState=function(){this.syncMovementState(),this._isPhysicsReady===!0&&(null!=this.m_ghostPosition&&this.transform.position.set(this.m_ghostPosition.x(),this.m_ghostPosition.y(),this.m_ghostPosition.z()),null!=this.m_ghostRotation&&this.transform.rotationQuaternion.set(this.m_ghostRotation.x(),this.m_ghostRotation.y(),this.m_ghostRotation.z(),this.m_ghostRotation.w())),this.parseGhostCollisionContacts()},i.prototype.parseGhostCollisionContacts=function(){if(this._isPhysicsReady===!0){var e=this._onCollisionEnterObservable.hasObservers(),t=this._onCollisionStayObservable.hasObservers(),i=this._onCollisionExitObservable.hasObservers();if(e||t||i){var r=0;for(r=0;r<this._tmpCollisionContacts.length;r++)this._tmpCollisionContacts[r].reset=!0;var s=this.m_ghostObject.getNumOverlappingObjects();if(s>this._maxCollisions&&(s=this._maxCollisions),s>0)for(r=0;r<s;r++){var o=this.m_ghostObject.getOverlappingObject(r);if(null!=o){var n=Ammo.castObject(o,Ammo.btCollisionObject);if(null!=n&&null!=n.entity&&n.isActive()){var a=-1,l=n.entity;for(r=0;r<this._tmpCollisionContacts.length;r++){var h=this._tmpCollisionContacts[r];if(null!=h.mesh&&h.mesh===l){h.state=1,h.reset=!1,a=r;break}}if(a===-1)for(r=0;r<this._tmpCollisionContacts.length;r++){var u=this._tmpCollisionContacts[r];if(null==u.mesh){u.mesh=l,u.state=0,u.reset=!1;break}}}}}for(r=0;r<this._tmpCollisionContacts.length;r++){var m=this._tmpCollisionContacts[r];m.reset===!0?(i&&null!=m.mesh&&this._onCollisionExitObservable.notifyObservers(m.mesh),m.mesh=null,m.state=0,m.reset=!1):0===m.state?e&&null!=m.mesh&&this._onCollisionEnterObservable.notifyObservers(m.mesh):t&&null!=m.mesh&&this._onCollisionStayObservable.notifyObservers(m.mesh)}}}},i.prototype.destroyMovementState=function(){this.m_physicsEngine=null,null!=this.m_character&&(Ammo.destroy(this.m_character),this.m_character=null),null!=this.m_ghostObject&&(Ammo.destroy(this.m_ghostObject),this.m_ghostObject=null),null!=this.m_ghostShape&&(Ammo.destroy(this.m_ghostShape),this.m_ghostShape=null),null!=this.m_ghostCollision&&(Ammo.destroy(this.m_ghostCollision),this.m_ghostCollision=null),null!=this.m_ghostPosition&&(Ammo.destroy(this.m_ghostPosition),this.m_ghostPosition=null),null!=this.m_ghostRotation&&(Ammo.destroy(this.m_ghostRotation),this.m_ghostRotation=null),null!=this.m_ghostTransform&&(Ammo.destroy(this.m_ghostTransform),this.m_ghostTransform=null),null!=this.m_startPosition&&(Ammo.destroy(this.m_startPosition),this.m_startPosition=null),null!=this.m_startRotation&&(Ammo.destroy(this.m_startRotation),this.m_startRotation=null),null!=this.m_startTransform&&(Ammo.destroy(this.m_startTransform),this.m_startTransform=null),null!=this.m_warpPosition&&(Ammo.destroy(this.m_warpPosition),this.m_warpPosition=null),null!=this.m_walkDirection&&(Ammo.destroy(this.m_walkDirection),this.m_walkDirection=null),null!=this._tmpAmmoQuaternion&&(Ammo.destroy(this._tmpAmmoQuaternion),this._tmpAmmoQuaternion=null),null!=this._tmpOriginQuaternion&&(Ammo.destroy(this._tmpOriginQuaternion),this._tmpOriginQuaternion=null),null!=this._tmpRotateQuaternion&&(Ammo.destroy(this._tmpRotateQuaternion),this._tmpRotateQuaternion=null),this._onCollisionEnterObservable.clear(),this._onCollisionEnterObservable=null,this._onCollisionStayObservable.clear(),this._onCollisionStayObservable=null,this._onCollisionExitObservable.clear(),this._onCollisionExitObservable=null,this._tmpCollisionContacts=null,this._abstractMesh=null},i.prototype.registerOnCollisionEnter=function(e){return this._onCollisionEnterObservable.add(e)},i.prototype.unregisterOnCollisionEnter=function(e){return this._onCollisionEnterObservable.remove(e)},i.prototype.registerOnCollisionStay=function(e){return this._onCollisionStayObservable.add(e)},i.prototype.unregisterOnCollisionStay=function(e){return this._onCollisionStayObservable.remove(e)},i.prototype.registerOnCollisionExit=function(e){return this._onCollisionExitObservable.add(e)},i.prototype.unregisterOnCollisionExit=function(e){return this._onCollisionExitObservable.remove(e)},i.prototype.setMaxNotifications=function(t){this._maxCollisions=t,this._tmpCollisionContacts=[];for(var i=0;i<this._maxCollisions;i++)this._tmpCollisionContacts.push(new e.CollisionContactInfo)},i.prototype.setActivationState=function(e){null!=this.m_ghostCollision&&this.m_ghostCollision.setActivationState&&this.m_ghostCollision.setActivationState(e)},i.prototype.getCollisionFilterGroup=function(){var e=-1;return null!=this.m_ghostCollision&&this.m_ghostCollision.getBroadphaseHandle&&(e=this.m_ghostCollision.getBroadphaseHandle().get_m_collisionFilterGroup()),e},i.prototype.setCollisionFilterGroup=function(e){null!=this.m_ghostCollision&&this.m_ghostCollision.getBroadphaseHandle&&this.m_ghostCollision.getBroadphaseHandle().set_m_collisionFilterGroup(e)},i.prototype.getCollisionFilterMask=function(){var e=-1;return null!=this.m_ghostCollision&&this.m_ghostCollision.getBroadphaseHandle&&(e=this.m_ghostCollision.getBroadphaseHandle().get_m_collisionFilterMask()),e},i.prototype.setCollisionFilterMask=function(e){null!=this.m_ghostCollision&&this.m_ghostCollision.getBroadphaseHandle&&this.m_ghostCollision.getBroadphaseHandle().set_m_collisionFilterMask(e)},i.prototype.getContactProcessingThreshold=function(){var e=-1;return null!=this.m_ghostCollision&&this.m_ghostCollision.getContactProcessingThreshold&&this.m_ghostCollision.getContactProcessingThreshold(),e},i.prototype.setContactProcessingThreshold=function(e){null!=this.m_ghostCollision&&this.m_ghostCollision.setContactProcessingThreshold&&this.m_ghostCollision.setContactProcessingThreshold(e)},i.prototype.setGhostWorldTransform=function(e,t){null!=this.m_ghostObject&&null!=this.m_ghostTransform&&(null!=this.m_ghostPosition&&null!=e&&(this.m_ghostPosition.setValue(e.x,e.y,e.z),this.m_ghostTransform.setOrigin(this.m_ghostPosition)),null!=this.m_ghostRotation&&null!=t&&(this.m_ghostRotation.setValue(t.x,t.y,t.z,t.w),this.m_ghostTransform.setRotation(this.m_ghostRotation)),this.m_ghostObject.setWorldTransform(this.m_ghostTransform))},i.prototype.move=function(e){null!=e&&(this.m_moveDeltaX=e.x,this.m_moveDeltaZ=e.z,Math.abs(e.x)<this._minMoveDistance&&(e.x>0?this.m_moveDeltaX=this._minMoveDistance:e.x<0&&(this.m_moveDeltaX=-this._minMoveDistance)),Math.abs(e.z)<this._minMoveDistance&&(e.z>0?this.m_moveDeltaZ=this._minMoveDistance:e.z<0&&(this.m_moveDeltaZ=-this._minMoveDistance)),null!=this.m_walkDirection&&this.m_walkDirection.setValue(this.m_moveDeltaX,0,this.m_moveDeltaZ))},i.prototype.turn=function(e){this.m_turningRate=e},i.prototype.jump=function(e){this.internalSetJumpSpeed(e),this.internalJump()},i.prototype.warp=function(e){null!=this.m_warpPosition&&(this.m_warpPosition.setValue(e.x,e.y,e.z),this.internalWarp(this.m_warpPosition))},i}(e.ScriptComponent);e.CharacterController=t}(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),BABYLON;!function(e){var t=function(t){function i(e,i,r){return void 0===r&&(r={}),t.call(this,e,i,r)||this}return __extends(i,t),Object.defineProperty(i.prototype,"info",{get:function(){return this._info},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hasAgentInfo",{get:function(){return null!=this.info},enumerable:!0,configurable:!0}),i.prototype.start=function(){},i.prototype.update=function(){},i.prototype.after=function(){},i.prototype.destroy=function(){},i.prototype.setDestination=function(t){this.hasAgentInfo||e.Tools.Warn("Null navigation agent metadata. Set agent destination ignored.")},i.GetNavigationMesh=function(t){return e.SceneManager.GetAbstractMesh(t,"NavigationMesh")},i.GetNavigationZone=function(){return"scene"},i.BuildNavigationNodes=function(t,i){void 0===i&&(i=null);var r=null,s=i||e.NavigationAgent.GetNavigationMesh(t);if(null!=s){r=new Navigation;var o=r.buildNodes(s);null!=o?r.setZoneData(e.NavigationAgent.GetNavigationZone(),o):e.Tools.Warn("Failed to build navigation zone nodes")}else e.Tools.Warn("Failed to locate scene navigation mesh");return r},i.FindNavigationPath=function(t,i,r){var s=e.NavigationAgent.GetNavigationZone(),o=t.getGroup(s,i);return t.findPath(i,r,s,o)},i}(e.ScriptComponent);e.NavigationAgent=t}(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),BABYLON;!function(e){var t=function(e){function t(t,i,r){return void 0===r&&(r={}),e.call(this,t,i,r)||this}return __extends(t,e),t.prototype.start=function(){},t.prototype.update=function(){},t.prototype.after=function(){},t.prototype.destroy=function(){},t}(e.ScriptComponent);e.NetworkSystem=t}(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),BABYLON;!function(e){var t=function(e){function t(t,i,r){return void 0===r&&(r={}),e.call(this,t,i,r)||this}return __extends(t,e),t.prototype.start=function(){},t.prototype.update=function(){},t.prototype.after=function(){},t.prototype.destroy=function(){},t}(e.ScriptComponent);e.ShurikenParticleSystem=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r,s){this._rightHanded=!1,this._centerMass=new e.Vector3(0,0,0),this._chassisMesh=null,this._tempVectorPos=new e.Vector3(0,0,0),this._tempQuaternion=new e.Quaternion(0,0,0,1),this._tempVectorScale=new e.Vector3(0,0,0),this.lockedWheelIndexes=null,this.m_vehicle=null,this.m_vehicleTuning=null,this.m_vehicleRaycaster=null,this.m_vehicleColliders=null,this.m_tempTransform=null,this.m_tempPosition=null,this.m_tempRotation=null,this.m_wheelDirectionCS0=null,this.m_wheelAxleCS=null,this._tempMatrixA=e.Matrix.Zero(),this._tempMatrixB=e.Matrix.Zero(),this._tempMatrixC=e.Matrix.Zero(),this._rightHanded=r,this._chassisMesh=t,this._centerMass=s,this.m_vehicleColliders=this._chassisMesh.metadata.wheels,this.m_vehicleTuning=new Ammo.btVehicleTuning,this.m_vehicleRaycaster=new Ammo.btSmoothVehicleRaycaster(i),this.m_vehicle=new Ammo.btRaycastVehicle(this.m_vehicleTuning,this._chassisMesh.physicsImpostor.physicsBody,this.m_vehicleRaycaster),this.m_vehicle.setCoordinateSystem(0,1,2),this.m_wheelDirectionCS0=new Ammo.btVector3(0,(-1),0),this.m_wheelAxleCS=new Ammo.btVector3((-1),0,0),this.m_tempPosition=null,this.m_tempRotation=null,this.m_tempTransform=null,i.addAction(this.m_vehicle),this.setupWheelInformation()}return t.prototype.getUpAxis=function(){if(null!=this.m_vehicle)return this.m_vehicle.getUpAxis()},t.prototype.getRightAxis=function(){if(null!=this.m_vehicle)return this.m_vehicle.getRightAxis()},t.prototype.getForwardAxis=function(){if(null!=this.m_vehicle)return this.m_vehicle.getForwardAxis()},t.prototype.getForwardVector=function(){if(null!=this.m_vehicle)return this.m_vehicle.getForwardVector()},t.prototype.getNumWheels=function(){if(null!=this.m_vehicle)return this.m_vehicle.getNumWheels()},t.prototype.getWheelInfo=function(e){if(null!=this.m_vehicle)return this.m_vehicle.getWheelInfo(e)},t.prototype.resetSuspension=function(){null!=this.m_vehicle&&this.m_vehicle.resetSuspension()},t.prototype.setPitchControl=function(e){null!=this.m_vehicle&&this.m_vehicle.setPitchControl(e)},t.prototype.setEngineForce=function(e,t){null!=this.m_vehicle&&this.m_vehicle.applyEngineForce(this._rightHanded?e*-1:e,t)},t.prototype.setBrakingForce=function(e,t){null!=this.m_vehicle&&this.m_vehicle.setBrake(this._rightHanded?1*e:e,t)},t.prototype.getSteeringAngle=function(e){if(null!=this.m_vehicle)return Math.abs(this.m_vehicle.getSteeringValue(e))},t.prototype.setSteeringAngle=function(e,t){null!=this.m_vehicle&&this.m_vehicle.setSteeringValue(this._rightHanded?e*-1:e,t)},t.prototype.getWheelTransform=function(e){if(null!=this.m_vehicle)return this.m_vehicle.getWheelTransformWS(e)},t.prototype.updateWheelTransform=function(e,t){null!=this.m_vehicle&&this.m_vehicle.updateWheelTransform(e,t)},t.prototype.getUserConstraintType=function(){if(null!=this.m_vehicle)return this.m_vehicle.getUserConstraintType()},t.prototype.setUserConstraintType=function(e){null!=this.m_vehicle&&this.m_vehicle.setUserConstraintType(e)},t.prototype.setUserConstraintId=function(e){null!=this.m_vehicle&&this.m_vehicle.setUserConstraintId(e)},t.prototype.getUserConstraintId=function(){if(null!=this.m_vehicle)return this.m_vehicle.getUserConstraintId()},t.prototype.getRawCurrentSpeedKph=function(){if(null!=this.m_vehicle)return this.m_vehicle.getCurrentSpeedKmHour()},t.prototype.getRawCurrentSpeedMph=function(){if(null!=this.m_vehicle)return this.m_vehicle.getCurrentSpeedKmHour()*e.System.Kph2Mph},t.prototype.getAbsCurrentSpeedKph=function(){if(null!=this.m_vehicle)return Math.abs(this.m_vehicle.getCurrentSpeedKmHour())},t.prototype.getAbsCurrentSpeedMph=function(){if(null!=this.m_vehicle)return Math.abs(this.m_vehicle.getCurrentSpeedKmHour())*e.System.Kph2Mph},t.prototype.getVehicleTuningSystem=function(){return this.m_vehicleTuning},t.prototype.getChassisWorldTransform=function(){if(null!=this.m_vehicle)return this.m_vehicle.getChassisWorldTransform()},t.prototype.dispose=function(){this.deleteWheelInformation(),null!=this.m_vehicle&&(Ammo.destroy(this.m_vehicle),this.m_vehicle=null),null!=this.m_vehicleTuning&&(Ammo.destroy(this.m_vehicleTuning),this.m_vehicleTuning=null),null!=this.m_vehicleRaycaster&&(Ammo.destroy(this.m_vehicleRaycaster),this.m_vehicleRaycaster=null),null!=this.m_wheelDirectionCS0&&(Ammo.destroy(this.m_wheelDirectionCS0),this.m_wheelDirectionCS0=null),null!=this.m_wheelAxleCS&&(Ammo.destroy(this.m_wheelAxleCS),this.m_wheelAxleCS=null),null!=this.m_tempPosition&&(Ammo.destroy(this.m_tempPosition),this.m_tempPosition=null),null!=this.m_tempRotation&&(Ammo.destroy(this.m_tempRotation),this.m_tempRotation=null),null!=this.m_tempTransform&&(Ammo.destroy(this.m_tempTransform),this.m_tempTransform=null),this.m_vehicleColliders=null},t.prototype.getCollisionFilterGroup=function(){var e=-1;return null!=this.m_vehicleRaycaster&&this.m_vehicleRaycaster.get_m_collisionFilterGroup&&(e=this.m_vehicleRaycaster.get_m_collisionFilterGroup()),e},t.prototype.setCollisionFilterGroup=function(e){null!=this.m_vehicleRaycaster&&this.m_vehicleRaycaster.set_m_collisionFilterGroup&&this.m_vehicleRaycaster.set_m_collisionFilterGroup(e)},t.prototype.getCollisionFilterMask=function(){var e=-1;return null!=this.m_vehicleRaycaster&&this.m_vehicleRaycaster.get_m_collisionFilterMask&&(e=this.m_vehicleRaycaster.get_m_collisionFilterMask()),e},t.prototype.setCollisionFilterMask=function(e){null!=this.m_vehicleRaycaster&&this.m_vehicleRaycaster.set_m_collisionFilterMask&&this.m_vehicleRaycaster.set_m_collisionFilterMask(e)},t.prototype.getInterpolateMeshNormals=function(){var e=-1;return null!=this.m_vehicleRaycaster&&this.m_vehicleRaycaster.get_m_interpolateMeshNormals&&(e=this.m_vehicleRaycaster.get_m_interpolateMeshNormals()),e},t.prototype.setInterpolateMeshNormals=function(e){null!=this.m_vehicleRaycaster&&this.m_vehicleRaycaster.set_m_interpolateMeshNormals&&this.m_vehicleRaycaster.set_m_interpolateMeshNormals(e)},t.prototype.getWheelIndexByID=function(e){var t=-1;if(null!=this.m_vehicleColliders&&this.m_vehicleColliders.length>0)for(var i=0;i<this.m_vehicleColliders.length;i++){var r=this.m_vehicleColliders[i];if(e.toLowerCase()===r.id.toLowerCase()){t=i;break}}return t},t.prototype.getWheelIndexByName=function(e){var t=-1;if(null!=this.m_vehicleColliders&&this.m_vehicleColliders.length>0)for(var i=0;i<this.m_vehicleColliders.length;i++){var r=this.m_vehicleColliders[i];if(e.toLowerCase()===r.name.toLowerCase()){t=i;break}}return t},t.prototype.getWheelColliderInfo=function(e){var t=-1;return null!=this.m_vehicleColliders&&this.m_vehicleColliders.length>0&&this.m_vehicleColliders.length>e&&(t=this.m_vehicleColliders[e]),t},t.prototype.setWheelTransformMesh=function(e,t){if(null!=t){var i=this.getWheelInfo(e);null!=i&&(i.transform=t)}},t.prototype.setupWheelInformation=function(){if(null!=this._chassisMesh&&null!=this._chassisMesh.physicsImpostor&&null!=this._chassisMesh.physicsImpostor.physicsBody&&this._chassisMesh.physicsImpostor.physicsBody.setActivationState(e.CollisionState.DISABLE_DEACTIVATION),null!=this.m_vehicle&&null!=this.m_vehicleColliders&&this.m_vehicleColliders.length>0){var t=-1;for(t=0;t<this.m_vehicleColliders.length;t++){var i=this.m_vehicleColliders[t],r=null!=i.name?i.name:"Unknown",s=null!=i.radius?i.radius:.5,o=null!=i.position&&i.position.length>=3?i.position[0]:1,n=null!=i.position&&i.position.length>=3?i.position[2]:-1,a=null!=i.suspensiondistance?i.suspensiondistance:.3,l=null!=i.suspensiontarget?i.suspensiontarget:.5,h=null!=i.forceapppointdistance?i.forceapppointdistance:0,u=null!=i.frontwheel||r.toLowerCase().indexOf("front")>=0;this.m_vehicle.addWheel(new Ammo.btVector3(o+-this._centerMass.x,a,n+-this._centerMass.z),this.m_wheelDirectionCS0,this.m_wheelAxleCS,l+h,s,this.m_vehicleTuning,u)}if(this.m_vehicle.getNumWheels()===this.m_vehicleColliders.length)for(t=0;t<this.m_vehicleColliders.length;t++){var i=this.m_vehicleColliders[t],m=6e3,c=500,p=null!=i.wheeldampingrate?.8*i.wheeldampingrate:.2,f=null!=i.forward_extremumvalue?10*i.forward_extremumvalue:10,_=null!=i.forward_stiffness?10*i.forward_stiffness:10,d=null!=i.suspensionspring?1e-4*i.suspensionspring:3.5,y=null!=i.suspensiondamper?.001*i.suspensiondamper:4.5,v=this.m_vehicle.getWheelInfo(t);null!=v&&(v.defaultFriction=f,v.set_m_frictionSlip(f),v.set_m_rollInfluence(p),v.set_m_maxSuspensionForce(m),v.set_m_maxSuspensionTravelCm(c),v.set_m_suspensionStiffness(_),v.set_m_wheelsDampingCompression(d),v.set_m_wheelsDampingRelaxation(y),v.set_m_wheelsRadiusScale&&v.set_m_wheelsRadiusScale(2))}else e.Tools.Warn("Failed to create proper number of wheels for: "+this._chassisMesh.name)}},t.prototype.updateWheelInformation=function(){var t=this.getNumWheels();if(t>0)for(var i=0;i<t;i++){var r=this.getWheelInfo(i);if(null!=r){var s=this.lockedWheelInformation(i);if(r.set_m_bIsWheelLocked&&r.set_m_bIsWheelLocked(s),this.updateWheelTransform(i,!1),this.m_tempTransform=this.getWheelTransform(i),this.m_tempPosition=this.m_tempTransform.getOrigin(),this.m_tempRotation=this.m_tempTransform.getRotation(),null!=r.transform){var o=r.transform;null!=o.parent?(this._tempMatrixA.reset(),this._tempMatrixB.reset(),this._tempMatrixC.reset(),this._tempVectorPos.set(this.m_tempPosition.x(),this.m_tempPosition.y(),this.m_tempPosition.z()),this._tempQuaternion.set(this.m_tempRotation.x(),this.m_tempRotation.y(),this.m_tempRotation.z(),this.m_tempRotation.w()),this._tempVectorScale.set(1,1,1),e.Matrix.ComposeToRef(this._tempVectorScale,this._tempQuaternion,this._tempVectorPos,this._tempMatrixA),o.parent.computeWorldMatrix(),o.parent.getWorldMatrix().invertToRef(this._tempMatrixB),this._tempMatrixA.multiplyToRef(this._tempMatrixB,this._tempMatrixC),this._tempMatrixC.decompose(this._tempVectorScale,o.rotationQuaternion,o.position),o.addRotation(0,Math.PI,0)):(o.position.set(this.m_tempPosition.x(),this.m_tempPosition.y(),this.m_tempPosition.z()),o.rotationQuaternion.set(this.m_tempRotation.x(),this.m_tempRotation.y(),this.m_tempRotation.z(),this.m_tempRotation.w()),o.addRotation(0,Math.PI,0))}}}},t.prototype.lockedWheelInformation=function(e){var t=!1;if(null!=this.lockedWheelIndexes&&this.lockedWheelIndexes.length>0)for(var i=0;i<this.lockedWheelIndexes.length;i++)if(this.lockedWheelIndexes[i]===e){t=!0;break}return t},t.prototype.deleteWheelInformation=function(){var e=this.getNumWheels();if(e>0)for(var t=0;t<e;t++){var i=this.getWheelInfo(t);null!=i&&(null!=i.transform&&delete i.transform,null!=i.defaultFriction&&delete i.defaultFriction)}},t}();e.RaycastVehicle=t}(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),BABYLON;!function(e){var t=function(){function e(){this.mesh=null,this.state=0,this.reset=!1}return e}();e.CollisionContactInfo=t;var i=function(i){function r(t,r,s){void 0===s&&(s={});var o=i.call(this,t,r,s)||this;return o._abstractMesh=null,o._isKinematic=!1,o._maxCollisions=4,o._isPhysicsReady=!1,o._centerOfMass=new e.Vector3(0,0,0),o._raycastVehicle=null,o._tmpCollisionContacts=null,o.m_physicsWorld=null,o.m_physicsEngine=null,o._onCollisionEnterObservable=new e.Observable,o._onCollisionStayObservable=new e.Observable,o._onCollisionExitObservable=new e.Observable,o._abstractMesh=o.getAbstractMesh(),o._isKinematic=o.getEditorProperty("isKinematic",o._isKinematic),o.m_physicsWorld=e.SceneManager.GetPhysicsWorld(o.scene),o.m_physicsEngine=e.SceneManager.GetPhysicsEngine(o.scene),null!=o.transform.metadata&&null!=o.transform.metadata.unity&&null!=o.transform.metadata.unity.physics&&(o._centerOfMass=null!=o.transform.metadata.unity.physics.center?e.Utilities.ParseVector3(o.transform.metadata.unity.physics.center,o._centerOfMass):o._centerOfMass),o.setMaxNotifications(o._maxCollisions),o}return __extends(r,i),Object.defineProperty(r.prototype,"isKinematic",{get:function(){return this._isKinematic},enumerable:!0,configurable:!0}),r.prototype.start=function(){this.initRigidbodyState()},r.prototype.update=function(){this.updateRigidbodyState()},r.prototype.after=function(){this.afterRigidbodyState()},r.prototype.destroy=function(){this.destroyRigidbodyState()},r.prototype.initRigidbodyState=function(){e.Utilities.ValidateTransformQuaternion(this.transform),this._isPhysicsReady=null!=this.m_physicsEngine&&null!=this._tmpCollisionContacts&&null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody;var t=this._isKinematic===!0?e.CollisionFilters.StaticFilter:e.CollisionFilters.DefaultFilter,i=this._isKinematic===!0?e.CollisionFilters.AllFilter^e.CollisionFilters.StaticFilter:e.CollisionFilters.AllFilter;this.setContactProcessingThreshold(0),this.setCollisionFilterGroup(t),this.setCollisionFilterMask(i),this.resetBodyCollisionContacts()},r.prototype.updateRigidbodyState=function(){this.syncronizeVehicleController()},r.prototype.afterRigidbodyState=function(){this.parseBodyCollisionContacts(),this.resetBodyCollisionContacts()},r.prototype.destroyRigidbodyState=function(){this.m_physicsWorld=null,this.m_physicsEngine=null,null!=this._raycastVehicle&&(this._raycastVehicle.dispose(),this._raycastVehicle=null),this._onCollisionEnterObservable.clear(),this._onCollisionEnterObservable=null,this._onCollisionStayObservable.clear(),this._onCollisionStayObservable=null,this._onCollisionExitObservable.clear(),this._onCollisionExitObservable=null,this._tmpCollisionContacts=null,this._abstractMesh=null},r.prototype.syncronizeVehicleController=function(){null!=this._raycastVehicle&&this._raycastVehicle.updateWheelInformation()},r.prototype.parseBodyCollisionContacts=function(){if(this._isPhysicsReady===!0){var e=this._onCollisionEnterObservable.hasObservers(),t=this._onCollisionStayObservable.hasObservers(),i=this._onCollisionExitObservable.hasObservers();if(e||t||i){var r=0;for(r=0;r<this._tmpCollisionContacts.length;r++)this._tmpCollisionContacts[r].reset=!0;var s=0;if(null!=this._abstractMesh.physicsImpostor.tmpCollisionObjects){var o=this._abstractMesh.physicsImpostor.tmpCollisionObjects;for(var n in o){var a=-1,l=o[n];for(r=0;r<this._tmpCollisionContacts.length;r++){var h=this._tmpCollisionContacts[r];if(null!=h.mesh&&h.mesh===l){h.state=1,h.reset=!1,a=r;break}}if(a===-1)for(r=0;r<this._tmpCollisionContacts.length;r++){var u=this._tmpCollisionContacts[r];if(null==u.mesh){u.mesh=l,u.state=0,u.reset=!1;break}}if(s++,s>this._maxCollisions)break}}for(r=0;r<this._tmpCollisionContacts.length;r++){var m=this._tmpCollisionContacts[r];m.reset===!0?(i&&null!=m.mesh&&this._onCollisionExitObservable.notifyObservers(m.mesh),m.mesh=null,m.state=0,m.reset=!1):0===m.state?e&&null!=m.mesh&&this._onCollisionEnterObservable.notifyObservers(m.mesh):t&&null!=m.mesh&&this._onCollisionStayObservable.notifyObservers(m.mesh)}}}},r.prototype.resetBodyCollisionContacts=function(){if(this._isPhysicsReady===!0){var e=this._onCollisionEnterObservable.hasObservers(),t=this._onCollisionStayObservable.hasObservers(),i=this._onCollisionExitObservable.hasObservers();e||t||i?this._abstractMesh.physicsImpostor.tmpCollisionObjects={}:this._abstractMesh.physicsImpostor.tmpCollisionObjects=null}},r.prototype.registerOnCollisionEnter=function(e){return this._onCollisionEnterObservable.add(e)},r.prototype.unregisterOnCollisionEnter=function(e){return this._onCollisionEnterObservable.remove(e)},r.prototype.registerOnCollisionStay=function(e){return this._onCollisionStayObservable.add(e)},r.prototype.unregisterOnCollisionStay=function(e){return this._onCollisionStayObservable.remove(e)},r.prototype.registerOnCollisionExit=function(e){return this._onCollisionExitObservable.add(e)},r.prototype.unregisterOnCollisionExit=function(e){return this._onCollisionExitObservable.remove(e)},r.prototype.applyForce=function(e,t){null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=e&&this._abstractMesh.physicsImpostor.applyForce(e,t)},r.prototype.applyImpulse=function(e,t){null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=e&&this._abstractMesh.physicsImpostor.applyImpulse(e,t)},r.prototype.getMass=function(){var e=0;return null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&(e=this._abstractMesh.physicsImpostor.mass),e},r.prototype.setMass=function(e){null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&this._abstractMesh.physicsImpostor.mass!==e&&(this._abstractMesh.physicsImpostor.mass=e)},r.prototype.getFriction=function(){var e=0;return null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&(e=this._abstractMesh.physicsImpostor.friction),e},r.prototype.setFriction=function(e){null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&this._abstractMesh.physicsImpostor.friction!==e&&(this._abstractMesh.physicsImpostor.friction=e)},r.prototype.getRestitution=function(){var e=0;return null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&(e=this._abstractMesh.physicsImpostor.restitution),e},r.prototype.setRestitution=function(e){null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&this._abstractMesh.physicsImpostor.restitution!==e&&(this._abstractMesh.physicsImpostor.restitution=e)},r.prototype.getLinearVelocity=function(){var e=null;return null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&(e=this._abstractMesh.physicsImpostor.getLinearVelocity()),e},r.prototype.setLinearVelocity=function(e){null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=e&&this._abstractMesh.physicsImpostor.setLinearVelocity(e)},r.prototype.getAngularVelocity=function(){var e=null;return null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&(e=this._abstractMesh.physicsImpostor.getAngularVelocity()),e},r.prototype.setAngularVelocity=function(e){null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=e&&this._abstractMesh.physicsImpostor.setAngularVelocity(e)},r.prototype.getCenterMass=function(){return this._centerOfMass},r.prototype.getLinearFactor=function(){var e=0;return null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody&&this._abstractMesh.physicsImpostor.physicsBody.getLinearFactor&&(e=this._abstractMesh.physicsImpostor.physicsBody.getLinearFactor()),e},r.prototype.setLinearFactor=function(e){null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody&&this._abstractMesh.physicsImpostor.physicsBody.setLinearFactor&&this._abstractMesh.physicsImpostor.physicsBody.setLinearFactor(e)},r.prototype.getAngularFactor=function(){var e=0;return null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody&&this._abstractMesh.physicsImpostor.physicsBody.getAngularFactor&&(e=this._abstractMesh.physicsImpostor.physicsBody.getAngularFactor()),e},r.prototype.setAngularFactor=function(e){null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody&&this._abstractMesh.physicsImpostor.physicsBody.setAngularFactor&&this._abstractMesh.physicsImpostor.physicsBody.setAngularFactor(e)},r.prototype.getAngularDamping=function(){var e=0;return null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody&&this._abstractMesh.physicsImpostor.physicsBody.getAngularDamping&&(e=this._abstractMesh.physicsImpostor.physicsBody.getAngularDamping()),e},r.prototype.getLinearDamping=function(){var e=0;return null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody&&this._abstractMesh.physicsImpostor.physicsBody.getLinearDamping&&(e=this._abstractMesh.physicsImpostor.physicsBody.getLinearDamping()),e},r.prototype.setDamping=function(e,t){
null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody&&this._abstractMesh.physicsImpostor.physicsBody.setDamping&&this._abstractMesh.physicsImpostor.physicsBody.setDamping(e,t)},r.prototype.getGravity=function(){var e=null;return null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody&&this._abstractMesh.physicsImpostor.physicsBody.getGravity&&(e=this._abstractMesh.physicsImpostor.physicsBody.getGravity()),e},r.prototype.setGravity=function(e){null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody&&this._abstractMesh.physicsImpostor.physicsBody.setGravity&&null!=e&&this._abstractMesh.physicsImpostor.physicsBody.setGravity(e)},r.prototype.setMaxNotifications=function(e){this._maxCollisions=e,this._tmpCollisionContacts=[];for(var i=0;i<this._maxCollisions;i++)this._tmpCollisionContacts.push(new t)},r.prototype.setActivationState=function(e){if(null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody){var t=Ammo.castObject(this._abstractMesh.physicsImpostor.physicsBody,Ammo.btCollisionObject);null!=t&&t.setActivationState&&t.setActivationState(e)}},r.prototype.getCollisionFilterGroup=function(){var e=-1;return null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody&&this._abstractMesh.physicsImpostor.physicsBody.getBroadphaseProxy&&(e=this._abstractMesh.physicsImpostor.physicsBody.getBroadphaseProxy().get_m_collisionFilterGroup()),e},r.prototype.setCollisionFilterGroup=function(e){null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody&&this._abstractMesh.physicsImpostor.physicsBody.getBroadphaseProxy&&this._abstractMesh.physicsImpostor.physicsBody.getBroadphaseProxy().set_m_collisionFilterGroup(e)},r.prototype.getCollisionFilterMask=function(){var e=-1;return null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody&&this._abstractMesh.physicsImpostor.physicsBody.getBroadphaseProxy&&(e=this._abstractMesh.physicsImpostor.physicsBody.getBroadphaseProxy().get_m_collisionFilterMask()),e},r.prototype.setCollisionFilterMask=function(e){null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody&&this._abstractMesh.physicsImpostor.physicsBody.getBroadphaseProxy&&this._abstractMesh.physicsImpostor.physicsBody.getBroadphaseProxy().set_m_collisionFilterMask(e)},r.prototype.getCollisionShapeType=function(){var e=-1;if(null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody){var t=Ammo.castObject(this._abstractMesh.physicsImpostor.physicsBody,Ammo.btCollisionObject);if(null!=t){var i=t.getCollisionShape();null!=i&&i.getShapeType&&(e=i.getShapeType())}}return e},r.prototype.getCollisionShapeMargin=function(){var e=-1;if(null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody){var t=Ammo.castObject(this._abstractMesh.physicsImpostor.physicsBody,Ammo.btCollisionObject);if(null!=t){var i=t.getCollisionShape();null!=i&&i.getMargin&&(e=i.getMargin())}}return e},r.prototype.setCollisionShapeMargin=function(e){if(null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody){var t=Ammo.castObject(this._abstractMesh.physicsImpostor.physicsBody,Ammo.btCollisionObject);if(null!=t){var i=t.getCollisionShape();null!=i&&i.setMargin&&i.setMargin(e)}}},r.prototype.getContactProcessingThreshold=function(){var e=-1;if(null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody){var t=Ammo.castObject(this._abstractMesh.physicsImpostor.physicsBody,Ammo.btCollisionObject);null!=t&&t.getContactProcessingThreshold&&(e=t.getContactProcessingThreshold())}return e},r.prototype.setContactProcessingThreshold=function(e){if(null!=this._abstractMesh&&null!=this._abstractMesh.physicsImpostor&&null!=this._abstractMesh.physicsImpostor.physicsBody){var t=Ammo.castObject(this._abstractMesh.physicsImpostor.physicsBody,Ammo.btCollisionObject);null!=t&&t.setContactProcessingThreshold&&t.setContactProcessingThreshold(e)}},r.prototype.hasRaycastVehicle=function(){return this._isPhysicsReady===!0&&null!=this._abstractMesh.metadata&&null!=this._abstractMesh.metadata.wheels},r.prototype.getRaycastVehicle=function(){return null==this._raycastVehicle&&(this.hasRaycastVehicle()?this._raycastVehicle=new e.RaycastVehicle(this._abstractMesh,this.m_physicsWorld,this.scene.useRightHandedSystem,this._centerOfMass):e.Tools.Warn("No wheel collider metadata info for: "+this.transform.name)),this._raycastVehicle},r.SetupPhysicsComponent=function(t,i){var r=null!=i.metadata&&null!=i.metadata.unity?i.metadata.unity:null;if(null!=r&&null!=r.physics){var s=null!=r.physics.mass?r.physics.mass:0,o=null!=r.physics.center?e.Utilities.ParseVector3(r.physics.center,e.Vector3.Zero()):e.Vector3.Zero();if("rigidbody"===r.physics.type)if(null!=r.collision&&null!=r.collision.type&&"MeshCollider"===r.collision.type){var n=null!=r.collision.convexmesh&&r.collision.convexmesh,a=null!=r.collision.dynamicfriction?r.collision.dynamicfriction:.6,l=(null!=r.collision.staticfriction?r.collision.staticfriction:.6,null!=r.collision.restitution?r.collision.restitution:0),h=null!=r.collision.trigger&&r.collision.trigger,u=n===!0?e.PhysicsImpostor.ConvexHullImpostor:e.PhysicsImpostor.MeshImpostor;e.SceneManager.CreatePhysicsImpostor(t,i,u,{mass:s,friction:a,restitution:l}),e.RigidbodyPhysics.ConfigRigidbodyPhysics(t,i,!1,h,r.physics)}else{var m=0,c=0,p=0,f=!1,_=0,d=null,y=i.getChildren(null,!0);null!=y&&y.length>0&&y.forEach(function(e){e.position.subtractInPlace(o)});var v=i.getChildren(null,!1);null!=v&&v.length>0&&v.forEach(function(s){if(null!=s.metadata&&null!=s.metadata.unity&&null!=s.metadata.unity.collision){var o=s.metadata.unity.collision,n=null!=o.wheelinformation?o.wheelinformation:null;if(null!=n)null==d&&(d=[]),d.push(n);else{s.parent!==i&&s.setParent(i);var a=null!=o.dynamicfriction?o.dynamicfriction:.6,l=null!=o.staticfriction?o.staticfriction:.6,h=null!=o.restitution?o.restitution:0,u=null!=o.trigger&&o.trigger,y=null!=o.type?o.type:"BoxCollider",v=e.PhysicsImpostor.BoxImpostor;"MeshCollider"===y?v=e.PhysicsImpostor.ConvexHullImpostor:"CapsuleCollider"===y?v=e.PhysicsImpostor.CapsuleImpostor:"SphereCollider"===y?v=e.PhysicsImpostor.SphereImpostor:"BoxCollider"===y&&(v=e.PhysicsImpostor.BoxImpostor),a>m&&(m=a),l>c&&(c=l),h>p&&(p=h),1==u&&(f=!0),e.SceneManager.CreatePhysicsImpostor(t,s,v,{mass:0,friction:0,restitution:0}),e.RigidbodyPhysics.ConfigRigidbodyPhysics(t,s,!0,!1,r.physics),_++}}}),_>0&&(e.SceneManager.CreatePhysicsImpostor(t,i,e.PhysicsImpostor.NoImpostor,{mass:s,friction:m,restitution:p}),e.RigidbodyPhysics.ConfigRigidbodyPhysics(t,i,!1,f,r.physics)),null!=d&&d.length>0&&(i.metadata.wheels=d),v=null}}},r.ConfigRigidbodyPhysics=function(t,i,r,s,o){null==e.RigidbodyPhysics.TempAmmoVector&&(e.RigidbodyPhysics.TempAmmoVector=new Ammo.btVector3(0,0,0)),null!=i&&(null!=i.physicsImpostor?i.physicsImpostor.executeNativeFunction(function(r,n){var a=Ammo.castObject(n,Ammo.btCollisionObject);a.entity=i;var l=e.SceneManager.GetPhysicsWorld(t);if(null!=l&&l.generateInternalEdgeInfo){var h=a.getCollisionShape();if(null!=h&&h.getShapeType){var u=h.getShapeType();if(21===u){var m=Ammo.castObject(h,Ammo.btBvhTriangleMeshShape);a.triangleMapInfo=new Ammo.btTriangleInfoMap,l.generateInternalEdgeInfo(m,a.triangleMapInfo)}}}var c=null==o||null==o.gravity||o.gravity;if(c===!1&&(n.setGravity?(e.RigidbodyPhysics.TempAmmoVector.setValue(0,0,0),n.setGravity(e.RigidbodyPhysics.TempAmmoVector)):e.Tools.Warn("Physics engine set gravity override not supported for: "+i.name)),n.setDamping){var p=null!=o&&null!=o.ldrag?o.ldrag:0,f=null!=o&&null!=o.adrag?o.adrag:.05;n.setDamping(p,f)}else e.Tools.Warn("Physics engine set drag damping not supported for: "+i.name);n.setCollisionFlags&&n.getCollisionFlags?s===!0?n.setCollisionFlags(n.getCollisionFlags()|e.CollisionFlags.CF_NO_CONTACT_RESPONSE|e.CollisionFlags.CF_CUSTOM_MATERIAL_CALLBACK):n.setCollisionFlags(n.getCollisionFlags()|e.CollisionFlags.CF_CUSTOM_MATERIAL_CALLBACK):e.Tools.Warn("Physics engine set collision flags not supported for: "+i.name);var _=null!=o&&null!=o.freeze?o.freeze:null;if(null!=_){if(n.setLinearFactor){var d=null!=_.positionx&&_.positionx===!0?0:1,y=null!=_.positiony&&_.positiony===!0?0:1,v=null!=_.positionz&&_.positionz===!0?0:1;e.RigidbodyPhysics.TempAmmoVector.setValue(d,y,v),n.setLinearFactor(e.RigidbodyPhysics.TempAmmoVector)}else e.Tools.Warn("Physics engine set linear factor not supported for: "+i.name);if(n.setAngularFactor){var g=null!=_.rotationx&&_.rotationx===!0?0:1,C=null!=_.rotationy&&_.rotationy===!0?0:1,S=null!=_.rotationz&&_.rotationz===!0?0:1;e.RigidbodyPhysics.TempAmmoVector.setValue(g,C,S),n.setAngularFactor(e.RigidbodyPhysics.TempAmmoVector)}else e.Tools.Warn("Physics engine set angular factor not supported for: "+i.name)}}):e.Tools.Warn("No valid physics impostor to setup for "+i.name))},r.TempAmmoVector=null,r}(e.ScriptComponent);e.RigidbodyPhysics=i}(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),__decorate=this&&this.__decorate||function(e,t,i,r){var s,o=arguments.length,n=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(n=(o<3?s(n):o>3?s(t,i,n):s(t,i))||n);return o>3&&n&&Object.defineProperty(t,i,n),n},BABYLON;!function(e){var t=function(){function e(){this._defines={},this._defines={}}return e.prototype.getDefines=function(){return this._defines},e.prototype.defineBoolean=function(e){this._defines[e]=!0},e.prototype.defineNumeric=function(e,t){this._defines[e]=t},e.ShaderIndexer=0,e}();e.UniversalShaderDefines=t;var i=function(e){function t(){var t=e.call(this)||this;return t.DIFFUSE=!1,t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.ALPHATEST=!1,t.DEPTHPREPASS=!1,t.POINTSIZE=!1,t.FOG=!1,t.NORMAL=!1,t.UV1=!1,t.UV2=!1,t.VERTEXCOLOR=!1,t.VERTEXALPHA=!1,t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,t.INSTANCES=!1,t.rebuild(),t}return __extends(t,e),t}(e.MaterialDefines);e.UniversalMaterialDefines=i;var r=function(){function e(){}return e}();e.UniversalAlbedoChunks=r;var s=function(){function e(){}return e}();e.UniversalDiffuseChunks=s;var o=function(t){function i(i,r){var s=t.call(this,i,r)||this;return s.diffuseColor=new e.Color3(1,1,1),s._disableLighting=!1,s._maxSimultaneousLights=4,s.universalMaterial=!0,s.locals=null,s._defines=null,s._uniforms=[],s._samplers=[],s._textures={},s._vectors4={},s._floats={},s.locals=new e.UniversalShaderDefines,s._defines=null,s.customShaderNameResolve=s._buildCustomShader,s}return __extends(i,t),i.prototype.getClassName=function(){return"UniversalPushMaterial"},i.prototype.getShaderName=function(){return"simple"},i.prototype.getShaderDefines=function(){return this._defines},i.prototype.needAlphaBlending=function(){return this.alpha<1},i.prototype.needAlphaTesting=function(){return!1},i.prototype.getAlphaTestTexture=function(){return null},i.prototype.getTexture=function(e){return this._textures[e]},i.prototype.getVector4=function(e){return this._vectors4[e]},i.prototype.getFloat=function(e){return this._floats[e]},i.prototype.setTexture=function(e,t,i){return void 0===i&&(i=!1),i===!0&&this.checkSampler(e),this._textures[e]=t,this},i.prototype.setVector4=function(e,t,i){return void 0===i&&(i=!1),i===!0&&this.checkUniform(e),this._vectors4[e]=t,this},i.prototype.setFloat=function(e,t,i){return void 0===i&&(i=!1),i===!0&&this.checkUniform(e),this._floats[e]=t,this},i.prototype.checkUniform=function(e){this._uniforms.indexOf(e)===-1&&(this._uniforms.push(e),this.locals.defineBoolean(e.toUpperCase()))},i.prototype.checkSampler=function(e){this._samplers.indexOf(e)===-1&&(this._samplers.push(e),this.locals.defineBoolean(e.toUpperCase()),this.checkUniform(e+"Infos"),this.checkUniform(e+"Matrix"))},i.prototype.isReadyForSubMesh=function(t,i,r){if(this.isFrozen&&this._wasPreviouslyReady&&i.effect)return!0;i._materialDefines||(i._materialDefines=new e.UniversalMaterialDefines);var s=i._materialDefines,o=this.getScene();if(!this.checkReadyOnEveryCall&&i.effect&&this._renderId===o.getRenderId())return!0;var n=o.getEngine();if(s._areTexturesDirty&&(s._needUVs=!1,o.texturesEnabled&&this._diffuseTexture&&e.MaterialFlags.DiffuseTextureEnabled)){if(!this._diffuseTexture.isReady())return!1;s._needUVs=!0,s.DIFFUSE=!0}if(e.MaterialHelper.PrepareDefinesForMisc(t,o,!1,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(t),s),s._needNormals=e.MaterialHelper.PrepareDefinesForLights(o,t,s,!1,this._maxSimultaneousLights,this._disableLighting),e.MaterialHelper.PrepareDefinesForFrameBoundValues(o,n,s,!!r),e.MaterialHelper.PrepareDefinesForAttributes(t,s,!0,!0),s.isDirty){s.markAsProcessed(),o.resetCachedMaterial();var a=new e.EffectFallbacks;s.FOG&&a.addFallback(1,"FOG"),e.MaterialHelper.HandleFallbacksForShadows(s,a,this.maxSimultaneousLights),s.NUM_BONE_INFLUENCERS>0&&a.addCPUSkinningFallback(0,t);var l=[e.VertexBuffer.PositionKind];s.NORMAL&&l.push(e.VertexBuffer.NormalKind),s.UV1&&l.push(e.VertexBuffer.UVKind),s.UV2&&l.push(e.VertexBuffer.UV2Kind),s.VERTEXCOLOR&&l.push(e.VertexBuffer.ColorKind),e.MaterialHelper.PrepareAttributesForBones(l,t,s,a),e.MaterialHelper.PrepareAttributesForInstances(l,s);var h=["world","view","viewProjection","vEyePosition","vLightsType","vDiffuseColor","vFogInfos","vFogColor","pointSize","vDiffuseInfos","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","diffuseMatrix"],u=["diffuseSampler"],m=new Array;e.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:h,uniformBuffersNames:m,samplers:u,defines:s,maxSimultaneousLights:this.maxSimultaneousLights});var c=this.getShaderName();this.customShaderNameResolve&&(c=this.customShaderNameResolve(c,h,m,u,s));var p=s.toString();i.setEffect(o.getEngine().createEffect(c,{attributes:l,uniformsNames:h,uniformBuffersNames:m,samplers:u,defines:p,fallbacks:a,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:this._maxSimultaneousLights-1}},n),s)}return!(!i.effect||!i.effect.isReady())&&(this._renderId=o.getRenderId(),this._wasPreviouslyReady=!0,!0)},i.prototype.bindForSubMesh=function(t,i,r){var s=this.getScene(),o=r._materialDefines;if(o){var n=r.effect;n&&(this._activeEffect=n,this.bindOnlyWorldMatrix(t),this._activeEffect.setMatrix("viewProjection",s.getTransformMatrix()),e.MaterialHelper.BindBonesParameters(i,this._activeEffect),this._mustRebind(s,n)&&(this._diffuseTexture&&e.MaterialFlags.DiffuseTextureEnabled&&(this._activeEffect.setTexture("diffuseSampler",this._diffuseTexture),this._activeEffect.setFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,this._diffuseTexture.level),this._activeEffect.setMatrix("diffuseMatrix",this._diffuseTexture.getTextureMatrix())),e.MaterialHelper.BindClipPlane(this._activeEffect,s),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),e.MaterialHelper.BindEyePosition(n,s)),this._activeEffect.setColor4("vDiffuseColor",this.diffuseColor,this.alpha*i.visibility),s.lightsEnabled&&!this.disableLighting&&e.MaterialHelper.BindLights(s,i,this._activeEffect,o,this.maxSimultaneousLights),s.fogEnabled&&i.applyFog&&s.fogMode!==e.Scene.FOGMODE_NONE&&this._activeEffect.setMatrix("view",s.getViewMatrix()),e.MaterialHelper.BindFogParameters(s,i,this._activeEffect),this._afterBind(i,this._activeEffect),this._attachAfterBind(i,this._activeEffect))}},i.prototype.getAnimatables=function(){var e=[];this._diffuseTexture&&this._diffuseTexture.animations&&this._diffuseTexture.animations.length>0&&e.push(this._diffuseTexture);for(var t in this._textures){var i=this._textures[t];i&&i.animations&&i.animations.length>0&&e.push(i)}return e},i.prototype.getActiveTextures=function(){var e=t.prototype.getActiveTextures.call(this);this._diffuseTexture&&e.push(this._diffuseTexture);for(var i in this._textures){var r=this._textures[i];r&&e.push(r)}return e},i.prototype.hasTexture=function(e){if(t.prototype.hasTexture.call(this,e))return!0;if(this.diffuseTexture===e)return!0;var i=!1;for(var r in this._textures){var s=this._textures[r];if(s===s){i=!0;break}}return i},i.prototype.dispose=function(e){this._diffuseTexture&&this._diffuseTexture.dispose();for(var i in this._textures){var r=this._textures[i];r&&r.dispose(),this._textures[i]=null}this._textures={},t.prototype.dispose.call(this,e)},i.prototype.clone=function(t){var i,r=this,s=e.SerializationHelper.Clone(function(){return new e.UniversalPushMaterial(t,r.getScene())},this);s._textures={};for(i in this._textures){var o=this._textures[i];o&&s.setTexture(i,o.clone(),!0)}s._vectors4={};for(i in this._vectors4)s.setVector4(i,this._vectors4[i].clone(),!0);s._floats={};for(i in this._floats)s.setFloat(i,this._floats[i],!0);return s},i.prototype.serialize=function(){var t,i=e.SerializationHelper.Serialize(this);i.customType="BABYLON.UniversalPushMaterial",i.textures={};for(t in this._textures){var r=this._textures[t];r&&(i.textures[t]=r.serialize())}i.vectors4={};for(t in this._vectors4)i.vectors4[t]=this._vectors4[t].asArray();i.floats={};for(t in this._floats)i.floats[t]=this._floats[t];return i},i.Parse=function(t,i,r){var s,o=e.SerializationHelper.Parse(function(){return new e.UniversalPushMaterial(t.name,i)},t,i,r);for(s in t.textures){var n=t.textures[s];n&&o.setTexture(s,e.Texture.Parse(n,i,r),!0)}for(s in t.vectors4)o.setVector4(s,e.Vector4.FromArray(t.vectors4[s]),!0);for(s in t.floats)o.setFloat(s,t.floats[s],!0);return o},i.prototype._buildCustomShader=function(e,t,i,r,s){this._defines=s;var o=this.getShaderName();null!=o&&""!==o||(o=e),null!=o&&""!==o||(o="simple");var n=this.locals.getDefines();if(null!=n&&null!=this._defines){var a=Object.keys(n);if(null!=a&&a.length>0){for(var l=this._defines,h=0,u=a;h<u.length;h++){var m=u[h];l[m]=n[m]}this._defines.rebuild()}}var c=0;if(null!=this._uniforms&&this._uniforms.length>0)for(c=0;c<this._uniforms.length;c++){var p=this._uniforms[c];t.indexOf(p)===-1&&t.push(p)}if(c=0,null!=this._samplers&&this._samplers.length>0)for(c=0;c<this._samplers.length;c++){var f=this._samplers[c];r.indexOf(f)===-1&&r.push(f)}return o},i.prototype._attachAfterBind=function(e,t){var i,r=this.getScene();if(r.texturesEnabled)for(i in this._textures){var s=this._textures[i];null!=s&&(t.setTexture(i,s),t.setFloat2(i+"Infos",s.coordinatesIndex,s.level),t.setMatrix(i+"Matrix",s.getTextureMatrix()))}for(i in this._vectors4)t.setVector4(i,this._vectors4[i]);for(i in this._floats)t.setFloat(i,this._floats[i])},__decorate([e.serializeAsTexture("diffuseTexture")],i.prototype,"_diffuseTexture",void 0),__decorate([e.expandToProperty("_markAllSubMeshesAsTexturesDirty")],i.prototype,"diffuseTexture",void 0),__decorate([e.serializeAsColor3("diffuse")],i.prototype,"diffuseColor",void 0),__decorate([e.serialize("disableLighting")],i.prototype,"_disableLighting",void 0),__decorate([e.expandToProperty("_markAllSubMeshesAsLightsDirty")],i.prototype,"disableLighting",void 0),__decorate([e.serialize("maxSimultaneousLights")],i.prototype,"_maxSimultaneousLights",void 0),__decorate([e.expandToProperty("_markAllSubMeshesAsLightsDirty")],i.prototype,"maxSimultaneousLights",void 0),i}(e.PushMaterial);e.UniversalPushMaterial=o,e._TypeStore.RegisteredTypes.UniversalPushMaterial=o;var n=function(t){function i(i,r){var s=t.call(this,i,r)||this;return s.universalMaterial=!0,s.locals=null,s.terrainInfo=null,s._defines=null,s._uniforms=[],s._samplers=[],s._textures={},s._vectors4={},s._floats={},s.locals=new e.UniversalShaderDefines,s._defines=null,s._setupAttachAfterBind(),s.enableShaderChunks=!1,s.materialShaderChunks=new e.UniversalAlbedoChunks,s.customShaderNameResolve=s._buildCustomShader,s.customShaderChunkResolve(),s}return __extends(i,t),i.prototype.updateShaderChunks=function(){},i.prototype.getClassName=function(){return"UniversalAlbedoMaterial"},i.prototype.getShaderName=function(){return"pbr"},i.prototype.getShaderChunk=function(){return null},i.prototype.getShaderDefines=function(){return this._defines},i.prototype.getTexture=function(e){return this._textures[e]},i.prototype.getVector4=function(e){return this._vectors4[e]},i.prototype.getFloat=function(e){return this._floats[e]},i.prototype.setTexture=function(e,t,i){return void 0===i&&(i=!1),i===!0&&this.checkSampler(e),this._textures[e]=t,this},i.prototype.setVector4=function(e,t,i){return void 0===i&&(i=!1),i===!0&&this.checkUniform(e),this._vectors4[e]=t,this},i.prototype.setFloat=function(e,t,i){return void 0===i&&(i=!1),i===!0&&this.checkUniform(e),this._floats[e]=t,this},i.prototype.checkUniform=function(e){this._uniforms.indexOf(e)===-1&&(this._uniforms.push(e),this.locals.defineBoolean(e.toUpperCase()))},i.prototype.checkSampler=function(e){this._samplers.indexOf(e)===-1&&(this._samplers.push(e),this.locals.defineBoolean(e.toUpperCase()),this.checkUniform(e+"Infos"),this.checkUniform(e+"Matrix"))},i.prototype.getAnimatables=function(){var e=t.prototype.getAnimatables.call(this);for(var i in this._textures){var r=this._textures[i];r&&r.animations&&r.animations.length>0&&e.push(r)}return e},i.prototype.getActiveTextures=function(){var e=t.prototype.getActiveTextures.call(this);for(var i in this._textures){var r=this._textures[i];r&&e.push(r)}return e},i.prototype.hasTexture=function(e){if(t.prototype.hasTexture.call(this,e))return!0;var i=!1;for(var r in this._textures){var s=this._textures[r];if(s===s){i=!0;break}}return i},i.prototype.dispose=function(e,i){if(i)for(var r in this._textures){var s=this._textures[r];s&&s.dispose(),this._textures[r]=null}this._textures={},t.prototype.dispose.call(this,e,i)},i.prototype.clone=function(t){var i,r=this,s=e.SerializationHelper.Clone(function(){return new e.UniversalAlbedoMaterial(t,r.getScene())},this);s._textures={};for(i in this._textures){var o=this._textures[i];o&&s.setTexture(i,o.clone(),!0)}s._vectors4={};for(i in this._vectors4)s.setVector4(i,this._vectors4[i].clone(),!0);s._floats={};for(i in this._floats)s.setFloat(i,this._floats[i],!0);return s},i.prototype.serialize=function(){var t,i=e.SerializationHelper.Serialize(this);i.customType="BABYLON.UniversalAlbedoMaterial",i.textures={};for(t in this._textures){var r=this._textures[t];r&&(i.textures[t]=r.serialize())}i.vectors4={};for(t in this._vectors4)i.vectors4[t]=this._vectors4[t].asArray();i.floats={};for(t in this._floats)i.floats[t]=this._floats[t];return i},i.Parse=function(t,i,r){var s,o=e.SerializationHelper.Parse(function(){return new e.UniversalAlbedoMaterial(t.name,i)},t,i,r);for(s in t.textures){var n=t.textures[s];n&&o.setTexture(s,e.Texture.Parse(n,i,r),!0)}for(s in t.vectors4)o.setVector4(s,e.Vector4.FromArray(t.vectors4[s]),!0);for(s in t.floats)o.setFloat(s,t.floats[s],!0);return o},i.prototype.customShaderChunkResolve=function(){var t=this.getShaderChunk();if(null!=t&&""!==t){var i=t+"ShaderChunks";if(null!=e.Effect.ShadersStore[i]){var r=e.Effect.ShadersStore[i],s=e.Utilities.HasOwnProperty(r,"VertexBegin")?r.VertexBegin:null;null!=s&&""!==s&&(this.materialShaderChunks.Vertex_Begin=s);var o=e.Utilities.HasOwnProperty(r,"VertexDefinitions")?r.VertexDefinitions:null;null!=o&&""!==o&&(this.materialShaderChunks.Vertex_Definitions=o);var n=e.Utilities.HasOwnProperty(r,"VertexMainBegin")?r.VertexMainBegin:null;null!=n&&""!==n&&(this.materialShaderChunks.Vertex_MainBegin=n);var a=e.Utilities.HasOwnProperty(r,"VertexUpdatePosition")?r.VertexUpdatePosition:null;null!=a&&""!==a&&(this.materialShaderChunks.Vertex_Before_PositionUpdated=a.replace("result","positionUpdated"));var l=e.Utilities.HasOwnProperty(r,"VertexUpdateNormal")?r.VertexUpdateNormal:null;null!=l&&""!==l&&(this.materialShaderChunks.Vertex_Before_NormalUpdated=l.replace("result","normalUpdated"));var h=e.Utilities.HasOwnProperty(r,"VertexMainEnd")?r.VertexMainEnd:null;null!=h&&""!==h&&(this.materialShaderChunks.Vertex_MainEnd=h);var u=e.Utilities.HasOwnProperty(r,"FragmentBegin")?r.FragmentBegin:null;null!=u&&""!==u&&(this.materialShaderChunks.Fragment_Begin=u);var m=e.Utilities.HasOwnProperty(r,"FragmentDefinitions")?r.FragmentDefinitions:null;null!=m&&""!==m&&(this.materialShaderChunks.Fragment_Definitions=m);var c=e.Utilities.HasOwnProperty(r,"FragmentMainBegin")?r.FragmentMainBegin:null;null!=c&&""!==c&&(this.materialShaderChunks.Fragment_MainBegin=c);var p=e.Utilities.HasOwnProperty(r,"FragmentUpdateAlbedo")?r.FragmentUpdateAlbedo:null;null!=p&&""!==p&&(this.materialShaderChunks.Fragment_Custom_Albedo=p.replace("result","surfaceAlbedo"));var f=e.Utilities.HasOwnProperty(r,"FragmentUpdateAlpha")?r.FragmentUpdateAlpha:null;null!=f&&""!==f&&(this.materialShaderChunks.Fragment_Custom_Alpha=f.replace("result","alpha"));var _=e.Utilities.HasOwnProperty(r,"FragmentMetallicRoughness")?r.FragmentMetallicRoughness:null;null!=_&&""!==_&&(this.materialShaderChunks.Fragment_MetallicRoughness=_);var d=e.Utilities.HasOwnProperty(r,"FragmentMicroSurface")?r.FragmentMicroSurface:null;null!=d&&""!==d&&(this.materialShaderChunks.Fragment_MicroSurface=d);var y=e.Utilities.HasOwnProperty(r,"FragmentBeforeLights")?r.FragmentBeforeLights:null;null!=y&&""!==y&&(this.materialShaderChunks.Fragment_Before_Lights=y);var v=e.Utilities.HasOwnProperty(r,"FragmentBeforeFog")?r.FragmentBeforeFog:null;null!=v&&""!==v&&(this.materialShaderChunks.Fragment_Before_Fog=v);var g=e.Utilities.HasOwnProperty(r,"FragmentBeforeFragColor")?r.FragmentBeforeFragColor:null;null!=g&&""!==g&&(this.materialShaderChunks.Fragment_Before_FragColor=g.replace("result","color"))}else e.Tools.Warn("Failed To Locate Shader Chunk Base: "+i)}},i.prototype._buildCustomShader=function(e,t,i,r,s){this._defines=s;var o=this.getShaderName();null!=o&&""!==o||(o=e),null!=o&&""!==o||(o="pbr");var n=this.locals.getDefines();if(null!=n&&null!=this._defines){var a=Object.keys(n);if(null!=a&&a.length>0){for(var l=this._defines,h=0,u=a;h<u.length;h++){var m=u[h];l[m]=n[m]}this._defines.rebuild()}}var c=0;if(null!=this._uniforms&&this._uniforms.length>0)for(c=0;c<this._uniforms.length;c++){var p=this._uniforms[c];t.indexOf(p)===-1&&t.push(p)}if(c=0,null!=this._samplers&&this._samplers.length>0)for(c=0;c<this._samplers.length;c++){var f=this._samplers[c];r.indexOf(f)===-1&&r.push(f)}return this.enableShaderChunks===!0?this._createShaderChunks(o):o},i.prototype._createShaderChunks=function(t){if(this._isCreatedShader)return this._createdShaderName;this._isCreatedShader=!1;var i=this.getShaderChunk();null!=i&&""!==i||(i=t),e.UniversalShaderDefines.ShaderIndexer++;var r=(i+"Custom"+e.UniversalShaderDefines.ShaderIndexer).trim(),s=e.Effect.ShadersStore[t+"VertexShader"],o=e.Effect.ShadersStore[t+"PixelShader"];this.updateShaderChunks();var n=r+"VertexShader";e.Effect.ShadersStore[n]=s.replace("#define CUSTOM_VERTEX_BEGIN",this.materialShaderChunks.Vertex_Begin?this.materialShaderChunks.Vertex_Begin:"").replace("#define CUSTOM_VERTEX_DEFINITIONS",this.materialShaderChunks.Vertex_Definitions?this.materialShaderChunks.Vertex_Definitions:"").replace("#define CUSTOM_VERTEX_MAIN_BEGIN",this.materialShaderChunks.Vertex_MainBegin?this.materialShaderChunks.Vertex_MainBegin:"").replace("#define CUSTOM_VERTEX_UPDATE_POSITION",this.materialShaderChunks.Vertex_Before_PositionUpdated?this.materialShaderChunks.Vertex_Before_PositionUpdated:"").replace("#define CUSTOM_VERTEX_UPDATE_NORMAL",this.materialShaderChunks.Vertex_Before_NormalUpdated?this.materialShaderChunks.Vertex_Before_NormalUpdated:"").replace("#define CUSTOM_VERTEX_MAIN_END",this.materialShaderChunks.Vertex_MainEnd?this.materialShaderChunks.Vertex_MainEnd:"");var a=r+"PixelShader";return e.Effect.ShadersStore[a]=o.replace("#define CUSTOM_FRAGMENT_BEGIN",this.materialShaderChunks.Fragment_Begin?this.materialShaderChunks.Fragment_Begin:"").replace("#define CUSTOM_FRAGMENT_DEFINITIONS",this.materialShaderChunks.Fragment_Definitions?this.materialShaderChunks.Fragment_Definitions:"").replace("#define CUSTOM_FRAGMENT_MAIN_BEGIN",this.materialShaderChunks.Fragment_MainBegin?this.materialShaderChunks.Fragment_MainBegin:"").replace("#define CUSTOM_FRAGMENT_UPDATE_ALBEDO",this.materialShaderChunks.Fragment_Custom_Albedo?this.materialShaderChunks.Fragment_Custom_Albedo:"").replace("#define CUSTOM_FRAGMENT_UPDATE_ALPHA",this.materialShaderChunks.Fragment_Custom_Alpha?this.materialShaderChunks.Fragment_Custom_Alpha:"").replace("#define CUSTOM_FRAGMENT_UPDATE_METALLICROUGHNESS",this.materialShaderChunks.Fragment_MetallicRoughness?this.materialShaderChunks.Fragment_MetallicRoughness:"").replace("#define CUSTOM_FRAGMENT_UPDATE_MICROSURFACE",this.materialShaderChunks.Fragment_MicroSurface?this.materialShaderChunks.Fragment_MicroSurface:"").replace("#define CUSTOM_FRAGMENT_BEFORE_LIGHTS",this.materialShaderChunks.Fragment_Before_Lights?this.materialShaderChunks.Fragment_Before_Lights:"").replace("#define CUSTOM_FRAGMENT_BEFORE_FOG",this.materialShaderChunks.Fragment_Before_Fog?this.materialShaderChunks.Fragment_Before_Fog:"").replace("#define CUSTOM_FRAGMENT_BEFORE_FRAGCOLOR",this.materialShaderChunks.Fragment_Before_FragColor?this.materialShaderChunks.Fragment_Before_FragColor:""),this._isCreatedShader=!0,this._createdShaderName=r,r},i.prototype._attachAfterBind=function(e,t){var i,r=this.getScene();if(r.texturesEnabled)for(i in this._textures){var s=this._textures[i];null!=s&&(t.setTexture(i,s),t.setFloat2(i+"Infos",s.coordinatesIndex,s.level),t.setMatrix(i+"Matrix",s.getTextureMatrix()))}for(i in this._vectors4)t.setVector4(i,this._vectors4[i]);for(i in this._floats)t.setFloat(i,this._floats[i])},i.prototype._setupAttachAfterBind=function(){var e=this,t=this._afterBind;this._afterBind=function(i,r){if(e._attachAfterBind(i,r),t)try{t(i,r)}catch(s){}}},i}(e.PBRMaterial);e.UniversalAlbedoMaterial=n,e._TypeStore.RegisteredTypes.UniversalAlbedoMaterial=n;var a=function(t){function i(i,r){var s=t.call(this,i,r)||this;return s.universalMaterial=!0,s.locals=null,s.terrainInfo=null,s._defines=null,s._uniforms=[],s._samplers=[],s._textures={},s._vectors4={},s._floats={},s.locals=new e.UniversalShaderDefines,s._defines=null,s._setupAttachAfterBind(),s.enableShaderChunks=!1,s.materialShaderChunks=new e.UniversalDiffuseChunks,s.customShaderNameResolve=s._buildCustomShader,s.customShaderChunkResolve(),s}return __extends(i,t),i.prototype.updateShaderChunks=function(){},i.prototype.getClassName=function(){return"UniversalDiffuseMaterial"},i.prototype.getShaderName=function(){return"default"},i.prototype.getShaderChunk=function(){return null},i.prototype.getShaderDefines=function(){return this._defines},i.prototype.getTexture=function(e){return this._textures[e]},i.prototype.getVector4=function(e){return this._vectors4[e]},i.prototype.getFloat=function(e){return this._floats[e]},i.prototype.setTexture=function(e,t,i){return void 0===i&&(i=!1),i===!0&&this.checkSampler(e),this._textures[e]=t,this},i.prototype.setVector4=function(e,t,i){return void 0===i&&(i=!1),i===!0&&this.checkUniform(e),this._vectors4[e]=t,this},i.prototype.setFloat=function(e,t,i){return void 0===i&&(i=!1),i===!0&&this.checkUniform(e),this._floats[e]=t,this},i.prototype.checkUniform=function(e){this._uniforms.indexOf(e)===-1&&(this._uniforms.push(e),this.locals.defineBoolean(e.toUpperCase()));
},i.prototype.checkSampler=function(e){this._samplers.indexOf(e)===-1&&(this._samplers.push(e),this.locals.defineBoolean(e.toUpperCase()),this.checkUniform(e+"Infos"),this.checkUniform(e+"Matrix"))},i.prototype.getAnimatables=function(){var e=t.prototype.getAnimatables.call(this);for(var i in this._textures){var r=this._textures[i];r&&r.animations&&r.animations.length>0&&e.push(r)}return e},i.prototype.getActiveTextures=function(){var e=t.prototype.getActiveTextures.call(this);for(var i in this._textures){var r=this._textures[i];r&&e.push(r)}return e},i.prototype.hasTexture=function(e){if(t.prototype.hasTexture.call(this,e))return!0;var i=!1;for(var r in this._textures){var s=this._textures[r];if(s===s){i=!0;break}}return i},i.prototype.dispose=function(e,i){if(i)for(var r in this._textures){var s=this._textures[r];s&&s.dispose(),this._textures[r]=null}this._textures={},t.prototype.dispose.call(this,e,i)},i.prototype.clone=function(t){var i,r=this,s=e.SerializationHelper.Clone(function(){return new e.UniversalDiffuseMaterial(t,r.getScene())},this);s._textures={};for(i in this._textures){var o=this._textures[i];o&&s.setTexture(i,o.clone(),!0)}s._vectors4={};for(i in this._vectors4)s.setVector4(i,this._vectors4[i].clone(),!0);s._floats={};for(i in this._floats)s.setFloat(i,this._floats[i],!0);return s},i.prototype.serialize=function(){var t,i=e.SerializationHelper.Serialize(this);i.customType="BABYLON.UniversalDiffuseMaterial",i.textures={};for(t in this._textures){var r=this._textures[t];r&&(i.textures[t]=r.serialize())}i.vectors4={};for(t in this._vectors4)i.vectors4[t]=this._vectors4[t].asArray();i.floats={};for(t in this._floats)i.floats[t]=this._floats[t];return i},i.Parse=function(t,i,r){var s,o=e.SerializationHelper.Parse(function(){return new e.UniversalDiffuseMaterial(t.name,i)},t,i,r);for(s in t.textures){var n=t.textures[s];n&&o.setTexture(s,e.Texture.Parse(n,i,r),!0)}for(s in t.vectors4)o.setVector4(s,e.Vector4.FromArray(t.vectors4[s]),!0);for(s in t.floats)o.setFloat(s,t.floats[s],!0);return o},i.prototype.customShaderChunkResolve=function(){var t=this.getShaderChunk();if(null!=t&&""!==t){var i=t+"ShaderChunks";if(null!=e.Effect.ShadersStore[i]){var r=e.Effect.ShadersStore[i],s=e.Utilities.HasOwnProperty(r,"VertexBegin")?r.VertexBegin:null;null!=s&&""!==s&&(this.materialShaderChunks.Vertex_Begin=s);var o=e.Utilities.HasOwnProperty(r,"VertexDefinitions")?r.VertexDefinitions:null;null!=o&&""!==o&&(this.materialShaderChunks.Vertex_Definitions=o);var n=e.Utilities.HasOwnProperty(r,"VertexMainBegin")?r.VertexMainBegin:null;null!=n&&""!==n&&(this.materialShaderChunks.Vertex_MainBegin=n);var a=e.Utilities.HasOwnProperty(r,"VertexUpdatePosition")?r.VertexUpdatePosition:null;null!=a&&""!==a&&(this.materialShaderChunks.Vertex_Before_PositionUpdated=a.replace("result","positionUpdated"));var l=e.Utilities.HasOwnProperty(r,"VertexUpdateNormal")?r.VertexUpdateNormal:null;null!=l&&""!==l&&(this.materialShaderChunks.Vertex_Before_NormalUpdated=l.replace("result","normalUpdated"));var h=e.Utilities.HasOwnProperty(r,"VertexMainEnd")?r.VertexMainEnd:null;null!=h&&""!==h&&(this.materialShaderChunks.Vertex_MainEnd=h);var u=e.Utilities.HasOwnProperty(r,"FragmentBegin")?r.FragmentBegin:null;null!=u&&""!==u&&(this.materialShaderChunks.Fragment_Begin=u);var m=e.Utilities.HasOwnProperty(r,"FragmentDefinitions")?r.FragmentDefinitions:null;null!=m&&""!==m&&(this.materialShaderChunks.Fragment_Definitions=m);var c=e.Utilities.HasOwnProperty(r,"FragmentMainBegin")?r.FragmentMainBegin:null;null!=c&&""!==c&&(this.materialShaderChunks.Fragment_MainBegin=c);var p=e.Utilities.HasOwnProperty(r,"FragmentUpdateDiffuse")?r.FragmentUpdateDiffuse:null;null!=p&&""!==p&&(this.materialShaderChunks.Fragment_Custom_Diffuse=p.replace("result","diffuseColor"));var f=e.Utilities.HasOwnProperty(r,"FragmentUpdateAlpha")?r.FragmentUpdateAlpha:null;null!=f&&""!==f&&(this.materialShaderChunks.Fragment_Custom_Alpha=f.replace("result","alpha"));var _=e.Utilities.HasOwnProperty(r,"FragmentBeforeLights")?r.FragmentBeforeLights:null;null!=_&&""!==_&&(this.materialShaderChunks.Fragment_Before_Lights=_);var d=e.Utilities.HasOwnProperty(r,"FragmentBeforeFog")?r.FragmentBeforeFog:null;null!=d&&""!==d&&(this.materialShaderChunks.Fragment_Before_Fog=d);var y=e.Utilities.HasOwnProperty(r,"FragmentBeforeFragColor")?r.FragmentBeforeFragColor:null;null!=y&&""!==y&&(this.materialShaderChunks.Fragment_Before_FragColor=y.replace("result","color"))}else e.Tools.Warn("Failed To Locate Shader Chunk Base: "+i)}},i.prototype._buildCustomShader=function(e,t,i,r,s){this._defines=s;var o=this.getShaderName();null!=o&&""!==o||(o=e),null!=o&&""!==o||(o="default");var n=this.locals.getDefines();if(null!=n&&null!=this._defines){var a=Object.keys(n);if(null!=a&&a.length>0){for(var l=this._defines,h=0,u=a;h<u.length;h++){var m=u[h];l[m]=n[m]}this._defines.rebuild()}}var c=0;if(null!=this._uniforms&&this._uniforms.length>0)for(c=0;c<this._uniforms.length;c++){var p=this._uniforms[c];t.indexOf(p)===-1&&t.push(p)}if(c=0,null!=this._samplers&&this._samplers.length>0)for(c=0;c<this._samplers.length;c++){var f=this._samplers[c];r.indexOf(f)===-1&&r.push(f)}return this.enableShaderChunks===!0?this._createShaderChunks(o):o},i.prototype._createShaderChunks=function(t){if(this._isCreatedShader)return this._createdShaderName;this._isCreatedShader=!1;var i=this.getShaderChunk();null!=i&&""!==i||(i=t),e.UniversalShaderDefines.ShaderIndexer++;var r=(i+"Custom"+e.UniversalShaderDefines.ShaderIndexer).trim(),s=e.Effect.ShadersStore[t+"VertexShader"],o=e.Effect.ShadersStore[t+"PixelShader"];this.updateShaderChunks();var n=r+"VertexShader";e.Effect.ShadersStore[n]=s.replace("#define CUSTOM_VERTEX_BEGIN",this.materialShaderChunks.Vertex_Begin?this.materialShaderChunks.Vertex_Begin:"").replace("#define CUSTOM_VERTEX_DEFINITIONS",this.materialShaderChunks.Vertex_Definitions?this.materialShaderChunks.Vertex_Definitions:"").replace("#define CUSTOM_VERTEX_MAIN_BEGIN",this.materialShaderChunks.Vertex_MainBegin?this.materialShaderChunks.Vertex_MainBegin:"").replace("#define CUSTOM_VERTEX_UPDATE_POSITION",this.materialShaderChunks.Vertex_Before_PositionUpdated?this.materialShaderChunks.Vertex_Before_PositionUpdated:"").replace("#define CUSTOM_VERTEX_UPDATE_NORMAL",this.materialShaderChunks.Vertex_Before_NormalUpdated?this.materialShaderChunks.Vertex_Before_NormalUpdated:"").replace("#define CUSTOM_VERTEX_MAIN_END",this.materialShaderChunks.Vertex_MainEnd?this.materialShaderChunks.Vertex_MainEnd:"");var a=r+"PixelShader";return e.Effect.ShadersStore[a]=o.replace("#define CUSTOM_FRAGMENT_BEGIN",this.materialShaderChunks.Fragment_Begin?this.materialShaderChunks.Fragment_Begin:"").replace("#define CUSTOM_FRAGMENT_DEFINITIONS",this.materialShaderChunks.Fragment_Definitions?this.materialShaderChunks.Fragment_Definitions:"").replace("#define CUSTOM_FRAGMENT_MAIN_BEGIN",this.materialShaderChunks.Fragment_MainBegin?this.materialShaderChunks.Fragment_MainBegin:"").replace("#define CUSTOM_FRAGMENT_UPDATE_DIFFUSE",this.materialShaderChunks.Fragment_Custom_Diffuse?this.materialShaderChunks.Fragment_Custom_Diffuse:"").replace("#define CUSTOM_FRAGMENT_UPDATE_ALPHA",this.materialShaderChunks.Fragment_Custom_Alpha?this.materialShaderChunks.Fragment_Custom_Alpha:"").replace("#define CUSTOM_FRAGMENT_BEFORE_LIGHTS",this.materialShaderChunks.Fragment_Before_Lights?this.materialShaderChunks.Fragment_Before_Lights:"").replace("#define CUSTOM_FRAGMENT_BEFORE_FOG",this.materialShaderChunks.Fragment_Before_Fog?this.materialShaderChunks.Fragment_Before_Fog:"").replace("#define CUSTOM_FRAGMENT_BEFORE_FRAGCOLOR",this.materialShaderChunks.Fragment_Before_FragColor?this.materialShaderChunks.Fragment_Before_FragColor:""),this._isCreatedShader=!0,this._createdShaderName=r,r},i.prototype._attachAfterBind=function(e,t){var i,r=this.getScene();if(r.texturesEnabled)for(i in this._textures){var s=this._textures[i];null!=s&&(t.setTexture(i,s),t.setFloat2(i+"Infos",s.coordinatesIndex,s.level),t.setMatrix(i+"Matrix",s.getTextureMatrix()))}for(i in this._vectors4)t.setVector4(i,this._vectors4[i]);for(i in this._floats)t.setFloat(i,this._floats[i])},i.prototype._setupAttachAfterBind=function(){var e=this,t=this._afterBind;this._afterBind=function(i,r){if(e._attachAfterBind(i,r),t)try{t(i,r)}catch(s){}}},i}(e.StandardMaterial);e.UniversalDiffuseMaterial=a,e._TypeStore.RegisteredTypes.UniversalDiffuseMaterial=a;var l=function(t){function i(e,i){var r=t.call(this,e,i)||this;return r.enableShaderChunks=!0,r}return __extends(i,t),i.prototype.getClassName=function(){return"UniversalTerrainMaterial"},i.prototype.getShaderName=function(){return"pbr"},i.prototype.getShaderChunk=function(){return null},i.prototype.updateShaderChunks=function(){var t="surfaceAlbedo",i="splatmapSampler",r="detailsSampler",s="normalsSampler",o=e.System.gammaCorrection;null!=this.materialShaderChunks.Vertex_Definitions&&""!==this.materialShaderChunks.Vertex_Definitions?this.materialShaderChunks.Vertex_Definitions=this.formatTerrainVertexDefintions()+this.materialShaderChunks.Vertex_Definitions:this.materialShaderChunks.Vertex_Definitions=this.formatTerrainVertexDefintions(),null!=this.materialShaderChunks.Vertex_MainEnd&&""!==this.materialShaderChunks.Vertex_MainEnd?this.materialShaderChunks.Vertex_MainEnd=this.formatTerrainVertexMainEnd()+this.materialShaderChunks.Vertex_MainEnd:this.materialShaderChunks.Vertex_MainEnd=this.formatTerrainVertexMainEnd(),null!=this.materialShaderChunks.Fragment_Definitions&&""!==this.materialShaderChunks.Fragment_Definitions?this.materialShaderChunks.Fragment_Definitions=this.formatTerrainFragmentDefintions(i,r,s)+this.materialShaderChunks.Fragment_Definitions:this.materialShaderChunks.Fragment_Definitions=this.formatTerrainFragmentDefintions(i,r,s),null!=this.materialShaderChunks.Fragment_Custom_Albedo&&""!==this.materialShaderChunks.Fragment_Custom_Albedo?this.materialShaderChunks.Fragment_Custom_Albedo=this.formatTerrainFragmentUpdateColor(this.terrainInfo,t,i,r,s,o)+this.materialShaderChunks.Fragment_Custom_Albedo:this.materialShaderChunks.Fragment_Custom_Albedo=this.formatTerrainFragmentUpdateColor(this.terrainInfo,t,i,r,s,o)},i.prototype.formatTerrainVertexDefintions=function(){return"\r\n#define TERRAIN_VERTEX_DEFINITIONS\r\n\r\nvarying vec2 vSplatmapUV;\r\n\r\n"},i.prototype.formatTerrainVertexMainEnd=function(){return"\r\n#define TERRAIN_VERTEX_MAIN_END\r\n\r\n#ifdef UV1\r\nvSplatmapUV = uv;\r\n#endif\r\n\r\n"},i.prototype.formatTerrainFragmentDefintions=function(e,t,i){return"\r\n#define TERRAIN_FRAGMENT_DEFNITIONS\r\n\r\nvarying vec2 vSplatmapUV;\r\nuniform sampler2D "+e+";\r\nuniform sampler2D "+t+";\r\nuniform sampler2D "+i+";\r\n\r\nfloat calculateMipmapLevel(const in vec2 uvs, const in vec2 size)\r\n{\r\n    vec2 dx = dFdx(uvs * size.x);\r\n    vec2 dy = dFdy(uvs * size.y);\r\n    float d = max(dot(dx, dx), dot(dy, dy));\r\n    return 0.4 * log2(d);\r\n}\r\n\r\nvec4 sampleTextureAtlas2D(const in sampler2D atlas, const in float gamma, const in vec2 tile, const in vec4 rect, in vec2 uvs, in float lod)\r\n{\r\n    if (lod < 0.0) lod = clamp(calculateMipmapLevel(uvs, vec2(tile.x, tile.x)), 0.0, tile.y);   // Tile Info (tile.xy)\r\n    float size = pow(2.0, tile.y - lod);                                                        // Tile Bits (tile.y)\r\n    float sizex = size / rect.z;                                                                // Tile Width (rect.z)\r\n    float sizey = size / rect.w;                                                                // Tile Height (rect.w)\r\n    uvs = fract(uvs);                                                                           // Perfrom Tiling (fract)\r\n    uvs.x = uvs.x * ((sizex * rect.z - 1.0) / sizex) + 0.5 / sizex + rect.z * rect.x;           // Tile Position X (rect.x)\r\n    uvs.y = uvs.y * ((sizey * rect.w - 1.0) / sizey) + 0.5 / sizey + rect.w * rect.y;           // Tile Position Y (rect.y)\r\n    vec4 color = texture2DLodEXT(atlas, uvs, lod);\r\n    if (gamma != 1.0) {\r\n        color.r = pow(color.r, gamma);\r\n        color.g = pow(color.g, gamma);\r\n        color.b = pow(color.b, gamma);\r\n    }\r\n    return color;\r\n}\r\n\r\nvec4 sampleSplatmapAtlas2D(const in sampler2D atlas, const in vec2 tile, const in vec4 rect, in vec2 uvs)\r\n{\r\n    float size = pow(2.0, tile.y);                                                              // Tile Bits (tile.y)\r\n\t   float sizex = size / rect.z;                                                                // Tile Width (rect.z)\r\n\t   float sizey = size / rect.w;                                                                // Tile Height (rect.w)\r\n\t   uvs.x = uvs.x * ((sizex * rect.z - 1.0) / sizex) + 0.5 / sizex + rect.z * rect.x;           // Tile Position X (rect.x)\r\n\t   uvs.y = uvs.y * ((sizey * rect.w - 1.0) / sizey) + 0.5 / sizey + rect.w * rect.y;           // Tile Position Y (rect.y)\r\n    return texture2D(atlas, uvs);\r\n}\r\n\r\nvec3 blendSplatmapAtlasColors(const in vec4 splatmap, in vec4 color1, in vec4 color2, in vec4 color3, in vec4 color4, in vec3 mixbuffer)\r\n{\r\n    mixbuffer += (color1.rgb * splatmap.r);\r\n    mixbuffer += (color2.rgb * splatmap.g);\r\n    mixbuffer += (color3.rgb * splatmap.b);\r\n    mixbuffer += (color4.rgb * splatmap.a);\r\n    return mixbuffer;\r\n}\r\n\r\nvec3 perturbNormalSamplerColor(mat3 cotangentFrame, vec3 samplerColor, float scale)\r\n{\r\n    vec3 map = samplerColor.xyz;\r\n    map = map * 2.00787402 - 1.00787402;\r\n    #ifdef NORMALXYSCALE\r\n        map = normalize(map * vec3(scale, scale, 1.0));\r\n    #endif\r\n    return normalize(cotangentFrame * map);\r\n}\r\n\r\n\r\n"},i.prototype.formatTerrainFragmentUpdateColor=function(e,t,i,r,s,o){void 0===o&&(o=1);var n="";if(null!=e&&null!=e.textureAtlas&&null!=e.splatmapAtlas&&e.splatmapCount>1){n="\r\n#define TERRAIN_FRAGMENT_UPDATE_COLOR\r\n\r\nvec3 normalsColor = vec3(0.5, 0.5, 1.0);\r\nvec3 normalsBuffer = vec3(0.0, 0.0, 0.0);\r\nvec3 splatmapBuffer = vec3(0.0, 0.0, 0.0);\r\nfloat autoMipMapLevel = -1.0;\r\nfloat normalCorrection = 1.0;\r\nfloat detailCorrection = "+o.toFixed(4)+";\r\n\r\n#if defined(ALBEDO) && defined("+i.toUpperCase()+") && defined("+r.toUpperCase()+")\r\n\r\n// Reset Normal Values\r\n#if defined(BUMP) || defined(PARALLAX) || defined(ANISOTROPIC)\r\n    uvOffset = vec2(0.0, 0.0);\r\n    #ifdef NORMAL\r\n        normalW = normalize(vNormalW);\r\n    #else\r\n        normalW = normalize(cross(dFdx(vPositionW), dFdy(vPositionW))) * vEyePosition.w;\r\n    #endif\r\n    #ifdef CLEARCOAT\r\n        clearCoatNormalW = normalW;\r\n    #endif\r\n    #if defined(BUMP) || defined(PARALLAX)\r\n        #if defined(TANGENT) && defined(NORMAL)\r\n            TBN = vTBN;\r\n        #else\r\n            TBN = cotangent_frame(normalW, vPositionW, vSplatmapUV);\r\n        #endif\r\n    #elif defined(ANISOTROPIC)\r\n        #if defined(TANGENT) && defined(NORMAL)\r\n            TBN = vTBN;\r\n        #else\r\n            TBN = cotangent_frame(normalW, vPositionW, vSplatmapUV, vec2(1.0, 1.0));\r\n        #endif\r\n    #endif\r\n    #ifdef PARALLAX\r\n        invTBN = transposeMat3(TBN);\r\n    #endif\r\n    normalW = perturbNormalSamplerColor(TBN, normalsColor, 1.0);\r\n#endif\r\n\r\n// Global Atlas Values\r\nfloat splatTileSize = "+e.splatmapAtlas[2].toFixed(4)+";\r\nfloat splatTileBits = "+e.splatmapAtlas[3].toFixed(4)+";\r\nfloat detailTileSize = "+e.textureAtlas[2].toFixed(4)+";\r\nfloat detailTileBits = "+e.textureAtlas[3].toFixed(4)+";\r\n\r\n// Sample splatmap textures\r\n";for(var a=0,l=0;l<e.splatmapCount;l++){a=4*l;var h=e["splatmapRect"+l];if(n+="vec4 splatmapRect"+l+" = vec4("+h[0].toFixed(4)+", "+h[1].toFixed(4)+", "+h[2].toFixed(4)+", "+h[3].toFixed(4)+");\r\n",n+="vec4 splatmapAlbedo"+l+" = sampleSplatmapAtlas2D("+i+", vec2(splatTileSize, splatTileBits), splatmapRect"+l+", (vSplatmapUV + uvOffset));\r\n",n+="vec4 textureAlbedo"+(a+0)+" = vec4(0.0, 0.0, 0.0, 1.0);\r\n",n+="vec4 textureAlbedo"+(a+1)+" = vec4(0.0, 0.0, 0.0, 1.0);\r\n",n+="vec4 textureAlbedo"+(a+2)+" = vec4(0.0, 0.0, 0.0, 1.0);\r\n",n+="vec4 textureAlbedo"+(a+3)+" = vec4(0.0, 0.0, 0.0, 1.0);\r\n",e["textureRect"+(a+0)]){var u=e["textureRect"+(a+0)],m=e["textureInfo"+(a+0)];n+="vec4 textureRect"+(a+0)+" = vec4("+u[0].toFixed(4)+", "+u[1].toFixed(4)+", "+u[2].toFixed(4)+", "+u[3].toFixed(4)+");\r\n",n+="vec2 textureScale"+(a+0)+" = vec2("+m[0].toFixed(4)+", "+m[1].toFixed(4)+");\r\n",n+="vec2 textureOffset"+(a+0)+" = vec2("+m[2].toFixed(4)+", "+m[3].toFixed(4)+");\r\n",n+="vec2 textureTileUV"+(a+0)+" = ((vSplatmapUV + textureOffset"+(a+0)+") * textureScale"+(a+0)+");\r\n",n+="textureAlbedo"+(a+0)+" = sampleTextureAtlas2D("+r+", detailCorrection, vec2(detailTileSize, detailTileBits), textureRect"+(a+0)+", textureTileUV"+(a+0)+", autoMipMapLevel);\r\n"}if(e["textureRect"+(a+1)]){var u=e["textureRect"+(a+1)],m=e["textureInfo"+(a+1)];n+="vec4 textureRect"+(a+1)+" = vec4("+u[0].toFixed(4)+", "+u[1].toFixed(4)+", "+u[2].toFixed(4)+", "+u[3].toFixed(4)+");\r\n",n+="vec2 textureScale"+(a+1)+" = vec2("+m[0].toFixed(4)+", "+m[1].toFixed(4)+");\r\n",n+="vec2 textureOffset"+(a+1)+" = vec2("+m[2].toFixed(4)+", "+m[3].toFixed(4)+");\r\n",n+="vec2 textureTileUV"+(a+1)+" = ((vSplatmapUV + textureOffset"+(a+1)+") * textureScale"+(a+1)+");\r\n",n+="textureAlbedo"+(a+1)+" = sampleTextureAtlas2D("+r+", detailCorrection, vec2(detailTileSize, detailTileBits), textureRect"+(a+1)+", textureTileUV"+(a+1)+", autoMipMapLevel);\r\n"}if(e["textureRect"+(a+2)]){var u=e["textureRect"+(a+2)],m=e["textureInfo"+(a+2)];n+="vec4 textureRect"+(a+2)+" = vec4("+u[0].toFixed(4)+", "+u[1].toFixed(4)+", "+u[2].toFixed(4)+", "+u[3].toFixed(4)+");\r\n",n+="vec2 textureScale"+(a+2)+" = vec2("+m[0].toFixed(4)+", "+m[1].toFixed(4)+");\r\n",n+="vec2 textureOffset"+(a+2)+" = vec2("+m[2].toFixed(4)+", "+m[3].toFixed(4)+");\r\n",n+="vec2 textureTileUV"+(a+2)+" = ((vSplatmapUV + textureOffset"+(a+2)+") * textureScale"+(a+2)+");\r\n",n+="textureAlbedo"+(a+2)+" = sampleTextureAtlas2D("+r+", detailCorrection, vec2(detailTileSize, detailTileBits), textureRect"+(a+2)+", textureTileUV"+(a+2)+", autoMipMapLevel);\r\n"}if(e["textureRect"+(a+3)]){var u=e["textureRect"+(a+3)],m=e["textureInfo"+(a+3)];n+="vec4 textureRect"+(a+3)+" = vec4("+u[0].toFixed(4)+", "+u[1].toFixed(4)+", "+u[2].toFixed(4)+", "+u[3].toFixed(4)+");\r\n",n+="vec2 textureScale"+(a+3)+" = vec2("+m[0].toFixed(4)+", "+m[1].toFixed(4)+");\r\n",n+="vec2 textureOffset"+(a+3)+" = vec2("+m[2].toFixed(4)+", "+m[3].toFixed(4)+");\r\n",n+="vec2 textureTileUV"+(a+3)+" = ((vSplatmapUV + textureOffset"+(a+3)+") * textureScale"+(a+3)+");\r\n",n+="textureAlbedo"+(a+3)+" = sampleTextureAtlas2D("+r+", detailCorrection, vec2(detailTileSize, detailTileBits), textureRect"+(a+3)+", textureTileUV"+(a+3)+", autoMipMapLevel);\r\n"}if(n+="splatmapBuffer = blendSplatmapAtlasColors(splatmapAlbedo"+l+", textureAlbedo"+(a+0)+", textureAlbedo"+(a+1)+", textureAlbedo"+(a+2)+", textureAlbedo"+(a+3)+", splatmapBuffer);\r\n",n+="#if defined(BUMP) || defined(PARALLAX) || defined(ANISOTROPIC)\r\n",n+="    #if defined("+s.toUpperCase()+")\r\n",n+="        vec4 normalColor"+(a+0)+" = vec4(0.0, 0.0, 0.0, 1.0);\r\n",n+="        vec4 normalColor"+(a+1)+" = vec4(0.0, 0.0, 0.0, 1.0);\r\n",n+="        vec4 normalColor"+(a+2)+" = vec4(0.0, 0.0, 0.0, 1.0);\r\n",n+="        vec4 normalColor"+(a+3)+" = vec4(0.0, 0.0, 0.0, 1.0);\r\n",e["textureRect"+(a+0)]){var c=e["normalsScale"+(a+0)];n+="        float normalScale"+(a+0)+" = "+c.toFixed(4)+";\r\n",n+="        normalColor"+(a+0)+" = sampleTextureAtlas2D("+s+", normalCorrection, vec2(detailTileSize, detailTileBits), textureRect"+(a+0)+", textureTileUV"+(a+0)+", autoMipMapLevel);\r\n",n+="        normalColor"+(a+0)+".rgb = perturbNormalSamplerColor(TBN, normalColor"+(a+0)+".rgb, normalScale"+(a+0)+");\r\n"}if(e["textureRect"+(a+1)]){var c=e["normalsScale"+(a+1)];n+="        float normalScale"+(a+1)+" = "+c.toFixed(4)+";\r\n",n+="        normalColor"+(a+1)+" = sampleTextureAtlas2D("+s+", normalCorrection, vec2(detailTileSize, detailTileBits), textureRect"+(a+1)+", textureTileUV"+(a+1)+", autoMipMapLevel);\r\n",n+="        normalColor"+(a+1)+".rgb = perturbNormalSamplerColor(TBN, normalColor"+(a+1)+".rgb, normalScale"+(a+1)+");\r\n"}if(e["textureRect"+(a+2)]){var c=e["normalsScale"+(a+2)];n+="        float normalScale"+(a+2)+" = "+c.toFixed(4)+";\r\n",n+="        normalColor"+(a+2)+" = sampleTextureAtlas2D("+s+", normalCorrection, vec2(detailTileSize, detailTileBits), textureRect"+(a+2)+", textureTileUV"+(a+2)+", autoMipMapLevel);\r\n",n+="        normalColor"+(a+2)+".rgb = perturbNormalSamplerColor(TBN, normalColor"+(a+2)+".rgb, normalScale"+(a+2)+");\r\n"}if(e["textureRect"+(a+3)]){var c=e["normalsScale"+(a+3)];n+="        float normalScale"+(a+3)+" = "+c.toFixed(4)+";\r\n",n+="        normalColor"+(a+3)+" = sampleTextureAtlas2D("+s+", normalCorrection, vec2(detailTileSize, detailTileBits), textureRect"+(a+3)+", textureTileUV"+(a+3)+", autoMipMapLevel);\r\n",n+="        normalColor"+(a+3)+".rgb = perturbNormalSamplerColor(TBN, normalColor"+(a+3)+".rgb, normalScale"+(a+3)+");\r\n"}n+="        normalsBuffer = blendSplatmapAtlasColors(splatmapAlbedo"+l+", normalColor"+(a+0)+", normalColor"+(a+1)+", normalColor"+(a+2)+", normalColor"+(a+3)+", normalsBuffer);\r\n",n+="    #endif\r\n",n+="#endif\r\n",n+="\r\n"}n+="// Update Color Values\r\n"+t+".rgb = splatmapBuffer;\r\n#if defined(BUMP) || defined(PARALLAX) || defined(ANISOTROPIC)\r\n    #if defined("+s.toUpperCase()+")\r\n        normalW = normalsBuffer;\r\n    #endif\r\n    #if defined(FORCENORMALFORWARD) && defined(NORMAL)\r\n        vec3 faceNormal = normalize(cross(dFdx(vPositionW), dFdy(vPositionW))) * vEyePosition.w;\r\n        #if defined(TWOSIDEDLIGHTING)\r\n            faceNormal = gl_FrontFacing ? faceNormal : -faceNormal;\r\n        #endif\r\n        normalW *= sign(dot(normalW, faceNormal));\r\n    #endif\r\n    #if defined(TWOSIDEDLIGHTING) && defined(NORMAL)\r\n        normalW = gl_FrontFacing ? normalW : -normalW;\r\n    #endif\r\n#endif\r\n\r\n#endif\r\n\r\n"}return n},i}(e.UniversalAlbedoMaterial);e.UniversalTerrainMaterial=l,e._TypeStore.RegisteredTypes.UniversalTerrainMaterial=l}(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),BABYLON;!function(e){var t=function(t){function i(e,i,r){return void 0===r&&(r={}),t.call(this,e,i,r)||this}return __extends(i,t),i.prototype.start=function(){},i.prototype.update=function(){},i.prototype.after=function(){},i.prototype.destroy=function(){},i.IsXboxLivePluginEnabled=function(){return!!window.isXboxLivePluginEnabled&&window.isXboxLivePluginEnabled()},i.IsXboxLiveUserSignedIn=function(t,i){if(void 0===t&&(t=null),void 0===i&&(i=e.PlayerNumber.One),e.WindowsPlatform.IsXboxLivePluginEnabled()){var r=null!=t?e.WindowsPlatform.GetXboxLiveSystemUser(t,i):e.WindowsPlatform.GetXboxLiveUser(i);return null!=r&&1==r.isSignedIn}return!1},i.XboxLiveUserSignIn=function(t,i,r,s){void 0===t&&(t=e.PlayerNumber.One),e.WindowsPlatform.IsXboxLivePluginEnabled()&&e.WindowsPlatform.XboxLiveUserSilentSignIn(t,function(o){o.status===Microsoft.Xbox.Services.System.SignInStatus.userInteractionRequired?e.WindowsPlatform.XboxLiveUserDialogSignIn(t,function(e){i&&i(e)},r,s):i&&i(o)},r,s)},i.XboxLiveUserSilentSignIn=function(t,i,r,s){return void 0===t&&(t=e.PlayerNumber.One),e.WindowsPlatform.IsXboxLivePluginEnabled()?e.WindowsPlatform.GetXboxLiveUser(t).signInSilentlyAsync(null).then(i,r,s):null},i.XboxLiveUserDialogSignIn=function(t,i,r,s){return void 0===t&&(t=e.PlayerNumber.One),e.WindowsPlatform.IsXboxLivePluginEnabled()?e.WindowsPlatform.GetXboxLiveUser(t).signInAsync(null).then(i,r,s):null},i.LoadXboxLiveUserProfile=function(t,i,r,s){return void 0===t&&(t=e.PlayerNumber.One),e.WindowsPlatform.IsXboxLivePluginEnabled()?e.WindowsPlatform.GetXboxLiveUserContext(t).profileService.getUserProfileAsync(e.WindowsPlatform.GetXboxLiveUser(t).xboxUserId).then(i,r,s):null},i.GetXboxLiveUser=function(t){void 0===t&&(t=e.PlayerNumber.One);var i=null;if(e.WindowsPlatform.IsXboxLivePluginEnabled())switch(t){case e.PlayerNumber.One:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveUserOne();break;case e.PlayerNumber.Two:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveUserTwo();break;case e.PlayerNumber.Three:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveUserThree();break;case e.PlayerNumber.Four:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveUserFour()}return i},i.GetXboxLiveSystemUser=function(t,i){void 0===i&&(i=e.PlayerNumber.One);var r=null;if(e.WindowsPlatform.IsXboxLivePluginEnabled())switch(i){case e.PlayerNumber.One:r=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveSystemUserOne(t);break;case e.PlayerNumber.Two:r=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveSystemUserTwo(t);break;case e.PlayerNumber.Three:r=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveSystemUserThree(t);break;case e.PlayerNumber.Four:r=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveSystemUserFour(t)}return r},i.GetXboxLiveUserContext=function(t){void 0===t&&(t=e.PlayerNumber.One);var i=null;if(e.WindowsPlatform.IsXboxLivePluginEnabled())switch(t){case e.PlayerNumber.One:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveContextOne();break;case e.PlayerNumber.Two:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveContextTwo();break;case e.PlayerNumber.Three:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveContextThree();break;case e.PlayerNumber.Four:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveContextFour()}return i},i.ResetXboxLiveUserContext=function(t){if(void 0===t&&(t=e.PlayerNumber.One),e.WindowsPlatform.IsXboxLivePluginEnabled()&&e.WindowsPlatform.IsXboxLivePluginEnabled())switch(t){case e.PlayerNumber.One:window.BabylonToolkit.XboxLive.Plugin.resetXboxLiveUserContextOne();break;case e.PlayerNumber.Two:window.BabylonToolkit.XboxLive.Plugin.resetXboxLiveUserContextTwo();break;case e.PlayerNumber.Three:window.BabylonToolkit.XboxLive.Plugin.resetXboxLiveUserContextThree();break;case e.PlayerNumber.Four:window.BabylonToolkit.XboxLive.Plugin.resetXboxLiveUserContextFour()}},i.GetXboxLiveContextProperty=function(t){return e.WindowsPlatform.IsXboxLivePluginEnabled()?window.BabylonToolkit.XboxLive.Plugin.getXboxLiveContextProperty(t):null},i.SetXboxLiveContextProperty=function(t,i){e.WindowsPlatform.IsXboxLivePluginEnabled()&&window.BabylonToolkit.XboxLive.Plugin.setXboxLiveContextProperty(t,i)},i.ResetXboxLivePropertyContexts=function(){e.WindowsPlatform.IsXboxLivePluginEnabled()&&window.BabylonToolkit.XboxLive.Plugin.resetXboxLivePropertyContexts()},i.SetXboxLiveSignOutHandler=function(t){void 0===t&&(t=null),e.WindowsPlatform.IsXboxLivePluginEnabled()&&(window.BabylonToolkit.XboxLive.Plugin.onusersignout=t)},i}(e.ScriptComponent);e.WindowsPlatform=t}(BABYLON||(BABYLON={})),BABYLON.SceneManager.IsXboxOne()&&navigator.gamepadInputEmulation&&(navigator.gamepadInputEmulation="gamepad"),BABYLON.SceneManager.IsWindows()&&"undefined"!=typeof Windows.UI.ViewManagement&&"undefined"!=typeof Windows.UI.ViewManagement.ApplicationViewBoundsMode&&"undefined"!=typeof Windows.UI.ViewManagement.ApplicationViewBoundsMode.useCoreWindow&&Windows.UI.ViewManagement.ApplicationView.getForCurrentView().setDesiredBoundsMode(Windows.UI.ViewManagement.ApplicationViewBoundsMode.useCoreWindow);

// worker.js
var versionStamp = '###VERSION###';
var installFiles = ['###INSTALL###'];
// ..
// Post Service Worker Version Message
// ..
self.addEventListener('message', function(evt) {
    if (evt.data != null && evt.data === 'version' && evt.ports != null && evt.ports.length > 0) {
        var port = evt.ports[0];
        if (port && port.postMessage) {
            // console.log('WORKER: Version check: ' + versionStamp);
            port.postMessage(versionStamp);
        }
    }
});
// ..
// Install Service Worker File System
// ..
self.addEventListener('install', function(evt) {
    evt.waitUntil(
        caches.open(versionStamp).then(function(cache) {
            // console.log('WORKER: Fetching cache: ' + versionStamp);
            var cachePromises = installFiles.map(function(urlToPrefetch) {
                var url = new URL(urlToPrefetch, location.href);
                url.search += (url.search ? '&' : '?') + 'time=' + new Date().getTime().toString();
                var request = new Request(url, { mode: 'no-cors' });
                return fetch(request, { cache: 'no-store' }).then(function(response) {
                    if (response.status >= 400) throw new Error('request for ' + urlToPrefetch + ' failed with status ' + response.statusText);
                    return cache.put(urlToPrefetch, response);
                }).catch(function(error) {
                    // console.warn('WORKER: Not caching ' + urlToPrefetch + ' due to ' + error);
                });
            });
            return Promise.all(cachePromises).then(function() {
                // console.log('WORKER: Cache updated: ' + versionStamp);
                return self.skipWaiting();
            });
        }).catch(function(error) {
            // console.warn('WORKER: Pre-Fetching Failed: ', error);
        })
    );
});
// ..
// Activate Service Worker File System
// ..
self.addEventListener('activate', function(evt) {
    evt.waitUntil(
        caches.keys().then(function(cacheNames) {
            return Promise.all(
                cacheNames.map(function(cache) {
                    if (cache !== versionStamp) {
                        // console.log('WORKER: Cleaning cache: ' + cache);
                        return caches.delete(cache);
                    }
                })
            );
        })
    );
    // console.log('WORKER: Activate cache: ' + versionStamp);
    return self.clients.claim();
});
// ..
// Fetch Service Worker Request Files
// ..
self.addEventListener('fetch', function(evt) {
    // Chrome Dev Tools Bug - Temporary Workaround
    // https://bugs.chromium.org/p/chromium/issues/detail?id=823392    
    if (evt.request.cache === 'only-if-cached' && evt.request.mode !== 'same-origin') {
        var oStrangeRequest = evt.request.clone();
        console.warn('Chrome Dev Tools. Request cache has only-if-cached, but not same-origin.', oStrangeRequest.cache, oStrangeRequest.mode, 'request redirect:', oStrangeRequest.redirect, oStrangeRequest.url, oStrangeRequest);
        return;
    }
    evt.respondWith(
        caches.match(evt.request).then(function(response) {
            return response || fetch(evt.request, { cache: 'no-store' });
        })
    );
});

// BabylonToolkit2019.js
var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (this && this.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};
/**
 * Babylon Script Component
 * @class DebugInformation
 */
var DebugInformation = /** @class */ (function (_super) {
    __extends(DebugInformation, _super);
    function DebugInformation(transform, scene, properties) {
        if (properties === void 0) { properties = {}; }
        var _this = _super.call(this, transform, scene, properties) || this;
        _this.keys = true;
        _this.show = true;
        _this.popup = false;
        _this.views = false;
        _this.xbox = false;
        _this.keys = _this.getEditorProperty("enableDebugKeys", _this.keys);
        _this.show = _this.getEditorProperty("showDebugLabels", _this.show);
        _this.popup = _this.getEditorProperty("popupDebugPanel", _this.popup);
        _this.views = _this.getEditorProperty("togglePlayerViews", _this.views);
        _this.xbox = _this.getEditorProperty("allowXboxLiveSignIn", _this.xbox);
        // ..
        if (BABYLON.SceneManager.IsWindows())
            _this.popup = false;
        BABYLON.Tools.Log("Debug information overlay loaded");
        return _this;
    }
    DebugInformation.prototype.start = function () {
        var _this = this;
        //this.screen = document.getElementById("screen");
        //this.toggle = document.getElementById("toggle");
        //this.signin = document.getElementById("signin");
        //this.reload = document.getElementById("reload");
        //this.mouse = document.getElementById("mouse");
        //this.debug = document.getElementById("debug");
        if (this.show === true) {
            /*
            if (this.keys === true) {
                if (!BABYLON.SceneManager.IsXboxOne()) {
                    if (this.screen) this.screen.innerHTML = "F - Show Full Screen";
                }
                if (BABYLON.CameraSystem.IsMultiPlayerView() && this.views === true) {
                    if (this.toggle) {
                        if (BABYLON.SceneManager.IsXboxOne()) {
                            this.toggle.style.top = "29px";
                        }
                        this.toggle.innerHTML = "1 - 4 Toggle Player View";
                    }
                }
                if (BABYLON.SceneManager.IsXboxLivePluginEnabled() && this.xbox === true) {
                    if (this.signin) {
                        if (BABYLON.SceneManager.IsXboxOne()) {
                            this.signin.style.top = "49px";
                        }
                        this.signin.innerHTML = "X - Xbox Live Sign In";
                    }
                }
                if (this.mouse) this.mouse.innerHTML = (BABYLON.SceneManager.IsXboxOne()) ? "M - Mouse" : "";
                if (this.reload) this.reload.innerHTML = "R - Reload";
                if (this.debug) this.debug.innerHTML = "P - Debug";
            }
            */
        }
        if (this.keys === true) {
            if (this.views === true) {
                console.log("Enable Multiplayer Keys");
                BABYLON.SceneManager.OnKeyboardPress(BABYLON.UserInputKey.Num1, function () {
                    BABYLON.UniversalCameraSystem.SetMultiPlayerViewLayout(_this.scene, 1);
                    console.log("1 player pressed");
                });
                BABYLON.SceneManager.OnKeyboardPress(BABYLON.UserInputKey.Num2, function () {
                    BABYLON.UniversalCameraSystem.SetMultiPlayerViewLayout(_this.scene, 2);
                    console.log("2 players pressed");
                });
                BABYLON.SceneManager.OnKeyboardPress(BABYLON.UserInputKey.Num3, function () {
                    BABYLON.UniversalCameraSystem.SetMultiPlayerViewLayout(_this.scene, 3);
                    console.log("3 players pressed");
                });
                BABYLON.SceneManager.OnKeyboardPress(BABYLON.UserInputKey.Num4, function () {
                    BABYLON.UniversalCameraSystem.SetMultiPlayerViewLayout(_this.scene, 4);
                    console.log("4 players pressed");
                });
            }
            BABYLON.SceneManager.OnKeyboardPress(BABYLON.UserInputKey.R, function () {
                window.location.reload();
            });
            BABYLON.SceneManager.OnKeyboardPress(BABYLON.UserInputKey.I, function () {
                if (_this.popup === true) {
                    BABYLON.SceneManager.PopupDebug(_this.scene);
                }
                else {
                    BABYLON.SceneManager.ToggleDebug(_this.scene, true, null);
                }
            });
            if (BABYLON.SceneManager.IsXboxOne()) {
                if (navigator.gamepadInputEmulation) {
                    BABYLON.SceneManager.OnKeyboardPress(BABYLON.UserInputKey.M, function () {
                        if (navigator.gamepadInputEmulation !== "mouse") {
                            navigator.gamepadInputEmulation = "mouse";
                        }
                        else {
                            navigator.gamepadInputEmulation = "gamepad";
                        }
                    });
                }
            }
            else {
                BABYLON.SceneManager.OnKeyboardPress(BABYLON.UserInputKey.F, function () {
                    //BABYLON.Tools.RequestFullscreen(document.documentElement);
                    _this.scene.getEngine().enterFullscreen(true);
                });
            }
            if (BABYLON.WindowsPlatform.IsXboxLivePluginEnabled() && this.xbox === true) {
                BABYLON.SceneManager.OnKeyboardPress(BABYLON.UserInputKey.X, function () {
                    var player = BABYLON.PlayerNumber.One;
                    if (!BABYLON.WindowsPlatform.IsXboxLiveUserSignedIn(null, player)) {
                        BABYLON.Tools.Log("===> Trying Xbox Live Sign In For Player: " + player.toString());
                        BABYLON.WindowsPlatform.XboxLiveUserSignIn(player, function (result) {
                            var user = BABYLON.WindowsPlatform.GetXboxLiveUser(player);
                            var msg = "(" + user.xboxUserId + ") - " + user.gamertag;
                            BABYLON.SceneManager.AlertMessage(msg, "Xbox Live User Signed In");
                        }, function (err) {
                            console.log(err);
                            var msg = "Encountered Sign Error";
                            BABYLON.Tools.Warn(msg);
                            BABYLON.SceneManager.AlertMessage(msg, "Xbox Live Warning");
                        });
                    }
                    else {
                        BABYLON.Tools.Warn("Xbox Live User Already Signed In");
                        BABYLON.SceneManager.AlertMessage("User Already Signed In", "Xbox Live Warning");
                    }
                });
            }
        }
        // Default Print To Screen Text
        var printColor = (this.scene.getEngine().webGLVersion < 2) ? "red" : "#0c0";
        var graphicsVersion = BABYLON.SceneManager.GetWebGLVersionString(this.scene);
        BABYLON.Utilities.PrintToScreen(graphicsVersion, printColor);
    };
    DebugInformation.prototype.destroy = function () {
        //this.screen = null;
        //this.toggle = null;
        //this.signin = null;
        //this.reload = null;
        //this.mouse = null;
        //this.debug = null;
    };
    return DebugInformation;
}(BABYLON.ScriptComponent));
/**
 * Babylon Script Component
 * @class SoftbodyMesh
 */
var SoftbodyMesh = /** @class */ (function (_super) {
    __extends(SoftbodyMesh, _super);
    function SoftbodyMesh(transform, scene, properties) {
        if (properties === void 0) { properties = {}; }
        var _this = _super.call(this, transform, scene, properties) || this;
        var type = _this.getEditorProperty("type", 0);
        var options = {
            mass: _this.getEditorProperty("mass", 1),
            friction: _this.getEditorProperty("friction", 0.3),
            restitution: _this.getEditorProperty("restitution", 0.3),
            pressure: _this.getEditorProperty("pressure", 200),
            velocityIterations: _this.getEditorProperty("velocityIterations", 20),
            positionIterations: _this.getEditorProperty("positionIterations", 20),
            stiffness: _this.getEditorProperty("stiffness", 1),
            margin: _this.getEditorProperty("margin", 0.0),
            damping: _this.getEditorProperty("damping", 0.01)
        };
        var mesh = _this.getTransformMesh();
        var forceSharedVertices = _this.getEditorProperty("forceSharedVertices", true);
        if (forceSharedVertices === true)
            mesh.forceSharedVertices();
        var increaseVertices = _this.getEditorProperty("increaseVertices", 4);
        if (increaseVertices > 0)
            mesh.increaseVertices(increaseVertices);
        var impostor = null;
        if (type === 0) { // Mesh
            impostor = new BABYLON.PhysicsImpostor(mesh, BABYLON.PhysicsImpostor.SoftbodyImpostor, options, _this.scene);
        }
        else if (type === 1) { // Cloth
            impostor = new BABYLON.PhysicsImpostor(mesh, BABYLON.PhysicsImpostor.ClothImpostor, options, _this.scene);
        }
        else if (type === 2) { // Rope
            impostor = new BABYLON.PhysicsImpostor(mesh, BABYLON.PhysicsImpostor.RopeImpostor, options, _this.scene);
        }
        if (impostor != null) {
            impostor.executeNativeFunction(function (word, body) {
                // TODO: Setup Native Softbody Physics Options
            });
        }
        return _this;
    }
    SoftbodyMesh.prototype.start = function () {
        // Start render loop function
    };
    SoftbodyMesh.prototype.update = function () {
        // Update render loop function
    };
    SoftbodyMesh.prototype.after = function () {
        // After render loop function
    };
    SoftbodyMesh.prototype.destroy = function () {
        // Destroy component function
    };
    return SoftbodyMesh;
}(BABYLON.ScriptComponent));
/**
 * Babylon Script Component
 * @class FirstPersonController
 */
var FirstPersonController = /** @class */ (function (_super) {
    __extends(FirstPersonController, _super);
    function FirstPersonController(transform, scene, properties) {
        if (properties === void 0) { properties = {}; }
        var _this = _super.call(this, transform, scene, properties) || this;
        _this.deltaFactor = 2.0;
        _this.attachCamera = true;
        _this.cameraPivot = null;
        _this.cameraRigger = null;
        _this.movementSpeed = 1.0;
        _this.jumpingVelocity = 10.0;
        _this.playerMovement = BABYLON.Vector3.Zero();
        _this.playerTurnRate = 0.0;
        _this.cameraPitchRate = 0.0;
        _this.horzSensitivity = 1.0;
        _this.vertSensitivity = 1.0;
        _this.mouseSensitivity = 1.0;
        _this.minimumPitchAngle = -60.0;
        _this.maximumPitchAngle = 60.0;
        _this.isCharacterGrounded = false;
        _this.isCharacterJumpFrame = false;
        _this.cameraEulerAngles = BABYLON.Vector3.Zero();
        _this.characterController = null;
        _this.buttonJump = BABYLON.Xbox360Button.A;
        _this.keyboardJump = BABYLON.UserInputKey.SpaceBar;
        _this.playerNumber = BABYLON.PlayerNumber.One;
        _this.playerDeltaX = 0.0;
        _this.playerDeltaZ = 0.0;
        _this.playerMouseX = 0.0;
        _this.playerMouseY = 0.0;
        _this.playerEyeLevel = 0.5;
        _this.attachCamera = _this.getEditorProperty("attachCamera", _this.attachCamera);
        _this.playerNumber = _this.getEditorProperty("playerNumber", _this.playerNumber);
        _this.playerEyeLevel = _this.getEditorProperty("playerEyeLevel", _this.playerEyeLevel);
        _this.movementSpeed = _this.getEditorProperty("movementSpeed", _this.movementSpeed);
        _this.mouseSensitivity = _this.getEditorProperty("mouseSensitivity", _this.mouseSensitivity);
        _this.minimumPitchAngle = _this.getEditorProperty("minimumPitchAngle", _this.minimumPitchAngle);
        _this.maximumPitchAngle = _this.getEditorProperty("maximumPitchAngle", _this.maximumPitchAngle);
        _this.vertSensitivity = _this.getEditorProperty("verticalSensitivity", _this.vertSensitivity);
        _this.horzSensitivity = _this.getEditorProperty("horizontalSensitivity", _this.horzSensitivity);
        _this.jumpingVelocity = _this.getEditorProperty("impulseJumpVelocity", _this.jumpingVelocity);
        // Scale Mouse Pointer Sensitivity
        if (_this.playerNumber == BABYLON.PlayerNumber.One) {
            BABYLON.UserInputOptions.PointerAngularSensibility = (BABYLON.UserInputOptions.PointerAngularSensibility * _this.mouseSensitivity);
        }
        return _this;
    }
    FirstPersonController.prototype.isCharacterJumping = function () { return false; /* TODO: Determine If Character Is Jumping - ??? */ };
    FirstPersonController.prototype.isCharacterFalling = function () { return false; /* TODO: Determine If Character Is Falling - ??? */ };
    FirstPersonController.prototype.getCharacterController = function () { return this.characterController; };
    FirstPersonController.prototype.start = function () { this.setupFirstPersonController(); };
    FirstPersonController.prototype.update = function () { this.updateFirstPersonController(); };
    FirstPersonController.prototype.destroy = function () { this.destroyFirstPersonController(); };
    FirstPersonController.prototype.setupFirstPersonController = function () {
        // Setup Camera Aattachments
        this.cameraPivot = this.getChildTransform("Pivot");
        if (this.cameraPivot == null) {
            this.cameraPivot = new BABYLON.TransformNode("Pivot", this.scene);
            this.cameraPivot.setParent(this.transform);
            this.cameraPivot.position = new BABYLON.Vector3(0.0, this.playerEyeLevel, 0.0); // NOTE: POSITION CAMERA EYE LEVEL (TO SEE ARMS)
        }
        BABYLON.Utilities.ValidateTransformQuaternion(this.cameraPivot);
        //console.log("Attach Camera For: " + this.transform.name + " --> " + this.attachCamera.toString());
        //console.log(this.transform.metadata);
        if (this.attachCamera === true) {
            // TODO: Create Multi Player Camera (No Attach Camera)
            this.cameraRigger = BABYLON.SceneManager.GetTransformNode(this.scene, "Main Camera");
            if (this.cameraRigger != null && this.cameraPivot != null) {
                this.cameraPivot.position = new BABYLON.Vector3(0.0, this.playerEyeLevel, 0.0); // NOTE: POSITION CAMERA EYE LEVEL (TO SEE ARMS)
                this.cameraRigger.setParent(this.cameraPivot);
                this.cameraRigger.position = new BABYLON.Vector3(0.0, 0.0, 0.0);
                this.cameraRigger.rotationQuaternion = BABYLON.Quaternion.Identity();
                console.log("FPC: Attached main camera to player controller: " + this.transform.name);
            }
            else {
                BABYLON.Tools.Warn("Failed to locate camera or local pivot for: " + this.transform.name);
            }
        }
        // Setup Character Controller
        this.characterController = this.getComponent("BABYLON.CharacterController");
        if (this.characterController == null)
            BABYLON.Tools.Warn("Failed to locate character controller for: " + this.transform.name);
        // Character Collision Contact (TEST)
        if (this.characterController != null) {
            // Test Static Only Collisions
            // this.characterController.setCollisionFilterMask(BABYLON.CollisionFilters.StaticFilter);
            this.characterController.registerOnCollisionEnter(function (mesh) {
                var tag = BABYLON.SceneManager.GetTransformTag(mesh);
                //console.log("PLAYER: ===> Got Collision Enter Event: " + mesh.name + " --> " + tag);
            });
            this.characterController.registerOnCollisionStay(function (mesh) {
                var tag = BABYLON.SceneManager.GetTransformTag(mesh);
                //console.log("PLAYER: ===> Got Collision Stay Event: " + mesh.name + " --> " + tag);
            });
            this.characterController.registerOnCollisionExit(function (mesh) {
                var tag = BABYLON.SceneManager.GetTransformTag(mesh);
                //console.warn("PLAYER ===> DESTROY: Collision Exit Event: " + mesh.name + " --> " + tag);
            });
        }
    };
    FirstPersonController.prototype.updateFirstPersonController = function () {
        var deltaTime = this.getDeltaSeconds();
        this.playerDeltaX = BABYLON.SceneManager.GetUserInput(BABYLON.UserInputAxis.Horizontal, this.playerNumber);
        this.playerDeltaZ = BABYLON.SceneManager.GetUserInput(BABYLON.UserInputAxis.Vertical, this.playerNumber);
        this.playerMouseX = BABYLON.SceneManager.GetUserInput(BABYLON.UserInputAxis.MouseX, this.playerNumber);
        this.playerMouseY = BABYLON.SceneManager.GetUserInput(BABYLON.UserInputAxis.MouseY, this.playerNumber);
        // Update Dead Input Values
        if (Math.abs(this.playerDeltaX) <= BABYLON.UserInputOptions.GamepadDeadStickValue)
            this.playerDeltaX = 0;
        if (Math.abs(this.playerDeltaZ) <= BABYLON.UserInputOptions.GamepadDeadStickValue)
            this.playerDeltaZ = 0;
        if (Math.abs(this.playerMouseX) <= BABYLON.UserInputOptions.GamepadDeadStickValue)
            this.playerMouseX = 0;
        if (Math.abs(this.playerMouseY) <= BABYLON.UserInputOptions.GamepadDeadStickValue)
            this.playerMouseY = 0;
        // Update Character Movement
        if (this.characterController != null) {
            this.isCharacterGrounded = this.characterController.isGrounded();
            this.isCharacterJumpFrame = false;
            // Rotate Player Left And Right With Mouse-X
            this.playerTurnRate = (this.playerMouseX * (this.horzSensitivity * this.deltaFactor));
            this.characterController.turn(this.playerTurnRate);
            /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
            // FPC: Pitch Camera Pivot Up And Down With Mouse-Y
            /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
            this.cameraPitchRate = (this.playerMouseY * (this.vertSensitivity * this.deltaFactor));
            this.cameraPivot.rotate(BABYLON.Axis.X, -(this.cameraPitchRate * BABYLON.System.Deg2Rad), BABYLON.Space.LOCAL);
            BABYLON.Utilities.ToEulerToRef(this.cameraPivot.rotationQuaternion, this.cameraEulerAngles);
            this.cameraEulerAngles.x = BABYLON.Scalar.Clamp(this.cameraEulerAngles.x, this.minimumPitchAngle, this.maximumPitchAngle);
            BABYLON.Utilities.FromEulerToRef(this.cameraEulerAngles.x, this.cameraEulerAngles.y, this.cameraEulerAngles.z, this.cameraPivot.rotationQuaternion);
            /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
            // Update Player Input With Delta-X And Delta-Z
            if (this.isCharacterGrounded === true) {
                this.playerMovement.x = this.playerDeltaX;
                this.playerMovement.y = 0.0;
                this.playerMovement.z = this.playerDeltaZ;
                this.isCharacterJumpFrame = (BABYLON.SceneManager.GetKeyboardInput(this.keyboardJump) || BABYLON.SceneManager.GetGamepadButtonInput(this.buttonJump));
                // Transform Movement Direction And Scale Speed
                BABYLON.Utilities.TransformDirectionToRef(this.transform, this.playerMovement, this.playerMovement);
                BABYLON.Vector3.NormalizeToRef(this.playerMovement, this.playerMovement);
                this.playerMovement.scaleInPlace((BABYLON.System.WalkingVelocity * this.movementSpeed) * deltaTime);
                // Move Player Using Physics Character Controller
                this.characterController.move(this.playerMovement);
                // Jump Player Using Physics Character Controller
                if (this.isCharacterJumpFrame === true) {
                    this.characterController.jump(this.jumpingVelocity);
                }
            }
        }
    };
    FirstPersonController.prototype.destroyFirstPersonController = function () {
        this.cameraPivot = null;
        this.cameraRigger = null;
        this.characterController = null;
    };
    return FirstPersonController;
}(BABYLON.ScriptComponent));
/**
 * Babylon Script Component
 * @class ThirdPersonController
 */
var ThirdPersonController = /** @class */ (function (_super) {
    __extends(ThirdPersonController, _super);
    function ThirdPersonController(transform, scene, properties) {
        if (properties === void 0) { properties = {}; }
        var _this = _super.call(this, transform, scene, properties) || this;
        _this.deltaFactor = 2.0;
        _this.attachCamera = true;
        _this.cameraPivot = null;
        _this.cameraRigger = null;
        _this.movementSpeed = 1.0;
        _this.jumpingVelocity = 10.0;
        _this.playerMovement = BABYLON.Vector3.Zero();
        _this.playerTurnRate = 0.0;
        _this.cameraPitchRate = 0.0;
        _this.horzSensitivity = 1.0;
        _this.vertSensitivity = 1.0;
        _this.mouseSensitivity = 1.0;
        _this.minimumPitchAngle = -60.0;
        _this.maximumPitchAngle = 60.0;
        _this.isCharacterGrounded = false;
        _this.isCharacterJumpFrame = false;
        _this.characterController = null;
        _this.buttonJump = BABYLON.Xbox360Button.A;
        _this.keyboardJump = BABYLON.UserInputKey.SpaceBar;
        _this.playerNumber = BABYLON.PlayerNumber.One;
        _this.playerDeltaX = 0.0;
        _this.playerDeltaZ = 0.0;
        _this.playerMouseX = 0.0;
        _this.playerMouseY = 0.0;
        _this.attachCamera = _this.getEditorProperty("attachCamera", _this.attachCamera);
        _this.playerNumber = _this.getEditorProperty("playerNumber", _this.playerNumber);
        _this.movementSpeed = _this.getEditorProperty("movementSpeed", _this.movementSpeed);
        _this.mouseSensitivity = _this.getEditorProperty("mouseSensitivity", _this.mouseSensitivity);
        _this.minimumPitchAngle = _this.getEditorProperty("minimumPitchAngle", _this.minimumPitchAngle);
        _this.maximumPitchAngle = _this.getEditorProperty("maximumPitchAngle", _this.maximumPitchAngle);
        _this.vertSensitivity = _this.getEditorProperty("verticalSensitivity", _this.vertSensitivity);
        _this.horzSensitivity = _this.getEditorProperty("horizontalSensitivity", _this.horzSensitivity);
        _this.jumpingVelocity = _this.getEditorProperty("impulseJumpVelocity", _this.jumpingVelocity);
        // Scale Mouse Pointer Sensitivity
        if (_this.playerNumber == BABYLON.PlayerNumber.One) {
            BABYLON.UserInputOptions.PointerAngularSensibility = (BABYLON.UserInputOptions.PointerAngularSensibility * _this.mouseSensitivity);
        }
        return _this;
    }
    ThirdPersonController.prototype.getCharacterController = function () { return this.characterController; };
    ThirdPersonController.prototype.start = function () { this.setupThirdPersonController(); };
    ThirdPersonController.prototype.update = function () { this.updateThirdPersonController(); };
    ThirdPersonController.prototype.destroy = function () { this.destroyThirdPersonController(); };
    ThirdPersonController.prototype.setupThirdPersonController = function () {
        // Setup Camera Attachments
        this.cameraPivot = this.getChildTransform("Pivot");
        if (this.cameraPivot == null) {
            this.cameraPivot = new BABYLON.TransformNode("Pivot", this.scene);
            this.cameraPivot.setParent(this.transform);
            this.cameraPivot.position = new BABYLON.Vector3(0.0, 1.85, 0.0);
        }
        BABYLON.Utilities.ValidateTransformQuaternion(this.cameraPivot);
        if (this.attachCamera === true) {
            // TODO: Create Multi Player Camera (No Attach Camera)
            this.cameraRigger = BABYLON.SceneManager.GetTransformNode(this.scene, "Main Camera");
            if (this.cameraRigger != null && this.cameraPivot != null) {
                this.cameraRigger.setParent(this.cameraPivot);
                this.cameraRigger.position = new BABYLON.Vector3(0.0, 0.0, -4.5);
                this.cameraRigger.rotationQuaternion = BABYLON.Quaternion.Identity();
                console.log("TPC: Attached main camera to player controller: " + this.transform.name);
            }
            else {
                BABYLON.Tools.Warn("Failed to locate camera or local pivot for: " + this.transform.name);
            }
        }
        // Setup Character Controller
        this.characterController = this.getComponent("BABYLON.CharacterController");
        if (this.characterController == null)
            BABYLON.Tools.Warn("Failed to locate character controller for: " + this.transform.name);
    };
    ThirdPersonController.prototype.updateThirdPersonController = function () {
        this.playerDeltaX = BABYLON.SceneManager.GetUserInput(BABYLON.UserInputAxis.Horizontal, this.playerNumber);
        this.playerDeltaZ = BABYLON.SceneManager.GetUserInput(BABYLON.UserInputAxis.Vertical, this.playerNumber);
        this.playerMouseX = BABYLON.SceneManager.GetUserInput(BABYLON.UserInputAxis.MouseX, this.playerNumber);
        this.playerMouseY = BABYLON.SceneManager.GetUserInput(BABYLON.UserInputAxis.MouseY, this.playerNumber);
        // Update Dead Input Values
        if (Math.abs(this.playerDeltaX) <= BABYLON.UserInputOptions.GamepadDeadStickValue)
            this.playerDeltaX = 0;
        if (Math.abs(this.playerDeltaZ) <= BABYLON.UserInputOptions.GamepadDeadStickValue)
            this.playerDeltaZ = 0;
        if (Math.abs(this.playerMouseX) <= BABYLON.UserInputOptions.GamepadDeadStickValue)
            this.playerMouseX = 0;
        if (Math.abs(this.playerMouseY) <= BABYLON.UserInputOptions.GamepadDeadStickValue)
            this.playerMouseY = 0;
        // Update Character Movement
        if (this.characterController != null) {
        }
    };
    ThirdPersonController.prototype.destroyThirdPersonController = function () {
        this.cameraPivot = null;
        this.cameraRigger = null;
        this.characterController = null;
    };
    return ThirdPersonController;
}(BABYLON.ScriptComponent));
/**
 * Babylon Script Component
 * @class BoundingBoxSkins
 */
var BoundingBoxSkins = /** @class */ (function (_super) {
    __extends(BoundingBoxSkins, _super);
    function BoundingBoxSkins(transform, scene, properties) {
        if (properties === void 0) { properties = {}; }
        var _this = _super.call(this, transform, scene, properties) || this;
        _this.skins = null;
        _this.syncBoundingInfo = true;
        _this.updateEveryFrame = false;
        _this.positionThreashold = 0.1;
        _this.lastPosition = BABYLON.Vector3.Zero();
        // ..
        // Validate Skin Bounding Box Info
        // ..
        _this.syncBoundingInfo = _this.getEditorProperty("syncBoundingInfo", _this.syncBoundingInfo);
        _this.updateEveryFrame = _this.getEditorProperty("updateEveryFrame", _this.updateEveryFrame);
        _this.positionThreashold = _this.getEditorProperty("positionThreashold", _this.positionThreashold);
        if (_this.syncBoundingInfo === true) {
            var skinned_1 = false;
            var metadata = _this.getMetadata();
            if (metadata != null && metadata.skin === true) {
                skinned_1 = true;
            }
            _this.skins = _this.transform.getChildMeshes(false, function (node) {
                var data = BABYLON.SceneManager.FindSceneMetadata(node);
                return ((data != null && data.skin === true) || (skinned_1 === true && node.name.indexOf("_primitive") >= 0)); // TODO: Remove Primitives
            });
            if (skinned_1 === true && _this.transform instanceof BABYLON.AbstractMesh) {
                if (_this.skins == null)
                    _this.skins = [];
                _this.skins.unshift(_this.transform);
            }
        }
        return _this;
    }
    BoundingBoxSkins.prototype.start = function () {
        this.checkSkins();
    };
    BoundingBoxSkins.prototype.update = function () {
        if (this.updateEveryFrame === true) {
            this.checkSkins();
        }
    };
    BoundingBoxSkins.prototype.after = function () {
    };
    BoundingBoxSkins.prototype.destroy = function () {
        this.skins = null;
    };
    BoundingBoxSkins.prototype.checkSkins = function () {
        // Start render loop function
        if (this.skins != null && this.skins.length > 0) {
            if (this.transform.position.x !== this.lastPosition.x || this.transform.position.y !== this.lastPosition.y || this.transform.position.z !== this.lastPosition.z) {
                if (Math.abs(this.transform.position.x - this.lastPosition.x) >= this.positionThreashold || Math.abs(this.transform.position.y - this.lastPosition.y) >= this.positionThreashold || Math.abs(this.transform.position.z - this.lastPosition.z) >= this.positionThreashold) {
                    this.skins.forEach(function (skin) { skin.refreshBoundingInfo(true); });
                    //console.log("===> Position Change Update: " + this.transform.name);
                    //console.log(this.transform.position.toString());
                    this.lastPosition.x = this.transform.position.x;
                    this.lastPosition.y = this.transform.position.y;
                    this.lastPosition.z = this.transform.position.z;
                }
            }
        }
    };
    return BoundingBoxSkins;
}(BABYLON.ScriptComponent));
/**
 * Babylon skidmark section class (Native Bullet Physics 2.82)
 * @class SkidmarkSection
 */
var SkidmarkSection = /** @class */ (function () {
    function SkidmarkSection() {
        this.Pos = BABYLON.Vector3.Zero();
        this.Normal = BABYLON.Vector3.Zero();
        this.Tangent = BABYLON.Vector4.Zero();
        this.Posl = BABYLON.Vector3.Zero();
        this.Posr = BABYLON.Vector3.Zero();
        this.Intensity = 0.0;
        this.LastIndex = -1;
    }
    return SkidmarkSection;
}());
/**
 * Babylon Script Component
 * @class SkidmarkManager
 */
var SkidmarkManager = /** @class */ (function (_super) {
    __extends(SkidmarkManager, _super);
    function SkidmarkManager(transform, scene, properties) {
        if (properties === void 0) { properties = {}; }
        var _this = _super.call(this, transform, scene, properties) || this;
        SkidmarkManager.MAX_MARKS = _this.getEditorProperty("maxSections", SkidmarkManager.MAX_MARKS);
        SkidmarkManager.MARK_COLOR = BABYLON.Utilities.ParseColor3(_this.getEditorProperty("textureColor", SkidmarkManager.MARK_COLOR));
        SkidmarkManager.MARK_WIDTH = _this.getEditorProperty("textureWidth", SkidmarkManager.MARK_WIDTH);
        SkidmarkManager.GROUND_OFFSET = _this.getEditorProperty("groundOffset", SkidmarkManager.GROUND_OFFSET);
        SkidmarkManager.VELOCITY_SCALE = _this.getEditorProperty("velocityScale", SkidmarkManager.VELOCITY_SCALE);
        SkidmarkManager.GPU_TRIANGLES = _this.getEditorProperty("gpuQuadIndices", SkidmarkManager.GPU_TRIANGLES);
        SkidmarkManager.TEXTURE_MARKS = _this.getEditorProperty("textureMarks", SkidmarkManager.TEXTURE_MARKS);
        SkidmarkManager.MIN_DISTANCE = _this.getEditorProperty("textureDistance", SkidmarkManager.MIN_DISTANCE);
        SkidmarkManager.MIN_SQR_DISTANCE = (SkidmarkManager.MIN_DISTANCE * SkidmarkManager.MIN_DISTANCE);
        return _this;
    }
    SkidmarkManager.prototype.start = function () { SkidmarkManager.CreateSkidmarkManager(this.scene); };
    SkidmarkManager.prototype.update = function () { SkidmarkManager.UpdateSkidmarkManager(); };
    SkidmarkManager.GetVelocityScale = function () { return SkidmarkManager.VELOCITY_SCALE; };
    SkidmarkManager.AddSkidmarkSegment = function (pos, normal, intensity, lastIndex) {
        if (SkidmarkManager.SkidmarkMesh == null)
            return null;
        SkidmarkManager.TempVector3_POS.set(0, 0, 0);
        SkidmarkManager.TempVector3_DIR.set(0, 0, 0);
        SkidmarkManager.TempVector3_XDIR.set(0, 0, 0);
        SkidmarkManager.TempVector3_SDIR.set(0, 0, 0);
        // ..
        if (intensity > 1.0)
            intensity = 1.0;
        else if (intensity < 0.0)
            return -1.0;
        // ..
        if (lastIndex > 0) {
            pos.subtractToRef(SkidmarkManager.SkidmarkSections[lastIndex].Pos, SkidmarkManager.TempVector3_POS);
            var sqrDistance = SkidmarkManager.TempVector3_POS.lengthSquared();
            if (sqrDistance < SkidmarkManager.MIN_SQR_DISTANCE)
                return lastIndex;
        }
        // ..
        var curSection = SkidmarkManager.SkidmarkSections[SkidmarkManager.SkidmarkIndex];
        normal.scaleToRef(SkidmarkManager.GROUND_OFFSET, SkidmarkManager.TempVector3_POS);
        pos.addToRef(SkidmarkManager.TempVector3_POS, curSection.Pos);
        curSection.Normal.copyFrom(normal);
        curSection.Intensity = intensity;
        curSection.LastIndex = lastIndex;
        // ..
        if (lastIndex != -1) {
            var lastSection = SkidmarkManager.SkidmarkSections[lastIndex];
            curSection.Pos.subtractToRef(lastSection.Pos, SkidmarkManager.TempVector3_DIR);
            BABYLON.Vector3.CrossToRef(SkidmarkManager.TempVector3_DIR, normal, SkidmarkManager.TempVector3_XDIR);
            SkidmarkManager.TempVector3_XDIR.normalizeToRef(SkidmarkManager.TempVector3_XDIR);
            // ..
            SkidmarkManager.TempVector3_XDIR.scaleToRef(SkidmarkManager.MARK_WIDTH * 0.5, SkidmarkManager.TempVector3_SDIR);
            curSection.Pos.addToRef(SkidmarkManager.TempVector3_SDIR, curSection.Posl);
            curSection.Pos.subtractToRef(SkidmarkManager.TempVector3_SDIR, curSection.Posr);
            curSection.Tangent.set(SkidmarkManager.TempVector3_XDIR.x, SkidmarkManager.TempVector3_XDIR.y, SkidmarkManager.TempVector3_XDIR.z, 1);
            // ..
            if (lastSection.LastIndex === -1) {
                curSection.Pos.addToRef(SkidmarkManager.TempVector3_SDIR, lastSection.Posl);
                curSection.Pos.subtractToRef(SkidmarkManager.TempVector3_SDIR, lastSection.Posr);
                lastSection.Tangent.copyFrom(curSection.Tangent);
            }
        }
        // ..
        SkidmarkManager.AddSkidmarkVertexData();
        var curIndex = SkidmarkManager.SkidmarkIndex;
        SkidmarkManager.SkidmarkIndex = ++SkidmarkManager.SkidmarkIndex % SkidmarkManager.MAX_MARKS;
        return curIndex;
    };
    SkidmarkManager.CreateSkidmarkManager = function (scene) {
        if (SkidmarkManager.SkidmarkMesh == null) {
            var skidmarkMaterial = new BABYLON.StandardMaterial("SkidmarkMaterial", scene);
            skidmarkMaterial.backFaceCulling = false;
            skidmarkMaterial.disableLighting = true;
            skidmarkMaterial.emissiveColor = SkidmarkManager.MARK_COLOR;
            skidmarkMaterial.diffuseColor = SkidmarkManager.MARK_COLOR;
            skidmarkMaterial.diffuseTexture = BABYLON.Utilities.ParseTexture(SkidmarkManager.TEXTURE_MARKS, scene);
            if (skidmarkMaterial.diffuseTexture != null) {
                skidmarkMaterial.diffuseTexture.hasAlpha = true;
                skidmarkMaterial.useAlphaFromDiffuseTexture = true;
            }
            skidmarkMaterial.freeze();
            SkidmarkManager.SkidmarkMesh = new BABYLON.Mesh("SkidmarkMesh", scene);
            SkidmarkManager.SkidmarkMesh.material = skidmarkMaterial;
            SkidmarkManager.SkidmarkMesh.alwaysSelectAsActiveMesh = true;
            SkidmarkManager.SkidmarkMesh.doNotSyncBoundingInfo = true;
            SkidmarkManager.SkidmarkMesh.receiveShadows = false;
            SkidmarkManager.SkidmarkMesh.checkCollisions = false;
            SkidmarkManager.SkidmarkMesh.useVertexColors = true;
            SkidmarkManager.SkidmarkMesh.hasVertexAlpha = true;
            SkidmarkManager.SkidmarkMesh.isPickable = false;
            // ..
            // Setup Skidmark Section Properties
            // ..
            SkidmarkManager.SkidmarkSections = new Array(SkidmarkManager.MAX_MARKS);
            for (var i = 0; i < SkidmarkManager.SkidmarkSections.length; i++) {
                SkidmarkManager.SkidmarkSections[i] = new SkidmarkSection();
            }
            // ..
            // Setup Raw Mesh Vertex Buffer Data
            // ..
            SkidmarkManager.SkidBufferPositions = new Float32Array(SkidmarkManager.MAX_MARKS * 4 * 3);
            SkidmarkManager.SkidBufferNormals = new Float32Array(SkidmarkManager.MAX_MARKS * 4 * 3);
            SkidmarkManager.SkidBufferTangents = new Float32Array(SkidmarkManager.MAX_MARKS * 4 * 4);
            SkidmarkManager.SkidBufferColors = new Float32Array(SkidmarkManager.MAX_MARKS * 4 * 4);
            SkidmarkManager.SkidBufferUvs = new Float32Array(SkidmarkManager.MAX_MARKS * 4 * 2);
            SkidmarkManager.SkidBufferIndices = new Int32Array(SkidmarkManager.MAX_MARKS * 6);
            // ..
            // Apply Raw Vertex Buffer Data To Mesh
            // ..
            var vertexData = new BABYLON.VertexData();
            vertexData.positions = SkidmarkManager.SkidBufferPositions;
            vertexData.normals = SkidmarkManager.SkidBufferNormals;
            vertexData.tangents = SkidmarkManager.SkidBufferTangents;
            vertexData.colors = SkidmarkManager.SkidBufferColors;
            vertexData.uvs = SkidmarkManager.SkidBufferUvs;
            vertexData.indices = SkidmarkManager.SkidBufferIndices;
            vertexData.applyToMesh(SkidmarkManager.SkidmarkMesh, true);
            SkidmarkManager.SkidmarkMesh.freezeWorldMatrix();
        }
    };
    SkidmarkManager.AddSkidmarkVertexData = function () {
        var curr = SkidmarkManager.SkidmarkSections[SkidmarkManager.SkidmarkIndex];
        if (curr.LastIndex === -1)
            return;
        var last = SkidmarkManager.SkidmarkSections[curr.LastIndex];
        SkidmarkManager.SkidmarkUpdated = true;
        // ..
        // Update Position Buffers Directly
        // ..
        var index = SkidmarkManager.SkidmarkIndex * 4 + 0;
        SkidmarkManager.SkidBufferPositions[index * 3] = last.Posl.x;
        SkidmarkManager.SkidBufferPositions[(index * 3) + 1] = last.Posl.y;
        SkidmarkManager.SkidBufferPositions[(index * 3) + 2] = last.Posl.z;
        index = SkidmarkManager.SkidmarkIndex * 4 + 1;
        SkidmarkManager.SkidBufferPositions[index * 3] = last.Posr.x;
        SkidmarkManager.SkidBufferPositions[(index * 3) + 1] = last.Posr.y;
        SkidmarkManager.SkidBufferPositions[(index * 3) + 2] = last.Posr.z;
        index = SkidmarkManager.SkidmarkIndex * 4 + 2;
        SkidmarkManager.SkidBufferPositions[index * 3] = curr.Posl.x;
        SkidmarkManager.SkidBufferPositions[(index * 3) + 1] = curr.Posl.y;
        SkidmarkManager.SkidBufferPositions[(index * 3) + 2] = curr.Posl.z;
        index = SkidmarkManager.SkidmarkIndex * 4 + 3;
        SkidmarkManager.SkidBufferPositions[index * 3] = curr.Posr.x;
        SkidmarkManager.SkidBufferPositions[(index * 3) + 1] = curr.Posr.y;
        SkidmarkManager.SkidBufferPositions[(index * 3) + 2] = curr.Posr.z;
        // ..
        // Update Normal Buffers Directly
        // ..
        index = SkidmarkManager.SkidmarkIndex * 4 + 0;
        SkidmarkManager.SkidBufferNormals[index * 3] = last.Normal.x;
        SkidmarkManager.SkidBufferNormals[(index * 3) + 1] = last.Normal.y;
        SkidmarkManager.SkidBufferNormals[(index * 3) + 2] = last.Normal.z;
        index = SkidmarkManager.SkidmarkIndex * 4 + 1;
        SkidmarkManager.SkidBufferNormals[index * 3] = last.Normal.x;
        SkidmarkManager.SkidBufferNormals[(index * 3) + 1] = last.Normal.y;
        SkidmarkManager.SkidBufferNormals[(index * 3) + 2] = last.Normal.z;
        index = SkidmarkManager.SkidmarkIndex * 4 + 2;
        SkidmarkManager.SkidBufferNormals[index * 3] = curr.Normal.x;
        SkidmarkManager.SkidBufferNormals[(index * 3) + 1] = curr.Normal.y;
        SkidmarkManager.SkidBufferNormals[(index * 3) + 2] = curr.Normal.z;
        index = SkidmarkManager.SkidmarkIndex * 4 + 3;
        SkidmarkManager.SkidBufferNormals[index * 3] = curr.Normal.x;
        SkidmarkManager.SkidBufferNormals[(index * 3) + 1] = curr.Normal.y;
        SkidmarkManager.SkidBufferNormals[(index * 3) + 2] = curr.Normal.z;
        // ..
        // Update Tangent Buffers Directly
        // ..
        index = SkidmarkManager.SkidmarkIndex * 4 + 0;
        SkidmarkManager.SkidBufferTangents[index * 4] = last.Tangent.x;
        SkidmarkManager.SkidBufferTangents[(index * 4) + 1] = last.Tangent.y;
        SkidmarkManager.SkidBufferTangents[(index * 4) + 2] = last.Tangent.z;
        SkidmarkManager.SkidBufferTangents[(index * 4) + 3] = last.Tangent.w;
        index = SkidmarkManager.SkidmarkIndex * 4 + 1;
        SkidmarkManager.SkidBufferTangents[index * 4] = last.Tangent.x;
        SkidmarkManager.SkidBufferTangents[(index * 4) + 1] = last.Tangent.y;
        SkidmarkManager.SkidBufferTangents[(index * 4) + 2] = last.Tangent.z;
        SkidmarkManager.SkidBufferTangents[(index * 4) + 3] = last.Tangent.w;
        index = SkidmarkManager.SkidmarkIndex * 4 + 2;
        SkidmarkManager.SkidBufferTangents[index * 4] = curr.Tangent.x;
        SkidmarkManager.SkidBufferTangents[(index * 4) + 1] = curr.Tangent.y;
        SkidmarkManager.SkidBufferTangents[(index * 4) + 2] = curr.Tangent.z;
        SkidmarkManager.SkidBufferTangents[(index * 4) + 3] = curr.Tangent.w;
        index = SkidmarkManager.SkidmarkIndex * 4 + 3;
        SkidmarkManager.SkidBufferTangents[index * 4] = curr.Tangent.x;
        SkidmarkManager.SkidBufferTangents[(index * 4) + 1] = curr.Tangent.y;
        SkidmarkManager.SkidBufferTangents[(index * 4) + 2] = curr.Tangent.z;
        SkidmarkManager.SkidBufferTangents[(index * 4) + 3] = curr.Tangent.w;
        // ..
        // Update Color Buffers Directly
        // ..
        index = SkidmarkManager.SkidmarkIndex * 4 + 0;
        SkidmarkManager.SkidBufferColors[index * 4] = 1.0;
        SkidmarkManager.SkidBufferColors[(index * 4) + 1] = 1.0;
        SkidmarkManager.SkidBufferColors[(index * 4) + 2] = 1.0;
        SkidmarkManager.SkidBufferColors[(index * 4) + 3] = last.Intensity;
        index = SkidmarkManager.SkidmarkIndex * 4 + 1;
        SkidmarkManager.SkidBufferColors[index * 4] = 1.0;
        SkidmarkManager.SkidBufferColors[(index * 4) + 1] = 1.0;
        SkidmarkManager.SkidBufferColors[(index * 4) + 2] = 1.0;
        SkidmarkManager.SkidBufferColors[(index * 4) + 3] = last.Intensity;
        index = SkidmarkManager.SkidmarkIndex * 4 + 2;
        SkidmarkManager.SkidBufferColors[index * 4] = 1.0;
        SkidmarkManager.SkidBufferColors[(index * 4) + 1] = 1.0;
        SkidmarkManager.SkidBufferColors[(index * 4) + 2] = 1.0;
        SkidmarkManager.SkidBufferColors[(index * 4) + 3] = curr.Intensity;
        index = SkidmarkManager.SkidmarkIndex * 4 + 3;
        SkidmarkManager.SkidBufferColors[index * 4] = 1.0;
        SkidmarkManager.SkidBufferColors[(index * 4) + 1] = 1.0;
        SkidmarkManager.SkidBufferColors[(index * 4) + 2] = 1.0;
        SkidmarkManager.SkidBufferColors[(index * 4) + 3] = curr.Intensity;
        // ..
        // Update Coord Buffers Directly
        // ..
        index = SkidmarkManager.SkidmarkIndex * 4 + 0;
        SkidmarkManager.SkidBufferUvs[index * 2] = 0;
        SkidmarkManager.SkidBufferUvs[(index * 2) + 1] = 0;
        index = SkidmarkManager.SkidmarkIndex * 4 + 1;
        SkidmarkManager.SkidBufferUvs[index * 2] = 1;
        SkidmarkManager.SkidBufferUvs[(index * 2) + 1] = 0;
        index = SkidmarkManager.SkidmarkIndex * 4 + 2;
        SkidmarkManager.SkidBufferUvs[index * 2] = 0;
        SkidmarkManager.SkidBufferUvs[(index * 2) + 1] = 1;
        index = SkidmarkManager.SkidmarkIndex * 4 + 3;
        SkidmarkManager.SkidBufferUvs[index * 2] = 1;
        SkidmarkManager.SkidBufferUvs[(index * 2) + 1] = 1;
        // ..
        // Update Triangle 1 Buffers Directly (QUAD)
        //..
        SkidmarkManager.SkidBufferIndices[SkidmarkManager.SkidmarkIndex * 6 + 0] = SkidmarkManager.SkidmarkIndex * 4 + 0;
        SkidmarkManager.SkidBufferIndices[SkidmarkManager.SkidmarkIndex * 6 + 2] = SkidmarkManager.SkidmarkIndex * 4 + 1;
        SkidmarkManager.SkidBufferIndices[SkidmarkManager.SkidmarkIndex * 6 + 1] = SkidmarkManager.SkidmarkIndex * 4 + 2;
        // ..
        // Update Triangle 2 Buffers Directly (QUAD)
        // ..
        SkidmarkManager.SkidBufferIndices[SkidmarkManager.SkidmarkIndex * 6 + 3] = SkidmarkManager.SkidmarkIndex * 4 + 2;
        SkidmarkManager.SkidBufferIndices[SkidmarkManager.SkidmarkIndex * 6 + 5] = SkidmarkManager.SkidmarkIndex * 4 + 1;
        SkidmarkManager.SkidBufferIndices[SkidmarkManager.SkidmarkIndex * 6 + 4] = SkidmarkManager.SkidmarkIndex * 4 + 3;
    };
    SkidmarkManager.UpdateSkidmarkManager = function () {
        if (SkidmarkManager.SkidmarkMesh != null && SkidmarkManager.SkidmarkUpdated === true) {
            SkidmarkManager.SkidmarkUpdated = false;
            if (SkidmarkManager.SkidmarkMesh.geometry != null) {
                SkidmarkManager.SkidmarkMesh.geometry.updateVerticesDataDirectly(BABYLON.VertexBuffer.PositionKind, SkidmarkManager.SkidBufferPositions, 0, false);
                SkidmarkManager.SkidmarkMesh.geometry.updateVerticesDataDirectly(BABYLON.VertexBuffer.NormalKind, SkidmarkManager.SkidBufferNormals, 0, false);
                SkidmarkManager.SkidmarkMesh.geometry.updateVerticesDataDirectly(BABYLON.VertexBuffer.TangentKind, SkidmarkManager.SkidBufferTangents, 0, false);
                SkidmarkManager.SkidmarkMesh.geometry.updateVerticesDataDirectly(BABYLON.VertexBuffer.ColorKind, SkidmarkManager.SkidBufferColors, 0, false);
                SkidmarkManager.SkidmarkMesh.geometry.updateVerticesDataDirectly(BABYLON.VertexBuffer.UVKind, SkidmarkManager.SkidBufferUvs, 0, false);
                SkidmarkManager.SkidmarkMesh.geometry.updateIndices(SkidmarkManager.SkidBufferIndices, 0, SkidmarkManager.GPU_TRIANGLES);
            }
        }
    };
    SkidmarkManager.MAX_MARKS = 4096; // Max number of marks total for everyone together
    SkidmarkManager.GROUND_OFFSET = 0.01; // Distance above surface in metres
    SkidmarkManager.VELOCITY_SCALE = 0.02; // Velocity offset scale factor
    SkidmarkManager.GPU_TRIANGLES = true; // GPU quad triangle indices only
    SkidmarkManager.MARK_COLOR = BABYLON.Color3.Black(); // Skidmark Color
    SkidmarkManager.MARK_WIDTH = 0.3; // Width of the Skidmarks. Should match the width of the wheels
    SkidmarkManager.MIN_DISTANCE = 0.1; // Distance between skid texture sections in metres. Bigger = better performance, less smooth
    SkidmarkManager.MIN_SQR_DISTANCE = (SkidmarkManager.MIN_DISTANCE * SkidmarkManager.MIN_DISTANCE);
    SkidmarkManager.TEXTURE_MARKS = null;
    SkidmarkManager.SkidBufferPositions = null;
    SkidmarkManager.SkidBufferNormals = null;
    SkidmarkManager.SkidBufferTangents = null;
    SkidmarkManager.SkidBufferColors = null;
    SkidmarkManager.SkidBufferUvs = null;
    SkidmarkManager.SkidBufferIndices = null;
    SkidmarkManager.SkidmarkSections = null;
    SkidmarkManager.SkidmarkIndex = 0;
    SkidmarkManager.SkidmarkMesh = null;
    SkidmarkManager.SkidmarkUpdated = false;
    SkidmarkManager.TempVector3_POS = new BABYLON.Vector3(0, 0, 0);
    SkidmarkManager.TempVector3_DIR = new BABYLON.Vector3(0, 0, 0);
    SkidmarkManager.TempVector3_XDIR = new BABYLON.Vector3(0, 0, 0);
    SkidmarkManager.TempVector3_SDIR = new BABYLON.Vector3(0, 0, 0);
    return SkidmarkManager;
}(BABYLON.ScriptComponent));
/**
 * Babylon standard rigidbody vehicle controller class (Native Bullet Physics 2.82)
 * @class StandardCarController
 */
var StandardCarController = /** @class */ (function (_super) {
    __extends(StandardCarController, _super);
    function StandardCarController(transform, scene, properties) {
        if (properties === void 0) { properties = {}; }
        var _this = _super.call(this, transform, scene, properties) || this;
        _this._rigidbody = null;
        _this._engineAudioSource = null;
        _this._skidFLAudioSource = null;
        _this._skidFRAudioSource = null;
        _this._skidRLAudioSource = null;
        _this._skidRRAudioSource = null;
        _this.gearIndex = 1; // 0: Reverse, 1: Neutral, 2: 1st
        _this.shiftingGears = false;
        _this.vehicleSteer = 0;
        _this.engineForce = 0;
        _this.brakingForce = 0;
        _this.forwardSpeed = 0;
        _this.absoluteSpeed = 0;
        _this.americanSpeed = 0;
        _this.normalizedSpeed = 0;
        _this.raycastVehicle = null;
        _this.frontLeftWheelMesh = null;
        _this.frontRightWheelMesh = null;
        _this.backLeftWheelMesh = null;
        _this.backRightWheelMesh = null;
        _this.frontLeftWheelTrans = null;
        _this.frontRightWheelTrans = null;
        _this.backLeftWheelTrans = null;
        _this.backRightWheelTrans = null;
        _this.frontLeftWheelCollider = null;
        _this.frontRightWheelCollider = null;
        _this.backLeftWheelCollider = null;
        _this.backRightWheelCollider = null;
        _this.engineTorqueCurve = null;
        _this.wheelRadius = 0;
        _this.shiftDelay = 0;
        _this.clutchSlip = 0;
        _this.engineRPM = 0;
        _this.lerpedRPM = 0;
        _this.oldRPM = 0;
        _this.STEER_RADIUS = 0.5;
        _this.FRONT_LEFT = -1;
        _this.FRONT_RIGHT = -1;
        _this.BACK_LEFT = -1;
        _this.BACK_RIGHT = -1;
        _this.smokeTexture = null;
        _this.shadowTexture = null;
        _this.setEngineTorque = null;
        _this.topEngineSpeed = 120;
        _this.lowSpeedAngle = 0.25;
        _this.highSpeedAngle = 0.0125;
        _this.transmissionRatio = 0.7;
        _this.differentialRatio = 3.55;
        _this.maxBrakingForce = 100;
        _this.maxReverseSpeed = 0.66;
        _this.lerpEnginePitching = 5000;
        _this.handBrakingForce = 1000;
        _this.wheelLockFriction = 0.1;
        _this.driftingInfluence = 0;
        _this.lowSpeedIncrement = 0.0125;
        _this.highSpeedIncrement = 0.0125;
        _this.frictionSlipSpeed = 10;
        _this.wheelDriveType = 0;
        _this.gearBoxShiftDelay = 0.3;
        _this.gearBoxShiftNext = 3500;
        _this.gearBoxShiftDown = 2500;
        _this.gearBoxShiftRatios = [3.437, 0.00, 3.626, 2.2, 1.541, 1.213, 1.0, 0.767];
        _this.gearBoxShiftScales = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0];
        _this.m_frontLeftWheel = null;
        _this.m_frontRightWheel = null;
        _this.m_backLeftWheel = null;
        _this.m_backRightWheel = null;
        _this.m_physicsWorld = null;
        _this.m_frontLeftWheelSkid = -1;
        _this.m_frontRightWheelSkid = -1;
        _this.m_backLeftWheelSkid = -1;
        _this.m_backRightWheelSkid = -1;
        _this.m_velocityOffset = new BABYLON.Vector3(0, 0, 0);
        ////////////////////////////////////////////////////
        // Public Vehicle Controller Movement Functions   //
        ////////////////////////////////////////////////////
        _this.steeringIncrement = 0;
        _this.allowedTurningAngle = 0;
        _this.vehicleSteer = 0;
        _this.brakingForce = 0;
        _this.engineForce = 0;
        _this.m_physicsWorld = BABYLON.SceneManager.GetPhysicsWorld(_this.scene);
        _this.smokeTexture = _this.getEditorProperty("smokeTexture", _this.smokeTexture);
        _this.shadowTexture = _this.getEditorProperty("shadowTexture", _this.shadowTexture);
        _this.setEngineTorque = _this.getEditorProperty("setEngineTorque", _this.setEngineTorque);
        _this.topEngineSpeed = _this.getEditorProperty("topEngineSpeed", _this.topEngineSpeed);
        _this.lowSpeedAngle = _this.getEditorProperty("lowSpeedAngle", _this.lowSpeedAngle);
        _this.highSpeedAngle = _this.getEditorProperty("highSpeedAngle", _this.highSpeedAngle);
        _this.wheelDriveType = _this.getEditorProperty("wheelDriveType", _this.wheelDriveType);
        _this.maxBrakingForce = _this.getEditorProperty("maxBrakingForce", _this.maxBrakingForce);
        _this.handBrakingForce = _this.getEditorProperty("handBrakingForce", _this.handBrakingForce);
        _this.driftingInfluence = _this.getEditorProperty("driftingInfluence", _this.driftingInfluence);
        _this.wheelLockFriction = _this.getEditorProperty("wheelLockFriction", _this.wheelLockFriction);
        _this.lowSpeedIncrement = _this.getEditorProperty("lowSpeedIncrement", _this.lowSpeedIncrement);
        _this.highSpeedIncrement = _this.getEditorProperty("highSpeedIncrement", _this.highSpeedIncrement);
        _this.frontLeftWheelTrans = _this.getEditorProperty("frontLeftWheelMesh", _this.frontLeftWheelTrans);
        _this.frontRightWheelTrans = _this.getEditorProperty("frontRightWheelMesh", _this.frontRightWheelTrans);
        _this.backLeftWheelTrans = _this.getEditorProperty("rearLeftWheelMesh", _this.backLeftWheelTrans);
        _this.backRightWheelTrans = _this.getEditorProperty("rearRightWheelMesh", _this.backRightWheelTrans);
        _this.frontLeftWheelCollider = _this.getEditorProperty("frontLeftWheelCollider", _this.frontLeftWheelCollider);
        _this.frontRightWheelCollider = _this.getEditorProperty("frontRightWheelCollider", _this.frontRightWheelCollider);
        _this.backLeftWheelCollider = _this.getEditorProperty("rearLeftWheelCollider", _this.backLeftWheelCollider);
        _this.backRightWheelCollider = _this.getEditorProperty("rearRightWheelCollider", _this.backRightWheelCollider);
        _this.frictionSlipSpeed = _this.getEditorProperty("frictionSlipSpeed", _this.frictionSlipSpeed);
        _this.lerpEnginePitching = _this.getEditorProperty("lerpEnginePitching", _this.lerpEnginePitching);
        _this.differentialRatio = _this.getEditorProperty("gearBoxDifferential", _this.differentialRatio);
        _this.transmissionRatio = _this.getEditorProperty("gearBoxOverdrive", _this.transmissionRatio);
        _this.gearBoxShiftNext = _this.getEditorProperty("gearBoxShiftNext", _this.gearBoxShiftNext);
        _this.gearBoxShiftDown = _this.getEditorProperty("gearBoxShiftDown", _this.gearBoxShiftDown);
        _this.gearBoxShiftDelay = _this.getEditorProperty("gearBoxShiftDelay", _this.gearBoxShiftDelay);
        _this.gearBoxShiftRatios = _this.getEditorProperty("gearBoxShiftRatios", _this.gearBoxShiftRatios);
        _this.gearBoxShiftScales = _this.getEditorProperty("gearBoxShiftScales", _this.gearBoxShiftScales);
        if (_this.lowSpeedAngle <= 0)
            _this.lowSpeedAngle = 0.3;
        if (_this.highSpeedAngle <= 0)
            _this.highSpeedAngle = 0.0125;
        if (_this.lowSpeedIncrement <= 0)
            _this.lowSpeedIncrement = 0.0125;
        if (_this.highSpeedIncrement <= 0)
            _this.highSpeedIncrement = 0.0125;
        if (_this.lerpEnginePitching <= 0)
            _this.lerpEnginePitching = 5000;
        if (_this.gearBoxShiftNext <= 0)
            _this.gearBoxShiftNext = 3500;
        if (_this.gearBoxShiftDown <= 0)
            _this.gearBoxShiftNext = 2500;
        if (_this.gearBoxShiftDelay <= 0)
            _this.gearBoxShiftDelay = 0.3;
        if (_this.transmissionRatio <= 0)
            _this.transmissionRatio = 1;
        if (_this.differentialRatio <= 0)
            _this.differentialRatio = 1;
        if (_this.driftingInfluence <= 0)
            _this.driftingInfluence = 1;
        if (_this.frictionSlipSpeed <= 0)
            _this.frictionSlipSpeed = 1;
        if (_this.setEngineTorque != null) {
            // TODO: USE ENGINE TORQUE CURVES
            console.warn("Setup Engine Torque Animation");
            console.log(_this.setEngineTorque);
            //this.engineTorqueCurve = null;
        }
        return _this;
    }
    StandardCarController.prototype.getRaycastVehicle = function () { return this.raycastVehicle; };
    StandardCarController.prototype.getAbsoluteSpeed = function () { return this.absoluteSpeed; };
    StandardCarController.prototype.getNormalizedSpeed = function () { return this.normalizedSpeed; };
    StandardCarController.prototype.getCurrentGearIndex = function () { return this.gearIndex; };
    StandardCarController.prototype.getCurrentEngineRPM = function () { return this.engineRPM; };
    StandardCarController.prototype.getCurrentEnginePitch = function () { return BABYLON.Scalar.Clamp((this.lerpedRPM / this.lerpEnginePitching) + 0.1); };
    StandardCarController.prototype.getGearShiftRatioCount = function () { return (this.gearBoxShiftRatios != null) ? this.gearBoxShiftRatios.length : 0; };
    StandardCarController.prototype.start = function () { this.initVehicleState(); };
    StandardCarController.prototype.update = function () { this.updateVehicleState(); };
    StandardCarController.prototype.destroy = function () { this.destroyVehicleState(); };
    //////////////////////////////////////////////////
    // Protected Vehicle Movement State Functions //
    //////////////////////////////////////////////////
    StandardCarController.prototype.initVehicleState = function () {
        BABYLON.Utilities.ValidateTransformQuaternion(this.transform);
        // Setup Engine Audio
        this._engineAudioSource = this.getComponent("BABYLON.AudioSource");
        if (this._engineAudioSource == null)
            BABYLON.Tools.Warn("No engine audio source manager found for: " + this.transform.name);
        // Setup Raycast Vehicle
        this._rigidbody = this.getComponent("BABYLON.RigidbodyPhysics");
        if (this._rigidbody != null) {
            if (this._rigidbody.hasRaycastVehicle()) {
                this.raycastVehicle = this._rigidbody.getRaycastVehicle();
                if (this.raycastVehicle != null) {
                    var frontLeftWheelName = (this.frontLeftWheelTrans.name != null && this.frontLeftWheelTrans.name !== "") ? this.frontLeftWheelTrans.name : null;
                    var frontRightWheelName = (this.frontRightWheelTrans.name != null && this.frontRightWheelTrans.name !== "") ? this.frontRightWheelTrans.name : null;
                    var backLeftWheelName = (this.backLeftWheelTrans.name != null && this.backLeftWheelTrans.name !== "") ? this.backLeftWheelTrans.name : null;
                    var backRightWheelName = (this.backRightWheelTrans.name != null && this.backRightWheelTrans.name !== "") ? this.backRightWheelTrans.name : null;
                    var frontLeftWheelLabel = (this.frontLeftWheelCollider.name != null && this.frontLeftWheelCollider.name !== "") ? this.frontLeftWheelCollider.name : null;
                    var frontRightWheelLabel = (this.frontRightWheelCollider.name != null && this.frontRightWheelCollider.name !== "") ? this.frontRightWheelCollider.name : null;
                    var backLeftWheelLabel = (this.backLeftWheelCollider.name != null && this.backLeftWheelCollider.name !== "") ? this.backLeftWheelCollider.name : null;
                    var backRightWheelLabel = (this.backRightWheelCollider.name != null && this.backRightWheelCollider.name !== "") ? this.backRightWheelCollider.name : null;
                    // Get Wheel Indexs from Wheel Names
                    if (frontLeftWheelLabel != null)
                        this.FRONT_LEFT = this.raycastVehicle.getWheelIndexByName(frontLeftWheelLabel);
                    if (frontRightWheelLabel != null)
                        this.FRONT_RIGHT = this.raycastVehicle.getWheelIndexByName(frontRightWheelLabel);
                    if (backLeftWheelLabel != null)
                        this.BACK_LEFT = this.raycastVehicle.getWheelIndexByName(backLeftWheelLabel);
                    if (backRightWheelLabel != null)
                        this.BACK_RIGHT = this.raycastVehicle.getWheelIndexByName(backRightWheelLabel);
                    // Setup Wheel Info And Transform Meshes
                    if (this.raycastVehicle.getNumWheels() >= 4) {
                        if (this.FRONT_LEFT >= 0 && frontLeftWheelName != null) {
                            this.m_frontLeftWheel = this.raycastVehicle.getWheelInfo(this.FRONT_LEFT);
                            this.frontLeftWheelMesh = this.getChildTransform(frontLeftWheelName, BABYLON.SearchType.StartsWith, false);
                            if (this.frontLeftWheelMesh != null) {
                                this.raycastVehicle.setWheelTransformMesh(this.FRONT_LEFT, this.frontLeftWheelMesh);
                                this._skidFLAudioSource = BABYLON.SceneManager.FindScriptComponent(this.frontLeftWheelMesh, "BABYLON.AudioSource");
                                if (this._skidFLAudioSource == null)
                                    BABYLON.Tools.Warn("No front left skid audio source manager found for: " + this.transform.name);
                            }
                        }
                        if (this.FRONT_RIGHT >= 0 && frontRightWheelName != null) {
                            this.m_frontRightWheel = this.raycastVehicle.getWheelInfo(this.FRONT_RIGHT);
                            this.frontRightWheelMesh = this.getChildTransform(frontRightWheelName, BABYLON.SearchType.StartsWith, false);
                            if (this.frontRightWheelMesh != null) {
                                this.raycastVehicle.setWheelTransformMesh(this.FRONT_RIGHT, this.frontRightWheelMesh);
                                this._skidFRAudioSource = BABYLON.SceneManager.FindScriptComponent(this.frontRightWheelMesh, "BABYLON.AudioSource");
                                if (this._skidFRAudioSource == null)
                                    BABYLON.Tools.Warn("No front right skid audio source manager found for: " + this.transform.name);
                            }
                        }
                        if (this.BACK_LEFT >= 0 && backLeftWheelName != null) {
                            this.m_backLeftWheel = this.raycastVehicle.getWheelInfo(this.BACK_LEFT);
                            if (this.wheelRadius <= 0 && this.m_backLeftWheel != null) {
                                this.wheelRadius = this.m_backLeftWheel.get_m_wheelsRadius();
                            }
                            this.backLeftWheelMesh = this.getChildTransform(backLeftWheelName, BABYLON.SearchType.StartsWith, false);
                            if (this.backLeftWheelMesh != null) {
                                this.raycastVehicle.setWheelTransformMesh(this.BACK_LEFT, this.backLeftWheelMesh);
                                this._skidRLAudioSource = BABYLON.SceneManager.FindScriptComponent(this.backLeftWheelMesh, "BABYLON.AudioSource");
                                if (this._skidRLAudioSource == null)
                                    BABYLON.Tools.Warn("No rear left skid audio source manager found for: " + this.transform.name);
                            }
                        }
                        if (this.BACK_RIGHT >= 0 && backRightWheelName != null) {
                            this.m_backRightWheel = this.raycastVehicle.getWheelInfo(this.BACK_RIGHT);
                            if (this.wheelRadius <= 0 && this.m_backRightWheel != null) {
                                this.wheelRadius = this.m_backRightWheel.get_m_wheelsRadius();
                            }
                            this.backRightWheelMesh = this.getChildTransform(backRightWheelName, BABYLON.SearchType.StartsWith, false);
                            if (this.backRightWheelMesh != null) {
                                this.raycastVehicle.setWheelTransformMesh(this.BACK_RIGHT, this.backRightWheelMesh);
                                this._skidRRAudioSource = BABYLON.SceneManager.FindScriptComponent(this.backRightWheelMesh, "BABYLON.AudioSource");
                                if (this._skidRRAudioSource == null)
                                    BABYLON.Tools.Warn("No rear right skid audio source manager found for: " + this.transform.name);
                            }
                        }
                    }
                    else {
                        BABYLON.Tools.Warn("Invalid vehicle controller wheel count info for: " + this.transform.name);
                    }
                }
                else {
                    BABYLON.Tools.Warn("Failed to create vehicle controller for: " + this.transform.name);
                }
            }
            else {
                BABYLON.Tools.Warn("No wheel collider information found for: " + this.transform.name);
            }
        }
        else {
            BABYLON.Tools.Warn("Failed to get rigidbody component: " + this.transform.name);
        }
    };
    StandardCarController.prototype.updateVehicleState = function () {
        var deltaTime = this.getDeltaSeconds();
        if (this.shiftDelay > 0) {
            this.shiftDelay -= deltaTime;
        }
        if (this.shiftDelay <= 0) {
            this.shiftDelay = 0;
            this.shiftingGears = false;
        }
        if (this._rigidbody != null && this.raycastVehicle != null) {
            this.forwardSpeed = this.raycastVehicle.getRawCurrentSpeedKph();
            if (this.forwardSpeed < 0.2)
                this.forwardSpeed = 0;
            this.absoluteSpeed = this.raycastVehicle.getAbsCurrentSpeedKph();
            if (this.absoluteSpeed < 0.2)
                this.absoluteSpeed = 0;
            this.americanSpeed = (this.absoluteSpeed * BABYLON.System.Kph2Mph);
            this.normalizedSpeed = BABYLON.Scalar.Clamp((this.absoluteSpeed / this.topEngineSpeed));
            if (this.gearBoxShiftRatios != null && this.gearIndex >= 0 && this.gearIndex < this.getGearShiftRatioCount()) {
                var minimumDelta = Math.min(Math.max(deltaTime, 1 / 200), 1);
                var wheelDiameter = (this.wheelRadius * 2 * BABYLON.System.Meter2Inch);
                var finalGearRatio = (this.gearBoxShiftRatios[this.gearIndex] * this.differentialRatio * this.transmissionRatio);
                this.engineRPM = (this.americanSpeed * finalGearRatio * 336) / wheelDiameter + 1000;
                this.clutchSlip = BABYLON.Utilities.LerpClamp(this.clutchSlip, 0, 1 - Math.pow(0.01, minimumDelta));
                this.lerpedRPM = BABYLON.Utilities.LerpClamp(this.oldRPM, this.engineRPM, (1 - this.clutchSlip));
                if (this.engineRPM > this.gearBoxShiftNext && this.gearIndex > 1 && this.clutchSlip < 0.05) {
                    if (this.gearIndex < (this.getGearShiftRatioCount() - 1)) {
                        this.gearIndex++; // Gear Shift Up
                        this.clutchSlip = 1.0;
                        this.oldRPM = this.engineRPM;
                        this.shiftDelay = this.gearBoxShiftDelay;
                        this.shiftingGears = true;
                    }
                }
                else if (this.engineRPM < this.gearBoxShiftDown && this.gearIndex > 2 && this.clutchSlip < 0.05) {
                    this.gearIndex--; // Gear Shift Down
                    this.clutchSlip = 1.0;
                    this.oldRPM = this.engineRPM;
                    //this.shiftDelay = (this.gearBoxShiftDelay * 0.5);
                    //this.shiftingGears = true;
                }
            }
        }
        // Account for further movement since the last wheel update
        var velocityScale = SkidmarkManager.GetVelocityScale();
        if (velocityScale > 0.0 && this._rigidbody != null) {
            this.m_velocityOffset.copyFrom(this._rigidbody.getLinearVelocity());
            this.m_velocityOffset.scaleInPlace(velocityScale);
        }
        // Update Wheel Skidding Info
        var skidThreashold = 0.65;
        var skid_FL = 0, skid_FR = 0, skid_RL = 0, skid_RR = 0;
        if (this.m_frontLeftWheel != null) {
            skid_FL = BABYLON.Scalar.Clamp((1 - this.m_frontLeftWheel.get_m_skidInfo()));
            if (skid_FL < skidThreashold)
                skid_FL = 0;
            if (skid_FL > 0) {
                var contactPointFL = this.m_frontLeftWheel.get_m_raycastInfo().get_m_contactPointWS();
                var contactNormalFL = this.m_frontLeftWheel.get_m_raycastInfo().get_m_contactNormalWS();
                var skidPosFL = new BABYLON.Vector3(contactPointFL.x(), contactPointFL.y(), contactPointFL.z());
                var skidNormFL = new BABYLON.Vector3(contactNormalFL.x(), contactNormalFL.y(), contactNormalFL.z());
                var skidScaleFL = BABYLON.Scalar.Normalize(skid_FL, skidThreashold, 1.0);
                if (velocityScale > 0.0)
                    skidPosFL.addInPlace(this.m_velocityOffset);
                this.m_frontLeftWheelSkid = SkidmarkManager.AddSkidmarkSegment(skidPosFL, skidNormFL, skidScaleFL, this.m_frontLeftWheelSkid);
            }
            else {
                this.m_frontLeftWheelSkid = -1;
            }
        }
        if (this.m_frontRightWheel != null) {
            skid_FR = BABYLON.Scalar.Clamp((1 - this.m_frontRightWheel.get_m_skidInfo()));
            if (skid_FR < skidThreashold)
                skid_FR = 0;
            if (skid_FR > 0) {
                var contactPointFR = this.m_frontRightWheel.get_m_raycastInfo().get_m_contactPointWS();
                var contactNormalFR = this.m_frontRightWheel.get_m_raycastInfo().get_m_contactNormalWS();
                var skidPosFR = new BABYLON.Vector3(contactPointFR.x(), contactPointFR.y(), contactPointFR.z());
                var skidNormFR = new BABYLON.Vector3(contactNormalFR.x(), contactNormalFR.y(), contactNormalFR.z());
                var skidScaleFR = BABYLON.Scalar.Normalize(skid_FR, skidThreashold, 1.0);
                if (velocityScale > 0.0)
                    skidPosFR.addInPlace(this.m_velocityOffset);
                this.m_frontRightWheelSkid = SkidmarkManager.AddSkidmarkSegment(skidPosFR, skidNormFR, skidScaleFR, this.m_frontRightWheelSkid);
            }
            else {
                this.m_frontRightWheelSkid = -1;
            }
        }
        if (this.m_backLeftWheel != null) {
            skid_RL = BABYLON.Scalar.Clamp((1 - this.m_backLeftWheel.get_m_skidInfo()));
            if (skid_RL < skidThreashold)
                skid_RL = 0;
            if (skid_RL > 0) {
                var contactPointRL = this.m_backLeftWheel.get_m_raycastInfo().get_m_contactPointWS();
                var contactNormalRL = this.m_backLeftWheel.get_m_raycastInfo().get_m_contactNormalWS();
                var skidPosRL = new BABYLON.Vector3(contactPointRL.x(), contactPointRL.y(), contactPointRL.z());
                var skidNormRL = new BABYLON.Vector3(contactNormalRL.x(), contactNormalRL.y(), contactNormalRL.z());
                var skidScaleRL = BABYLON.Scalar.Normalize(skid_RL, skidThreashold, 1.0);
                if (velocityScale > 0.0)
                    skidPosRL.addInPlace(this.m_velocityOffset);
                this.m_backLeftWheelSkid = SkidmarkManager.AddSkidmarkSegment(skidPosRL, skidNormRL, skidScaleRL, this.m_backLeftWheelSkid);
            }
            else {
                this.m_backLeftWheelSkid = -1;
            }
        }
        if (this.m_backRightWheel != null) {
            skid_RR = BABYLON.Scalar.Clamp((1 - this.m_backRightWheel.get_m_skidInfo()));
            if (skid_RR < skidThreashold)
                skid_RR = 0;
            if (skid_RR > 0) {
                var contactPointRR = this.m_backRightWheel.get_m_raycastInfo().get_m_contactPointWS();
                var contactNormalRR = this.m_backRightWheel.get_m_raycastInfo().get_m_contactNormalWS();
                var skidPosRR = new BABYLON.Vector3(contactPointRR.x(), contactPointRR.y(), contactPointRR.z());
                var skidNormRR = new BABYLON.Vector3(contactNormalRR.x(), contactNormalRR.y(), contactNormalRR.z());
                var skidScaleRR = BABYLON.Scalar.Normalize(skid_RR, skidThreashold, 1.0);
                if (velocityScale > 0.0)
                    skidPosRR.addInPlace(this.m_velocityOffset);
                this.m_backRightWheelSkid = SkidmarkManager.AddSkidmarkSegment(skidPosRR, skidNormRR, skidScaleRR, this.m_backRightWheelSkid);
            }
            else {
                this.m_backRightWheelSkid = -1;
            }
        }
        // Update Engine And Wheel Pitch
        if (this._engineAudioSource != null) {
            var engineSoundClip = this._engineAudioSource.getSoundClip();
            if (engineSoundClip != null)
                engineSoundClip.setPlaybackRate(this.getCurrentEnginePitch() * 0.75);
        }
        if (this._skidFLAudioSource != null) {
            var skidFLSoundClip = this._skidFLAudioSource.getSoundClip();
            if (skidFLSoundClip != null)
                skidFLSoundClip.setPlaybackRate(skid_FL);
        }
        if (this._skidFRAudioSource != null) {
            var skidFRSoundClip = this._skidFRAudioSource.getSoundClip();
            if (skidFRSoundClip != null)
                skidFRSoundClip.setPlaybackRate(skid_FR);
        }
        if (this._skidRLAudioSource != null) {
            var skidRLSoundClip = this._skidRLAudioSource.getSoundClip();
            if (skidRLSoundClip != null)
                skidRLSoundClip.setPlaybackRate(skid_RL);
        }
        if (this._skidRRAudioSource != null) {
            var skidRRSoundClip = this._skidRRAudioSource.getSoundClip();
            if (skidRRSoundClip != null)
                skidRRSoundClip.setPlaybackRate(skid_RR);
        }
        //const msg:string = ("MPH: " + this.americanSpeed.toFixed(1) + " --> Skid Info - FL: " + skid_FL.toFixed(2) + " - FR: " + skid_FR.toFixed(2) + " - RL: " + skid_RL.toFixed(2) + " - RR: " + skid_RR.toFixed(2));
        //BABYLON.Utilities.PrintToScreen(msg, "#008000");
    };
    StandardCarController.prototype.destroyVehicleState = function () {
        this._rigidbody = null;
        this._engineAudioSource = null;
        this._skidFLAudioSource = null;
        this._skidFRAudioSource = null;
        this._skidRLAudioSource = null;
        this._skidRRAudioSource = null;
        if (this.m_frontLeftWheel != null) {
            Ammo.destroy(this.m_frontLeftWheel); // ???
            this.m_frontLeftWheel = null;
        }
        if (this.m_frontRightWheel != null) {
            Ammo.destroy(this.m_frontRightWheel); // ???
            this.m_frontRightWheel = null;
        }
        if (this.m_backLeftWheel != null) {
            Ammo.destroy(this.m_backLeftWheel); // ???
            this.m_backLeftWheel = null;
        }
        if (this.m_backRightWheel != null) {
            Ammo.destroy(this.m_backRightWheel); // ???
            this.m_backRightWheel = null;
        }
        this.m_physicsWorld = null;
        this.raycastVehicle = null;
        this.frontLeftWheelMesh = null;
        this.frontRightWheelMesh = null;
        this.backLeftWheelMesh = null;
        this.backRightWheelMesh = null;
        this.frontLeftWheelTrans = null;
        this.frontRightWheelTrans = null;
        this.backLeftWheelTrans = null;
        this.backRightWheelTrans = null;
        this.frontLeftWheelCollider = null;
        this.frontRightWheelCollider = null;
        this.backLeftWheelCollider = null;
        this.backRightWheelCollider = null;
    };
    /** Drives the raycast vehicle with the specfied movement and hand braking properties. */
    StandardCarController.prototype.drive = function (forward, turn, braking) {
        if (braking === void 0) { braking = false; }
        if (this._rigidbody == null || this.raycastVehicle == null)
            return;
        if (this.FRONT_LEFT >= 0 && this.FRONT_RIGHT >= 0 && this.BACK_LEFT >= 0 && this.BACK_RIGHT >= 0) {
            var deltaTime = this.getDeltaSeconds();
            this.brakingForce = 0;
            this.engineForce = 0;
            // ..
            // Update Gearing Box (TODO: Fix Start Gear Engine Sound)
            // ..
            var throttleAmount = 0;
            var brakingAmount = 0;
            if (forward > 0.1) { // Forward
                brakingAmount = 0;
                throttleAmount = Math.abs(forward);
            }
            else if (forward < 0.1) { // Reverse
                throttleAmount = 0;
                brakingAmount = Math.abs(forward);
            }
            if (this.absoluteSpeed >= 0.2) {
                if (this.gearIndex > 0) {
                    // TODO: Get Engine Curve Power
                }
                else {
                    // TODO: Get Engine Curve Power
                }
            }
            else {
                if (throttleAmount > 0.1) {
                    this.gearIndex = 2; // Set First Gear
                }
                else if (brakingAmount > 0.1) {
                    this.gearIndex = 0; // Set Reverse Gear
                }
                else {
                    this.gearIndex = 1; // Set Neutral Gear
                }
            }
            // ..
            // Update Engine Forces
            // ..
            var gearShiftScale = (this.gearBoxShiftScales != null && this.gearBoxShiftScales.length > this.gearIndex) ? this.gearBoxShiftScales[this.gearIndex] : 1.0;
            var gearShiftRatio = (this.gearBoxShiftRatios != null && this.gearBoxShiftRatios.length > this.gearIndex) ? this.gearBoxShiftRatios[this.gearIndex] : 1.0;
            var finalGearRatio = (gearShiftRatio * this.differentialRatio * this.transmissionRatio);
            var engineMotorTorque = this.getVehicleEngineTorque(this.engineRPM) * Math.abs(forward) * gearShiftScale;
            var allowedEnginePower = (engineMotorTorque * finalGearRatio);
            if (forward > 0.1) { // Forward
                if (this.forwardSpeed < -1)
                    this.brakingForce = this.maxBrakingForce;
                else
                    this.engineForce = allowedEnginePower;
            }
            else if (forward < -0.1) { // Reverse
                if (this.forwardSpeed > 1)
                    this.brakingForce = this.maxBrakingForce;
                else
                    this.engineForce = -(allowedEnginePower * this.maxReverseSpeed);
            }
            else {
                this.engineForce = 0;
                this.brakingForce = 10; // Static
            }
            if (this.shiftingGears === true || this.americanSpeed > this.topEngineSpeed)
                this.engineForce = 0;
            // ..
            // Update Turning Angle
            // ..
            this.steeringIncrement = BABYLON.Scalar.Lerp(this.lowSpeedIncrement, this.highSpeedIncrement, this.normalizedSpeed);
            this.allowedTurningAngle = BABYLON.Scalar.Lerp(this.lowSpeedAngle, this.highSpeedAngle, this.normalizedSpeed);
            if (turn > 0) { // Right
                if (this.vehicleSteer < this.allowedTurningAngle) {
                    this.vehicleSteer += (this.steeringIncrement);
                }
            }
            else if (turn < 0) { // Left
                if (this.vehicleSteer > -this.allowedTurningAngle) {
                    this.vehicleSteer -= (this.steeringIncrement);
                }
            }
            else {
                if (this.vehicleSteer < -this.steeringIncrement) {
                    this.vehicleSteer += this.steeringIncrement;
                }
                else {
                    if (this.vehicleSteer > this.steeringIncrement) {
                        this.vehicleSteer -= this.steeringIncrement;
                    }
                    else {
                        this.vehicleSteer = 0;
                    }
                }
            }
            // ..
            // Update Vehicle Controls
            // ..
            if (braking === true && this.handBrakingForce > 0) {
                if (this.americanSpeed > 20) {
                    var frontLockFriction = (this.wheelLockFriction > 0.01) ? (this.wheelLockFriction - 0.01) : this.wheelLockFriction;
                    if (this.m_frontLeftWheel != null && this.m_frontLeftWheel.defaultFriction != null) {
                        this.m_frontLeftWheel.set_m_frictionSlip(this.m_frontLeftWheel.defaultFriction * frontLockFriction);
                    }
                    if (this.m_frontRightWheel != null && this.m_frontRightWheel.defaultFriction != null) {
                        this.m_frontRightWheel.set_m_frictionSlip(this.m_frontLeftWheel.defaultFriction * frontLockFriction);
                    }
                    if (this.m_backLeftWheel != null && this.m_backLeftWheel.defaultFriction != null) {
                        this.m_backLeftWheel.set_m_frictionSlip(this.m_frontLeftWheel.defaultFriction * this.wheelLockFriction);
                    }
                    if (this.m_backRightWheel != null && this.m_backRightWheel.defaultFriction != null) {
                        this.m_backRightWheel.set_m_frictionSlip(this.m_frontLeftWheel.defaultFriction * this.wheelLockFriction);
                    }
                }
                this.updateCurrentFrictionSlip(deltaTime * this.frictionSlipSpeed);
                if (this.raycastVehicle.lockedWheelIndexes == null)
                    this.raycastVehicle.lockedWheelIndexes = [this.BACK_LEFT, this.BACK_RIGHT];
                this.raycastVehicle.setSteeringAngle(this.vehicleSteer, this.FRONT_LEFT);
                this.raycastVehicle.setSteeringAngle(this.vehicleSteer, this.FRONT_RIGHT);
                this.raycastVehicle.setEngineForce(0, this.FRONT_LEFT);
                this.raycastVehicle.setEngineForce(0, this.FRONT_RIGHT);
                this.raycastVehicle.setEngineForce(0, this.BACK_LEFT);
                this.raycastVehicle.setEngineForce(0, this.BACK_RIGHT);
                this.raycastVehicle.setBrakingForce(0, this.FRONT_LEFT);
                this.raycastVehicle.setBrakingForce(0, this.FRONT_RIGHT);
                this.raycastVehicle.setBrakingForce(this.handBrakingForce, this.BACK_LEFT);
                this.raycastVehicle.setBrakingForce(this.handBrakingForce, this.BACK_RIGHT);
                // ..
                // TODO: Support Angular Rotation Boost - ???
                // ..
                // let angularBoostFactor:number = 0; 
                // if (angularBoostFactor !== 0) {
                //    const angularVelocity:BABYLON.Vector3 = this._rigidbody.getAngularVelocity();
                //    angularVelocity.y += (angularBoostFactor * this.driftingInfluence);
                //    this._rigidbody.setAngularVelocity(angularVelocity);
                // }
            }
            else {
                //this.m_frontLeftWheel.set_m_frictionSlip(0);
                //this.m_frontRightWheel.set_m_frictionSlip(0);
                //this.m_backLeftWheel.set_m_frictionSlip(0.0);
                //this.m_backRightWheel.set_m_frictionSlip(0.0);
                this.updateCurrentFrictionSlip(deltaTime);
                if (this.raycastVehicle.lockedWheelIndexes != null)
                    this.raycastVehicle.lockedWheelIndexes = null;
                this.raycastVehicle.setSteeringAngle(this.vehicleSteer, this.FRONT_LEFT);
                this.raycastVehicle.setSteeringAngle(this.vehicleSteer, this.FRONT_RIGHT);
                if (this.wheelDriveType === 1 || this.wheelDriveType === 2) { // FRONT OR ALL WHEEL DRIVE
                    this.raycastVehicle.setEngineForce(this.engineForce, this.FRONT_LEFT);
                    this.raycastVehicle.setEngineForce(this.engineForce, this.FRONT_RIGHT);
                }
                if (this.wheelDriveType === 0 || this.wheelDriveType === 2) { // REAR OR ALL WHEEL DRIVE
                    this.raycastVehicle.setEngineForce(this.engineForce, this.BACK_LEFT);
                    this.raycastVehicle.setEngineForce(this.engineForce, this.BACK_RIGHT);
                }
                this.raycastVehicle.setBrakingForce(this.brakingForce * 0.5, this.FRONT_LEFT);
                this.raycastVehicle.setBrakingForce(this.brakingForce * 0.5, this.FRONT_RIGHT);
                this.raycastVehicle.setBrakingForce(this.brakingForce, this.BACK_LEFT);
                this.raycastVehicle.setBrakingForce(this.brakingForce, this.BACK_RIGHT);
            }
            // Trace Current Speed
            // const msg:string = ("Speed: " + this.americanSpeed.toFixed(1) + " --> Turn Angle: " + this.allowedTurningAngle.toFixed(4) + " --> Turn Increment: " + this.steeringIncrement.toFixed(4));
            // const msg:string = ("MPH: " + this.americanSpeed.toFixed(1) + " --> Gear Index: " + this.gearIndex.toFixed(0) + " --> Engine RPM: " + this.engineRPM.toFixed(0) + " ---> Engine Pitch: " + this.getCurrentEnginePitch().toFixed(2) + " ---> Clutch Slip: " + this.clutchSlip.toFixed(4) + " ---> Raw KPH: " + this.absoluteSpeed.toFixed(1));
            //const msg:string = ("Car Speed: " + this.americanSpeed.toFixed(1) + " --> Gear Index: " + this.gearIndex.toFixed(0) + " --> Engine RPM: " + this.engineRPM.toFixed(0) + " ---> Engine Toruqe: " + engineMotorTorque.toFixed(2)+ " ---> Engine Power: " + allowedEnginePower.toFixed(2));
            //BABYLON.Utilities.PrintToScreen(msg, "#008000");
        }
    };
    StandardCarController.prototype.getVehicleEngineTorque = function (rpm) {
        var result = 2000;
        //if (this.engineTorqueCurve != null) {
        //    result = 1000; // TODO: Sample Animation Curve
        //}
        //if (result <= 0) {
        //    result = 100;
        //}
        return result;
    };
    StandardCarController.prototype.updateCurrentFrictionSlip = function (deltaTime) {
        if (this.m_frontLeftWheel != null && this.m_frontLeftWheel.defaultFriction != null) {
            var frontLeftFriction = this.m_frontLeftWheel.get_m_frictionSlip();
            if (frontLeftFriction !== this.m_frontLeftWheel.defaultFriction) {
                frontLeftFriction = BABYLON.Scalar.Lerp(frontLeftFriction, this.m_frontLeftWheel.defaultFriction, deltaTime);
                this.m_frontLeftWheel.set_m_frictionSlip(frontLeftFriction);
            }
        }
        if (this.m_frontRightWheel != null && this.m_frontRightWheel.defaultFriction != null) {
            var frontRightFriction = this.m_frontRightWheel.get_m_frictionSlip();
            if (frontRightFriction !== this.m_frontRightWheel.defaultFriction) {
                frontRightFriction = BABYLON.Scalar.Lerp(frontRightFriction, this.m_frontRightWheel.defaultFriction, deltaTime);
                this.m_frontRightWheel.set_m_frictionSlip(frontRightFriction);
            }
        }
        if (this.m_backLeftWheel != null && this.m_backLeftWheel.defaultFriction != null) {
            var backLeftFriction = this.m_backLeftWheel.get_m_frictionSlip();
            if (backLeftFriction !== this.m_backLeftWheel.defaultFriction) {
                backLeftFriction = BABYLON.Scalar.Lerp(backLeftFriction, this.m_backLeftWheel.defaultFriction, deltaTime);
                this.m_backLeftWheel.set_m_frictionSlip(backLeftFriction);
            }
        }
        if (this.m_backRightWheel != null && this.m_backRightWheel.defaultFriction != null) {
            var backRightFriction = this.m_backRightWheel.get_m_frictionSlip();
            if (backRightFriction !== this.m_backRightWheel.defaultFriction) {
                backRightFriction = BABYLON.Scalar.Lerp(backRightFriction, this.m_backRightWheel.defaultFriction, deltaTime);
                this.m_backRightWheel.set_m_frictionSlip(backRightFriction);
            }
        }
    };
    return StandardCarController;
}(BABYLON.ScriptComponent));
/**
 * Babylon Script Component
 * @class VehicleInputController
 */
var VehicleInputController = /** @class */ (function (_super) {
    __extends(VehicleInputController, _super);
    function VehicleInputController(transform, scene, properties) {
        if (properties === void 0) { properties = {}; }
        var _this = _super.call(this, transform, scene, properties) || this;
        _this.playerDeltaX = 0;
        _this.playerDeltaY = 0;
        _this.playerMouseX = 0;
        _this.playerMouseY = 0;
        _this.enableInput = false;
        _this.attachCamera = false;
        _this.followBehind = true;
        _this.playerNumber = BABYLON.PlayerNumber.One;
        _this.triggerForward = BABYLON.Xbox360Trigger.Right;
        _this.keyboardForawrd = BABYLON.UserInputKey.W;
        _this.auxKeyboardForawrd = BABYLON.UserInputKey.UpArrow;
        _this.triggerBackwards = BABYLON.Xbox360Trigger.Left;
        _this.keyboardBackwards = BABYLON.UserInputKey.S;
        _this.auxKeyboardBackwards = BABYLON.UserInputKey.DownArrow;
        _this.buttonHandbrake = BABYLON.Xbox360Button.X;
        _this.keyboardHandbrake = BABYLON.UserInputKey.SpaceBar;
        //protected m_currentFollowSpeed:number = 0.1;
        //protected m_followTargetManager:BABYLON.FollowTargetManager = null;
        _this.m_standardCarController = null;
        _this.enableInput = _this.getEditorProperty("enableInput", _this.enableInput);
        _this.playerNumber = _this.getEditorProperty("playerNumber", _this.playerNumber);
        _this.attachCamera = _this.getEditorProperty("attachCamera", _this.attachCamera);
        _this.followBehind = _this.getEditorProperty("followBehind", _this.followBehind);
        return _this;
    }
    VehicleInputController.prototype.getPlayerDeltaX = function () { return this.playerDeltaX; };
    ;
    VehicleInputController.prototype.getPlayerDeltaY = function () { return this.playerDeltaY; };
    ;
    VehicleInputController.prototype.getPlayerMouseX = function () { return this.playerMouseX; };
    ;
    VehicleInputController.prototype.getPlayerMouseY = function () { return this.playerMouseY; };
    ;
    VehicleInputController.prototype.start = function () { this.initVehicleController(); };
    VehicleInputController.prototype.update = function () { this.updateVehicleController(); };
    VehicleInputController.prototype.after = function () { this.afterVehicleController(); };
    VehicleInputController.prototype.destroy = function () { this.destroyVehicleController(); };
    //////////////////////////////////////////////////
    // Protected Character Movement State Functions //
    //////////////////////////////////////////////////
    //protected m_cameraBoom:BABYLON.TransformNode = null;
    VehicleInputController.prototype.initVehicleController = function () {
        if (this.attachCamera === true) {
            //this.m_cameraBoom = BABYLON.Mesh.CreateBox("Camera Boom", 0.5, this.scene);
            //this.m_cameraBoom.parent = this.transform;
            //this.m_cameraBoom.position.set(0,1.5,0);
            //this.m_cameraBoom.rotationQuaternion = BABYLON.Utilities.FromEuler(0,0,0);
            //const transformCamera:BABYLON.TransformNode = BABYLON.SceneManager.GetTransformNode(this.scene, "Main Camera");
            /*
            //const transformCamera:BABYLON.TransformNode = BABYLON.UniversalCameraSystem.GetPlayerCameraTransform(this.playerNumber);
            const transformCamera:BABYLON.TransformNode = BABYLON.SceneManager.GetTransformNode(this.scene, "Main Camera");
            this.m_followTargetManager = new BABYLON.FollowTargetManager(transformCamera, this.getAbstractMesh());
            // Acceleration of camera in moving from current to goal position
            this.m_followTargetManager.followAcceleration = this.m_currentFollowSpeed;
            // The goal distance of camera from target
            this.m_followTargetManager.followDistance = 6;
            // The goal height of camera above local origin (centre) of target
            this.m_followTargetManager.heightOffset = 2;
            // The goal rotation of camera around local origin (centre) of target in x y plane
            this.m_followTargetManager.rotationOffset = 180;
            // The speed at which acceleration is halted
            this.m_followTargetManager.maxFollowSpeed = 10000;
            // The lower hight offset limit value
            this.m_followTargetManager.lowerHeightOffsetLimit = 1;
            */
            //
            var startPos = this.transform.position.clone();
            startPos.y += 2;
            startPos.z += -6;
            // ..
            var followCamera = new BABYLON.FollowCamera("FollowCam", startPos, this.scene);
            followCamera.cameraAcceleration = 0.06;
            followCamera.maxCameraSpeed = 1800;
            followCamera.rotationOffset = 180;
            followCamera.heightOffset = 2.0;
            followCamera.inertia = 40.0;
            followCamera.radius = 10;
            followCamera.lockedTarget = this.getAbstractMesh();
            followCamera.lowerHeightOffsetLimit = 1;
            this.scene.activeCamera = followCamera;
            //
        }
        this.m_standardCarController = this.getComponent("StandardCarController");
        if (this.m_standardCarController == null)
            BABYLON.Tools.Warn("Null standard car controller for: " + this.transform.name);
    };
    VehicleInputController.prototype.updateVehicleController = function () {
        if (this.m_standardCarController != null) {
            if (this.enableInput === true) {
                this.playerDeltaX = BABYLON.SceneManager.GetUserInput(BABYLON.UserInputAxis.Horizontal, this.playerNumber);
                this.playerDeltaY = BABYLON.SceneManager.GetUserInput(BABYLON.UserInputAxis.Vertical, this.playerNumber);
                this.playerMouseX = BABYLON.SceneManager.GetUserInput(BABYLON.UserInputAxis.MouseX, this.playerNumber);
                this.playerMouseY = BABYLON.SceneManager.GetUserInput(BABYLON.UserInputAxis.MouseY, this.playerNumber);
                if (Math.abs(this.playerDeltaX) <= BABYLON.UserInputOptions.GamepadDeadStickValue)
                    this.playerDeltaX = 0;
                if (Math.abs(this.playerDeltaY) <= BABYLON.UserInputOptions.GamepadDeadStickValue)
                    this.playerDeltaY = 0;
                if (Math.abs(this.playerMouseX) <= BABYLON.UserInputOptions.GamepadDeadStickValue)
                    this.playerMouseX = 0;
                if (Math.abs(this.playerMouseY) <= BABYLON.UserInputOptions.GamepadDeadStickValue)
                    this.playerMouseY = 0;
                var auxForwardKeyboard = BABYLON.SceneManager.GetKeyboardInput(this.auxKeyboardForawrd); // Player One Only
                var forwardKeyboard = BABYLON.SceneManager.GetKeyboardInput(this.keyboardForawrd); // Player One Only
                var forwardTrigger = BABYLON.SceneManager.GetGamepadTriggerInput(this.triggerForward, this.playerNumber);
                var auxBackwardKeyboard = BABYLON.SceneManager.GetKeyboardInput(this.auxKeyboardBackwards); // Player One Only
                var backwardKeyboard = BABYLON.SceneManager.GetKeyboardInput(this.keyboardBackwards); // Player One Only
                var backwardTrigger = BABYLON.SceneManager.GetGamepadTriggerInput(this.triggerBackwards, this.playerNumber);
                var handbrakeKeyboard = BABYLON.SceneManager.GetKeyboardInput(this.keyboardHandbrake); // Player One Only
                var handbrakeButton = BABYLON.SceneManager.GetGamepadButtonInput(this.buttonHandbrake, this.playerNumber);
                var playerMovement = 0;
                var playerSteering = 0;
                var playerHandbrake = false;
                // Primary Accelerattion
                if (forwardTrigger > 0.2)
                    playerMovement = forwardTrigger;
                else if (this.playerNumber === BABYLON.PlayerNumber.One && (forwardKeyboard === true || auxForwardKeyboard === true))
                    playerMovement = 1;
                // Braking Takes Precedence
                if (backwardTrigger > 0.2)
                    playerMovement = -backwardTrigger;
                else if (this.playerNumber === BABYLON.PlayerNumber.One && (backwardKeyboard === true || auxBackwardKeyboard === true))
                    playerMovement = -1;
                // Includes AD And Arrow Keys
                playerSteering = this.playerDeltaX;
                // Pull Hard Hand Brake Lever
                playerHandbrake = (handbrakeKeyboard === true || handbrakeButton === true);
                // Drive Standard Car Controller
                this.m_standardCarController.drive(playerMovement, playerSteering, playerHandbrake);
            }
        }
    };
    VehicleInputController.prototype.afterVehicleController = function () {
        if (this.attachCamera === true) {
            /*
            if (this.m_followTargetManager != null) {
                const targetDistance:number = this.m_followTargetManager.getTargetDistance();
                // ..
                // TODO: Calculate Smooth Follow Acceleration Speed
                // ..
                this.m_followTargetManager.followAcceleration = this.m_currentFollowSpeed;
                this.m_followTargetManager.update(this.followBehind, true);

                const msg:string = "Target Distance: " + targetDistance.toFixed(2) + " --> Follow Speed: " + this.m_currentFollowSpeed.toFixed(2);
                BABYLON.Utilities.PrintToScreen(msg, "#00FF00");
            }
            */
        }
    };
    VehicleInputController.prototype.destroyVehicleController = function () {
        this.m_standardCarController = null;
        /*
        if (this.m_followTargetManager != null) {
            this.m_followTargetManager.dispose();
            this.m_followTargetManager = null;
        }
        */
    };
    return VehicleInputController;
}(BABYLON.ScriptComponent));
/**
 * Babylon Script Component
 * @class ItemRotator
 */
var ItemRotator = /** @class */ (function (_super) {
    __extends(ItemRotator, _super);
    function ItemRotator(transform, scene, properties) {
        if (properties === void 0) { properties = {}; }
        var _this = _super.call(this, transform, scene, properties) || this;
        _this.rotateSpeed = 1.0;
        _this.rotateSpeed = _this.getEditorProperty("rotateSpeed", _this.rotateSpeed);
        return _this;
    }
    ItemRotator.prototype.start = function () {
        console.log("===> Starting item rotator for: " + this.transform.name);
    };
    ItemRotator.prototype.update = function () {
        var delta = this.getDeltaSeconds();
        this.transform.addRotation(0, (this.rotateSpeed * delta), 0);
    };
    ItemRotator.prototype.destroy = function () {
        console.log("===> Destroying item rotator for: " + this.transform.name);
    };
    return ItemRotator;
}(BABYLON.ScriptComponent));
/**
 * Babylon Script Component
 * @class TestAnimation
 */
var TestAnimation = /** @class */ (function (_super) {
    __extends(TestAnimation, _super);
    function TestAnimation(transform, scene, properties) {
        if (properties === void 0) { properties = {}; }
        var _this = _super.call(this, transform, scene, properties) || this;
        //private animator:BABYLON.AnimationState = null;
        _this.animator = null;
        return _this;
    }
    TestAnimation.prototype.start = function () {
        console.log("===> Starting animation test for: " + this.transform.name);
        this.animator = this.getComponent("BABYLON.AnimationState");
        if (this.animator == null) {
            BABYLON.Tools.Warn("Failed to get animation state component: " + this.transform.name);
        }
    };
    TestAnimation.prototype.update = function () {
        // Update render loop function
    };
    TestAnimation.prototype.after = function () {
        // After render loop function
    };
    TestAnimation.prototype.destroy = function () {
        // Destroy component function
    };
    return TestAnimation;
}(BABYLON.ScriptComponent));
/**
 * Babylon Script Component
 * @class TestCollision
 */
var TestCollision = /** @class */ (function (_super) {
    __extends(TestCollision, _super);
    function TestCollision(transform, scene, properties) {
        if (properties === void 0) { properties = {}; }
        var _this = _super.call(this, transform, scene, properties) || this;
        _this.rigidbody = null;
        return _this;
    }
    TestCollision.prototype.start = function () {
        var _this = this;
        // Start render loop function
        console.log("Test collision for: " + this.transform.name);
        this.rigidbody = this.getComponent("BABYLON.RigidbodyPhysics");
        if (this.rigidbody != null) {
            this.rigidbody.registerOnCollisionEnter(function (mesh) {
                var tag = BABYLON.SceneManager.GetTransformTag(mesh);
                console.log("###: " + _this.transform.name + ": Begin Contact With: " + mesh.name);
            });
            this.rigidbody.registerOnCollisionStay(function (mesh) {
                var tag = BABYLON.SceneManager.GetTransformTag(mesh);
                //console.log("###: " + this.transform.name + ": Update Contact With: " + mesh.name);
            });
            this.rigidbody.registerOnCollisionExit(function (mesh) {
                var tag = BABYLON.SceneManager.GetTransformTag(mesh);
                console.warn("###: " + _this.transform.name + ": End Contact With: " + mesh.name);
            });
        }
        else {
            console.warn("Failed to locate rigidbody component for: " + this.transform.name);
        }
    };
    TestCollision.prototype.update = function () {
        // Update render loop function
    };
    TestCollision.prototype.after = function () {
        // After render loop function
    };
    TestCollision.prototype.destroy = function () {
        // Destroy component function
    };
    return TestCollision;
}(BABYLON.ScriptComponent));
/**
 * Babylon Script Component
 * @class TestController
 */
var TestController = /** @class */ (function (_super) {
    __extends(TestController, _super);
    function TestController(transform, scene, properties) {
        if (properties === void 0) { properties = {}; }
        var _this = _super.call(this, transform, scene, properties) || this;
        _this.testTexture = null;
        _this.m_physicsWorld = null;
        _this.m_physicsEngine = null;
        _this.ran = false;
        _this.testTexture = _this.getEditorProperty("testTexture", _this.testTexture);
        return _this;
    }
    TestController.prototype.start = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                // Start render loop function
                console.log("===> Starting test controller...");
                this.m_physicsWorld = BABYLON.SceneManager.GetPhysicsWorld(this.scene);
                this.m_physicsEngine = BABYLON.SceneManager.GetPhysicsEngine(this.scene);
                return [2 /*return*/];
            });
        });
    };
    TestController.prototype.update = function () {
        // Update render loop function
        // const num_manifolds:number = this.m_physicsWorld.getBroadphase().getOverlappingPairCache().getNumOverlappingPairs();
        //const num_manifolds:number = this.m_physicsWorld.getDispatcher().getNumManifolds();
        //const msg = "Total Overlapping Paris: " + num_manifolds;
        //BABYLON.Utilities.PrintToScreen(msg);   
        // Test Running Loop
        //if (this.ran === false) {
        //    this.ran = true;
        //    
        //}
    };
    TestController.prototype.after = function () {
        // After render loop function
    };
    TestController.prototype.destroy = function () {
        // Destroy component function
    };
    return TestController;
}(BABYLON.ScriptComponent));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQmFieWxvblRvb2xraXQyMDE5LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vQXNzZXRzL0JhYnlsb24vW1Byb10vQ29udGVudC9EZWJ1Zy9EZWJ1Z0luZm9ybWF0aW9uLnRzIiwiLi4vQXNzZXRzL0JhYnlsb24vW1Byb10vQ29udGVudC9QaHlzaWNzL1NvZnRib2R5TWVzaC50cyIsIi4uL0Fzc2V0cy9CYWJ5bG9uL1tQcm9dL0NvbnRlbnQvUGxheWVycy9GaXJzdFBlcnNvbkNvbnRyb2xsZXIudHMiLCIuLi9Bc3NldHMvQmFieWxvbi9bUHJvXS9Db250ZW50L1BsYXllcnMvVGhpcmRQZXJzb25Db250cm9sbGVyLnRzIiwiLi4vQXNzZXRzL0JhYnlsb24vW1Byb10vQ29udGVudC9UZXN0aW5nL0JvdW5kaW5nQm94U2tpbnMudHMiLCIuLi9Bc3NldHMvQmFieWxvbi9bUHJvXS9Db250ZW50L1ZlaGljbGUvU2tpZG1hcmtNYW5hZ2VyLnRzIiwiLi4vQXNzZXRzL0JhYnlsb24vW1Byb10vQ29udGVudC9WZWhpY2xlL1N0YW5kYXJkQ2FyQ29udHJvbGxlci50cyIsIi4uL0Fzc2V0cy9CYWJ5bG9uL1tQcm9dL0NvbnRlbnQvVmVoaWNsZS9WZWhpY2xlSW5wdXRDb250cm9sbGVyLnRzIiwiLi4vQXNzZXRzL1NjcmlwdHMvSXRlbVJvdGF0b3IudHMiLCIuLi9Bc3NldHMvU2NyaXB0cy9UZXN0QW5pbWF0aW9uLnRzIiwiLi4vQXNzZXRzL1NjcmlwdHMvVGVzdENvbGxpc2lvbi50cyIsIi4uL0Fzc2V0cy9TY3JpcHRzL1Rlc3RDb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOzs7R0FHRztBQUNIO0lBQStCLG9DQUF1QjtJQU1sRCwwQkFBbUIsU0FBZ0MsRUFBRSxLQUFvQixFQUFFLFVBQW9CO1FBQXBCLDJCQUFBLEVBQUEsZUFBb0I7UUFBL0Ys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QztRQUM3RCxlQUFlLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDbkUsZUFBZSxDQUFDLG1CQUFtQixDQUFDLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ25FLEtBQUssR0FBRyxlQUFlLENBQUMsYUFBYSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDOUMsZUFBZSxDQUFDLG1CQUFtQixDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUM3RCxlQUFlLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDbkUsZUFBZSxDQUFDLG1CQUFtQixDQUFDLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ25FLEtBQUssR0FBRyxlQUFlLENBQUMsYUFBYSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDOUMsZUFBZSxDQUFDLG1CQUFtQixDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUM3RCxlQUFlLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDbkUsZUFBZSxDQUFDLG1CQUFtQixDQUFDLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ25FLEtBQUssR0FBRyxlQUFlLENBQUMsYUFBYSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDOUMsZUFBZSxDQUFDLG1CQUFtQixDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUM3RCxlQUFlLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDbkUsZUFBZSxDQUFDLG1CQUFtQixDQUFDLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ25FLEtBQUs7UUFDTCxpQ0FBaUM7UUFDakMsS0FBSztRQUNMLEtBQUssR0FBRyxlQUFlLENBQUMsYUFBYSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDOUMsZUFBZSxDQUFDLGlCQUFpQixDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUM3RCxlQUFlLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDbkUsZUFBZSxDQUFDLGlCQUFpQixDQUFDLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1FBQ25FLEtBQUssR0FBRyxlQUFlLENBQUMsYUFBYSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDOUMsZUFBZSxDQUFDLGlCQUFpQixDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUM3RCxlQUFlLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxLQUFLLEdB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QU8sQ0FBQyxZQUFZLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDdkUsSUFBSSxDQUFDLGVBQWUsR0FBRyxPQUFPLENBQUMsWUFBWSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQzs7OztLQWtHNUU7SUFHUywrQkFBTSxHQUFoQjtRQUNJLDhCQUE4QjtRQUM5Qix1SEFBdUg7UUFDdkgscUZBQXFGO1FBQ3JGLDBEQUEwRDtRQUMxRCwwQ0FBMEM7UUFDMUMsb0JBQW9CO1FBQ3BCLDJCQUEyQjtRQUMzQixzQkFBc0I7UUFDdEIsTUFBTTtRQUNOLEdBQUc7SUFDUCxDQUFDO0lBRVMsOEJBQUssR0FBZjtRQUNJLDZCQUE2QjtJQUNqQyxDQUFDO0lBRVMsZ0NBQU8sR0FBakI7UUFDSSw2QkFBNkI7SUFDakMsQ0FBQztJQUNMLHFCQUFDO0FBQUQsQ0FBQyxBQXRJRCxDQUE2QixPQUFPLENBQUMsZUFBZSxHQXNJbkQiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEJhYnlsb24gU2NyaXB0IENvbXBvbmVudFxuICogQGNsYXNzIERlYnVnSW5mb3JtYXRpb25cbiAqL1xuY2xhc3MgRGVidWdJbmZvcm1hdGlvbiBleHRlbmRzIEJBQllMT04uU2NyaXB0Q29tcG9uZW50IHtcbiAgICBwcml2YXRlIGtleXM6Ym9vbGVhbiA9IHRydWU7XG4gICAgcHJpdmF0ZSBzaG93OmJvb2xlYW4gPSB0cnVlO1xuICAgIHByaXZhdGUgcG9wdXA6Ym9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgdmlld3M6Ym9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgeGJveDpib29sZWFuID0gZmFsc2U7XG4gICAgcHVibGljIGNvbnN0cnVjdG9yKHRyYW5zZm9ybTogQkFCWUxPTi5UcmFuc2Zvcm1Ob2RlLCBzY2VuZTogQkFCWUxPTi5TY2VuZSwgcHJvcGVydGllczogYW55ID0ge30pIHtcbiAgICAgICAgc3VwZXIodHJhbnNmb3JtLCBzY2VuZSwgcHJvcGVydGllcyk7XG4gICAgICAgIHRoaXMua2V5cyA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJlbmFibGVEZWJ1Z0tleXNcIiwgdGhpcy5rZXlzKTtcbiAgICAgICAgdGhpcy5zaG93ID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcInNob3dEZWJ1Z0xhYmVsc1wiLCB0aGlzLnNob3cpO1xuICAgICAgICB0aGlzLnBvcHVwID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcInBvcHVwRGVidWdQYW5lbFwiLCB0aGlzLnBvcHVwKTtcbiAgICAgICAgdGhpcy52aWV3cyA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJ0b2dnbGVQbGF5ZXJWaWV3c1wiLCB0aGlzLnZpZXdzKTtcbiAgICAgICAgdGhpcy54Ym94ID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcImFsbG93WGJveExpdmVTaWduSW5cIiwgdGhpcy54Ym94KTtcbiAgICAgICAgLy8gLi5cbiAgICAgICAgaWYgKEJBQllMT04uU2NlbmVNYW5hZ2VyLklzV2luZG93cygpKSB0aGlzLnBvcHVwID0gZmFsc2U7XG4gICAgICAgIEJBQllMT04uVG9vbHMuTG9nKFwiRGVidWcgaW5mb3JtYXRpb24gb3ZlcmxheSBsb2FkZWRcIik7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHN0YXJ0KCkgOnZvaWQge1xuICAgICAgICAvL3RoaXMuc2NyZWVuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzY3JlZW5cIik7XG4gICAgICAgIC8vdGhpcy50b2dnbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvZ2dsZVwiKTtcbiAgICAgICAgLy90aGlzLnNpZ25pbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2lnbmluXCIpO1xuICAgICAgICAvL3RoaXMucmVsb2FkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZWxvYWRcIik7XG4gICAgICAgIC8vdGhpcy5tb3VzZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibW91c2VcIik7XG4gICAgICAgIC8vdGhpcy5kZWJ1ZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGVidWdcIik7XG4gICAgICAgIGlmICh0aGlzLnNob3cgPT09IHRydWUpIHtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICBpZiAodGhpcy5rZXlzID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFCQUJZTE9OLlNjZW5lTWFuYWdlci5Jc1hib3hPbmUoKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zY3JlZW4pIHRoaXMuc2NyZWVuLmlubmVySFRNTCA9IFwiRiAtIFNob3cgRnVsbCBTY3JlZW5cIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKEJBQllMT04uQ2FtZXJhU3lzdGVtLklzTXVsdGlQbGF5ZXJWaWV3KCkgJiYgdGhpcy52aWV3cyA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50b2dnbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChCQUJZTE9OLlNjZW5lTWFuYWdlci5Jc1hib3hPbmUoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlLnN0eWxlLnRvcCA9IFwiMjlweFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGUuaW5uZXJIVE1MID0gXCIxIC0gNCBUb2dnbGUgUGxheWVyIFZpZXdcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoQkFCWUxPTi5TY2VuZU1hbmFnZXIuSXNYYm94TGl2ZVBsdWdpbkVuYWJsZWQoKSAmJiB0aGlzLnhib3ggPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2lnbmluKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoQkFCWUxPTi5TY2VuZU1hbmFnZXIuSXNYYm94T25lKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNpZ25pbi5zdHlsZS50b3AgPSBcIjQ5cHhcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2lnbmluLmlubmVySFRNTCA9IFwiWCAtIFhib3ggTGl2ZSBTaWduIEluXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubW91c2UpIHRoaXMubW91c2UuaW5uZXJIVE1MID0gKEJBQllMT04uU2NlbmVNYW5hZ2VyLklzWGJveE9uZSgpKSA/IFwiTSAtIE1vdXNlXCIgOiBcIlwiO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlbG9hZCkgdGhpcy5yZWxvYWQuaW5uZXJIVE1MID0gXCJSIC0gUmVsb2FkXCI7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGVidWcpIHRoaXMuZGVidWcuaW5uZXJIVE1MID0gXCJQIC0gRGVidWdcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICovXG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMua2V5cyA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMudmlld3MgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVuYWJsZSBNdWx0aXBsYXllciBLZXlzXCIpO1xuICAgICAgICAgICAgICAgIEJBQllMT04uU2NlbmVNYW5hZ2VyLk9uS2V5Ym9hcmRQcmVzcyhCQUJZTE9OLlVzZXJJbnB1dEtleS5OdW0xLCAoKT0+e1xuICAgICAgICAgICAgICAgICAgICBCQUJZTE9OLlVuaXZlcnNhbENhbWVyYVN5c3RlbS5TZXRNdWx0aVBsYXllclZpZXdMYXlvdXQodGhpcy5zY2VuZSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiMSBwbGF5ZXIgcHJlc3NlZFwiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBCQUJZTE9OLlNjZW5lTWFuYWdlci5PbktleWJvYXJkUHJlc3MoQkFCWUxPTi5Vc2VySW5wdXRLZXkuTnVtMiwgKCk9PntcbiAgICAgICAgICAgICAgICAgICAgQkFCWUxPTi5Vbml2ZXJzYWxDYW1lcmFTeXN0ZW0uU2V0TXVsdGlQbGF5ZXJWaWV3TGF5b3V0KHRoaXMuc2NlbmUsIDIpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIjIgcGxheWVycyBwcmVzc2VkXCIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIEJBQllMT04uU2NlbmVNYW5hZ2VyLk9uS2V5Ym9hcmRQcmVzcyhCQUJZTE9OLlVzZXJJbnB1dEtleS5OdW0zLCAoKT0+e1xuICAgICAgICAgICAgICAgICAgICBCQUJZTE9OLlVuaXZlcnNhbENhbWVyYVN5c3RlbS5TZXRNdWx0aVBsYXllclZpZXdMYXlvdXQodGhpcy5zY2VuZSwgMyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiMyBwbGF5ZXJzIHByZXNzZWRcIik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgQkFCWUxPTi5TY2VuZU1hbmFnZXIuT25LZXlib2FyZFByZXNzKEJBQllMT04uVXNlcklucHV0S2V5Lk51bTQsICgpPT57XG4gICAgICAgICAgICAgICAgICAgIEJBQllMT04uVW5pdmVyc2FsQ2FtZXJhU3lzdGVtLlNldE11bHRpUGxheWVyVmlld0xheW91dCh0aGlzLnNjZW5lLCA0KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCI0IHBsYXllcnMgcHJlc3NlZFwiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIEJBQllMT04uU2NlbmVNYW5hZ2VyLk9uS2V5Ym9hcmRQcmVzcyhCQUJZTE9OLlVzZXJJbnB1dEtleS5SLCAoKT0+e1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgQkFCWUxPTi5TY2VuZU1hbmFnZXIuT25LZXlib2FyZFByZXNzKEJBQllMT04uVXNlcklucHV0S2V5LkksICgpPT57XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucG9wdXAgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgQkFCWUxPTi5TY2VuZU1hbmFnZXIuUG9wdXBEZWJ1Zyh0aGlzLnNjZW5lKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBCQUJZTE9OLlNjZW5lTWFuYWdlci5Ub2dnbGVEZWJ1Zyh0aGlzLnNjZW5lLCB0cnVlLCBudWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChCQUJZTE9OLlNjZW5lTWFuYWdlci5Jc1hib3hPbmUoKSkge1xuICAgICAgICAgICAgICAgIGlmIChuYXZpZ2F0b3IuZ2FtZXBhZElucHV0RW11bGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIEJBQllMT04uU2NlbmVNYW5hZ2VyLk9uS2V5Ym9hcmRQcmVzcyhCQUJZTE9OLlVzZXJJbnB1dEtleS5NLCAoKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hdmlnYXRvci5nYW1lcGFkSW5wdXRFbXVsYXRpb24gIT09IFwibW91c2VcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRvci5nYW1lcGFkSW5wdXRFbXVsYXRpb24gPSBcIm1vdXNlXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRvci5nYW1lcGFkSW5wdXRFbXVsYXRpb24gPSBcImdhbWVwYWRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBCQUJZTE9OLlNjZW5lTWFuYWdlci5PbktleWJvYXJkUHJlc3MoQkFCWUxPTi5Vc2VySW5wdXRLZXkuRiwgKCk9PntcbiAgICAgICAgICAgICAgICAgICAgLy9CQUJZTE9OLlRvb2xzLlJlcXVlc3RGdWxsc2NyZWVuKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NlbmUuZ2V0RW5naW5lKCkuZW50ZXJGdWxsc2NyZWVuKHRydWUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKEJBQllMT04uV2luZG93c1BsYXRmb3JtLklzWGJveExpdmVQbHVnaW5FbmFibGVkKCkgJiYgdGhpcy54Ym94ID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgQkFCWUxPTi5TY2VuZU1hbmFnZXIuT25LZXlib2FyZFByZXNzKEJBQllMT04uVXNlcklucHV0S2V5LlgsICgpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBwbGF5ZXI6QkFCWUxPTi5QbGF5ZXJOdW1iZXIuT25lID0gQkFCWUxPTi5QbGF5ZXJOdW1iZXIuT25lO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIUJBQllMT04uV2luZG93c1BsYXRmb3JtLklzWGJveExpdmVVc2VyU2lnbmVkSW4obnVsbCwgcGxheWVyKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQkFCWUxPTi5Ub29scy5Mb2coXCI9PT0+IFRyeWluZyBYYm94IExpdmUgU2lnbiBJbiBGb3IgUGxheWVyOiBcIiArIHBsYXllci50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIEJBQllMT04uV2luZG93c1BsYXRmb3JtLlhib3hMaXZlVXNlclNpZ25JbihwbGF5ZXIsIChyZXN1bHQ6IE1pY3Jvc29mdC5YYm94LlNlcnZpY2VzLlN5c3RlbS5TaWduSW5SZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlciA9IEJBQllMT04uV2luZG93c1BsYXRmb3JtLkdldFhib3hMaXZlVXNlcihwbGF5ZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtc2cgPSBcIihcIiArIHVzZXIueGJveFVzZXJJZCArIFwiKSAtIFwiICsgdXNlci5nYW1lcnRhZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBCQUJZTE9OLlNjZW5lTWFuYWdlci5BbGVydE1lc3NhZ2UobXNnLCBcIlhib3ggTGl2ZSBVc2VyIFNpZ25lZCBJblwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIChlcnIpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbXNnOnN0cmluZyA9IFwiRW5jb3VudGVyZWQgU2lnbiBFcnJvclwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJBQllMT04uVG9vbHMuV2Fybihtc2cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJBQllMT04uU2NlbmVNYW5hZ2VyLkFsZXJ0TWVzc2FnZShtc2csIFwiWGJveCBMaXZlIFdhcm5pbmdcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEJBQllMT04uVG9vbHMuV2FybihcIlhib3ggTGl2ZSBVc2VyIEFscmVhZHkgU2lnbmVkIEluXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQkFCWUxPTi5TY2VuZU1hbmFnZXIuQWxlcnRNZXNzYWdlKFwiVXNlciBBbHJlYWR5IFNpZ25lZCBJblwiLCBcIlhib3ggTGl2ZSBXYXJuaW5nXCIpO1xuICAgICAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIERlZmF1bHQgUHJpbnQgVG8gU2NyZWVuIFRleHRcbiAgICAgICAgdmFyIHByaW50Q29sb3I6c3RyaW5nID0gKHRoaXMuc2NlbmUuZ2V0RW5naW5lKCkud2ViR0xWZXJzaW9uIDwgMikgPyBcInJlZFwiIDogXCIjMGMwXCI7XG4gICAgICAgIHZhciBncmFwaGljc1ZlcnNpb246c3RyaW5nID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuR2V0V2ViR0xWZXJzaW9uU3RyaW5nKHRoaXMuc2NlbmUpO1xuICAgICAgICBCQUJZTE9OLlV0aWxpdGllcy5QcmludFRvU2NyZWVuKGdyYXBoaWNzVmVyc2lvbiwgcHJpbnRDb2xvcik7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGRlc3Ryb3koKSA6dm9pZCB7XG4gICAgICAgIC8vdGhpcy5zY3JlZW4gPSBudWxsO1xuICAgICAgICAvL3RoaXMudG9nZ2xlID0gbnVsbDtcbiAgICAgICAgLy90aGlzLnNpZ25pbiA9IG51bGw7XG4gICAgICAgIC8vdGhpcy5yZWxvYWQgPSBudWxsO1xuICAgICAgICAvL3RoaXMubW91c2UgPSBudWxsO1xuICAgICAgICAvL3RoaXMuZGVidWcgPSBudWxsO1xuICAgIH1cbn0iLCIvKipcbiAqIEJhYnlsb24gU2NyaXB0IENvbXBvbmVudFxuICogQGNsYXNzIFNvZnRib2R5TWVzaFxuICovXG5jbGFzcyBTb2Z0Ym9keU1lc2ggZXh0ZW5kcyBCQUJZTE9OLlNjcmlwdENvbXBvbmVudCB7XG4gICAgcHVibGljIGNvbnN0cnVjdG9yKHRyYW5zZm9ybTogQkFCWUxPTi5UcmFuc2Zvcm1Ob2RlLCBzY2VuZTogQkFCWUxPTi5TY2VuZSwgcHJvcGVydGllczogYW55ID0ge30pIHtcbiAgICAgICAgc3VwZXIodHJhbnNmb3JtLCBzY2VuZSwgcHJvcGVydGllcyk7XG5cbiAgICAgICAgY29uc3QgdHlwZTpudW1iZXIgPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwidHlwZVwiLCAwKTtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgIG1hc3M6IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJtYXNzXCIsIDEpLFxuICAgICAgICAgICAgZnJpY3Rpb246IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJmcmljdGlvblwiLCAwLjMpLFxuICAgICAgICAgICAgcmVzdGl0dXRpb246IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJyZXN0aXR1dGlvblwiLCAwLjMpLFxuICAgICAgICAgICAgcHJlc3N1cmU6IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJwcmVzc3VyZVwiLCAyMDApLFxuICAgICAgICAgICAgdmVsb2NpdHlJdGVyYXRpb25zOiB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwidmVsb2NpdHlJdGVyYXRpb25zXCIsIDIwKSwgXG4gICAgICAgICAgICBwb3NpdGlvbkl0ZXJhdGlvbnM6IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJwb3NpdGlvbkl0ZXJhdGlvbnNcIiwgMjApLFxuICAgICAgICAgICAgc3RpZmZuZXNzOiB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwic3RpZmZuZXNzXCIsIDEpLFxuICAgICAgICAgICAgbWFyZ2luOiB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwibWFyZ2luXCIsIDAuMCksXG4gICAgICAgICAgICBkYW1waW5nOiB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwiZGFtcGluZ1wiLCAwLjAxKVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbWVzaDpCQUJZTE9OLk1lc2ggPSB0aGlzLmdldFRyYW5zZm9ybU1lc2goKTtcbiAgICAgICAgY29uc3QgZm9yY2VTaGFyZWRWZXJ0aWNlczpib29sZWFuID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcImZvcmNlU2hhcmVkVmVydGljZXNcIiwgdHJ1ZSk7XG4gICAgICAgIGlmIChmb3JjZVNoYXJlZFZlcnRpY2VzID09PSB0cnVlKSBtZXNoLmZvcmNlU2hhcmVkVmVydGljZXMoKTtcblxuICAgICAgICBjb25zdCBpbmNyZWFzZVZlcnRpY2VzOm51bWJlciA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJpbmNyZWFzZVZlcnRpY2VzXCIsIDQpO1xuICAgICAgICBpZiAoaW5jcmVhc2VWZXJ0aWNlcyA+IDApIG1lc2guaW5jcmVhc2VWZXJ0aWNlcyhpbmNyZWFzZVZlcnRpY2VzKTtcbiAgICBcbiAgICAgICAgbGV0IGltcG9zdG9yOkJBQllMT04uUGh5c2ljc0ltcG9zdG9yID0gbnVsbDtcbiAgICAgICAgaWYgKHR5cGUgPT09IDApIHsgLy8gTWVzaFxuICAgICAgICAgICAgaW1wb3N0b3IgPSBuZXcgQkFCWUxPTi5QaHlzaWNzSW1wb3N0b3IobWVzaCwgQkFCWUxPTi5QaHlzaWNzSW1wb3N0b3IuU29mdGJvZHlJbXBvc3Rvciwgb3B0aW9ucywgdGhpcy5zY2VuZSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gMSkgeyAvLyBDbG90aFxuICAgICAgICAgICAgaW1wb3N0b3IgPSBuZXcgQkFCWUxPTi5QaHlzaWNzSW1wb3N0b3IobWVzaCwgQkFCWUxPTi5QaHlzaWNzSW1wb3N0b3IuQ2xvdGhJbXBvc3Rvciwgb3B0aW9ucywgdGhpcy5zY2VuZSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gMikgIHsgLy8gUm9wZVxuICAgICAgICAgICAgaW1wb3N0b3IgPSBuZXcgQkFCWUxPTi5QaHlzaWNzSW1wb3N0b3IobWVzaCwgQkFCWUxPTi5QaHlzaWNzSW1wb3N0b3IuUm9wZUltcG9zdG9yLCBvcHRpb25zLCB0aGlzLnNjZW5lKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW1wb3N0b3IgIT0gbnVsbCkge1xuICAgICAgICAgICAgaW1wb3N0b3IuZXhlY3V0ZU5hdGl2ZUZ1bmN0aW9uKCh3b3JkOmFueSwgYm9keTphbnkpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBTZXR1cCBOYXRpdmUgU29mdGJvZHkgUGh5c2ljcyBPcHRpb25zXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBzdGFydCgpOiB2b2lkIHtcbiAgICAgICAgLy8gU3RhcnQgcmVuZGVyIGxvb3AgZnVuY3Rpb25cbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgdXBkYXRlKCk6IHZvaWQge1xuICAgICAgICAvLyBVcGRhdGUgcmVuZGVyIGxvb3AgZnVuY3Rpb25cbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgYWZ0ZXIoKTogdm9pZCB7XG4gICAgICAgIC8vIEFmdGVyIHJlbmRlciBsb29wIGZ1bmN0aW9uXG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgICAgIC8vIERlc3Ryb3kgY29tcG9uZW50IGZ1bmN0aW9uXG4gICAgfVxufSIsIi8qKlxuICogQmFieWxvbiBTY3JpcHQgQ29tcG9uZW50XG4gKiBAY2xhc3MgRmlyc3RQZXJzb25Db250cm9sbGVyXG4gKi9cbmNsYXNzIEZpcnN0UGVyc29uQ29udHJvbGxlciBleHRlbmRzIEJBQllMT04uU2NyaXB0Q29tcG9uZW50IHtcbiAgICBwcml2YXRlIGRlbHRhRmFjdG9yOm51bWJlciA9IDIuMDtcbiAgICBwcml2YXRlIGF0dGFjaENhbWVyYTpib29sZWFuID0gdHJ1ZTtcbiAgICBwcml2YXRlIGNhbWVyYVBpdm90OkJBQllMT04uVHJhbnNmb3JtTm9kZSA9IG51bGw7XG4gICAgcHJpdmF0ZSBjYW1lcmFSaWdnZXI6QkFCWUxPTi5UcmFuc2Zvcm1Ob2RlID0gbnVsbDtcbiAgICBwcml2YXRlIG1vdmVtZW50U3BlZWQ6bnVtYmVyID0gMS4wO1xuICAgIHByaXZhdGUganVtcGluZ1ZlbG9jaXR5Om51bWJlciA9IDEwLjA7XG4gICAgcHJpdmF0ZSBwbGF5ZXJNb3ZlbWVudDpCQUJZTE9OLlZlY3RvcjMgPSBCQUJZTE9OLlZlY3RvcjMuWmVybygpO1xuICAgIHByaXZhdGUgcGxheWVyVHVyblJhdGU6bnVtYmVyID0gMC4wO1xuICAgIHByaXZhdGUgY2FtZXJhUGl0Y2hSYXRlOm51bWJlciA9IDAuMDtcblx0cHJpdmF0ZSBob3J6U2Vuc2l0aXZpdHk6bnVtYmVyID0gMS4wO1xuICAgIHByaXZhdGUgdmVydFNlbnNpdGl2aXR5Om51bWJlciA9IDEuMDtcbiAgICBwcml2YXRlIG1vdXNlU2Vuc2l0aXZpdHk6bnVtYmVyID0gMS4wO1xuICAgIHByaXZhdGUgbWluaW11bVBpdGNoQW5nbGU6bnVtYmVyID0gLTYwLjA7XG4gICAgcHJpdmF0ZSBtYXhpbXVtUGl0Y2hBbmdsZTpudW1iZXIgPSA2MC4wO1xuICAgIHByaXZhdGUgaXNDaGFyYWN0ZXJHcm91bmRlZDpib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBpc0NoYXJhY3Rlckp1bXBGcmFtZTpib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBjYW1lcmFFdWxlckFuZ2xlczpCQUJZTE9OLlZlY3RvcjMgPSBCQUJZTE9OLlZlY3RvcjMuWmVybygpO1xuICAgIHByaXZhdGUgY2hhcmFjdGVyQ29udHJvbGxlcjpCQUJZTE9OLkNoYXJhY3RlckNvbnRyb2xsZXIgPSBudWxsO1xuXG4gICAgcHVibGljIGlzQ2hhcmFjdGVySnVtcGluZygpOmJvb2xlYW4geyByZXR1cm4gZmFsc2U7IC8qIFRPRE86IERldGVybWluZSBJZiBDaGFyYWN0ZXIgSXMgSnVtcGluZyAtID8/PyAqLyB9XG4gICAgcHVibGljIGlzQ2hhcmFjdGVyRmFsbGluZygpOmJvb2xlYW4geyByZXR1cm4gZmFsc2U7IC8qIFRPRE86IERldGVybWluZSBJZiBDaGFyYWN0ZXIgSXMgRmFsbGluZyAtID8/PyAqLyB9XG5cbiAgICBwdWJsaWMgYnV0dG9uSnVtcDpudW1iZXIgPSBCQUJZTE9OLlhib3gzNjBCdXR0b24uQTtcbiAgICBwdWJsaWMga2V5Ym9hcmRKdW1wOm51bWJlciA9IEJBQllMT04uVXNlcklucHV0S2V5LlNwYWNlQmFyO1xuICAgIHB1YmxpYyBwbGF5ZXJOdW1iZXI6QkFCWUxPTi5QbGF5ZXJOdW1iZXIgPSBCQUJZTE9OLlBsYXllck51bWJlci5PbmU7XG4gICAgcHVibGljIHBsYXllckRlbHRhWDpudW1iZXIgPSAwLjA7XG4gICAgcHVibGljIHBsYXllckRlbHRhWjpudW1iZXIgPSAwLjA7XG4gICAgcHVibGljIHBsYXllck1vdXNlWDpudW1iZXIgPSAwLjA7XG4gICAgcHVibGljIHBsYXllck1vdXNlWTpudW1iZXIgPSAwLjA7XG4gICAgcHVibGljIHBsYXllckV5ZUxldmVsOm51bWJlciA9IDAuNTtcbiAgICBwdWJsaWMgZ2V0Q2hhcmFjdGVyQ29udHJvbGxlcigpOkJBQllMT04uQ2hhcmFjdGVyQ29udHJvbGxlciB7IHJldHVybiB0aGlzLmNoYXJhY3RlckNvbnRyb2xsZXI7IH1cbiAgICBwdWJsaWMgY29uc3RydWN0b3IodHJhbnNmb3JtOiBCQUJZTE9OLlRyYW5zZm9ybU5vZGUsIHNjZW5lOiBCQUJZTE9OLlNjZW5lLCBwcm9wZXJ0aWVzOiBhbnkgPSB7fSkge1xuICAgICAgICBzdXBlcih0cmFuc2Zvcm0sIHNjZW5lLCBwcm9wZXJ0aWVzKTtcbiAgICAgICAgdGhpcy5hdHRhY2hDYW1lcmEgPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwiYXR0YWNoQ2FtZXJhXCIsIHRoaXMuYXR0YWNoQ2FtZXJhKTtcbiAgICAgICAgdGhpcy5wbGF5ZXJOdW1iZXIgPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwicGxheWVyTnVtYmVyXCIsIHRoaXMucGxheWVyTnVtYmVyKTtcbiAgICAgICAgdGhpcy5wbGF5ZXJFeWVMZXZlbCA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJwbGF5ZXJFeWVMZXZlbFwiLCB0aGlzLnBsYXllckV5ZUxldmVsKTtcbiAgICAgICAgdGhpcy5tb3ZlbWVudFNwZWVkID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcIm1vdmVtZW50U3BlZWRcIiwgdGhpcy5tb3ZlbWVudFNwZWVkKTtcbiAgICAgICAgdGhpcy5tb3VzZVNlbnNpdGl2aXR5ID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcIm1vdXNlU2Vuc2l0aXZpdHlcIiwgdGhpcy5tb3VzZVNlbnNpdGl2aXR5KVxuICAgICAgICB0aGlzLm1pbmltdW1QaXRjaEFuZ2xlID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcIm1pbmltdW1QaXRjaEFuZ2xlXCIsIHRoaXMubWluaW11bVBpdGNoQW5nbGUpO1xuICAgICAgICB0aGlzLm1heGltdW1QaXRjaEFuZ2xlID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcIm1heGltdW1QaXRjaEFuZ2xlXCIsIHRoaXMubWF4aW11bVBpdGNoQW5nbGUpO1xuICAgICAgICB0aGlzLnZlcnRTZW5zaXRpdml0eSA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJ2ZXJ0aWNhbFNlbnNpdGl2aXR5XCIsIHRoaXMudmVydFNlbnNpdGl2aXR5KTtcbiAgICAgICAgdGhpcy5ob3J6U2Vuc2l0aXZpdHkgPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwiaG9yaXpvbnRhbFNlbnNpdGl2aXR5XCIsIHRoaXMuaG9yelNlbnNpdGl2aXR5KVxuICAgICAgICB0aGlzLmp1bXBpbmdWZWxvY2l0eSA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJpbXB1bHNlSnVtcFZlbG9jaXR5XCIsIHRoaXMuanVtcGluZ1ZlbG9jaXR5KTtcbiAgICAgICAgLy8gU2NhbGUgTW91c2UgUG9pbnRlciBTZW5zaXRpdml0eVxuICAgICAgICBpZiAodGhpcy5wbGF5ZXJOdW1iZXIgPT0gQkFCWUxPTi5QbGF5ZXJOdW1iZXIuT25lKSB7XG4gICAgICAgICAgICBCQUJZTE9OLlVzZXJJbnB1dE9wdGlvbnMuUG9pbnRlckFuZ3VsYXJTZW5zaWJpbGl0eSA9IChCQUJZTE9OLlVzZXJJbnB1dE9wdGlvbnMuUG9pbnRlckFuZ3VsYXJTZW5zaWJpbGl0eSAqIHRoaXMubW91c2VTZW5zaXRpdml0eSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgc3RhcnQoKTogdm9pZCB7IHRoaXMuc2V0dXBGaXJzdFBlcnNvbkNvbnRyb2xsZXIoKTsgfVxuICAgIHByb3RlY3RlZCB1cGRhdGUoKTogdm9pZCB7IHRoaXMudXBkYXRlRmlyc3RQZXJzb25Db250cm9sbGVyKCk7IH1cbiAgICBwcm90ZWN0ZWQgZGVzdHJveSgpOiB2b2lkIHsgdGhpcy5kZXN0cm95Rmlyc3RQZXJzb25Db250cm9sbGVyKCk7IH1cblxuICAgIHByaXZhdGUgc2V0dXBGaXJzdFBlcnNvbkNvbnRyb2xsZXIoKTp2b2lkIHtcbiAgICAgICAgLy8gU2V0dXAgQ2FtZXJhIEFhdHRhY2htZW50c1xuICAgICAgICB0aGlzLmNhbWVyYVBpdm90ID0gdGhpcy5nZXRDaGlsZFRyYW5zZm9ybShcIlBpdm90XCIpO1xuICAgICAgICBpZiAodGhpcy5jYW1lcmFQaXZvdCA9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmNhbWVyYVBpdm90ID0gbmV3IEJBQllMT04uVHJhbnNmb3JtTm9kZShcIlBpdm90XCIsIHRoaXMuc2NlbmUpO1xuICAgICAgICAgICAgdGhpcy5jYW1lcmFQaXZvdC5zZXRQYXJlbnQodGhpcy50cmFuc2Zvcm0pO1xuICAgICAgICAgICAgdGhpcy5jYW1lcmFQaXZvdC5wb3NpdGlvbiA9IG5ldyBCQUJZTE9OLlZlY3RvcjMoMC4wLCB0aGlzLnBsYXllckV5ZUxldmVsLCAwLjApOyAvLyBOT1RFOiBQT1NJVElPTiBDQU1FUkEgRVlFIExFVkVMIChUTyBTRUUgQVJNUylcbiAgICAgICAgfVxuICAgICAgICBCQUJZTE9OLlV0aWxpdGllcy5WYWxpZGF0ZVRyYW5zZm9ybVF1YXRlcm5pb24odGhpcy5jYW1lcmFQaXZvdCk7XG4gICAgICAgIFxuICAgICAgICAvL2NvbnNvbGUubG9nKFwiQXR0YWNoIENhbWVyYSBGb3I6IFwiICsgdGhpcy50cmFuc2Zvcm0ubmFtZSArIFwiIC0tPiBcIiArIHRoaXMuYXR0YWNoQ2FtZXJhLnRvU3RyaW5nKCkpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMudHJhbnNmb3JtLm1ldGFkYXRhKTtcblxuICAgICAgICBpZiAodGhpcy5hdHRhY2hDYW1lcmEgPT09IHRydWUpIHtcbiAgICAgICAgICAgIC8vIFRPRE86IENyZWF0ZSBNdWx0aSBQbGF5ZXIgQ2FtZXJhIChObyBBdHRhY2ggQ2FtZXJhKVxuICAgICAgICAgICAgdGhpcy5jYW1lcmFSaWdnZXIgPSBCQUJZTE9OLlNjZW5lTWFuYWdlci5HZXRUcmFuc2Zvcm1Ob2RlKHRoaXMuc2NlbmUsIFwiTWFpbiBDYW1lcmFcIik7XG4gICAgICAgICAgICBpZiAodGhpcy5jYW1lcmFSaWdnZXIgIT0gbnVsbCAmJiB0aGlzLmNhbWVyYVBpdm90ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbWVyYVBpdm90LnBvc2l0aW9uID0gbmV3IEJBQllMT04uVmVjdG9yMygwLjAsIHRoaXMucGxheWVyRXllTGV2ZWwsIDAuMCk7IC8vIE5PVEU6IFBPU0lUSU9OIENBTUVSQSBFWUUgTEVWRUwgKFRPIFNFRSBBUk1TKVxuICAgICAgICAgICAgICAgIHRoaXMuY2FtZXJhUmlnZ2VyLnNldFBhcmVudCh0aGlzLmNhbWVyYVBpdm90KTtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbWVyYVJpZ2dlci5wb3NpdGlvbiA9IG5ldyBCQUJZTE9OLlZlY3RvcjMoMC4wLCAwLjAsIDAuMCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW1lcmFSaWdnZXIucm90YXRpb25RdWF0ZXJuaW9uID0gQkFCWUxPTi5RdWF0ZXJuaW9uLklkZW50aXR5KCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJGUEM6IEF0dGFjaGVkIG1haW4gY2FtZXJhIHRvIHBsYXllciBjb250cm9sbGVyOiBcIiArIHRoaXMudHJhbnNmb3JtLm5hbWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBCQUJZTE9OLlRvb2xzLldhcm4oXCJGYWlsZWQgdG8gbG9jYXRlIGNhbWVyYSBvciBsb2NhbCBwaXZvdCBmb3I6IFwiICsgdGhpcy50cmFuc2Zvcm0ubmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2V0dXAgQ2hhcmFjdGVyIENvbnRyb2xsZXJcbiAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb250cm9sbGVyID0gdGhpcy5nZXRDb21wb25lbnQoXCJCQUJZTE9OLkNoYXJhY3RlckNvbnRyb2xsZXJcIik7XG4gICAgICAgIGlmICh0aGlzLmNoYXJhY3RlckNvbnRyb2xsZXIgPT0gbnVsbCkgQkFCWUxPTi5Ub29scy5XYXJuKFwiRmFpbGVkIHRvIGxvY2F0ZSBjaGFyYWN0ZXIgY29udHJvbGxlciBmb3I6IFwiICsgdGhpcy50cmFuc2Zvcm0ubmFtZSk7XG5cbiAgICAgICAgLy8gQ2hhcmFjdGVyIENvbGxpc2lvbiBDb250YWN0IChURVNUKVxuICAgICAgICBpZiAodGhpcy5jaGFyYWN0ZXJDb250cm9sbGVyICE9IG51bGwpIHtcblxuICAgICAgICAgICAgLy8gVGVzdCBTdGF0aWMgT25seSBDb2xsaXNpb25zXG4gICAgICAgICAgICAvLyB0aGlzLmNoYXJhY3RlckNvbnRyb2xsZXIuc2V0Q29sbGlzaW9uRmlsdGVyTWFzayhCQUJZTE9OLkNvbGxpc2lvbkZpbHRlcnMuU3RhdGljRmlsdGVyKTtcblxuICAgICAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb250cm9sbGVyLnJlZ2lzdGVyT25Db2xsaXNpb25FbnRlcigobWVzaDpCQUJZTE9OLkFic3RyYWN0TWVzaCk9PntcbiAgICAgICAgICAgICAgICBjb25zdCB0YWc6c3RyaW5nID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuR2V0VHJhbnNmb3JtVGFnKG1lc2gpO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJQTEFZRVI6ID09PT4gR290IENvbGxpc2lvbiBFbnRlciBFdmVudDogXCIgKyBtZXNoLm5hbWUgKyBcIiAtLT4gXCIgKyB0YWcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmNoYXJhY3RlckNvbnRyb2xsZXIucmVnaXN0ZXJPbkNvbGxpc2lvblN0YXkoKG1lc2g6QkFCWUxPTi5BYnN0cmFjdE1lc2gpPT57XG4gICAgICAgICAgICAgICAgY29uc3QgdGFnOnN0cmluZyA9IEJBQllMT04uU2NlbmVNYW5hZ2VyLkdldFRyYW5zZm9ybVRhZyhtZXNoKTtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiUExBWUVSOiA9PT0+IEdvdCBDb2xsaXNpb24gU3RheSBFdmVudDogXCIgKyBtZXNoLm5hbWUgKyBcIiAtLT4gXCIgKyB0YWcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmNoYXJhY3RlckNvbnRyb2xsZXIucmVnaXN0ZXJPbkNvbGxpc2lvbkV4aXQoKG1lc2g6QkFCWUxPTi5BYnN0cmFjdE1lc2gpPT57XG4gICAgICAgICAgICAgICAgY29uc3QgdGFnOnN0cmluZyA9IEJBQllMT04uU2NlbmVNYW5hZ2VyLkdldFRyYW5zZm9ybVRhZyhtZXNoKTtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUud2FybihcIlBMQVlFUiA9PT0+IERFU1RST1k6IENvbGxpc2lvbiBFeGl0IEV2ZW50OiBcIiArIG1lc2gubmFtZSArIFwiIC0tPiBcIiArIHRhZyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlRmlyc3RQZXJzb25Db250cm9sbGVyKCk6dm9pZCB7XG4gICAgICAgIGNvbnN0IGRlbHRhVGltZTpudW1iZXIgPSB0aGlzLmdldERlbHRhU2Vjb25kcygpO1xuICAgICAgICB0aGlzLnBsYXllckRlbHRhWCA9IEJBQllMT04uU2NlbmVNYW5hZ2VyLkdldFVzZXJJbnB1dChCQUJZTE9OLlVzZXJJbnB1dEF4aXMuSG9yaXpvbnRhbCwgdGhpcy5wbGF5ZXJOdW1iZXIpO1xuICAgICAgICB0aGlzLnBsYXllckRlbHRhWiA9IEJBQllMT04uU2NlbmVNYW5hZ2VyLkdldFVzZXJJbnB1dChCQUJZTE9OLlVzZXJJbnB1dEF4aXMuVmVydGljYWwsIHRoaXMucGxheWVyTnVtYmVyKTtcbiAgICAgICAgdGhpcy5wbGF5ZXJNb3VzZVggPSBCQUJZTE9OLlNjZW5lTWFuYWdlci5HZXRVc2VySW5wdXQoQkFCWUxPTi5Vc2VySW5wdXRBeGlzLk1vdXNlWCwgdGhpcy5wbGF5ZXJOdW1iZXIpO1xuICAgICAgICB0aGlzLnBsYXllck1vdXNlWSA9IEJBQllMT04uU2NlbmVNYW5hZ2VyLkdldFVzZXJJbnB1dChCQUJZTE9OLlVzZXJJbnB1dEF4aXMuTW91c2VZLCB0aGlzLnBsYXllck51bWJlcik7XG4gICAgICAgIFxuICAgICAgICAvLyBVcGRhdGUgRGVhZCBJbnB1dCBWYWx1ZXNcbiAgICAgICAgaWYgKE1hdGguYWJzKHRoaXMucGxheWVyRGVsdGFYKSA8PSBCQUJZTE9OLlVzZXJJbnB1dE9wdGlvbnMuR2FtZXBhZERlYWRTdGlja1ZhbHVlKSB0aGlzLnBsYXllckRlbHRhWCA9IDA7XG4gICAgICAgIGlmIChNYXRoLmFicyh0aGlzLnBsYXllckRlbHRhWikgPD0gQkFCWUxPTi5Vc2VySW5wdXRPcHRpb25zLkdhbWVwYWREZWFkU3RpY2tWYWx1ZSkgdGhpcy5wbGF5ZXJEZWx0YVogPSAwO1xuICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5wbGF5ZXJNb3VzZVgpIDw9IEJBQllMT04uVXNlcklucHV0T3B0aW9ucy5HYW1lcGFkRGVhZFN0aWNrVmFsdWUpIHRoaXMucGxheWVyTW91c2VYID0gMDtcbiAgICAgICAgaWYgKE1hdGguYWJzKHRoaXMucGxheWVyTW91c2VZKSA8PSBCQUJZTE9OLlVzZXJJbnB1dE9wdGlvbnMuR2FtZXBhZERlYWRTdGlja1ZhbHVlKSB0aGlzLnBsYXllck1vdXNlWSA9IDA7XG5cbiAgICAgICAgLy8gVXBkYXRlIENoYXJhY3RlciBNb3ZlbWVudFxuICAgICAgICBpZiAodGhpcy5jaGFyYWN0ZXJDb250cm9sbGVyICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuaXNDaGFyYWN0ZXJHcm91bmRlZCA9IHRoaXMuY2hhcmFjdGVyQ29udHJvbGxlci5pc0dyb3VuZGVkKCk7XG4gICAgICAgICAgICB0aGlzLmlzQ2hhcmFjdGVySnVtcEZyYW1lID0gZmFsc2U7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFJvdGF0ZSBQbGF5ZXIgTGVmdCBBbmQgUmlnaHQgV2l0aCBNb3VzZS1YXG4gICAgICAgICAgICB0aGlzLnBsYXllclR1cm5SYXRlID0gKHRoaXMucGxheWVyTW91c2VYICogKHRoaXMuaG9yelNlbnNpdGl2aXR5ICogdGhpcy5kZWx0YUZhY3RvcikpO1xuICAgICAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb250cm9sbGVyLnR1cm4odGhpcy5wbGF5ZXJUdXJuUmF0ZSk7XG5cbiAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgICAgICAgICAgLy8gRlBDOiBQaXRjaCBDYW1lcmEgUGl2b3QgVXAgQW5kIERvd24gV2l0aCBNb3VzZS1ZXG4gICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgICAgIHRoaXMuY2FtZXJhUGl0Y2hSYXRlID0gKHRoaXMucGxheWVyTW91c2VZICogKHRoaXMudmVydFNlbnNpdGl2aXR5ICogdGhpcy5kZWx0YUZhY3RvcikpO1xuICAgICAgICAgICAgdGhpcy5jYW1lcmFQaXZvdC5yb3RhdGUoQkFCWUxPTi5BeGlzLlgsIC0odGhpcy5jYW1lcmFQaXRjaFJhdGUgKiBCQUJZTE9OLlN5c3RlbS5EZWcyUmFkKSwgQkFCWUxPTi5TcGFjZS5MT0NBTCk7XG4gICAgICAgICAgICBCQUJZTE9OLlV0aWxpdGllcy5Ub0V1bGVyVG9SZWYodGhpcy5jYW1lcmFQaXZvdC5yb3RhdGlvblF1YXRlcm5pb24sIHRoaXMuY2FtZXJhRXVsZXJBbmdsZXMpO1xuICAgICAgICAgICAgdGhpcy5jYW1lcmFFdWxlckFuZ2xlcy54ID0gQkFCWUxPTi5TY2FsYXIuQ2xhbXAodGhpcy5jYW1lcmFFdWxlckFuZ2xlcy54LCB0aGlzLm1pbmltdW1QaXRjaEFuZ2xlLCB0aGlzLm1heGltdW1QaXRjaEFuZ2xlKTtcbiAgICAgICAgICAgIEJBQllMT04uVXRpbGl0aWVzLkZyb21FdWxlclRvUmVmKHRoaXMuY2FtZXJhRXVsZXJBbmdsZXMueCwgdGhpcy5jYW1lcmFFdWxlckFuZ2xlcy55LCB0aGlzLmNhbWVyYUV1bGVyQW5nbGVzLnosIHRoaXMuY2FtZXJhUGl2b3Qucm90YXRpb25RdWF0ZXJuaW9uKTtcbiAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgICAgICAvLyBVcGRhdGUgUGxheWVyIElucHV0IFdpdGggRGVsdGEtWCBBbmQgRGVsdGEtWlxuICAgICAgICAgICAgaWYgKHRoaXMuaXNDaGFyYWN0ZXJHcm91bmRlZCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyTW92ZW1lbnQueCA9IHRoaXMucGxheWVyRGVsdGFYO1xuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyTW92ZW1lbnQueSA9IDAuMDtcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXllck1vdmVtZW50LnogPSB0aGlzLnBsYXllckRlbHRhWjtcbiAgICAgICAgICAgICAgICB0aGlzLmlzQ2hhcmFjdGVySnVtcEZyYW1lID0gKEJBQllMT04uU2NlbmVNYW5hZ2VyLkdldEtleWJvYXJkSW5wdXQodGhpcy5rZXlib2FyZEp1bXApIHx8IEJBQllMT04uU2NlbmVNYW5hZ2VyLkdldEdhbWVwYWRCdXR0b25JbnB1dCh0aGlzLmJ1dHRvbkp1bXApKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBUcmFuc2Zvcm0gTW92ZW1lbnQgRGlyZWN0aW9uIEFuZCBTY2FsZSBTcGVlZFxuICAgICAgICAgICAgICAgIEJBQllMT04uVXRpbGl0aWVzLlRyYW5zZm9ybURpcmVjdGlvblRvUmVmKHRoaXMudHJhbnNmb3JtLCB0aGlzLnBsYXllck1vdmVtZW50LCB0aGlzLnBsYXllck1vdmVtZW50KTtcbiAgICAgICAgICAgICAgICBCQUJZTE9OLlZlY3RvcjMuTm9ybWFsaXplVG9SZWYodGhpcy5wbGF5ZXJNb3ZlbWVudCwgdGhpcy5wbGF5ZXJNb3ZlbWVudCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXJNb3ZlbWVudC5zY2FsZUluUGxhY2UoKEJBQllMT04uU3lzdGVtLldhbGtpbmdWZWxvY2l0eSAqIHRoaXMubW92ZW1lbnRTcGVlZCkgKiBkZWx0YVRpbWUpO1xuXG4gICAgICAgICAgICAgICAgLy8gTW92ZSBQbGF5ZXIgVXNpbmcgUGh5c2ljcyBDaGFyYWN0ZXIgQ29udHJvbGxlclxuICAgICAgICAgICAgICAgIHRoaXMuY2hhcmFjdGVyQ29udHJvbGxlci5tb3ZlKHRoaXMucGxheWVyTW92ZW1lbnQpO1xuXG4gICAgICAgICAgICAgICAgLy8gSnVtcCBQbGF5ZXIgVXNpbmcgUGh5c2ljcyBDaGFyYWN0ZXIgQ29udHJvbGxlclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzQ2hhcmFjdGVySnVtcEZyYW1lID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhcmFjdGVyQ29udHJvbGxlci5qdW1wKHRoaXMuanVtcGluZ1ZlbG9jaXR5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSBkZXN0cm95Rmlyc3RQZXJzb25Db250cm9sbGVyKCk6dm9pZCB7XG4gICAgICAgIHRoaXMuY2FtZXJhUGl2b3QgPSBudWxsO1xuICAgICAgICB0aGlzLmNhbWVyYVJpZ2dlciA9IG51bGw7XG4gICAgICAgIHRoaXMuY2hhcmFjdGVyQ29udHJvbGxlciA9IG51bGw7XG4gICAgfVxufSIsIi8qKlxuICogQmFieWxvbiBTY3JpcHQgQ29tcG9uZW50XG4gKiBAY2xhc3MgVGhpcmRQZXJzb25Db250cm9sbGVyXG4gKi9cbmNsYXNzIFRoaXJkUGVyc29uQ29udHJvbGxlciBleHRlbmRzIEJBQllMT04uU2NyaXB0Q29tcG9uZW50IHtcbiAgICBwcml2YXRlIGRlbHRhRmFjdG9yOm51bWJlciA9IDIuMDtcbiAgICBwcml2YXRlIGF0dGFjaENhbWVyYTpib29sZWFuID0gdHJ1ZTtcbiAgICBwcml2YXRlIGNhbWVyYVBpdm90OkJBQllMT04uVHJhbnNmb3JtTm9kZSA9IG51bGw7XG4gICAgcHJpdmF0ZSBjYW1lcmFSaWdnZXI6QkFCWUxPTi5UcmFuc2Zvcm1Ob2RlID0gbnVsbDtcbiAgICBwcml2YXRlIG1vdmVtZW50U3BlZWQ6bnVtYmVyID0gMS4wO1xuICAgIHByaXZhdGUganVtcGluZ1ZlbG9jaXR5Om51bWJlciA9IDEwLjA7XG4gICAgcHJpdmF0ZSBwbGF5ZXJNb3ZlbWVudDpCQUJZTE9OLlZlY3RvcjMgPSBCQUJZTE9OLlZlY3RvcjMuWmVybygpO1xuICAgIHByaXZhdGUgcGxheWVyVHVyblJhdGU6bnVtYmVyID0gMC4wO1xuICAgIHByaXZhdGUgY2FtZXJhUGl0Y2hSYXRlOm51bWJlciA9IDAuMDtcblx0cHJpdmF0ZSBob3J6U2Vuc2l0aXZpdHk6bnVtYmVyID0gMS4wO1xuICAgIHByaXZhdGUgdmVydFNlbnNpdGl2aXR5Om51bWJlciA9IDEuMDtcbiAgICBwcml2YXRlIG1vdXNlU2Vuc2l0aXZpdHk6bnVtYmVyID0gMS4wO1xuICAgIHByaXZhdGUgbWluaW11bVBpdGNoQW5nbGU6bnVtYmVyID0gLTYwLjA7XG4gICAgcHJpdmF0ZSBtYXhpbXVtUGl0Y2hBbmdsZTpudW1iZXIgPSA2MC4wO1xuICAgIHByaXZhdGUgaXNDaGFyYWN0ZXJHcm91bmRlZDpib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBpc0NoYXJhY3Rlckp1bXBGcmFtZTpib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBjaGFyYWN0ZXJDb250cm9sbGVyOkJBQllMT04uQ2hhcmFjdGVyQ29udHJvbGxlciA9IG51bGw7XG5cbiAgICBwdWJsaWMgYnV0dG9uSnVtcDpudW1iZXIgPSBCQUJZTE9OLlhib3gzNjBCdXR0b24uQTtcbiAgICBwdWJsaWMga2V5Ym9hcmRKdW1wOm51bWJlciA9IEJBQllMT04uVXNlcklucHV0S2V5LlNwYWNlQmFyO1xuICAgIHB1YmxpYyBwbGF5ZXJOdW1iZXI6QkFCWUxPTi5QbGF5ZXJOdW1iZXIgPSBCQUJZTE9OLlBsYXllck51bWJlci5PbmU7XG4gICAgcHVibGljIHBsYXllckRlbHRhWDpudW1iZXIgPSAwLjA7XG4gICAgcHVibGljIHBsYXllckRlbHRhWjpudW1iZXIgPSAwLjA7XG4gICAgcHVibGljIHBsYXllck1vdXNlWDpudW1iZXIgPSAwLjA7XG4gICAgcHVibGljIHBsYXllck1vdXNlWTpudW1iZXIgPSAwLjA7XG4gICAgcHVibGljIGdldENoYXJhY3RlckNvbnRyb2xsZXIoKTpCQUJZTE9OLkNoYXJhY3RlckNvbnRyb2xsZXIgeyByZXR1cm4gdGhpcy5jaGFyYWN0ZXJDb250cm9sbGVyOyB9XG4gICAgcHVibGljIGNvbnN0cnVjdG9yKHRyYW5zZm9ybTogQkFCWUxPTi5UcmFuc2Zvcm1Ob2RlLCBzY2VuZTogQkFCWUxPTi5TY2VuZSwgcHJvcGVydGllczogYW55ID0ge30pIHtcbiAgICAgICAgc3VwZXIodHJhbnNmb3JtLCBzY2VuZSwgcHJvcGVydGllcyk7XG4gICAgICAgIHRoaXMuYXR0YWNoQ2FtZXJhID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcImF0dGFjaENhbWVyYVwiLCB0aGlzLmF0dGFjaENhbWVyYSk7XG4gICAgICAgIHRoaXMucGxheWVyTnVtYmVyID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcInBsYXllck51bWJlclwiLCB0aGlzLnBsYXllck51bWJlcilcbiAgICAgICAgdGhpcy5tb3ZlbWVudFNwZWVkID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcIm1vdmVtZW50U3BlZWRcIiwgdGhpcy5tb3ZlbWVudFNwZWVkKTtcbiAgICAgICAgdGhpcy5tb3VzZVNlbnNpdGl2aXR5ID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcIm1vdXNlU2Vuc2l0aXZpdHlcIiwgdGhpcy5tb3VzZVNlbnNpdGl2aXR5KVxuICAgICAgICB0aGlzLm1pbmltdW1QaXRjaEFuZ2xlID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcIm1pbmltdW1QaXRjaEFuZ2xlXCIsIHRoaXMubWluaW11bVBpdGNoQW5nbGUpO1xuICAgICAgICB0aGlzLm1heGltdW1QaXRjaEFuZ2xlID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcIm1heGltdW1QaXRjaEFuZ2xlXCIsIHRoaXMubWF4aW11bVBpdGNoQW5nbGUpO1xuICAgICAgICB0aGlzLnZlcnRTZW5zaXRpdml0eSA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJ2ZXJ0aWNhbFNlbnNpdGl2aXR5XCIsIHRoaXMudmVydFNlbnNpdGl2aXR5KTtcbiAgICAgICAgdGhpcy5ob3J6U2Vuc2l0aXZpdHkgPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwiaG9yaXpvbnRhbFNlbnNpdGl2aXR5XCIsIHRoaXMuaG9yelNlbnNpdGl2aXR5KVxuICAgICAgICB0aGlzLmp1bXBpbmdWZWxvY2l0eSA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJpbXB1bHNlSnVtcFZlbG9jaXR5XCIsIHRoaXMuanVtcGluZ1ZlbG9jaXR5KTtcbiAgICAgICAgLy8gU2NhbGUgTW91c2UgUG9pbnRlciBTZW5zaXRpdml0eVxuICAgICAgICBpZiAodGhpcy5wbGF5ZXJOdW1iZXIgPT0gQkFCWUxPTi5QbGF5ZXJOdW1iZXIuT25lKSB7XG4gICAgICAgICAgICBCQUJZTE9OLlVzZXJJbnB1dE9wdGlvbnMuUG9pbnRlckFuZ3VsYXJTZW5zaWJpbGl0eSA9IChCQUJZTE9OLlVzZXJJbnB1dE9wdGlvbnMuUG9pbnRlckFuZ3VsYXJTZW5zaWJpbGl0eSAqIHRoaXMubW91c2VTZW5zaXRpdml0eSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgc3RhcnQoKTogdm9pZCB7IHRoaXMuc2V0dXBUaGlyZFBlcnNvbkNvbnRyb2xsZXIoKTsgfVxuICAgIHByb3RlY3RlZCB1cGRhdGUoKTogdm9pZCB7IHRoaXMudXBkYXRlVGhpcmRQZXJzb25Db250cm9sbGVyKCk7IH1cbiAgICBwcm90ZWN0ZWQgZGVzdHJveSgpOiB2b2lkIHsgdGhpcy5kZXN0cm95VGhpcmRQZXJzb25Db250cm9sbGVyKCk7IH1cblxuICAgIHByaXZhdGUgc2V0dXBUaGlyZFBlcnNvbkNvbnRyb2xsZXIoKTogdm9pZCB7XG4gICAgICAgIC8vIFNldHVwIENhbWVyYSBBdHRhY2htZW50c1xuICAgICAgICB0aGlzLmNhbWVyYVBpdm90ID0gdGhpcy5nZXRDaGlsZFRyYW5zZm9ybShcIlBpdm90XCIpO1xuICAgICAgICBpZiAodGhpcy5jYW1lcmFQaXZvdCA9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmNhbWVyYVBpdm90ID0gbmV3IEJBQllMT04uVHJhbnNmb3JtTm9kZShcIlBpdm90XCIsIHRoaXMuc2NlbmUpO1xuICAgICAgICAgICAgdGhpcy5jYW1lcmFQaXZvdC5zZXRQYXJlbnQodGhpcy50cmFuc2Zvcm0pO1xuICAgICAgICAgICAgdGhpcy5jYW1lcmFQaXZvdC5wb3NpdGlvbiA9IG5ldyBCQUJZTE9OLlZlY3RvcjMoMC4wLCAxLjg1LCAwLjApO1xuICAgICAgICB9XG4gICAgICAgIEJBQllMT04uVXRpbGl0aWVzLlZhbGlkYXRlVHJhbnNmb3JtUXVhdGVybmlvbih0aGlzLmNhbWVyYVBpdm90KTtcbiAgICAgICAgaWYgKHRoaXMuYXR0YWNoQ2FtZXJhID09PSB0cnVlKSB7XG4gICAgICAgICAgICAvLyBUT0RPOiBDcmVhdGUgTXVsdGkgUGxheWVyIENhbWVyYSAoTm8gQXR0YWNoIENhbWVyYSlcbiAgICAgICAgICAgIHRoaXMuY2FtZXJhUmlnZ2VyID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuR2V0VHJhbnNmb3JtTm9kZSh0aGlzLnNjZW5lLCBcIk1haW4gQ2FtZXJhXCIpO1xuICAgICAgICAgICAgaWYgKHRoaXMuY2FtZXJhUmlnZ2VyICE9IG51bGwgJiYgdGhpcy5jYW1lcmFQaXZvdCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW1lcmFSaWdnZXIuc2V0UGFyZW50KHRoaXMuY2FtZXJhUGl2b3QpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2FtZXJhUmlnZ2VyLnBvc2l0aW9uID0gbmV3IEJBQllMT04uVmVjdG9yMygwLjAsIDAuMCwgLTQuNSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW1lcmFSaWdnZXIucm90YXRpb25RdWF0ZXJuaW9uID0gQkFCWUxPTi5RdWF0ZXJuaW9uLklkZW50aXR5KCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUUEM6IEF0dGFjaGVkIG1haW4gY2FtZXJhIHRvIHBsYXllciBjb250cm9sbGVyOiBcIiArIHRoaXMudHJhbnNmb3JtLm5hbWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBCQUJZTE9OLlRvb2xzLldhcm4oXCJGYWlsZWQgdG8gbG9jYXRlIGNhbWVyYSBvciBsb2NhbCBwaXZvdCBmb3I6IFwiICsgdGhpcy50cmFuc2Zvcm0ubmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2V0dXAgQ2hhcmFjdGVyIENvbnRyb2xsZXJcbiAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb250cm9sbGVyID0gdGhpcy5nZXRDb21wb25lbnQoXCJCQUJZTE9OLkNoYXJhY3RlckNvbnRyb2xsZXJcIik7XG4gICAgICAgIGlmICh0aGlzLmNoYXJhY3RlckNvbnRyb2xsZXIgPT0gbnVsbCkgQkFCWUxPTi5Ub29scy5XYXJuKFwiRmFpbGVkIHRvIGxvY2F0ZSBjaGFyYWN0ZXIgY29udHJvbGxlciBmb3I6IFwiICsgdGhpcy50cmFuc2Zvcm0ubmFtZSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB1cGRhdGVUaGlyZFBlcnNvbkNvbnRyb2xsZXIoKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGxheWVyRGVsdGFYID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuR2V0VXNlcklucHV0KEJBQllMT04uVXNlcklucHV0QXhpcy5Ib3Jpem9udGFsLCB0aGlzLnBsYXllck51bWJlcik7XG4gICAgICAgIHRoaXMucGxheWVyRGVsdGFaID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuR2V0VXNlcklucHV0KEJBQllMT04uVXNlcklucHV0QXhpcy5WZXJ0aWNhbCwgdGhpcy5wbGF5ZXJOdW1iZXIpO1xuICAgICAgICB0aGlzLnBsYXllck1vdXNlWCA9IEJBQllMT04uU2NlbmVNYW5hZ2VyLkdldFVzZXJJbnB1dChCQUJZTE9OLlVzZXJJbnB1dEF4aXMuTW91c2VYLCB0aGlzLnBsYXllck51bWJlcik7XG4gICAgICAgIHRoaXMucGxheWVyTW91c2VZID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuR2V0VXNlcklucHV0KEJBQllMT04uVXNlcklucHV0QXhpcy5Nb3VzZVksIHRoaXMucGxheWVyTnVtYmVyKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSBEZWFkIElucHV0IFZhbHVlc1xuICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5wbGF5ZXJEZWx0YVgpIDw9IEJBQllMT04uVXNlcklucHV0T3B0aW9ucy5HYW1lcGFkRGVhZFN0aWNrVmFsdWUpIHRoaXMucGxheWVyRGVsdGFYID0gMDtcbiAgICAgICAgaWYgKE1hdGguYWJzKHRoaXMucGxheWVyRGVsdGFaKSA8PSBCQUJZTE9OLlVzZXJJbnB1dE9wdGlvbnMuR2FtZXBhZERlYWRTdGlja1ZhbHVlKSB0aGlzLnBsYXllckRlbHRhWiA9IDA7XG4gICAgICAgIGlmIChNYXRoLmFicyh0aGlzLnBsYXllck1vdXNlWCkgPD0gQkFCWUxPTi5Vc2VySW5wdXRPcHRpb25zLkdhbWVwYWREZWFkU3RpY2tWYWx1ZSkgdGhpcy5wbGF5ZXJNb3VzZVggPSAwO1xuICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5wbGF5ZXJNb3VzZVkpIDw9IEJBQllMT04uVXNlcklucHV0T3B0aW9ucy5HYW1lcGFkRGVhZFN0aWNrVmFsdWUpIHRoaXMucGxheWVyTW91c2VZID0gMDtcblxuICAgICAgICAvLyBVcGRhdGUgQ2hhcmFjdGVyIE1vdmVtZW50XG4gICAgICAgIGlmICh0aGlzLmNoYXJhY3RlckNvbnRyb2xsZXIgIT0gbnVsbCkge1xuXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGRlc3Ryb3lUaGlyZFBlcnNvbkNvbnRyb2xsZXIoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY2FtZXJhUGl2b3QgPSBudWxsO1xuICAgICAgICB0aGlzLmNhbWVyYVJpZ2dlciA9IG51bGw7XG4gICAgICAgIHRoaXMuY2hhcmFjdGVyQ29udHJvbGxlciA9IG51bGw7XG4gICAgfVxufSIsIi8qKlxuICogQmFieWxvbiBTY3JpcHQgQ29tcG9uZW50XG4gKiBAY2xhc3MgQm91bmRpbmdCb3hTa2luc1xuICovXG5jbGFzcyBCb3VuZGluZ0JveFNraW5zIGV4dGVuZHMgQkFCWUxPTi5TY3JpcHRDb21wb25lbnQge1xuICAgIHByaXZhdGUgc2tpbnM6QkFCWUxPTi5BYnN0cmFjdE1lc2hbXSA9IG51bGw7XG4gICAgcHJpdmF0ZSBzeW5jQm91bmRpbmdJbmZvOmJvb2xlYW4gPSB0cnVlO1xuICAgIHByaXZhdGUgdXBkYXRlRXZlcnlGcmFtZTpib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBwb3NpdGlvblRocmVhc2hvbGQ6bnVtYmVyID0gMC4xO1xuICAgIHByaXZhdGUgbGFzdFBvc2l0aW9uOkJBQllMT04uVmVjdG9yMyA9IEJBQllMT04uVmVjdG9yMy5aZXJvKCk7XG4gICAgcHVibGljIGNvbnN0cnVjdG9yKHRyYW5zZm9ybTogQkFCWUxPTi5UcmFuc2Zvcm1Ob2RlLCBzY2VuZTogQkFCWUxPTi5TY2VuZSwgcHJvcGVydGllczogYW55ID0ge30pIHtcbiAgICAgICAgc3VwZXIodHJhbnNmb3JtLCBzY2VuZSwgcHJvcGVydGllcyk7XG4gICAgICAgIC8vIC4uXG4gICAgICAgIC8vIFZhbGlkYXRlIFNraW4gQm91bmRpbmcgQm94IEluZm9cbiAgICAgICAgLy8gLi5cbiAgICAgICAgdGhpcy5zeW5jQm91bmRpbmdJbmZvID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcInN5bmNCb3VuZGluZ0luZm9cIiwgdGhpcy5zeW5jQm91bmRpbmdJbmZvKTtcbiAgICAgICAgdGhpcy51cGRhdGVFdmVyeUZyYW1lID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcInVwZGF0ZUV2ZXJ5RnJhbWVcIiwgdGhpcy51cGRhdGVFdmVyeUZyYW1lKTtcbiAgICAgICAgdGhpcy5wb3NpdGlvblRocmVhc2hvbGQgPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwicG9zaXRpb25UaHJlYXNob2xkXCIsIHRoaXMucG9zaXRpb25UaHJlYXNob2xkKTtcbiAgICAgICAgaWYgKHRoaXMuc3luY0JvdW5kaW5nSW5mbyA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgbGV0IHNraW5uZWQ6Ym9vbGVhbiA9IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgbWV0YWRhdGE6YW55ID0gdGhpcy5nZXRNZXRhZGF0YSgpO1xuICAgICAgICAgICAgaWYgKG1ldGFkYXRhICE9IG51bGwgJiYgbWV0YWRhdGEuc2tpbiA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHNraW5uZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5za2lucyA9IHRoaXMudHJhbnNmb3JtLmdldENoaWxkTWVzaGVzKGZhbHNlLCAobm9kZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGE6YW55ID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuRmluZFNjZW5lTWV0YWRhdGEobm9kZSBhcyBCQUJZTE9OLlRyYW5zZm9ybU5vZGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiAoKGRhdGEgIT0gbnVsbCAmJiBkYXRhLnNraW4gPT09IHRydWUpIHx8IChza2lubmVkID09PSB0cnVlICYmIG5vZGUubmFtZS5pbmRleE9mKFwiX3ByaW1pdGl2ZVwiKSA+PSAwKSk7IC8vIFRPRE86IFJlbW92ZSBQcmltaXRpdmVzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChza2lubmVkID09PSB0cnVlICYmIHRoaXMudHJhbnNmb3JtIGluc3RhbmNlb2YgQkFCWUxPTi5BYnN0cmFjdE1lc2gpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5za2lucyA9PSBudWxsKSB0aGlzLnNraW5zID0gW107XG4gICAgICAgICAgICAgICAgdGhpcy5za2lucy51bnNoaWZ0KHRoaXMudHJhbnNmb3JtIGFzIEJBQllMT04uQWJzdHJhY3RNZXNoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBzdGFydCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jaGVja1NraW5zKCk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHVwZGF0ZSgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMudXBkYXRlRXZlcnlGcmFtZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgdGhpcy5jaGVja1NraW5zKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgYWZ0ZXIoKTogdm9pZCB7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2tpbnMgPSBudWxsO1xuICAgIH1cblxuICAgIHByaXZhdGUgY2hlY2tTa2lucygpOiB2b2lkIHtcbiAgICAgICAgLy8gU3RhcnQgcmVuZGVyIGxvb3AgZnVuY3Rpb25cbiAgICAgICAgaWYgKHRoaXMuc2tpbnMgIT0gbnVsbCAmJiB0aGlzLnNraW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnRyYW5zZm9ybS5wb3NpdGlvbi54ICE9PSB0aGlzLmxhc3RQb3NpdGlvbi54IHx8IHRoaXMudHJhbnNmb3JtLnBvc2l0aW9uLnkgIT09IHRoaXMubGFzdFBvc2l0aW9uLnkgfHwgdGhpcy50cmFuc2Zvcm0ucG9zaXRpb24ueiAhPT0gdGhpcy5sYXN0UG9zaXRpb24ueikge1xuICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyh0aGlzLnRyYW5zZm9ybS5wb3NpdGlvbi54IC0gdGhpcy5sYXN0UG9zaXRpb24ueCkgPj0gdGhpcy5wb3NpdGlvblRocmVhc2hvbGQgfHwgTWF0aC5hYnModGhpcy50cmFuc2Zvcm0ucG9zaXRpb24ueSAtIHRoaXMubGFzdFBvc2l0aW9uLnkpID49IHRoaXMucG9zaXRpb25UaHJlYXNob2xkIHx8IE1hdGguYWJzKHRoaXMudHJhbnNmb3JtLnBvc2l0aW9uLnogLSB0aGlzLmxhc3RQb3NpdGlvbi56KSA+PSB0aGlzLnBvc2l0aW9uVGhyZWFzaG9sZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNraW5zLmZvckVhY2goKHNraW46QkFCWUxPTi5BYnN0cmFjdE1lc2gpID0+IHsgc2tpbi5yZWZyZXNoQm91bmRpbmdJbmZvKHRydWUpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIj09PT4gUG9zaXRpb24gQ2hhbmdlIFVwZGF0ZTogXCIgKyB0aGlzLnRyYW5zZm9ybS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLnRyYW5zZm9ybS5wb3NpdGlvbi50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0UG9zaXRpb24ueCA9IHRoaXMudHJhbnNmb3JtLnBvc2l0aW9uLng7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdFBvc2l0aW9uLnkgPSB0aGlzLnRyYW5zZm9ybS5wb3NpdGlvbi55O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RQb3NpdGlvbi56ID0gdGhpcy50cmFuc2Zvcm0ucG9zaXRpb24uejtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59IiwiLyoqXG4gKiBCYWJ5bG9uIHNraWRtYXJrIHNlY3Rpb24gY2xhc3MgKE5hdGl2ZSBCdWxsZXQgUGh5c2ljcyAyLjgyKVxuICogQGNsYXNzIFNraWRtYXJrU2VjdGlvblxuICovXG5jbGFzcyBTa2lkbWFya1NlY3Rpb24ge1xuICAgIHB1YmxpYyBQb3M6QkFCWUxPTi5WZWN0b3IzID0gQkFCWUxPTi5WZWN0b3IzLlplcm8oKTtcbiAgICBwdWJsaWMgTm9ybWFsOkJBQllMT04uVmVjdG9yMyA9IEJBQllMT04uVmVjdG9yMy5aZXJvKCk7XG4gICAgcHVibGljIFRhbmdlbnQ6QkFCWUxPTi5WZWN0b3I0ID0gQkFCWUxPTi5WZWN0b3I0Llplcm8oKTtcbiAgICBwdWJsaWMgUG9zbDpCQUJZTE9OLlZlY3RvcjMgPSBCQUJZTE9OLlZlY3RvcjMuWmVybygpO1xuICAgIHB1YmxpYyBQb3NyOkJBQllMT04uVmVjdG9yMyA9IEJBQllMT04uVmVjdG9yMy5aZXJvKCk7XG4gICAgcHVibGljIEludGVuc2l0eTpudW1iZXIgPSAwLjA7XG4gICAgcHVibGljIExhc3RJbmRleDpudW1iZXIgPSAtMTtcbn1cbi8qKlxuICogQmFieWxvbiBTY3JpcHQgQ29tcG9uZW50XG4gKiBAY2xhc3MgU2tpZG1hcmtNYW5hZ2VyXG4gKi9cbmNsYXNzIFNraWRtYXJrTWFuYWdlciBleHRlbmRzIEJBQllMT04uU2NyaXB0Q29tcG9uZW50IHtcblx0cHJpdmF0ZSBzdGF0aWMgTUFYX01BUktTOm51bWJlciA9IDQwOTY7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWF4IG51bWJlciBvZiBtYXJrcyB0b3RhbCBmb3IgZXZlcnlvbmUgdG9nZXRoZXJcbiAgICBwcml2YXRlIHN0YXRpYyBHUk9VTkRfT0ZGU0VUOm51bWJlciA9IDAuMDE7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEaXN0YW5jZSBhYm92ZSBzdXJmYWNlIGluIG1ldHJlc1xuXHRwcml2YXRlIHN0YXRpYyBWRUxPQ0lUWV9TQ0FMRTpudW1iZXIgPSAwLjAyOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBWZWxvY2l0eSBvZmZzZXQgc2NhbGUgZmFjdG9yXG4gICAgcHJpdmF0ZSBzdGF0aWMgR1BVX1RSSUFOR0xFUzpib29sZWFuID0gdHJ1ZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gR1BVIHF1YWQgdHJpYW5nbGUgaW5kaWNlcyBvbmx5XG4gICAgcHJpdmF0ZSBzdGF0aWMgTUFSS19DT0xPUjpCQUJZTE9OLkNvbG9yMyA9IEJBQllMT04uQ29sb3IzLkJsYWNrKCk7ICAgICAgLy8gU2tpZG1hcmsgQ29sb3Jcblx0cHJpdmF0ZSBzdGF0aWMgTUFSS19XSURUSDpudW1iZXIgPSAwLjM7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2lkdGggb2YgdGhlIFNraWRtYXJrcy4gU2hvdWxkIG1hdGNoIHRoZSB3aWR0aCBvZiB0aGUgd2hlZWxzXG5cdHByaXZhdGUgc3RhdGljIE1JTl9ESVNUQU5DRTpudW1iZXIgPSAwLjE7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIERpc3RhbmNlIGJldHdlZW4gc2tpZCB0ZXh0dXJlIHNlY3Rpb25zIGluIG1ldHJlcy4gQmlnZ2VyID0gYmV0dGVyIHBlcmZvcm1hbmNlLCBsZXNzIHNtb290aFxuICAgIHByaXZhdGUgc3RhdGljIE1JTl9TUVJfRElTVEFOQ0UgPSAoU2tpZG1hcmtNYW5hZ2VyLk1JTl9ESVNUQU5DRSAqIFNraWRtYXJrTWFuYWdlci5NSU5fRElTVEFOQ0UpO1xuICAgIHByaXZhdGUgc3RhdGljIFRFWFRVUkVfTUFSS1M6YW55ID0gbnVsbDtcblxuICAgIHByaXZhdGUgc3RhdGljIFNraWRCdWZmZXJQb3NpdGlvbnM6RmxvYXQzMkFycmF5ID0gbnVsbDtcbiAgICBwcml2YXRlIHN0YXRpYyBTa2lkQnVmZmVyTm9ybWFsczpGbG9hdDMyQXJyYXkgPSBudWxsO1xuICAgIHByaXZhdGUgc3RhdGljIFNraWRCdWZmZXJUYW5nZW50czpGbG9hdDMyQXJyYXkgPSBudWxsO1xuICAgIHByaXZhdGUgc3RhdGljIFNraWRCdWZmZXJDb2xvcnM6RmxvYXQzMkFycmF5ID0gbnVsbDtcbiAgICBwcml2YXRlIHN0YXRpYyBTa2lkQnVmZmVyVXZzOkZsb2F0MzJBcnJheSA9IG51bGw7XG4gICAgcHJpdmF0ZSBzdGF0aWMgU2tpZEJ1ZmZlckluZGljZXM6SW50MzJBcnJheSA9IG51bGw7XG5cdHByaXZhdGUgc3RhdGljIFNraWRtYXJrU2VjdGlvbnM6U2tpZG1hcmtTZWN0aW9uW10gPSBudWxsO1xuXHRwcml2YXRlIHN0YXRpYyBTa2lkbWFya0luZGV4Om51bWJlciA9IDA7XG5cdHByaXZhdGUgc3RhdGljIFNraWRtYXJrTWVzaDpCQUJZTE9OLk1lc2ggPSBudWxsO1xuICAgIHByaXZhdGUgc3RhdGljIFNraWRtYXJrVXBkYXRlZDpib29sZWFuID0gZmFsc2U7XG5cbiAgICBwcml2YXRlIHN0YXRpYyBUZW1wVmVjdG9yM19QT1M6QkFCWUxPTi5WZWN0b3IzID0gbmV3IEJBQllMT04uVmVjdG9yMygwLDAsMCk7XG4gICAgcHJpdmF0ZSBzdGF0aWMgVGVtcFZlY3RvcjNfRElSOkJBQllMT04uVmVjdG9yMyA9IG5ldyBCQUJZTE9OLlZlY3RvcjMoMCwwLDApO1xuICAgIHByaXZhdGUgc3RhdGljIFRlbXBWZWN0b3IzX1hESVI6QkFCWUxPTi5WZWN0b3IzID0gbmV3IEJBQllMT04uVmVjdG9yMygwLDAsMCk7XG4gICAgcHJpdmF0ZSBzdGF0aWMgVGVtcFZlY3RvcjNfU0RJUjpCQUJZTE9OLlZlY3RvcjMgPSBuZXcgQkFCWUxPTi5WZWN0b3IzKDAsMCwwKTtcbiAgICBwdWJsaWMgY29uc3RydWN0b3IodHJhbnNmb3JtOiBCQUJZTE9OLlRyYW5zZm9ybU5vZGUsIHNjZW5lOiBCQUJZTE9OLlNjZW5lLCBwcm9wZXJ0aWVzOiBhbnkgPSB7fSkge1xuICAgICAgICBzdXBlcih0cmFuc2Zvcm0sIHNjZW5lLCBwcm9wZXJ0aWVzKTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLk1BWF9NQVJLUyA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJtYXhTZWN0aW9uc1wiLCBTa2lkbWFya01hbmFnZXIuTUFYX01BUktTKTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLk1BUktfQ09MT1IgPSBCQUJZTE9OLlV0aWxpdGllcy5QYXJzZUNvbG9yMyh0aGlzLmdldEVkaXRvclByb3BlcnR5KFwidGV4dHVyZUNvbG9yXCIsIFNraWRtYXJrTWFuYWdlci5NQVJLX0NPTE9SKSk7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5NQVJLX1dJRFRIID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcInRleHR1cmVXaWR0aFwiLCBTa2lkbWFya01hbmFnZXIuTUFSS19XSURUSCk7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5HUk9VTkRfT0ZGU0VUID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcImdyb3VuZE9mZnNldFwiLCBTa2lkbWFya01hbmFnZXIuR1JPVU5EX09GRlNFVCk7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5WRUxPQ0lUWV9TQ0FMRSA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJ2ZWxvY2l0eVNjYWxlXCIsIFNraWRtYXJrTWFuYWdlci5WRUxPQ0lUWV9TQ0FMRSk7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5HUFVfVFJJQU5HTEVTID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcImdwdVF1YWRJbmRpY2VzXCIsIFNraWRtYXJrTWFuYWdlci5HUFVfVFJJQU5HTEVTKTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlRFWFRVUkVfTUFSS1MgPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwidGV4dHVyZU1hcmtzXCIsIFNraWRtYXJrTWFuYWdlci5URVhUVVJFX01BUktTKTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLk1JTl9ESVNUQU5DRSA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJ0ZXh0dXJlRGlzdGFuY2VcIiwgU2tpZG1hcmtNYW5hZ2VyLk1JTl9ESVNUQU5DRSk7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5NSU5fU1FSX0RJU1RBTkNFID0gKFNraWRtYXJrTWFuYWdlci5NSU5fRElTVEFOQ0UgKiBTa2lkbWFya01hbmFnZXIuTUlOX0RJU1RBTkNFKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgc3RhcnQoKTogdm9pZCB7IFNraWRtYXJrTWFuYWdlci5DcmVhdGVTa2lkbWFya01hbmFnZXIodGhpcy5zY2VuZSk7IH1cbiAgICBwcm90ZWN0ZWQgdXBkYXRlKCk6IHZvaWQgeyBTa2lkbWFya01hbmFnZXIuVXBkYXRlU2tpZG1hcmtNYW5hZ2VyKCk7IH1cblxuICAgIHB1YmxpYyBzdGF0aWMgR2V0VmVsb2NpdHlTY2FsZSgpOm51bWJlciB7IHJldHVybiBTa2lkbWFya01hbmFnZXIuVkVMT0NJVFlfU0NBTEU7IH1cblxuICAgIHB1YmxpYyBzdGF0aWMgQWRkU2tpZG1hcmtTZWdtZW50KHBvczpCQUJZTE9OLlZlY3RvcjMsIG5vcm1hbDpCQUJZTE9OLlZlY3RvcjMsIGludGVuc2l0eTpudW1iZXIsIGxhc3RJbmRleDpudW1iZXIpOkJBQllMT04uTnVsbGFibGU8bnVtYmVyPiB7XG4gICAgICAgIGlmIChTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtNZXNoID09IG51bGwpIHJldHVybiBudWxsO1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuVGVtcFZlY3RvcjNfUE9TLnNldCgwLDAsMCk7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5UZW1wVmVjdG9yM19ESVIuc2V0KDAsMCwwKTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlRlbXBWZWN0b3IzX1hESVIuc2V0KDAsMCwwKTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlRlbXBWZWN0b3IzX1NESVIuc2V0KDAsMCwwKTtcbiAgICAgICAgLy8gLi5cbiAgICAgICAgaWYgKGludGVuc2l0eSA+IDEuMCkgaW50ZW5zaXR5ID0gMS4wO1xuICAgICAgICBlbHNlIGlmIChpbnRlbnNpdHkgPCAwLjApIHJldHVybiAtMS4wO1xuICAgICAgICAvLyAuLlxuXHRcdGlmIChsYXN0SW5kZXggPiAwKSB7XG4gICAgICAgICAgICBwb3Muc3VidHJhY3RUb1JlZihTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtTZWN0aW9uc1tsYXN0SW5kZXhdLlBvcywgU2tpZG1hcmtNYW5hZ2VyLlRlbXBWZWN0b3IzX1BPUyk7XG5cdFx0XHRjb25zdCBzcXJEaXN0YW5jZTpudW1iZXIgPSBTa2lkbWFya01hbmFnZXIuVGVtcFZlY3RvcjNfUE9TLmxlbmd0aFNxdWFyZWQoKTtcbiAgICAgICAgICAgIGlmIChzcXJEaXN0YW5jZSA8IFNraWRtYXJrTWFuYWdlci5NSU5fU1FSX0RJU1RBTkNFKSByZXR1cm4gbGFzdEluZGV4O1xuICAgICAgICB9XG4gICAgICAgIC8vIC4uXG5cdFx0Y29uc3QgY3VyU2VjdGlvbjpTa2lkbWFya1NlY3Rpb24gPSBTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtTZWN0aW9uc1tTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtJbmRleF07XG4gICAgICAgIG5vcm1hbC5zY2FsZVRvUmVmKFNraWRtYXJrTWFuYWdlci5HUk9VTkRfT0ZGU0VULCBTa2lkbWFya01hbmFnZXIuVGVtcFZlY3RvcjNfUE9TKTtcbiAgICAgICAgcG9zLmFkZFRvUmVmKFNraWRtYXJrTWFuYWdlci5UZW1wVmVjdG9yM19QT1MsIGN1clNlY3Rpb24uUG9zKTtcblx0XHRjdXJTZWN0aW9uLk5vcm1hbC5jb3B5RnJvbShub3JtYWwpO1xuXHRcdGN1clNlY3Rpb24uSW50ZW5zaXR5ID0gaW50ZW5zaXR5O1xuICAgICAgICBjdXJTZWN0aW9uLkxhc3RJbmRleCA9IGxhc3RJbmRleDtcbiAgICAgICAgLy8gLi5cbiAgICAgICAgaWYgKGxhc3RJbmRleCAhPSAtMSkge1xuICAgICAgICAgICAgY29uc3QgbGFzdFNlY3Rpb246U2tpZG1hcmtTZWN0aW9uID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrU2VjdGlvbnNbbGFzdEluZGV4XTtcbiAgICAgICAgICAgIGN1clNlY3Rpb24uUG9zLnN1YnRyYWN0VG9SZWYobGFzdFNlY3Rpb24uUG9zLCBTa2lkbWFya01hbmFnZXIuVGVtcFZlY3RvcjNfRElSKTtcbiAgICAgICAgICAgIEJBQllMT04uVmVjdG9yMy5Dcm9zc1RvUmVmKFNraWRtYXJrTWFuYWdlci5UZW1wVmVjdG9yM19ESVIsIG5vcm1hbCwgU2tpZG1hcmtNYW5hZ2VyLlRlbXBWZWN0b3IzX1hESVIpO1xuICAgICAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlRlbXBWZWN0b3IzX1hESVIubm9ybWFsaXplVG9SZWYoU2tpZG1hcmtNYW5hZ2VyLlRlbXBWZWN0b3IzX1hESVIpO1xuICAgICAgICAgICAgLy8gLi5cbiAgICAgICAgICAgIFNraWRtYXJrTWFuYWdlci5UZW1wVmVjdG9yM19YRElSLnNjYWxlVG9SZWYoU2tpZG1hcmtNYW5hZ2VyLk1BUktfV0lEVEggKiAwLjUsIFNraWRtYXJrTWFuYWdlci5UZW1wVmVjdG9yM19TRElSKVxuICAgICAgICAgICAgY3VyU2VjdGlvbi5Qb3MuYWRkVG9SZWYoU2tpZG1hcmtNYW5hZ2VyLlRlbXBWZWN0b3IzX1NESVIsIGN1clNlY3Rpb24uUG9zbCk7XG4gICAgICAgICAgICBjdXJTZWN0aW9uLlBvcy5zdWJ0cmFjdFRvUmVmKFNraWRtYXJrTWFuYWdlci5UZW1wVmVjdG9yM19TRElSLCBjdXJTZWN0aW9uLlBvc3IpO1xuICAgICAgICAgICAgY3VyU2VjdGlvbi5UYW5nZW50LnNldChTa2lkbWFya01hbmFnZXIuVGVtcFZlY3RvcjNfWERJUi54LCBTa2lkbWFya01hbmFnZXIuVGVtcFZlY3RvcjNfWERJUi55LCBTa2lkbWFya01hbmFnZXIuVGVtcFZlY3RvcjNfWERJUi56LCAxKTtcbiAgICAgICAgICAgIC8vIC4uXG5cdFx0XHRpZiAobGFzdFNlY3Rpb24uTGFzdEluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgICAgIGN1clNlY3Rpb24uUG9zLmFkZFRvUmVmKFNraWRtYXJrTWFuYWdlci5UZW1wVmVjdG9yM19TRElSLCBsYXN0U2VjdGlvbi5Qb3NsKTtcbiAgICAgICAgICAgICAgICBjdXJTZWN0aW9uLlBvcy5zdWJ0cmFjdFRvUmVmKFNraWRtYXJrTWFuYWdlci5UZW1wVmVjdG9yM19TRElSLCBsYXN0U2VjdGlvbi5Qb3NyKTtcbiAgICAgICAgICAgICAgICBsYXN0U2VjdGlvbi5UYW5nZW50LmNvcHlGcm9tKGN1clNlY3Rpb24uVGFuZ2VudCk7XG5cdFx0XHR9XG4gICAgICAgIH1cbiAgICAgICAgLy8gLi5cbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLkFkZFNraWRtYXJrVmVydGV4RGF0YSgpO1xuXHRcdGNvbnN0IGN1ckluZGV4Om51bWJlciA9IFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4O1xuXHRcdFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ID0gKytTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtJbmRleCAlIFNraWRtYXJrTWFuYWdlci5NQVhfTUFSS1M7XG5cdFx0cmV0dXJuIGN1ckluZGV4O1xuICAgIH1cbiAgICBwcml2YXRlIHN0YXRpYyBDcmVhdGVTa2lkbWFya01hbmFnZXIoc2NlbmU6QkFCWUxPTi5TY2VuZSk6dm9pZCB7XG4gICAgICAgIGlmIChTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtNZXNoID09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnN0IHNraWRtYXJrTWF0ZXJpYWw6QkFCWUxPTi5TdGFuZGFyZE1hdGVyaWFsID0gbmV3IEJBQllMT04uU3RhbmRhcmRNYXRlcmlhbChcIlNraWRtYXJrTWF0ZXJpYWxcIiwgc2NlbmUpO1xuICAgICAgICAgICAgc2tpZG1hcmtNYXRlcmlhbC5iYWNrRmFjZUN1bGxpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHNraWRtYXJrTWF0ZXJpYWwuZGlzYWJsZUxpZ2h0aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHNraWRtYXJrTWF0ZXJpYWwuZW1pc3NpdmVDb2xvciA9IFNraWRtYXJrTWFuYWdlci5NQVJLX0NPTE9SO1xuICAgICAgICAgICAgc2tpZG1hcmtNYXRlcmlhbC5kaWZmdXNlQ29sb3IgPSBTa2lkbWFya01hbmFnZXIuTUFSS19DT0xPUjtcbiAgICAgICAgICAgIHNraWRtYXJrTWF0ZXJpYWwuZGlmZnVzZVRleHR1cmUgPSBCQUJZTE9OLlV0aWxpdGllcy5QYXJzZVRleHR1cmUoU2tpZG1hcmtNYW5hZ2VyLlRFWFRVUkVfTUFSS1MsIHNjZW5lKTtcbiAgICAgICAgICAgIGlmIChza2lkbWFya01hdGVyaWFsLmRpZmZ1c2VUZXh0dXJlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBza2lkbWFya01hdGVyaWFsLmRpZmZ1c2VUZXh0dXJlLmhhc0FscGhhID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBza2lkbWFya01hdGVyaWFsLnVzZUFscGhhRnJvbURpZmZ1c2VUZXh0dXJlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNraWRtYXJrTWF0ZXJpYWwuZnJlZXplKCk7XG4gICAgICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtNZXNoID0gbmV3IEJBQllMT04uTWVzaChcIlNraWRtYXJrTWVzaFwiLCBzY2VuZSk7XG4gICAgICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtNZXNoLm1hdGVyaWFsID0gc2tpZG1hcmtNYXRlcmlhbDtcbiAgICAgICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya01lc2guYWx3YXlzU2VsZWN0QXNBY3RpdmVNZXNoID0gdHJ1ZTtcbiAgICAgICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya01lc2guZG9Ob3RTeW5jQm91bmRpbmdJbmZvID0gdHJ1ZTtcbiAgICAgICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya01lc2gucmVjZWl2ZVNoYWRvd3MgPSBmYWxzZTtcbiAgICAgICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya01lc2guY2hlY2tDb2xsaXNpb25zID0gZmFsc2U7XG4gICAgICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtNZXNoLnVzZVZlcnRleENvbG9ycyA9IHRydWU7XG4gICAgICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtNZXNoLmhhc1ZlcnRleEFscGhhID0gdHJ1ZTtcbiAgICAgICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya01lc2guaXNQaWNrYWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgLy8gLi5cbiAgICAgICAgICAgIC8vIFNldHVwIFNraWRtYXJrIFNlY3Rpb24gUHJvcGVydGllc1xuICAgICAgICAgICAgLy8gLi5cbiAgICAgICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya1NlY3Rpb25zID0gbmV3IEFycmF5PFNraWRtYXJrU2VjdGlvbj4oU2tpZG1hcmtNYW5hZ2VyLk1BWF9NQVJLUyk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya1NlY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrU2VjdGlvbnNbaV0gPSBuZXcgU2tpZG1hcmtTZWN0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyAuLlxuICAgICAgICAgICAgLy8gU2V0dXAgUmF3IE1lc2ggVmVydGV4IEJ1ZmZlciBEYXRhXG4gICAgICAgICAgICAvLyAuLlxuICAgICAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJQb3NpdGlvbnMgPSBuZXcgRmxvYXQzMkFycmF5KFNraWRtYXJrTWFuYWdlci5NQVhfTUFSS1MgKiA0ICogMyk7XG4gICAgICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlck5vcm1hbHMgPSBuZXcgRmxvYXQzMkFycmF5KFNraWRtYXJrTWFuYWdlci5NQVhfTUFSS1MgKiA0ICogMyk7XG4gICAgICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclRhbmdlbnRzID0gbmV3IEZsb2F0MzJBcnJheShTa2lkbWFya01hbmFnZXIuTUFYX01BUktTICogNCAqIDQpO1xuICAgICAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJDb2xvcnMgPSBuZXcgRmxvYXQzMkFycmF5KFNraWRtYXJrTWFuYWdlci5NQVhfTUFSS1MgKiA0ICogNCk7XG4gICAgICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclV2cyA9IG5ldyBGbG9hdDMyQXJyYXkoU2tpZG1hcmtNYW5hZ2VyLk1BWF9NQVJLUyAqIDQgKiAyKTtcbiAgICAgICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVySW5kaWNlcyA9IG5ldyBJbnQzMkFycmF5KFNraWRtYXJrTWFuYWdlci5NQVhfTUFSS1MgKiA2KTtcbiAgICAgICAgICAgIC8vIC4uXG4gICAgICAgICAgICAvLyBBcHBseSBSYXcgVmVydGV4IEJ1ZmZlciBEYXRhIFRvIE1lc2hcbiAgICAgICAgICAgIC8vIC4uXG4gICAgICAgICAgICBjb25zdCB2ZXJ0ZXhEYXRhID0gbmV3IEJBQllMT04uVmVydGV4RGF0YSgpO1xuICAgICAgICAgICAgdmVydGV4RGF0YS5wb3NpdGlvbnMgPSBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclBvc2l0aW9ucztcbiAgICAgICAgICAgIHZlcnRleERhdGEubm9ybWFscyA9IFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyTm9ybWFscztcbiAgICAgICAgICAgIHZlcnRleERhdGEudGFuZ2VudHMgPSBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclRhbmdlbnRzO1xuICAgICAgICAgICAgdmVydGV4RGF0YS5jb2xvcnMgPSBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlckNvbG9ycztcbiAgICAgICAgICAgIHZlcnRleERhdGEudXZzID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJVdnM7ICAgICAgICAgICAgXG4gICAgICAgICAgICB2ZXJ0ZXhEYXRhLmluZGljZXMgPSBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlckluZGljZXM7XG4gICAgICAgICAgICB2ZXJ0ZXhEYXRhLmFwcGx5VG9NZXNoKFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya01lc2gsIHRydWUpO1xuICAgICAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrTWVzaC5mcmVlemVXb3JsZE1hdHJpeCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHByaXZhdGUgc3RhdGljIEFkZFNraWRtYXJrVmVydGV4RGF0YSgpOnZvaWQge1xuXHRcdGNvbnN0IGN1cnI6U2tpZG1hcmtTZWN0aW9uID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrU2VjdGlvbnNbU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrSW5kZXhdO1xuICAgICAgICBpZiAoY3Vyci5MYXN0SW5kZXggPT09IC0xKSByZXR1cm47XG4gICAgICAgIGNvbnN0IGxhc3Q6U2tpZG1hcmtTZWN0aW9uID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrU2VjdGlvbnNbY3Vyci5MYXN0SW5kZXhdO1xuXHRcdFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya1VwZGF0ZWQgPSB0cnVlO1xuICAgICAgICAvLyAuLlxuICAgICAgICAvLyBVcGRhdGUgUG9zaXRpb24gQnVmZmVycyBEaXJlY3RseVxuICAgICAgICAvLyAuLlxuICAgICAgICBsZXQgaW5kZXg6bnVtYmVyID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrSW5kZXggKiA0ICsgMDtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJQb3NpdGlvbnNbaW5kZXggKiAzXSA9IGxhc3QuUG9zbC54O1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclBvc2l0aW9uc1soaW5kZXggKiAzKSArIDFdID0gbGFzdC5Qb3NsLnk7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyUG9zaXRpb25zWyhpbmRleCAqIDMpICsgMl0gPSBsYXN0LlBvc2wuejtcbiAgICAgICAgaW5kZXggPSBTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtJbmRleCAqIDQgKyAxO1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclBvc2l0aW9uc1tpbmRleCAqIDNdID0gbGFzdC5Qb3NyLng7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyUG9zaXRpb25zWyhpbmRleCAqIDMpICsgMV0gPSBsYXN0LlBvc3IueTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJQb3NpdGlvbnNbKGluZGV4ICogMykgKyAyXSA9IGxhc3QuUG9zci56O1xuICAgICAgICBpbmRleCA9IFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ICogNCArIDI7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyUG9zaXRpb25zW2luZGV4ICogM10gPSBjdXJyLlBvc2wueDtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJQb3NpdGlvbnNbKGluZGV4ICogMykgKyAxXSA9IGN1cnIuUG9zbC55O1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclBvc2l0aW9uc1soaW5kZXggKiAzKSArIDJdID0gY3Vyci5Qb3NsLno7XG4gICAgICAgIGluZGV4ID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrSW5kZXggKiA0ICsgMztcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJQb3NpdGlvbnNbaW5kZXggKiAzXSA9IGN1cnIuUG9zci54O1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclBvc2l0aW9uc1soaW5kZXggKiAzKSArIDFdID0gY3Vyci5Qb3NyLnk7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyUG9zaXRpb25zWyhpbmRleCAqIDMpICsgMl0gPSBjdXJyLlBvc3IuejtcbiAgICAgICAgLy8gLi5cbiAgICAgICAgLy8gVXBkYXRlIE5vcm1hbCBCdWZmZXJzIERpcmVjdGx5XG4gICAgICAgIC8vIC4uXG4gICAgICAgIGluZGV4ID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrSW5kZXggKiA0ICsgMDtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJOb3JtYWxzW2luZGV4ICogM10gPSBsYXN0Lk5vcm1hbC54O1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlck5vcm1hbHNbKGluZGV4ICogMykgKyAxXSA9IGxhc3QuTm9ybWFsLnk7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyTm9ybWFsc1soaW5kZXggKiAzKSArIDJdID0gbGFzdC5Ob3JtYWwuejtcbiAgICAgICAgaW5kZXggPSBTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtJbmRleCAqIDQgKyAxO1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlck5vcm1hbHNbaW5kZXggKiAzXSA9IGxhc3QuTm9ybWFsLng7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyTm9ybWFsc1soaW5kZXggKiAzKSArIDFdID0gbGFzdC5Ob3JtYWwueTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJOb3JtYWxzWyhpbmRleCAqIDMpICsgMl0gPSBsYXN0Lk5vcm1hbC56O1xuICAgICAgICBpbmRleCA9IFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ICogNCArIDI7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyTm9ybWFsc1tpbmRleCAqIDNdID0gY3Vyci5Ob3JtYWwueDtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJOb3JtYWxzWyhpbmRleCAqIDMpICsgMV0gPSBjdXJyLk5vcm1hbC55O1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlck5vcm1hbHNbKGluZGV4ICogMykgKyAyXSA9IGN1cnIuTm9ybWFsLno7XG4gICAgICAgIGluZGV4ID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrSW5kZXggKiA0ICsgMztcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJOb3JtYWxzW2luZGV4ICogM10gPSBjdXJyLk5vcm1hbC54O1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlck5vcm1hbHNbKGluZGV4ICogMykgKyAxXSA9IGN1cnIuTm9ybWFsLnk7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyTm9ybWFsc1soaW5kZXggKiAzKSArIDJdID0gY3Vyci5Ob3JtYWwuejtcbiAgICAgICAgLy8gLi5cbiAgICAgICAgLy8gVXBkYXRlIFRhbmdlbnQgQnVmZmVycyBEaXJlY3RseVxuICAgICAgICAvLyAuLlxuICAgICAgICBpbmRleCA9IFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ICogNCArIDA7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyVGFuZ2VudHNbaW5kZXggKiA0XSA9IGxhc3QuVGFuZ2VudC54O1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclRhbmdlbnRzWyhpbmRleCAqIDQpICsgMV0gPSBsYXN0LlRhbmdlbnQueTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJUYW5nZW50c1soaW5kZXggKiA0KSArIDJdID0gbGFzdC5UYW5nZW50Lno7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyVGFuZ2VudHNbKGluZGV4ICogNCkgKyAzXSA9IGxhc3QuVGFuZ2VudC53O1xuICAgICAgICBpbmRleCA9IFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ICogNCArIDE7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyVGFuZ2VudHNbaW5kZXggKiA0XSA9IGxhc3QuVGFuZ2VudC54O1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclRhbmdlbnRzWyhpbmRleCAqIDQpICsgMV0gPSBsYXN0LlRhbmdlbnQueTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJUYW5nZW50c1soaW5kZXggKiA0KSArIDJdID0gbGFzdC5UYW5nZW50Lno7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyVGFuZ2VudHNbKGluZGV4ICogNCkgKyAzXSA9IGxhc3QuVGFuZ2VudC53O1xuICAgICAgICBpbmRleCA9IFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ICogNCArIDI7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyVGFuZ2VudHNbaW5kZXggKiA0XSA9IGN1cnIuVGFuZ2VudC54O1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclRhbmdlbnRzWyhpbmRleCAqIDQpICsgMV0gPSBjdXJyLlRhbmdlbnQueTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJUYW5nZW50c1soaW5kZXggKiA0KSArIDJdID0gY3Vyci5UYW5nZW50Lno7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyVGFuZ2VudHNbKGluZGV4ICogNCkgKyAzXSA9IGN1cnIuVGFuZ2VudC53O1xuICAgICAgICBpbmRleCA9IFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ICogNCArIDM7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyVGFuZ2VudHNbaW5kZXggKiA0XSA9IGN1cnIuVGFuZ2VudC54O1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclRhbmdlbnRzWyhpbmRleCAqIDQpICsgMV0gPSBjdXJyLlRhbmdlbnQueTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJUYW5nZW50c1soaW5kZXggKiA0KSArIDJdID0gY3Vyci5UYW5nZW50Lno7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyVGFuZ2VudHNbKGluZGV4ICogNCkgKyAzXSA9IGN1cnIuVGFuZ2VudC53O1xuICAgICAgICAvLyAuLlxuICAgICAgICAvLyBVcGRhdGUgQ29sb3IgQnVmZmVycyBEaXJlY3RseVxuICAgICAgICAvLyAuLlxuICAgICAgICBpbmRleCA9IFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ICogNCArIDA7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyQ29sb3JzW2luZGV4ICogNF0gPSAxLjA7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyQ29sb3JzWyhpbmRleCAqIDQpICsgMV0gPSAxLjA7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyQ29sb3JzWyhpbmRleCAqIDQpICsgMl0gPSAxLjA7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyQ29sb3JzWyhpbmRleCAqIDQpICsgM10gPSBsYXN0LkludGVuc2l0eTtcbiAgICAgICAgaW5kZXggPSBTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtJbmRleCAqIDQgKyAxO1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlckNvbG9yc1tpbmRleCAqIDRdID0gMS4wO1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlckNvbG9yc1soaW5kZXggKiA0KSArIDFdID0gMS4wO1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlckNvbG9yc1soaW5kZXggKiA0KSArIDJdID0gMS4wO1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlckNvbG9yc1soaW5kZXggKiA0KSArIDNdID0gbGFzdC5JbnRlbnNpdHk7XG4gICAgICAgIGluZGV4ID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrSW5kZXggKiA0ICsgMjtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJDb2xvcnNbaW5kZXggKiA0XSA9IDEuMDtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJDb2xvcnNbKGluZGV4ICogNCkgKyAxXSA9IDEuMDtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJDb2xvcnNbKGluZGV4ICogNCkgKyAyXSA9IDEuMDtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJDb2xvcnNbKGluZGV4ICogNCkgKyAzXSA9IGN1cnIuSW50ZW5zaXR5O1xuICAgICAgICBpbmRleCA9IFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ICogNCArIDM7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyQ29sb3JzW2luZGV4ICogNF0gPSAxLjA7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyQ29sb3JzWyhpbmRleCAqIDQpICsgMV0gPSAxLjA7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyQ29sb3JzWyhpbmRleCAqIDQpICsgMl0gPSAxLjA7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyQ29sb3JzWyhpbmRleCAqIDQpICsgM10gPSBjdXJyLkludGVuc2l0eTtcbiAgICAgICAgLy8gLi5cbiAgICAgICAgLy8gVXBkYXRlIENvb3JkIEJ1ZmZlcnMgRGlyZWN0bHlcbiAgICAgICAgLy8gLi5cbiAgICAgICAgaW5kZXggPSBTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtJbmRleCAqIDQgKyAwO1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclV2c1tpbmRleCAqIDJdID0gMDtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJVdnNbKGluZGV4ICogMikgKyAxXSA9IDA7XG4gICAgICAgIGluZGV4ID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrSW5kZXggKiA0ICsgMTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJVdnNbaW5kZXggKiAyXSA9IDE7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyVXZzWyhpbmRleCAqIDIpICsgMV0gPSAwO1xuICAgICAgICBpbmRleCA9IFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ICogNCArIDI7XG4gICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkQnVmZmVyVXZzW2luZGV4ICogMl0gPSAwO1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclV2c1soaW5kZXggKiAyKSArIDFdID0gMTtcbiAgICAgICAgaW5kZXggPSBTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtJbmRleCAqIDQgKyAzO1xuICAgICAgICBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclV2c1tpbmRleCAqIDJdID0gMTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJVdnNbKGluZGV4ICogMikgKyAxXSA9IDE7XG4gICAgICAgIC8vIC4uXG4gICAgICAgIC8vIFVwZGF0ZSBUcmlhbmdsZSAxIEJ1ZmZlcnMgRGlyZWN0bHkgKFFVQUQpXG4gICAgICAgIC8vLi5cbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJJbmRpY2VzW1NraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ICogNiArIDBdID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrSW5kZXggKiA0ICsgMDtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJJbmRpY2VzW1NraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ICogNiArIDJdID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrSW5kZXggKiA0ICsgMTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJJbmRpY2VzW1NraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ICogNiArIDFdID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrSW5kZXggKiA0ICsgMjtcbiAgICAgICAgLy8gLi5cbiAgICAgICAgLy8gVXBkYXRlIFRyaWFuZ2xlIDIgQnVmZmVycyBEaXJlY3RseSAoUVVBRClcbiAgICAgICAgLy8gLi5cbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJJbmRpY2VzW1NraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ICogNiArIDNdID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrSW5kZXggKiA0ICsgMjtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJJbmRpY2VzW1NraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ICogNiArIDVdID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrSW5kZXggKiA0ICsgMTtcbiAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJJbmRpY2VzW1NraWRtYXJrTWFuYWdlci5Ta2lkbWFya0luZGV4ICogNiArIDRdID0gU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrSW5kZXggKiA0ICsgMztcbiAgICB9XG4gICAgcHJpdmF0ZSBzdGF0aWMgVXBkYXRlU2tpZG1hcmtNYW5hZ2VyKCk6dm9pZCB7XG4gICAgICAgIGlmIChTa2lkbWFya01hbmFnZXIuU2tpZG1hcmtNZXNoICE9IG51bGwgJiYgU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrVXBkYXRlZCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrVXBkYXRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya01lc2guZ2VvbWV0cnkgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya01lc2guZ2VvbWV0cnkudXBkYXRlVmVydGljZXNEYXRhRGlyZWN0bHkoQkFCWUxPTi5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kLCBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclBvc2l0aW9ucywgMCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya01lc2guZ2VvbWV0cnkudXBkYXRlVmVydGljZXNEYXRhRGlyZWN0bHkoQkFCWUxPTi5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCwgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJOb3JtYWxzLCAwLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgU2tpZG1hcmtNYW5hZ2VyLlNraWRtYXJrTWVzaC5nZW9tZXRyeS51cGRhdGVWZXJ0aWNlc0RhdGFEaXJlY3RseShCQUJZTE9OLlZlcnRleEJ1ZmZlci5UYW5nZW50S2luZCwgU2tpZG1hcmtNYW5hZ2VyLlNraWRCdWZmZXJUYW5nZW50cywgMCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya01lc2guZ2VvbWV0cnkudXBkYXRlVmVydGljZXNEYXRhRGlyZWN0bHkoQkFCWUxPTi5WZXJ0ZXhCdWZmZXIuQ29sb3JLaW5kLCBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlckNvbG9ycywgMCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya01lc2guZ2VvbWV0cnkudXBkYXRlVmVydGljZXNEYXRhRGlyZWN0bHkoQkFCWUxPTi5WZXJ0ZXhCdWZmZXIuVVZLaW5kLCBTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlclV2cywgMCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIFNraWRtYXJrTWFuYWdlci5Ta2lkbWFya01lc2guZ2VvbWV0cnkudXBkYXRlSW5kaWNlcyhTa2lkbWFya01hbmFnZXIuU2tpZEJ1ZmZlckluZGljZXMsIDAsIFNraWRtYXJrTWFuYWdlci5HUFVfVFJJQU5HTEVTKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0iLCIvKipcbiAqIEJhYnlsb24gc3RhbmRhcmQgcmlnaWRib2R5IHZlaGljbGUgY29udHJvbGxlciBjbGFzcyAoTmF0aXZlIEJ1bGxldCBQaHlzaWNzIDIuODIpXG4gKiBAY2xhc3MgU3RhbmRhcmRDYXJDb250cm9sbGVyXG4gKi9cbmNsYXNzIFN0YW5kYXJkQ2FyQ29udHJvbGxlciBleHRlbmRzIEJBQllMT04uU2NyaXB0Q29tcG9uZW50IHtcbiAgICBwcml2YXRlIF9yaWdpZGJvZHk6QkFCWUxPTi5SaWdpZGJvZHlQaHlzaWNzID0gbnVsbDtcbiAgICBwcml2YXRlIF9lbmdpbmVBdWRpb1NvdXJjZTpCQUJZTE9OLkF1ZGlvU291cmNlID0gbnVsbDtcbiAgICBwcml2YXRlIF9za2lkRkxBdWRpb1NvdXJjZTpCQUJZTE9OLkF1ZGlvU291cmNlID0gbnVsbDtcbiAgICBwcml2YXRlIF9za2lkRlJBdWRpb1NvdXJjZTpCQUJZTE9OLkF1ZGlvU291cmNlID0gbnVsbDtcbiAgICBwcml2YXRlIF9za2lkUkxBdWRpb1NvdXJjZTpCQUJZTE9OLkF1ZGlvU291cmNlID0gbnVsbDtcbiAgICBwcml2YXRlIF9za2lkUlJBdWRpb1NvdXJjZTpCQUJZTE9OLkF1ZGlvU291cmNlID0gbnVsbDtcblxuICAgIHByaXZhdGUgZ2VhckluZGV4Om51bWJlciA9IDE7IC8vIDA6IFJldmVyc2UsIDE6IE5ldXRyYWwsIDI6IDFzdFxuICAgIHByaXZhdGUgc2hpZnRpbmdHZWFyczpib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSB2ZWhpY2xlU3RlZXI6bnVtYmVyID0gMDtcbiAgICBwcml2YXRlIGVuZ2luZUZvcmNlOm51bWJlciA9IDA7XG4gICAgcHJpdmF0ZSBicmFraW5nRm9yY2U6bnVtYmVyID0gMDtcbiAgICBwcml2YXRlIGZvcndhcmRTcGVlZDpudW1iZXIgPSAwO1xuICAgIHByaXZhdGUgYWJzb2x1dGVTcGVlZDpudW1iZXIgPSAwO1xuICAgIHByaXZhdGUgYW1lcmljYW5TcGVlZDpudW1iZXIgPSAwO1xuICAgIHByaXZhdGUgbm9ybWFsaXplZFNwZWVkOm51bWJlciA9IDA7XG4gICAgcHJpdmF0ZSByYXljYXN0VmVoaWNsZTpCQUJZTE9OLlJheWNhc3RWZWhpY2xlID0gbnVsbDtcbiAgICBwcml2YXRlIGZyb250TGVmdFdoZWVsTWVzaDpCQUJZTE9OLlRyYW5zZm9ybU5vZGUgPSBudWxsO1xuICAgIHByaXZhdGUgZnJvbnRSaWdodFdoZWVsTWVzaDpCQUJZTE9OLlRyYW5zZm9ybU5vZGUgPSBudWxsO1xuICAgIHByaXZhdGUgYmFja0xlZnRXaGVlbE1lc2g6QkFCWUxPTi5UcmFuc2Zvcm1Ob2RlID0gbnVsbDtcbiAgICBwcml2YXRlIGJhY2tSaWdodFdoZWVsTWVzaDpCQUJZTE9OLlRyYW5zZm9ybU5vZGUgPSBudWxsO1xuICAgIHByaXZhdGUgZnJvbnRMZWZ0V2hlZWxUcmFuczpCQUJZTE9OLklVbml0eVRyYW5zZm9ybSA9IG51bGw7XG4gICAgcHJpdmF0ZSBmcm9udFJpZ2h0V2hlZWxUcmFuczpCQUJZTE9OLklVbml0eVRyYW5zZm9ybSA9IG51bGw7XG4gICAgcHJpdmF0ZSBiYWNrTGVmdFdoZWVsVHJhbnM6QkFCWUxPTi5JVW5pdHlUcmFuc2Zvcm0gPSBudWxsO1xuICAgIHByaXZhdGUgYmFja1JpZ2h0V2hlZWxUcmFuczpCQUJZTE9OLklVbml0eVRyYW5zZm9ybSA9IG51bGw7XG4gICAgcHJpdmF0ZSBmcm9udExlZnRXaGVlbENvbGxpZGVyOmFueSA9IG51bGw7XG4gICAgcHJpdmF0ZSBmcm9udFJpZ2h0V2hlZWxDb2xsaWRlcjphbnkgPSBudWxsO1xuICAgIHByaXZhdGUgYmFja0xlZnRXaGVlbENvbGxpZGVyOmFueSA9IG51bGw7XG4gICAgcHJpdmF0ZSBiYWNrUmlnaHRXaGVlbENvbGxpZGVyOmFueSA9IG51bGw7XG4gICAgcHJpdmF0ZSBlbmdpbmVUb3JxdWVDdXJ2ZTpCQUJZTE9OLkFuaW1hdGlvbiA9IG51bGw7XG4gICAgcHJpdmF0ZSB3aGVlbFJhZGl1czpudW1iZXIgPSAwO1xuICAgIHByaXZhdGUgc2hpZnREZWxheTpudW1iZXIgPSAwO1xuICAgIHByaXZhdGUgY2x1dGNoU2xpcDpudW1iZXIgPSAwO1xuICAgIHByaXZhdGUgZW5naW5lUlBNOm51bWJlciA9IDA7XG4gICAgcHJpdmF0ZSBsZXJwZWRSUE06bnVtYmVyID0gMDtcbiAgICBwcml2YXRlIG9sZFJQTTpudW1iZXIgPSAwO1xuXG5cbiAgICBwcml2YXRlIFNURUVSX1JBRElVUzpudW1iZXIgPSAwLjU7XG4gICAgcHJpdmF0ZSBGUk9OVF9MRUZUOm51bWJlciA9IC0xO1xuICAgIHByaXZhdGUgRlJPTlRfUklHSFQ6bnVtYmVyID0gLTE7XG4gICAgcHJpdmF0ZSBCQUNLX0xFRlQ6bnVtYmVyID0gLTE7XG4gICAgcHJpdmF0ZSBCQUNLX1JJR0hUOm51bWJlciA9IC0xO1xuXG4gICAgcHVibGljIGdldFJheWNhc3RWZWhpY2xlKCk6QkFCWUxPTi5SYXljYXN0VmVoaWNsZSB7IHJldHVybiB0aGlzLnJheWNhc3RWZWhpY2xlOyB9XG4gICAgcHVibGljIGdldEFic29sdXRlU3BlZWQoKTpudW1iZXIgeyByZXR1cm4gdGhpcy5hYnNvbHV0ZVNwZWVkOyB9XG4gICAgcHVibGljIGdldE5vcm1hbGl6ZWRTcGVlZCgpOm51bWJlciB7IHJldHVybiB0aGlzLm5vcm1hbGl6ZWRTcGVlZDsgfVxuICAgIHB1YmxpYyBnZXRDdXJyZW50R2VhckluZGV4KCk6bnVtYmVyIHsgcmV0dXJuIHRoaXMuZ2VhckluZGV4IH1cbiAgICBwdWJsaWMgZ2V0Q3VycmVudEVuZ2luZVJQTSgpOm51bWJlciB7IHJldHVybiB0aGlzLmVuZ2luZVJQTSB9XG4gICAgcHVibGljIGdldEN1cnJlbnRFbmdpbmVQaXRjaCgpOm51bWJlciB7IHJldHVybiBCQUJZTE9OLlNjYWxhci5DbGFtcCgodGhpcy5sZXJwZWRSUE0gLyB0aGlzLmxlcnBFbmdpbmVQaXRjaGluZykgKyAwLjEpOyB9XG4gICAgcHVibGljIGdldEdlYXJTaGlmdFJhdGlvQ291bnQoKTpudW1iZXIgeyByZXR1cm4gKHRoaXMuZ2VhckJveFNoaWZ0UmF0aW9zICE9IG51bGwpID8gdGhpcy5nZWFyQm94U2hpZnRSYXRpb3MubGVuZ3RoIDogMCB9XG5cbiAgICBwdWJsaWMgc21va2VUZXh0dXJlOmFueSA9IG51bGw7XG4gICAgcHVibGljIHNoYWRvd1RleHR1cmU6YW55ID0gbnVsbDtcbiAgICBwdWJsaWMgc2V0RW5naW5lVG9ycXVlOmFueSA9IG51bGw7XG4gICAgcHVibGljIHRvcEVuZ2luZVNwZWVkOm51bWJlciA9IDEyMDtcbiAgICBwdWJsaWMgbG93U3BlZWRBbmdsZTpudW1iZXIgPSAwLjI1O1xuICAgIHB1YmxpYyBoaWdoU3BlZWRBbmdsZTpudW1iZXIgPSAwLjAxMjU7XG4gICAgcHVibGljIHRyYW5zbWlzc2lvblJhdGlvID0gMC43O1xuICAgIHB1YmxpYyBkaWZmZXJlbnRpYWxSYXRpbyA9IDMuNTU7XG4gICAgcHVibGljIG1heEJyYWtpbmdGb3JjZTpudW1iZXIgPSAxMDA7XG4gICAgcHVibGljIG1heFJldmVyc2VTcGVlZDpudW1iZXIgPSAwLjY2O1xuICAgIHB1YmxpYyBsZXJwRW5naW5lUGl0Y2hpbmcgPSA1MDAwO1xuICAgIHB1YmxpYyBoYW5kQnJha2luZ0ZvcmNlOm51bWJlciA9IDEwMDA7XG4gICAgcHVibGljIHdoZWVsTG9ja0ZyaWN0aW9uOm51bWJlciA9IDAuMTtcbiAgICBwdWJsaWMgZHJpZnRpbmdJbmZsdWVuY2U6bnVtYmVyID0gMDtcbiAgICBwdWJsaWMgbG93U3BlZWRJbmNyZW1lbnQ6bnVtYmVyID0gMC4wMTI1O1xuICAgIHB1YmxpYyBoaWdoU3BlZWRJbmNyZW1lbnQ6bnVtYmVyID0gMC4wMTI1O1xuICAgIHB1YmxpYyBmcmljdGlvblNsaXBTcGVlZDpudW1iZXIgPSAxMDtcbiAgICBwdWJsaWMgd2hlZWxEcml2ZVR5cGU6bnVtYmVyID0gMDtcbiAgICBwdWJsaWMgZ2VhckJveFNoaWZ0RGVsYXk6bnVtYmVyID0gMC4zO1xuICAgIHB1YmxpYyBnZWFyQm94U2hpZnROZXh0Om51bWJlciA9IDM1MDA7XG4gICAgcHVibGljIGdlYXJCb3hTaGlmdERvd246bnVtYmVyID0gMjUwMDtcbiAgICBwdWJsaWMgZ2VhckJveFNoaWZ0UmF0aW9zOm51bWJlcltdID0gWzMuNDM3LCAwLjAwLCAzLjYyNiwgMi4yLCAxLjU0MSwgMS4yMTMsIDEuMCwgMC43NjddO1xuXHRwdWJsaWMgZ2VhckJveFNoaWZ0U2NhbGVzOm51bWJlcltdID0gWzEuMCwgMS4wLCAxLjAsIDEuMCwgMS4wLCAxLjAsIDEuMCwgMS4wXTtcblxuICAgIHByb3RlY3RlZCBtX2Zyb250TGVmdFdoZWVsOmFueSA9IG51bGw7XG4gICAgcHJvdGVjdGVkIG1fZnJvbnRSaWdodFdoZWVsOmFueSA9IG51bGw7XG4gICAgcHJvdGVjdGVkIG1fYmFja0xlZnRXaGVlbDphbnkgPSBudWxsO1xuICAgIHByb3RlY3RlZCBtX2JhY2tSaWdodFdoZWVsOmFueSA9IG51bGw7XG4gICAgcHJvdGVjdGVkIG1fcGh5c2ljc1dvcmxkOmFueSA9IG51bGw7XG4gICAgcHVibGljIGNvbnN0cnVjdG9yKHRyYW5zZm9ybTogQkFCWUxPTi5UcmFuc2Zvcm1Ob2RlLCBzY2VuZTogQkFCWUxPTi5TY2VuZSwgcHJvcGVydGllczogYW55ID0ge30pIHtcbiAgICAgICAgc3VwZXIodHJhbnNmb3JtLCBzY2VuZSwgcHJvcGVydGllcyk7XG4gICAgICAgIHRoaXMudmVoaWNsZVN0ZWVyID0gMDtcbiAgICAgICAgdGhpcy5icmFraW5nRm9yY2UgPSAwO1xuICAgICAgICB0aGlzLmVuZ2luZUZvcmNlID0gMDtcbiAgICAgICAgdGhpcy5tX3BoeXNpY3NXb3JsZCA9IEJBQllMT04uU2NlbmVNYW5hZ2VyLkdldFBoeXNpY3NXb3JsZCh0aGlzLnNjZW5lKTtcbiAgICAgICAgdGhpcy5zbW9rZVRleHR1cmUgPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwic21va2VUZXh0dXJlXCIsIHRoaXMuc21va2VUZXh0dXJlKTtcbiAgICAgICAgdGhpcy5zaGFkb3dUZXh0dXJlID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcInNoYWRvd1RleHR1cmVcIiwgdGhpcy5zaGFkb3dUZXh0dXJlKTtcbiAgICAgICAgdGhpcy5zZXRFbmdpbmVUb3JxdWUgPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwic2V0RW5naW5lVG9ycXVlXCIsIHRoaXMuc2V0RW5naW5lVG9ycXVlKTtcbiAgICAgICAgdGhpcy50b3BFbmdpbmVTcGVlZCA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJ0b3BFbmdpbmVTcGVlZFwiLCB0aGlzLnRvcEVuZ2luZVNwZWVkKTtcbiAgICAgICAgdGhpcy5sb3dTcGVlZEFuZ2xlID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcImxvd1NwZWVkQW5nbGVcIiwgdGhpcy5sb3dTcGVlZEFuZ2xlKTtcbiAgICAgICAgdGhpcy5oaWdoU3BlZWRBbmdsZSA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJoaWdoU3BlZWRBbmdsZVwiLCB0aGlzLmhpZ2hTcGVlZEFuZ2xlKTtcbiAgICAgICAgdGhpcy53aGVlbERyaXZlVHlwZSA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJ3aGVlbERyaXZlVHlwZVwiLCB0aGlzLndoZWVsRHJpdmVUeXBlKTtcbiAgICAgICAgdGhpcy5tYXhCcmFraW5nRm9yY2UgPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwibWF4QnJha2luZ0ZvcmNlXCIsIHRoaXMubWF4QnJha2luZ0ZvcmNlKTtcbiAgICAgICAgdGhpcy5oYW5kQnJha2luZ0ZvcmNlID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcImhhbmRCcmFraW5nRm9yY2VcIiwgdGhpcy5oYW5kQnJha2luZ0ZvcmNlKTtcbiAgICAgICAgdGhpcy5kcmlmdGluZ0luZmx1ZW5jZSA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJkcmlmdGluZ0luZmx1ZW5jZVwiLCB0aGlzLmRyaWZ0aW5nSW5mbHVlbmNlKTtcbiAgICAgICAgdGhpcy53aGVlbExvY2tGcmljdGlvbiA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJ3aGVlbExvY2tGcmljdGlvblwiLCB0aGlzLndoZWVsTG9ja0ZyaWN0aW9uKTtcbiAgICAgICAgdGhpcy5sb3dTcGVlZEluY3JlbWVudCA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJsb3dTcGVlZEluY3JlbWVudFwiLCB0aGlzLmxvd1NwZWVkSW5jcmVtZW50KTtcbiAgICAgICAgdGhpcy5oaWdoU3BlZWRJbmNyZW1lbnQgPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwiaGlnaFNwZWVkSW5jcmVtZW50XCIsIHRoaXMuaGlnaFNwZWVkSW5jcmVtZW50KTtcbiAgICAgICAgdGhpcy5mcm9udExlZnRXaGVlbFRyYW5zID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcImZyb250TGVmdFdoZWVsTWVzaFwiLCB0aGlzLmZyb250TGVmdFdoZWVsVHJhbnMpO1xuICAgICAgICB0aGlzLmZyb250UmlnaHRXaGVlbFRyYW5zID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcImZyb250UmlnaHRXaGVlbE1lc2hcIiwgdGhpcy5mcm9udFJpZ2h0V2hlZWxUcmFucyk7XG4gICAgICAgIHRoaXMuYmFja0xlZnRXaGVlbFRyYW5zID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcInJlYXJMZWZ0V2hlZWxNZXNoXCIsIHRoaXMuYmFja0xlZnRXaGVlbFRyYW5zKTtcbiAgICAgICAgdGhpcy5iYWNrUmlnaHRXaGVlbFRyYW5zID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcInJlYXJSaWdodFdoZWVsTWVzaFwiLCB0aGlzLmJhY2tSaWdodFdoZWVsVHJhbnMpO1xuICAgICAgICB0aGlzLmZyb250TGVmdFdoZWVsQ29sbGlkZXIgPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwiZnJvbnRMZWZ0V2hlZWxDb2xsaWRlclwiLCB0aGlzLmZyb250TGVmdFdoZWVsQ29sbGlkZXIpO1xuICAgICAgICB0aGlzLmZyb250UmlnaHRXaGVlbENvbGxpZGVyID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcImZyb250UmlnaHRXaGVlbENvbGxpZGVyXCIsIHRoaXMuZnJvbnRSaWdodFdoZWVsQ29sbGlkZXIpO1xuICAgICAgICB0aGlzLmJhY2tMZWZ0V2hlZWxDb2xsaWRlciA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJyZWFyTGVmdFdoZWVsQ29sbGlkZXJcIiwgdGhpcy5iYWNrTGVmdFdoZWVsQ29sbGlkZXIpO1xuICAgICAgICB0aGlzLmJhY2tSaWdodFdoZWVsQ29sbGlkZXIgPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwicmVhclJpZ2h0V2hlZWxDb2xsaWRlclwiLCB0aGlzLmJhY2tSaWdodFdoZWVsQ29sbGlkZXIpO1xuICAgICAgICB0aGlzLmZyaWN0aW9uU2xpcFNwZWVkID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcImZyaWN0aW9uU2xpcFNwZWVkXCIsIHRoaXMuZnJpY3Rpb25TbGlwU3BlZWQpO1xuICAgICAgICB0aGlzLmxlcnBFbmdpbmVQaXRjaGluZyA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJsZXJwRW5naW5lUGl0Y2hpbmdcIiwgdGhpcy5sZXJwRW5naW5lUGl0Y2hpbmcpO1xuICAgICAgICB0aGlzLmRpZmZlcmVudGlhbFJhdGlvID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcImdlYXJCb3hEaWZmZXJlbnRpYWxcIiwgdGhpcy5kaWZmZXJlbnRpYWxSYXRpbyk7XG4gICAgICAgIHRoaXMudHJhbnNtaXNzaW9uUmF0aW8gPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwiZ2VhckJveE92ZXJkcml2ZVwiLCB0aGlzLnRyYW5zbWlzc2lvblJhdGlvKTtcbiAgICAgICAgdGhpcy5nZWFyQm94U2hpZnROZXh0ID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcImdlYXJCb3hTaGlmdE5leHRcIiwgdGhpcy5nZWFyQm94U2hpZnROZXh0KTtcbiAgICAgICAgdGhpcy5nZWFyQm94U2hpZnREb3duID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcImdlYXJCb3hTaGlmdERvd25cIiwgdGhpcy5nZWFyQm94U2hpZnREb3duKTtcbiAgICAgICAgdGhpcy5nZWFyQm94U2hpZnREZWxheSA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJnZWFyQm94U2hpZnREZWxheVwiLCB0aGlzLmdlYXJCb3hTaGlmdERlbGF5KTtcbiAgICAgICAgdGhpcy5nZWFyQm94U2hpZnRSYXRpb3MgPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwiZ2VhckJveFNoaWZ0UmF0aW9zXCIsIHRoaXMuZ2VhckJveFNoaWZ0UmF0aW9zKTtcbiAgICAgICAgdGhpcy5nZWFyQm94U2hpZnRTY2FsZXMgPSB0aGlzLmdldEVkaXRvclByb3BlcnR5KFwiZ2VhckJveFNoaWZ0U2NhbGVzXCIsIHRoaXMuZ2VhckJveFNoaWZ0U2NhbGVzKTtcblxuICAgICAgICBpZiAodGhpcy5sb3dTcGVlZEFuZ2xlIDw9IDApIHRoaXMubG93U3BlZWRBbmdsZSA9IDAuMztcbiAgICAgICAgaWYgKHRoaXMuaGlnaFNwZWVkQW5nbGUgPD0gMCkgdGhpcy5oaWdoU3BlZWRBbmdsZSA9IDAuMDEyNTtcbiAgICAgICAgaWYgKHRoaXMubG93U3BlZWRJbmNyZW1lbnQgPD0gMCkgdGhpcy5sb3dTcGVlZEluY3JlbWVudCA9IDAuMDEyNTtcbiAgICAgICAgaWYgKHRoaXMuaGlnaFNwZWVkSW5jcmVtZW50IDw9IDApIHRoaXMuaGlnaFNwZWVkSW5jcmVtZW50ID0gMC4wMTI1O1xuICAgICAgICBpZiAodGhpcy5sZXJwRW5naW5lUGl0Y2hpbmcgPD0gMCkgdGhpcy5sZXJwRW5naW5lUGl0Y2hpbmcgPSA1MDAwO1xuICAgICAgICBpZiAodGhpcy5nZWFyQm94U2hpZnROZXh0IDw9IDApIHRoaXMuZ2VhckJveFNoaWZ0TmV4dCA9IDM1MDA7XG4gICAgICAgIGlmICh0aGlzLmdlYXJCb3hTaGlmdERvd24gPD0gMCkgdGhpcy5nZWFyQm94U2hpZnROZXh0ID0gMjUwMDtcbiAgICAgICAgaWYgKHRoaXMuZ2VhckJveFNoaWZ0RGVsYXkgPD0gMCkgdGhpcy5nZWFyQm94U2hpZnREZWxheSA9IDAuMztcbiAgICAgICAgaWYgKHRoaXMudHJhbnNtaXNzaW9uUmF0aW8gPD0gMCkgdGhpcy50cmFuc21pc3Npb25SYXRpbyA9IDE7XG4gICAgICAgIGlmICh0aGlzLmRpZmZlcmVudGlhbFJhdGlvIDw9IDApIHRoaXMuZGlmZmVyZW50aWFsUmF0aW8gPSAxO1xuICAgICAgICBpZiAodGhpcy5kcmlmdGluZ0luZmx1ZW5jZSA8PSAwKSB0aGlzLmRyaWZ0aW5nSW5mbHVlbmNlID0gMTtcbiAgICAgICAgaWYgKHRoaXMuZnJpY3Rpb25TbGlwU3BlZWQgPD0gMCkgdGhpcy5mcmljdGlvblNsaXBTcGVlZCA9IDE7XG4gICAgICAgIGlmICh0aGlzLnNldEVuZ2luZVRvcnF1ZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAvLyBUT0RPOiBVU0UgRU5HSU5FIFRPUlFVRSBDVVJWRVNcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIlNldHVwIEVuZ2luZSBUb3JxdWUgQW5pbWF0aW9uXCIpO1xuICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5zZXRFbmdpbmVUb3JxdWUpO1xuICAgICAgICAgICAgLy90aGlzLmVuZ2luZVRvcnF1ZUN1cnZlID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBzdGFydCgpOnZvaWQgeyB0aGlzLmluaXRWZWhpY2xlU3RhdGUoKTsgfVxuICAgIHByb3RlY3RlZCB1cGRhdGUoKSA6dm9pZCB7ICB0aGlzLnVwZGF0ZVZlaGljbGVTdGF0ZSgpOyB9XG4gICAgcHJvdGVjdGVkIGRlc3Ryb3koKTogdm9pZCB7IHRoaXMuZGVzdHJveVZlaGljbGVTdGF0ZSgpOyB9XG5cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIC8vIFByb3RlY3RlZCBWZWhpY2xlIE1vdmVtZW50IFN0YXRlIEZ1bmN0aW9ucyAvL1xuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICBcbiAgICBwcm90ZWN0ZWQgaW5pdFZlaGljbGVTdGF0ZSgpOiB2b2lkIHtcbiAgICAgICAgQkFCWUxPTi5VdGlsaXRpZXMuVmFsaWRhdGVUcmFuc2Zvcm1RdWF0ZXJuaW9uKHRoaXMudHJhbnNmb3JtKTtcbiAgICAgICAgLy8gU2V0dXAgRW5naW5lIEF1ZGlvXG4gICAgICAgIHRoaXMuX2VuZ2luZUF1ZGlvU291cmNlID0gdGhpcy5nZXRDb21wb25lbnQoXCJCQUJZTE9OLkF1ZGlvU291cmNlXCIpO1xuICAgICAgICBpZiAodGhpcy5fZW5naW5lQXVkaW9Tb3VyY2UgPT0gbnVsbCkgQkFCWUxPTi5Ub29scy5XYXJuKFwiTm8gZW5naW5lIGF1ZGlvIHNvdXJjZSBtYW5hZ2VyIGZvdW5kIGZvcjogXCIgKyB0aGlzLnRyYW5zZm9ybS5uYW1lKTtcbiAgICAgICAgLy8gU2V0dXAgUmF5Y2FzdCBWZWhpY2xlXG4gICAgICAgIHRoaXMuX3JpZ2lkYm9keSA9IHRoaXMuZ2V0Q29tcG9uZW50KFwiQkFCWUxPTi5SaWdpZGJvZHlQaHlzaWNzXCIpO1xuICAgICAgICBpZiAodGhpcy5fcmlnaWRib2R5ICE9IG51bGwpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9yaWdpZGJvZHkuaGFzUmF5Y2FzdFZlaGljbGUoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmF5Y2FzdFZlaGljbGUgPSB0aGlzLl9yaWdpZGJvZHkuZ2V0UmF5Y2FzdFZlaGljbGUoKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yYXljYXN0VmVoaWNsZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZyb250TGVmdFdoZWVsTmFtZTpzdHJpbmcgPSAodGhpcy5mcm9udExlZnRXaGVlbFRyYW5zLm5hbWUgIT0gbnVsbCAmJiB0aGlzLmZyb250TGVmdFdoZWVsVHJhbnMubmFtZSAhPT0gXCJcIikgPyB0aGlzLmZyb250TGVmdFdoZWVsVHJhbnMubmFtZSA6IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZyb250UmlnaHRXaGVlbE5hbWU6c3RyaW5nID0gKHRoaXMuZnJvbnRSaWdodFdoZWVsVHJhbnMubmFtZSAhPSBudWxsICYmIHRoaXMuZnJvbnRSaWdodFdoZWVsVHJhbnMubmFtZSAhPT0gXCJcIikgPyB0aGlzLmZyb250UmlnaHRXaGVlbFRyYW5zLm5hbWUgOiBudWxsO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBiYWNrTGVmdFdoZWVsTmFtZTpzdHJpbmcgPSAodGhpcy5iYWNrTGVmdFdoZWVsVHJhbnMubmFtZSAhPSBudWxsICYmIHRoaXMuYmFja0xlZnRXaGVlbFRyYW5zLm5hbWUgIT09IFwiXCIpID8gdGhpcy5iYWNrTGVmdFdoZWVsVHJhbnMubmFtZSA6IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJhY2tSaWdodFdoZWVsTmFtZTpzdHJpbmcgPSAodGhpcy5iYWNrUmlnaHRXaGVlbFRyYW5zLm5hbWUgIT0gbnVsbCAmJiB0aGlzLmJhY2tSaWdodFdoZWVsVHJhbnMubmFtZSAhPT0gXCJcIikgPyB0aGlzLmJhY2tSaWdodFdoZWVsVHJhbnMubmFtZSA6IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZyb250TGVmdFdoZWVsTGFiZWw6c3RyaW5nID0gKHRoaXMuZnJvbnRMZWZ0V2hlZWxDb2xsaWRlci5uYW1lICE9IG51bGwgJiYgdGhpcy5mcm9udExlZnRXaGVlbENvbGxpZGVyLm5hbWUgIT09IFwiXCIpID8gdGhpcy5mcm9udExlZnRXaGVlbENvbGxpZGVyLm5hbWUgOiBudWxsO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmcm9udFJpZ2h0V2hlZWxMYWJlbDpzdHJpbmcgPSAodGhpcy5mcm9udFJpZ2h0V2hlZWxDb2xsaWRlci5uYW1lICE9IG51bGwgJiYgdGhpcy5mcm9udFJpZ2h0V2hlZWxDb2xsaWRlci5uYW1lICE9PSBcIlwiKSA/IHRoaXMuZnJvbnRSaWdodFdoZWVsQ29sbGlkZXIubmFtZSA6IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJhY2tMZWZ0V2hlZWxMYWJlbDpzdHJpbmcgPSAodGhpcy5iYWNrTGVmdFdoZWVsQ29sbGlkZXIubmFtZSAhPSBudWxsICYmIHRoaXMuYmFja0xlZnRXaGVlbENvbGxpZGVyLm5hbWUgIT09IFwiXCIpID8gdGhpcy5iYWNrTGVmdFdoZWVsQ29sbGlkZXIubmFtZSA6IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJhY2tSaWdodFdoZWVsTGFiZWw6c3RyaW5nID0gKHRoaXMuYmFja1JpZ2h0V2hlZWxDb2xsaWRlci5uYW1lICE9IG51bGwgJiYgdGhpcy5iYWNrUmlnaHRXaGVlbENvbGxpZGVyLm5hbWUgIT09IFwiXCIpID8gdGhpcy5iYWNrUmlnaHRXaGVlbENvbGxpZGVyLm5hbWUgOiBudWxsO1xuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgV2hlZWwgSW5kZXhzIGZyb20gV2hlZWwgTmFtZXNcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZyb250TGVmdFdoZWVsTGFiZWwgIT0gbnVsbCkgdGhpcy5GUk9OVF9MRUZUID0gdGhpcy5yYXljYXN0VmVoaWNsZS5nZXRXaGVlbEluZGV4QnlOYW1lKGZyb250TGVmdFdoZWVsTGFiZWwpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZnJvbnRSaWdodFdoZWVsTGFiZWwgIT0gbnVsbCkgdGhpcy5GUk9OVF9SSUdIVCA9IHRoaXMucmF5Y2FzdFZlaGljbGUuZ2V0V2hlZWxJbmRleEJ5TmFtZShmcm9udFJpZ2h0V2hlZWxMYWJlbCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChiYWNrTGVmdFdoZWVsTGFiZWwgIT0gbnVsbCkgdGhpcy5CQUNLX0xFRlQgPSB0aGlzLnJheWNhc3RWZWhpY2xlLmdldFdoZWVsSW5kZXhCeU5hbWUoYmFja0xlZnRXaGVlbExhYmVsKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJhY2tSaWdodFdoZWVsTGFiZWwgIT0gbnVsbCkgdGhpcy5CQUNLX1JJR0hUID0gdGhpcy5yYXljYXN0VmVoaWNsZS5nZXRXaGVlbEluZGV4QnlOYW1lKGJhY2tSaWdodFdoZWVsTGFiZWwpO1xuICAgICAgICAgICAgICAgICAgICAvLyBTZXR1cCBXaGVlbCBJbmZvIEFuZCBUcmFuc2Zvcm0gTWVzaGVzXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJheWNhc3RWZWhpY2xlLmdldE51bVdoZWVscygpID49IDQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLkZST05UX0xFRlQgPj0gMCAmJiBmcm9udExlZnRXaGVlbE5hbWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubV9mcm9udExlZnRXaGVlbCA9IHRoaXMucmF5Y2FzdFZlaGljbGUuZ2V0V2hlZWxJbmZvKHRoaXMuRlJPTlRfTEVGVCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mcm9udExlZnRXaGVlbE1lc2ggPSB0aGlzLmdldENoaWxkVHJhbnNmb3JtKGZyb250TGVmdFdoZWVsTmFtZSwgQkFCWUxPTi5TZWFyY2hUeXBlLlN0YXJ0c1dpdGgsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5mcm9udExlZnRXaGVlbE1lc2ggIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJheWNhc3RWZWhpY2xlLnNldFdoZWVsVHJhbnNmb3JtTWVzaCh0aGlzLkZST05UX0xFRlQsIHRoaXMuZnJvbnRMZWZ0V2hlZWxNZXNoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2tpZEZMQXVkaW9Tb3VyY2UgPSBCQUJZTE9OLlNjZW5lTWFuYWdlci5GaW5kU2NyaXB0Q29tcG9uZW50KHRoaXMuZnJvbnRMZWZ0V2hlZWxNZXNoLCBcIkJBQllMT04uQXVkaW9Tb3VyY2VcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9za2lkRkxBdWRpb1NvdXJjZSA9PSBudWxsKSBCQUJZTE9OLlRvb2xzLldhcm4oXCJObyBmcm9udCBsZWZ0IHNraWQgYXVkaW8gc291cmNlIG1hbmFnZXIgZm91bmQgZm9yOiBcIiArIHRoaXMudHJhbnNmb3JtLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLkZST05UX1JJR0hUID49IDAgJiYgZnJvbnRSaWdodFdoZWVsTmFtZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tX2Zyb250UmlnaHRXaGVlbCA9IHRoaXMucmF5Y2FzdFZlaGljbGUuZ2V0V2hlZWxJbmZvKHRoaXMuRlJPTlRfUklHSFQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZnJvbnRSaWdodFdoZWVsTWVzaCA9IHRoaXMuZ2V0Q2hpbGRUcmFuc2Zvcm0oZnJvbnRSaWdodFdoZWVsTmFtZSwgQkFCWUxPTi5TZWFyY2hUeXBlLlN0YXJ0c1dpdGgsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5mcm9udFJpZ2h0V2hlZWxNZXNoICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yYXljYXN0VmVoaWNsZS5zZXRXaGVlbFRyYW5zZm9ybU1lc2godGhpcy5GUk9OVF9SSUdIVCwgdGhpcy5mcm9udFJpZ2h0V2hlZWxNZXNoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2tpZEZSQXVkaW9Tb3VyY2UgPSBCQUJZTE9OLlNjZW5lTWFuYWdlci5GaW5kU2NyaXB0Q29tcG9uZW50KHRoaXMuZnJvbnRSaWdodFdoZWVsTWVzaCwgXCJCQUJZTE9OLkF1ZGlvU291cmNlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc2tpZEZSQXVkaW9Tb3VyY2UgPT0gbnVsbCkgQkFCWUxPTi5Ub29scy5XYXJuKFwiTm8gZnJvbnQgcmlnaHQgc2tpZCBhdWRpbyBzb3VyY2UgbWFuYWdlciBmb3VuZCBmb3I6IFwiICsgdGhpcy50cmFuc2Zvcm0ubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuQkFDS19MRUZUID49IDAgJiYgYmFja0xlZnRXaGVlbE5hbWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubV9iYWNrTGVmdFdoZWVsID0gdGhpcy5yYXljYXN0VmVoaWNsZS5nZXRXaGVlbEluZm8odGhpcy5CQUNLX0xFRlQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLndoZWVsUmFkaXVzIDw9IDAgJiYgdGhpcy5tX2JhY2tMZWZ0V2hlZWwgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndoZWVsUmFkaXVzID0gdGhpcy5tX2JhY2tMZWZ0V2hlZWwuZ2V0X21fd2hlZWxzUmFkaXVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmFja0xlZnRXaGVlbE1lc2ggPSB0aGlzLmdldENoaWxkVHJhbnNmb3JtKGJhY2tMZWZ0V2hlZWxOYW1lLCBCQUJZTE9OLlNlYXJjaFR5cGUuU3RhcnRzV2l0aCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmJhY2tMZWZ0V2hlZWxNZXNoICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yYXljYXN0VmVoaWNsZS5zZXRXaGVlbFRyYW5zZm9ybU1lc2godGhpcy5CQUNLX0xFRlQsIHRoaXMuYmFja0xlZnRXaGVlbE1lc2gpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9za2lkUkxBdWRpb1NvdXJjZSA9IEJBQllMT04uU2NlbmVNYW5hZ2VyLkZpbmRTY3JpcHRDb21wb25lbnQodGhpcy5iYWNrTGVmdFdoZWVsTWVzaCwgXCJCQUJZTE9OLkF1ZGlvU291cmNlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc2tpZFJMQXVkaW9Tb3VyY2UgPT0gbnVsbCkgQkFCWUxPTi5Ub29scy5XYXJuKFwiTm8gcmVhciBsZWZ0IHNraWQgYXVkaW8gc291cmNlIG1hbmFnZXIgZm91bmQgZm9yOiBcIiArIHRoaXMudHJhbnNmb3JtLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLkJBQ0tfUklHSFQgPj0gMCAmJiBiYWNrUmlnaHRXaGVlbE5hbWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubV9iYWNrUmlnaHRXaGVlbCA9IHRoaXMucmF5Y2FzdFZlaGljbGUuZ2V0V2hlZWxJbmZvKHRoaXMuQkFDS19SSUdIVCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMud2hlZWxSYWRpdXMgPD0gMCAmJiB0aGlzLm1fYmFja1JpZ2h0V2hlZWwgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndoZWVsUmFkaXVzID0gdGhpcy5tX2JhY2tSaWdodFdoZWVsLmdldF9tX3doZWVsc1JhZGl1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJhY2tSaWdodFdoZWVsTWVzaCA9IHRoaXMuZ2V0Q2hpbGRUcmFuc2Zvcm0oYmFja1JpZ2h0V2hlZWxOYW1lLCBCQUJZTE9OLlNlYXJjaFR5cGUuU3RhcnRzV2l0aCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmJhY2tSaWdodFdoZWVsTWVzaCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmF5Y2FzdFZlaGljbGUuc2V0V2hlZWxUcmFuc2Zvcm1NZXNoKHRoaXMuQkFDS19SSUdIVCwgdGhpcy5iYWNrUmlnaHRXaGVlbE1lc2gpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9za2lkUlJBdWRpb1NvdXJjZSA9IEJBQllMT04uU2NlbmVNYW5hZ2VyLkZpbmRTY3JpcHRDb21wb25lbnQodGhpcy5iYWNrUmlnaHRXaGVlbE1lc2gsIFwiQkFCWUxPTi5BdWRpb1NvdXJjZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3NraWRSUkF1ZGlvU291cmNlID09IG51bGwpIEJBQllMT04uVG9vbHMuV2FybihcIk5vIHJlYXIgcmlnaHQgc2tpZCBhdWRpbyBzb3VyY2UgbWFuYWdlciBmb3VuZCBmb3I6IFwiICsgdGhpcy50cmFuc2Zvcm0ubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgQkFCWUxPTi5Ub29scy5XYXJuKFwiSW52YWxpZCB2ZWhpY2xlIGNvbnRyb2xsZXIgd2hlZWwgY291bnQgaW5mbyBmb3I6IFwiICsgdGhpcy50cmFuc2Zvcm0ubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBCQUJZTE9OLlRvb2xzLldhcm4oXCJGYWlsZWQgdG8gY3JlYXRlIHZlaGljbGUgY29udHJvbGxlciBmb3I6IFwiICsgdGhpcy50cmFuc2Zvcm0ubmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBCQUJZTE9OLlRvb2xzLldhcm4oXCJObyB3aGVlbCBjb2xsaWRlciBpbmZvcm1hdGlvbiBmb3VuZCBmb3I6IFwiICsgdGhpcy50cmFuc2Zvcm0ubmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBCQUJZTE9OLlRvb2xzLldhcm4oXCJGYWlsZWQgdG8gZ2V0IHJpZ2lkYm9keSBjb21wb25lbnQ6IFwiICsgdGhpcy50cmFuc2Zvcm0ubmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIG1fZnJvbnRMZWZ0V2hlZWxTa2lkOm51bWJlciA9IC0xO1xuICAgIHByaXZhdGUgbV9mcm9udFJpZ2h0V2hlZWxTa2lkOm51bWJlciA9IC0xO1xuICAgIHByaXZhdGUgbV9iYWNrTGVmdFdoZWVsU2tpZDpudW1iZXIgPSAtMTtcbiAgICBwcml2YXRlIG1fYmFja1JpZ2h0V2hlZWxTa2lkOm51bWJlciA9IC0xO1xuICAgIHByaXZhdGUgbV92ZWxvY2l0eU9mZnNldDpCQUJZTE9OLlZlY3RvcjMgPSBuZXcgQkFCWUxPTi5WZWN0b3IzKDAsMCwwKTtcblxuICAgIHByb3RlY3RlZCB1cGRhdGVWZWhpY2xlU3RhdGUoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGRlbHRhVGltZSA9IHRoaXMuZ2V0RGVsdGFTZWNvbmRzKCk7XG4gICAgICAgIGlmICh0aGlzLnNoaWZ0RGVsYXkgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnNoaWZ0RGVsYXkgLT0gZGVsdGFUaW1lO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNoaWZ0RGVsYXkgPD0gMCkge1xuICAgICAgICAgICAgdGhpcy5zaGlmdERlbGF5ID0gMDtcbiAgICAgICAgICAgIHRoaXMuc2hpZnRpbmdHZWFycyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9yaWdpZGJvZHkgIT0gbnVsbCAmJiB0aGlzLnJheWNhc3RWZWhpY2xlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuZm9yd2FyZFNwZWVkID0gdGhpcy5yYXljYXN0VmVoaWNsZS5nZXRSYXdDdXJyZW50U3BlZWRLcGgoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmZvcndhcmRTcGVlZCA8IDAuMikgdGhpcy5mb3J3YXJkU3BlZWQgPSAwO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmFic29sdXRlU3BlZWQgPSB0aGlzLnJheWNhc3RWZWhpY2xlLmdldEFic0N1cnJlbnRTcGVlZEtwaCgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuYWJzb2x1dGVTcGVlZCA8IDAuMikgdGhpcy5hYnNvbHV0ZVNwZWVkID0gMDtcbiAgICAgICAgICAgIHRoaXMuYW1lcmljYW5TcGVlZCA9ICh0aGlzLmFic29sdXRlU3BlZWQgKiBCQUJZTE9OLlN5c3RlbS5LcGgyTXBoKTtcbiAgICAgICAgICAgIHRoaXMubm9ybWFsaXplZFNwZWVkID0gQkFCWUxPTi5TY2FsYXIuQ2xhbXAoKHRoaXMuYWJzb2x1dGVTcGVlZCAvIHRoaXMudG9wRW5naW5lU3BlZWQpKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuZ2VhckJveFNoaWZ0UmF0aW9zICE9IG51bGwgJiYgdGhpcy5nZWFySW5kZXggPj0gMCAmJiB0aGlzLmdlYXJJbmRleCA8IHRoaXMuZ2V0R2VhclNoaWZ0UmF0aW9Db3VudCgpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWluaW11bURlbHRhID0gTWF0aC5taW4oTWF0aC5tYXgoZGVsdGFUaW1lLCAxIC8gMjAwKSwgMSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgd2hlZWxEaWFtZXRlcjpudW1iZXIgPSAodGhpcy53aGVlbFJhZGl1cyAqIDIgKiBCQUJZTE9OLlN5c3RlbS5NZXRlcjJJbmNoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBmaW5hbEdlYXJSYXRpbzpudW1iZXIgPSAodGhpcy5nZWFyQm94U2hpZnRSYXRpb3NbdGhpcy5nZWFySW5kZXhdICogdGhpcy5kaWZmZXJlbnRpYWxSYXRpbyAqIHRoaXMudHJhbnNtaXNzaW9uUmF0aW8pO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5lbmdpbmVSUE0gPSAodGhpcy5hbWVyaWNhblNwZWVkICogZmluYWxHZWFyUmF0aW8gKiAzMzYpIC8gd2hlZWxEaWFtZXRlciArIDEwMDA7XG4gICAgICAgICAgICAgICAgdGhpcy5jbHV0Y2hTbGlwID0gQkFCWUxPTi5VdGlsaXRpZXMuTGVycENsYW1wKHRoaXMuY2x1dGNoU2xpcCwgMCwgMSAtIE1hdGgucG93KDAuMDEsIG1pbmltdW1EZWx0YSkpO1xuICAgICAgICAgICAgICAgIHRoaXMubGVycGVkUlBNID0gQkFCWUxPTi5VdGlsaXRpZXMuTGVycENsYW1wKHRoaXMub2xkUlBNLCB0aGlzLmVuZ2luZVJQTSwgKDEgLSB0aGlzLmNsdXRjaFNsaXApKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmVuZ2luZVJQTSA+IHRoaXMuZ2VhckJveFNoaWZ0TmV4dCAmJiB0aGlzLmdlYXJJbmRleCA+IDEgJiYgdGhpcy5jbHV0Y2hTbGlwIDwgMC4wNSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5nZWFySW5kZXggPCAodGhpcy5nZXRHZWFyU2hpZnRSYXRpb0NvdW50KCkgLSAxKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZWFySW5kZXgrKzsgLy8gR2VhciBTaGlmdCBVcFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbHV0Y2hTbGlwID0gMS4wO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbGRSUE0gPSB0aGlzLmVuZ2luZVJQTTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hpZnREZWxheSA9IHRoaXMuZ2VhckJveFNoaWZ0RGVsYXk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoaWZ0aW5nR2VhcnMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmVuZ2luZVJQTSA8IHRoaXMuZ2VhckJveFNoaWZ0RG93biAmJiB0aGlzLmdlYXJJbmRleCA+IDIgJiYgdGhpcy5jbHV0Y2hTbGlwIDwgMC4wNSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdlYXJJbmRleC0tOyAvLyBHZWFyIFNoaWZ0IERvd25cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbHV0Y2hTbGlwID0gMS4wO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9sZFJQTSA9IHRoaXMuZW5naW5lUlBNO1xuICAgICAgICAgICAgICAgICAgICAvL3RoaXMuc2hpZnREZWxheSA9ICh0aGlzLmdlYXJCb3hTaGlmdERlbGF5ICogMC41KTtcbiAgICAgICAgICAgICAgICAgICAgLy90aGlzLnNoaWZ0aW5nR2VhcnMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBBY2NvdW50IGZvciBmdXJ0aGVyIG1vdmVtZW50IHNpbmNlIHRoZSBsYXN0IHdoZWVsIHVwZGF0ZVxuICAgICAgICBjb25zdCB2ZWxvY2l0eVNjYWxlOm51bWJlciA9IFNraWRtYXJrTWFuYWdlci5HZXRWZWxvY2l0eVNjYWxlKCk7XG4gICAgICAgIGlmICh2ZWxvY2l0eVNjYWxlID4gMC4wICYmIHRoaXMuX3JpZ2lkYm9keSAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLm1fdmVsb2NpdHlPZmZzZXQuY29weUZyb20odGhpcy5fcmlnaWRib2R5LmdldExpbmVhclZlbG9jaXR5KCkpO1xuICAgICAgICAgICAgdGhpcy5tX3ZlbG9jaXR5T2Zmc2V0LnNjYWxlSW5QbGFjZSh2ZWxvY2l0eVNjYWxlKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBVcGRhdGUgV2hlZWwgU2tpZGRpbmcgSW5mb1xuICAgICAgICBjb25zdCBza2lkVGhyZWFzaG9sZDpudW1iZXIgPSAwLjY1O1xuICAgICAgICBsZXQgc2tpZF9GTDpudW1iZXIgPSAwLCBza2lkX0ZSID0gMCwgc2tpZF9STCA9IDAsIHNraWRfUlIgID0gMDtcbiAgICAgICAgaWYgKHRoaXMubV9mcm9udExlZnRXaGVlbCAhPSBudWxsKSB7IFxuICAgICAgICAgICAgc2tpZF9GTCA9IEJBQllMT04uU2NhbGFyLkNsYW1wKCgxIC0gdGhpcy5tX2Zyb250TGVmdFdoZWVsLmdldF9tX3NraWRJbmZvKCkpKTtcbiAgICAgICAgICAgIGlmIChza2lkX0ZMIDwgc2tpZFRocmVhc2hvbGQpIHNraWRfRkwgPSAwO1xuICAgICAgICAgICAgaWYgKHNraWRfRkwgPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGFjdFBvaW50Rkw6YW55ID0gdGhpcy5tX2Zyb250TGVmdFdoZWVsLmdldF9tX3JheWNhc3RJbmZvKCkuZ2V0X21fY29udGFjdFBvaW50V1MoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250YWN0Tm9ybWFsRkw6YW55ID0gdGhpcy5tX2Zyb250TGVmdFdoZWVsLmdldF9tX3JheWNhc3RJbmZvKCkuZ2V0X21fY29udGFjdE5vcm1hbFdTKCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3Qgc2tpZFBvc0ZMOkJBQllMT04uVmVjdG9yMyA9IG5ldyBCQUJZTE9OLlZlY3RvcjMoY29udGFjdFBvaW50RkwueCgpLCBjb250YWN0UG9pbnRGTC55KCksIGNvbnRhY3RQb2ludEZMLnooKSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2tpZE5vcm1GTDpCQUJZTE9OLlZlY3RvcjMgPSBuZXcgQkFCWUxPTi5WZWN0b3IzKGNvbnRhY3ROb3JtYWxGTC54KCksIGNvbnRhY3ROb3JtYWxGTC55KCksIGNvbnRhY3ROb3JtYWxGTC56KCkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNraWRTY2FsZUZMOm51bWJlciA9IEJBQllMT04uU2NhbGFyLk5vcm1hbGl6ZShza2lkX0ZMLCBza2lkVGhyZWFzaG9sZCwgMS4wKTtcblxuICAgICAgICAgICAgICAgIGlmICh2ZWxvY2l0eVNjYWxlID4gMC4wKSBza2lkUG9zRkwuYWRkSW5QbGFjZSh0aGlzLm1fdmVsb2NpdHlPZmZzZXQpO1xuICAgICAgICAgICAgICAgIHRoaXMubV9mcm9udExlZnRXaGVlbFNraWQgPSBTa2lkbWFya01hbmFnZXIuQWRkU2tpZG1hcmtTZWdtZW50KHNraWRQb3NGTCwgc2tpZE5vcm1GTCwgc2tpZFNjYWxlRkwsIHRoaXMubV9mcm9udExlZnRXaGVlbFNraWQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1fZnJvbnRMZWZ0V2hlZWxTa2lkID0gLTE7ICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fZnJvbnRSaWdodFdoZWVsICE9IG51bGwpIHtcbiAgICAgICAgICAgIHNraWRfRlIgPSBCQUJZTE9OLlNjYWxhci5DbGFtcCgoMSAtIHRoaXMubV9mcm9udFJpZ2h0V2hlZWwuZ2V0X21fc2tpZEluZm8oKSkpO1xuICAgICAgICAgICAgaWYgKHNraWRfRlIgPCBza2lkVGhyZWFzaG9sZCkgc2tpZF9GUiA9IDA7XG4gICAgICAgICAgICBpZiAoc2tpZF9GUiA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250YWN0UG9pbnRGUjphbnkgPSB0aGlzLm1fZnJvbnRSaWdodFdoZWVsLmdldF9tX3JheWNhc3RJbmZvKCkuZ2V0X21fY29udGFjdFBvaW50V1MoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250YWN0Tm9ybWFsRlI6YW55ID0gdGhpcy5tX2Zyb250UmlnaHRXaGVlbC5nZXRfbV9yYXljYXN0SW5mbygpLmdldF9tX2NvbnRhY3ROb3JtYWxXUygpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IHNraWRQb3NGUjpCQUJZTE9OLlZlY3RvcjMgPSBuZXcgQkFCWUxPTi5WZWN0b3IzKGNvbnRhY3RQb2ludEZSLngoKSwgY29udGFjdFBvaW50RlIueSgpLCBjb250YWN0UG9pbnRGUi56KCkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNraWROb3JtRlI6QkFCWUxPTi5WZWN0b3IzID0gbmV3IEJBQllMT04uVmVjdG9yMyhjb250YWN0Tm9ybWFsRlIueCgpLCBjb250YWN0Tm9ybWFsRlIueSgpLCBjb250YWN0Tm9ybWFsRlIueigpKTtcbiAgICAgICAgICAgICAgICBjb25zdCBza2lkU2NhbGVGUjpudW1iZXIgPSBCQUJZTE9OLlNjYWxhci5Ob3JtYWxpemUoc2tpZF9GUiwgc2tpZFRocmVhc2hvbGQsIDEuMCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKHZlbG9jaXR5U2NhbGUgPiAwLjApIHNraWRQb3NGUi5hZGRJblBsYWNlKHRoaXMubV92ZWxvY2l0eU9mZnNldCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tX2Zyb250UmlnaHRXaGVlbFNraWQgPSBTa2lkbWFya01hbmFnZXIuQWRkU2tpZG1hcmtTZWdtZW50KHNraWRQb3NGUiwgc2tpZE5vcm1GUiwgc2tpZFNjYWxlRlIsIHRoaXMubV9mcm9udFJpZ2h0V2hlZWxTa2lkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tX2Zyb250UmlnaHRXaGVlbFNraWQgPSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2JhY2tMZWZ0V2hlZWwgIT0gbnVsbCkge1xuICAgICAgICAgICAgc2tpZF9STCA9IEJBQllMT04uU2NhbGFyLkNsYW1wKCgxIC0gdGhpcy5tX2JhY2tMZWZ0V2hlZWwuZ2V0X21fc2tpZEluZm8oKSkpO1xuICAgICAgICAgICAgaWYgKHNraWRfUkwgPCBza2lkVGhyZWFzaG9sZCkgc2tpZF9STCA9IDA7XG4gICAgICAgICAgICBpZiAoc2tpZF9STCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250YWN0UG9pbnRSTDphbnkgPSB0aGlzLm1fYmFja0xlZnRXaGVlbC5nZXRfbV9yYXljYXN0SW5mbygpLmdldF9tX2NvbnRhY3RQb2ludFdTKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGFjdE5vcm1hbFJMOmFueSA9IHRoaXMubV9iYWNrTGVmdFdoZWVsLmdldF9tX3JheWNhc3RJbmZvKCkuZ2V0X21fY29udGFjdE5vcm1hbFdTKCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3Qgc2tpZFBvc1JMOkJBQllMT04uVmVjdG9yMyA9IG5ldyBCQUJZTE9OLlZlY3RvcjMoY29udGFjdFBvaW50UkwueCgpLCBjb250YWN0UG9pbnRSTC55KCksIGNvbnRhY3RQb2ludFJMLnooKSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2tpZE5vcm1STDpCQUJZTE9OLlZlY3RvcjMgPSBuZXcgQkFCWUxPTi5WZWN0b3IzKGNvbnRhY3ROb3JtYWxSTC54KCksIGNvbnRhY3ROb3JtYWxSTC55KCksIGNvbnRhY3ROb3JtYWxSTC56KCkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNraWRTY2FsZVJMOm51bWJlciA9IEJBQllMT04uU2NhbGFyLk5vcm1hbGl6ZShza2lkX1JMLCBza2lkVGhyZWFzaG9sZCwgMS4wKTtcblxuICAgICAgICAgICAgICAgIGlmICh2ZWxvY2l0eVNjYWxlID4gMC4wKSBza2lkUG9zUkwuYWRkSW5QbGFjZSh0aGlzLm1fdmVsb2NpdHlPZmZzZXQpO1xuICAgICAgICAgICAgICAgIHRoaXMubV9iYWNrTGVmdFdoZWVsU2tpZCA9IFNraWRtYXJrTWFuYWdlci5BZGRTa2lkbWFya1NlZ21lbnQoc2tpZFBvc1JMLCBza2lkTm9ybVJMLCBza2lkU2NhbGVSTCwgdGhpcy5tX2JhY2tMZWZ0V2hlZWxTa2lkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tX2JhY2tMZWZ0V2hlZWxTa2lkID0gLTE7ICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fYmFja1JpZ2h0V2hlZWwgIT0gbnVsbCkge1xuICAgICAgICAgICAgc2tpZF9SUiA9IEJBQllMT04uU2NhbGFyLkNsYW1wKCgxIC0gdGhpcy5tX2JhY2tSaWdodFdoZWVsLmdldF9tX3NraWRJbmZvKCkpKTtcbiAgICAgICAgICAgIGlmIChza2lkX1JSIDwgc2tpZFRocmVhc2hvbGQpIHNraWRfUlIgPSAwO1xuICAgICAgICAgICAgaWYgKHNraWRfUlIgPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGFjdFBvaW50UlI6YW55ID0gdGhpcy5tX2JhY2tSaWdodFdoZWVsLmdldF9tX3JheWNhc3RJbmZvKCkuZ2V0X21fY29udGFjdFBvaW50V1MoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250YWN0Tm9ybWFsUlI6YW55ID0gdGhpcy5tX2JhY2tSaWdodFdoZWVsLmdldF9tX3JheWNhc3RJbmZvKCkuZ2V0X21fY29udGFjdE5vcm1hbFdTKCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3Qgc2tpZFBvc1JSOkJBQllMT04uVmVjdG9yMyA9IG5ldyBCQUJZTE9OLlZlY3RvcjMoY29udGFjdFBvaW50UlIueCgpLCBjb250YWN0UG9pbnRSUi55KCksIGNvbnRhY3RQb2ludFJSLnooKSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2tpZE5vcm1SUjpCQUJZTE9OLlZlY3RvcjMgPSBuZXcgQkFCWUxPTi5WZWN0b3IzKGNvbnRhY3ROb3JtYWxSUi54KCksIGNvbnRhY3ROb3JtYWxSUi55KCksIGNvbnRhY3ROb3JtYWxSUi56KCkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNraWRTY2FsZVJSOm51bWJlciA9IEJBQllMT04uU2NhbGFyLk5vcm1hbGl6ZShza2lkX1JSLCBza2lkVGhyZWFzaG9sZCwgMS4wKTtcblxuICAgICAgICAgICAgICAgIGlmICh2ZWxvY2l0eVNjYWxlID4gMC4wKSBza2lkUG9zUlIuYWRkSW5QbGFjZSh0aGlzLm1fdmVsb2NpdHlPZmZzZXQpO1xuICAgICAgICAgICAgICAgIHRoaXMubV9iYWNrUmlnaHRXaGVlbFNraWQgPSBTa2lkbWFya01hbmFnZXIuQWRkU2tpZG1hcmtTZWdtZW50KHNraWRQb3NSUiwgc2tpZE5vcm1SUiwgc2tpZFNjYWxlUlIsIHRoaXMubV9iYWNrUmlnaHRXaGVlbFNraWQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1fYmFja1JpZ2h0V2hlZWxTa2lkID0gLTE7ICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIFVwZGF0ZSBFbmdpbmUgQW5kIFdoZWVsIFBpdGNoXG4gICAgICAgIGlmICh0aGlzLl9lbmdpbmVBdWRpb1NvdXJjZSAhPSBudWxsKSB7XG4gICAgICAgICAgICBjb25zdCBlbmdpbmVTb3VuZENsaXA6QkFCWUxPTi5Tb3VuZCA9IHRoaXMuX2VuZ2luZUF1ZGlvU291cmNlLmdldFNvdW5kQ2xpcCgpO1xuICAgICAgICAgICAgaWYgKGVuZ2luZVNvdW5kQ2xpcCAhPSBudWxsKSBlbmdpbmVTb3VuZENsaXAuc2V0UGxheWJhY2tSYXRlKHRoaXMuZ2V0Q3VycmVudEVuZ2luZVBpdGNoKCkgKiAwLjc1KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fc2tpZEZMQXVkaW9Tb3VyY2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3Qgc2tpZEZMU291bmRDbGlwOkJBQllMT04uU291bmQgPSB0aGlzLl9za2lkRkxBdWRpb1NvdXJjZS5nZXRTb3VuZENsaXAoKTtcbiAgICAgICAgICAgIGlmIChza2lkRkxTb3VuZENsaXAgIT0gbnVsbCkgc2tpZEZMU291bmRDbGlwLnNldFBsYXliYWNrUmF0ZShza2lkX0ZMKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fc2tpZEZSQXVkaW9Tb3VyY2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3Qgc2tpZEZSU291bmRDbGlwOkJBQllMT04uU291bmQgPSB0aGlzLl9za2lkRlJBdWRpb1NvdXJjZS5nZXRTb3VuZENsaXAoKTtcbiAgICAgICAgICAgIGlmIChza2lkRlJTb3VuZENsaXAgIT0gbnVsbCkgc2tpZEZSU291bmRDbGlwLnNldFBsYXliYWNrUmF0ZShza2lkX0ZSKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fc2tpZFJMQXVkaW9Tb3VyY2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3Qgc2tpZFJMU291bmRDbGlwOkJBQllMT04uU291bmQgPSB0aGlzLl9za2lkUkxBdWRpb1NvdXJjZS5nZXRTb3VuZENsaXAoKTtcbiAgICAgICAgICAgIGlmIChza2lkUkxTb3VuZENsaXAgIT0gbnVsbCkgc2tpZFJMU291bmRDbGlwLnNldFBsYXliYWNrUmF0ZShza2lkX1JMKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fc2tpZFJSQXVkaW9Tb3VyY2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3Qgc2tpZFJSU291bmRDbGlwOkJBQllMT04uU291bmQgPSB0aGlzLl9za2lkUlJBdWRpb1NvdXJjZS5nZXRTb3VuZENsaXAoKTtcbiAgICAgICAgICAgIGlmIChza2lkUlJTb3VuZENsaXAgIT0gbnVsbCkgc2tpZFJSU291bmRDbGlwLnNldFBsYXliYWNrUmF0ZShza2lkX1JSKTtcbiAgICAgICAgfVxuICAgICAgICAvL2NvbnN0IG1zZzpzdHJpbmcgPSAoXCJNUEg6IFwiICsgdGhpcy5hbWVyaWNhblNwZWVkLnRvRml4ZWQoMSkgKyBcIiAtLT4gU2tpZCBJbmZvIC0gRkw6IFwiICsgc2tpZF9GTC50b0ZpeGVkKDIpICsgXCIgLSBGUjogXCIgKyBza2lkX0ZSLnRvRml4ZWQoMikgKyBcIiAtIFJMOiBcIiArIHNraWRfUkwudG9GaXhlZCgyKSArIFwiIC0gUlI6IFwiICsgc2tpZF9SUi50b0ZpeGVkKDIpKTtcbiAgICAgICAgLy9CQUJZTE9OLlV0aWxpdGllcy5QcmludFRvU2NyZWVuKG1zZywgXCIjMDA4MDAwXCIpO1xuICAgIH1cbiAgICBwcm90ZWN0ZWQgZGVzdHJveVZlaGljbGVTdGF0ZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fcmlnaWRib2R5ID0gbnVsbDtcbiAgICAgICAgdGhpcy5fZW5naW5lQXVkaW9Tb3VyY2UgPSBudWxsO1xuICAgICAgICB0aGlzLl9za2lkRkxBdWRpb1NvdXJjZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3NraWRGUkF1ZGlvU291cmNlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fc2tpZFJMQXVkaW9Tb3VyY2UgPSBudWxsO1xuICAgICAgICB0aGlzLl9za2lkUlJBdWRpb1NvdXJjZSA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLm1fZnJvbnRMZWZ0V2hlZWwgIT0gbnVsbCkge1xuICAgICAgICAgICAgQW1tby5kZXN0cm95KHRoaXMubV9mcm9udExlZnRXaGVlbCk7IC8vID8/P1xuICAgICAgICAgICAgdGhpcy5tX2Zyb250TGVmdFdoZWVsID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2Zyb250UmlnaHRXaGVlbCAhPSBudWxsKSB7XG4gICAgICAgICAgICBBbW1vLmRlc3Ryb3kodGhpcy5tX2Zyb250UmlnaHRXaGVlbCk7IC8vID8/P1xuICAgICAgICAgICAgdGhpcy5tX2Zyb250UmlnaHRXaGVlbCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9iYWNrTGVmdFdoZWVsICE9IG51bGwpIHtcbiAgICAgICAgICAgIEFtbW8uZGVzdHJveSh0aGlzLm1fYmFja0xlZnRXaGVlbCk7IC8vID8/P1xuICAgICAgICAgICAgdGhpcy5tX2JhY2tMZWZ0V2hlZWwgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1fYmFja1JpZ2h0V2hlZWwgIT0gbnVsbCkge1xuICAgICAgICAgICAgQW1tby5kZXN0cm95KHRoaXMubV9iYWNrUmlnaHRXaGVlbCk7IC8vID8/P1xuICAgICAgICAgICAgdGhpcy5tX2JhY2tSaWdodFdoZWVsID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fcGh5c2ljc1dvcmxkID0gbnVsbDtcbiAgICAgICAgdGhpcy5yYXljYXN0VmVoaWNsZSA9IG51bGw7XG4gICAgICAgIHRoaXMuZnJvbnRMZWZ0V2hlZWxNZXNoID0gbnVsbDtcbiAgICAgICAgdGhpcy5mcm9udFJpZ2h0V2hlZWxNZXNoID0gbnVsbDtcbiAgICAgICAgdGhpcy5iYWNrTGVmdFdoZWVsTWVzaCA9IG51bGw7XG4gICAgICAgIHRoaXMuYmFja1JpZ2h0V2hlZWxNZXNoID0gbnVsbDtcbiAgICAgICAgdGhpcy5mcm9udExlZnRXaGVlbFRyYW5zID0gbnVsbDtcbiAgICAgICAgdGhpcy5mcm9udFJpZ2h0V2hlZWxUcmFucyA9IG51bGw7XG4gICAgICAgIHRoaXMuYmFja0xlZnRXaGVlbFRyYW5zID0gbnVsbDtcbiAgICAgICAgdGhpcy5iYWNrUmlnaHRXaGVlbFRyYW5zID0gbnVsbDtcbiAgICAgICAgdGhpcy5mcm9udExlZnRXaGVlbENvbGxpZGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5mcm9udFJpZ2h0V2hlZWxDb2xsaWRlciA9IG51bGw7XG4gICAgICAgIHRoaXMuYmFja0xlZnRXaGVlbENvbGxpZGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5iYWNrUmlnaHRXaGVlbENvbGxpZGVyID0gbnVsbDtcbiAgICB9XG4gICAgXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIC8vIFB1YmxpYyBWZWhpY2xlIENvbnRyb2xsZXIgTW92ZW1lbnQgRnVuY3Rpb25zICAgLy9cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICBwcml2YXRlIHN0ZWVyaW5nSW5jcmVtZW50Om51bWJlciA9IDA7XG4gICAgcHJpdmF0ZSBhbGxvd2VkVHVybmluZ0FuZ2xlOm51bWJlciA9IDA7XG4gICAgLyoqIERyaXZlcyB0aGUgcmF5Y2FzdCB2ZWhpY2xlIHdpdGggdGhlIHNwZWNmaWVkIG1vdmVtZW50IGFuZCBoYW5kIGJyYWtpbmcgcHJvcGVydGllcy4gKi9cbiAgICBwdWJsaWMgZHJpdmUoZm9yd2FyZDpudW1iZXIsIHR1cm46bnVtYmVyLCBicmFraW5nOmJvb2xlYW4gPSBmYWxzZSk6dm9pZCB7XG4gICAgICAgIGlmICh0aGlzLl9yaWdpZGJvZHkgPT0gbnVsbCB8fCB0aGlzLnJheWNhc3RWZWhpY2xlID09IG51bGwpIHJldHVybjtcbiAgICAgICAgaWYgKHRoaXMuRlJPTlRfTEVGVCA+PSAwICYmIHRoaXMuRlJPTlRfUklHSFQgPj0gMCAmJiB0aGlzLkJBQ0tfTEVGVCA+PSAwICYmIHRoaXMuQkFDS19SSUdIVCA+PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBkZWx0YVRpbWU6bnVtYmVyID0gdGhpcy5nZXREZWx0YVNlY29uZHMoKTtcbiAgICAgICAgICAgIHRoaXMuYnJha2luZ0ZvcmNlID0gMDsgdGhpcy5lbmdpbmVGb3JjZSA9IDA7XG4gICAgICAgICAgICAvLyAuLlxuICAgICAgICAgICAgLy8gVXBkYXRlIEdlYXJpbmcgQm94IChUT0RPOiBGaXggU3RhcnQgR2VhciBFbmdpbmUgU291bmQpXG4gICAgICAgICAgICAvLyAuLlxuICAgICAgICAgICAgbGV0IHRocm90dGxlQW1vdW50Om51bWJlciA9IDA7XG4gICAgICAgICAgICBsZXQgYnJha2luZ0Ftb3VudDpudW1iZXIgPSAwO1xuICAgICAgICAgICAgaWYgKGZvcndhcmQgPiAwLjEpIHsgLy8gRm9yd2FyZFxuICAgICAgICAgICAgICAgIGJyYWtpbmdBbW91bnQgPSAwO1xuICAgICAgICAgICAgICAgIHRocm90dGxlQW1vdW50ID0gTWF0aC5hYnMoZm9yd2FyZCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZvcndhcmQgPCAwLjEpIHsgLy8gUmV2ZXJzZVxuICAgICAgICAgICAgICAgIHRocm90dGxlQW1vdW50ID0gMDtcbiAgICAgICAgICAgICAgICBicmFraW5nQW1vdW50ID0gTWF0aC5hYnMoZm9yd2FyZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5hYnNvbHV0ZVNwZWVkID49IDAuMikge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdlYXJJbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogR2V0IEVuZ2luZSBDdXJ2ZSBQb3dlclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IEdldCBFbmdpbmUgQ3VydmUgUG93ZXJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh0aHJvdHRsZUFtb3VudCA+IDAuMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdlYXJJbmRleCA9IDI7IC8vIFNldCBGaXJzdCBHZWFyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChicmFraW5nQW1vdW50ID4gMC4xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2VhckluZGV4ID0gMDsgLy8gU2V0IFJldmVyc2UgR2VhclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2VhckluZGV4ID0gMTsgLy8gU2V0IE5ldXRyYWwgR2VhclxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIC4uXG4gICAgICAgICAgICAvLyBVcGRhdGUgRW5naW5lIEZvcmNlc1xuICAgICAgICAgICAgLy8gLi5cbiAgICAgICAgICAgIGNvbnN0IGdlYXJTaGlmdFNjYWxlOm51bWJlciA9ICh0aGlzLmdlYXJCb3hTaGlmdFNjYWxlcyAhPSBudWxsICYmIHRoaXMuZ2VhckJveFNoaWZ0U2NhbGVzLmxlbmd0aCA+IHRoaXMuZ2VhckluZGV4KSA/IHRoaXMuZ2VhckJveFNoaWZ0U2NhbGVzW3RoaXMuZ2VhckluZGV4XSA6IDEuMDtcbiAgICAgICAgICAgIGNvbnN0IGdlYXJTaGlmdFJhdGlvOm51bWJlciA9ICh0aGlzLmdlYXJCb3hTaGlmdFJhdGlvcyAhPSBudWxsICYmIHRoaXMuZ2VhckJveFNoaWZ0UmF0aW9zLmxlbmd0aCA+IHRoaXMuZ2VhckluZGV4KSA/IHRoaXMuZ2VhckJveFNoaWZ0UmF0aW9zW3RoaXMuZ2VhckluZGV4XSA6IDEuMDtcbiAgICAgICAgICAgIGNvbnN0IGZpbmFsR2VhclJhdGlvOm51bWJlciA9IChnZWFyU2hpZnRSYXRpbyAqIHRoaXMuZGlmZmVyZW50aWFsUmF0aW8gKiB0aGlzLnRyYW5zbWlzc2lvblJhdGlvKTtcbiAgICAgICAgICAgIGNvbnN0IGVuZ2luZU1vdG9yVG9ycXVlOm51bWJlciA9IHRoaXMuZ2V0VmVoaWNsZUVuZ2luZVRvcnF1ZSh0aGlzLmVuZ2luZVJQTSkgKiBNYXRoLmFicyhmb3J3YXJkKSAqIGdlYXJTaGlmdFNjYWxlO1xuICAgICAgICAgICAgY29uc3QgYWxsb3dlZEVuZ2luZVBvd2VyOm51bWJlciA9IChlbmdpbmVNb3RvclRvcnF1ZSAqIGZpbmFsR2VhclJhdGlvKTtcbiAgICAgICAgICAgIGlmIChmb3J3YXJkID4gMC4xKSB7IC8vIEZvcndhcmRcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5mb3J3YXJkU3BlZWQgPCAtMSkgdGhpcy5icmFraW5nRm9yY2UgPSB0aGlzLm1heEJyYWtpbmdGb3JjZTtcbiAgICAgICAgICAgICAgICBlbHNlIHRoaXMuZW5naW5lRm9yY2UgPSBhbGxvd2VkRW5naW5lUG93ZXI7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZvcndhcmQgPCAtMC4xKSB7IC8vIFJldmVyc2VcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5mb3J3YXJkU3BlZWQgPiAxKSB0aGlzLmJyYWtpbmdGb3JjZSA9IHRoaXMubWF4QnJha2luZ0ZvcmNlO1xuICAgICAgICAgICAgICAgIGVsc2UgdGhpcy5lbmdpbmVGb3JjZSA9IC0oYWxsb3dlZEVuZ2luZVBvd2VyICogdGhpcy5tYXhSZXZlcnNlU3BlZWQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVuZ2luZUZvcmNlID0gMDsgdGhpcy5icmFraW5nRm9yY2UgPSAxMDsgLy8gU3RhdGljXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5zaGlmdGluZ0dlYXJzID09PSB0cnVlIHx8IHRoaXMuYW1lcmljYW5TcGVlZCA+IHRoaXMudG9wRW5naW5lU3BlZWQpIHRoaXMuZW5naW5lRm9yY2UgPSAwO1xuICAgICAgICAgICAgLy8gLi5cbiAgICAgICAgICAgIC8vIFVwZGF0ZSBUdXJuaW5nIEFuZ2xlXG4gICAgICAgICAgICAvLyAuLlxuICAgICAgICAgICAgdGhpcy5zdGVlcmluZ0luY3JlbWVudCA9IEJBQllMT04uU2NhbGFyLkxlcnAodGhpcy5sb3dTcGVlZEluY3JlbWVudCwgdGhpcy5oaWdoU3BlZWRJbmNyZW1lbnQsIHRoaXMubm9ybWFsaXplZFNwZWVkKTtcbiAgICAgICAgICAgIHRoaXMuYWxsb3dlZFR1cm5pbmdBbmdsZSA9IEJBQllMT04uU2NhbGFyLkxlcnAodGhpcy5sb3dTcGVlZEFuZ2xlLCB0aGlzLmhpZ2hTcGVlZEFuZ2xlLCB0aGlzLm5vcm1hbGl6ZWRTcGVlZCk7XG4gICAgICAgICAgICBpZiAodHVybiA+IDApIHsgLy8gUmlnaHRcbiAgICAgICAgICAgICAgICBpZiAodGhpcy52ZWhpY2xlU3RlZXIgPCB0aGlzLmFsbG93ZWRUdXJuaW5nQW5nbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52ZWhpY2xlU3RlZXIgKz0gKHRoaXMuc3RlZXJpbmdJbmNyZW1lbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHVybiA8IDApIHsgLy8gTGVmdFxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZlaGljbGVTdGVlciA+IC10aGlzLmFsbG93ZWRUdXJuaW5nQW5nbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52ZWhpY2xlU3RlZXIgLT0gKHRoaXMuc3RlZXJpbmdJbmNyZW1lbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmVoaWNsZVN0ZWVyIDwgLXRoaXMuc3RlZXJpbmdJbmNyZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52ZWhpY2xlU3RlZXIgKz0gdGhpcy5zdGVlcmluZ0luY3JlbWVudDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy52ZWhpY2xlU3RlZXIgPiB0aGlzLnN0ZWVyaW5nSW5jcmVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZlaGljbGVTdGVlciAtPSB0aGlzLnN0ZWVyaW5nSW5jcmVtZW50O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52ZWhpY2xlU3RlZXIgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gLi5cbiAgICAgICAgICAgIC8vIFVwZGF0ZSBWZWhpY2xlIENvbnRyb2xzXG4gICAgICAgICAgICAvLyAuLlxuICAgICAgICAgICAgaWYgKGJyYWtpbmcgPT09IHRydWUgJiYgdGhpcy5oYW5kQnJha2luZ0ZvcmNlID4gMCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFtZXJpY2FuU3BlZWQgPiAyMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmcm9udExvY2tGcmljdGlvbjpudW1iZXIgPSAodGhpcy53aGVlbExvY2tGcmljdGlvbiA+IDAuMDEpID8gKHRoaXMud2hlZWxMb2NrRnJpY3Rpb24gLSAwLjAxKSA6IHRoaXMud2hlZWxMb2NrRnJpY3Rpb247XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1fZnJvbnRMZWZ0V2hlZWwgIT0gbnVsbCAmJiB0aGlzLm1fZnJvbnRMZWZ0V2hlZWwuZGVmYXVsdEZyaWN0aW9uICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubV9mcm9udExlZnRXaGVlbC5zZXRfbV9mcmljdGlvblNsaXAodGhpcy5tX2Zyb250TGVmdFdoZWVsLmRlZmF1bHRGcmljdGlvbiAqIGZyb250TG9ja0ZyaWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5tX2Zyb250UmlnaHRXaGVlbCAhPSBudWxsICYmIHRoaXMubV9mcm9udFJpZ2h0V2hlZWwuZGVmYXVsdEZyaWN0aW9uICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubV9mcm9udFJpZ2h0V2hlZWwuc2V0X21fZnJpY3Rpb25TbGlwKHRoaXMubV9mcm9udExlZnRXaGVlbC5kZWZhdWx0RnJpY3Rpb24gKiBmcm9udExvY2tGcmljdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubV9iYWNrTGVmdFdoZWVsICE9IG51bGwgJiYgdGhpcy5tX2JhY2tMZWZ0V2hlZWwuZGVmYXVsdEZyaWN0aW9uICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubV9iYWNrTGVmdFdoZWVsLnNldF9tX2ZyaWN0aW9uU2xpcCh0aGlzLm1fZnJvbnRMZWZ0V2hlZWwuZGVmYXVsdEZyaWN0aW9uICogdGhpcy53aGVlbExvY2tGcmljdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubV9iYWNrUmlnaHRXaGVlbCAhPSBudWxsICYmIHRoaXMubV9iYWNrUmlnaHRXaGVlbC5kZWZhdWx0RnJpY3Rpb24gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tX2JhY2tSaWdodFdoZWVsLnNldF9tX2ZyaWN0aW9uU2xpcCh0aGlzLm1fZnJvbnRMZWZ0V2hlZWwuZGVmYXVsdEZyaWN0aW9uICogdGhpcy53aGVlbExvY2tGcmljdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDdXJyZW50RnJpY3Rpb25TbGlwKGRlbHRhVGltZSAqIHRoaXMuZnJpY3Rpb25TbGlwU3BlZWQpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJheWNhc3RWZWhpY2xlLmxvY2tlZFdoZWVsSW5kZXhlcyA9PSBudWxsKSB0aGlzLnJheWNhc3RWZWhpY2xlLmxvY2tlZFdoZWVsSW5kZXhlcyA9IFt0aGlzLkJBQ0tfTEVGVCwgdGhpcy5CQUNLX1JJR0hUXTtcbiAgICAgICAgICAgICAgICB0aGlzLnJheWNhc3RWZWhpY2xlLnNldFN0ZWVyaW5nQW5nbGUodGhpcy52ZWhpY2xlU3RlZXIsIHRoaXMuRlJPTlRfTEVGVCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yYXljYXN0VmVoaWNsZS5zZXRTdGVlcmluZ0FuZ2xlKHRoaXMudmVoaWNsZVN0ZWVyLCB0aGlzLkZST05UX1JJR0hUKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJheWNhc3RWZWhpY2xlLnNldEVuZ2luZUZvcmNlKDAsIHRoaXMuRlJPTlRfTEVGVCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yYXljYXN0VmVoaWNsZS5zZXRFbmdpbmVGb3JjZSgwLCB0aGlzLkZST05UX1JJR0hUKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJheWNhc3RWZWhpY2xlLnNldEVuZ2luZUZvcmNlKDAsIHRoaXMuQkFDS19MRUZUKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJheWNhc3RWZWhpY2xlLnNldEVuZ2luZUZvcmNlKDAsIHRoaXMuQkFDS19SSUdIVCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yYXljYXN0VmVoaWNsZS5zZXRCcmFraW5nRm9yY2UoMCwgdGhpcy5GUk9OVF9MRUZUKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJheWNhc3RWZWhpY2xlLnNldEJyYWtpbmdGb3JjZSgwLCB0aGlzLkZST05UX1JJR0hUKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJheWNhc3RWZWhpY2xlLnNldEJyYWtpbmdGb3JjZSh0aGlzLmhhbmRCcmFraW5nRm9yY2UsIHRoaXMuQkFDS19MRUZUKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJheWNhc3RWZWhpY2xlLnNldEJyYWtpbmdGb3JjZSh0aGlzLmhhbmRCcmFraW5nRm9yY2UsIHRoaXMuQkFDS19SSUdIVCk7XG4gICAgICAgICAgICAgICAgLy8gLi5cbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBTdXBwb3J0IEFuZ3VsYXIgUm90YXRpb24gQm9vc3QgLSA/Pz9cbiAgICAgICAgICAgICAgICAvLyAuLlxuICAgICAgICAgICAgICAgIC8vIGxldCBhbmd1bGFyQm9vc3RGYWN0b3I6bnVtYmVyID0gMDsgXG4gICAgICAgICAgICAgICAgLy8gaWYgKGFuZ3VsYXJCb29zdEZhY3RvciAhPT0gMCkge1xuICAgICAgICAgICAgICAgIC8vICAgIGNvbnN0IGFuZ3VsYXJWZWxvY2l0eTpCQUJZTE9OLlZlY3RvcjMgPSB0aGlzLl9yaWdpZGJvZHkuZ2V0QW5ndWxhclZlbG9jaXR5KCk7XG4gICAgICAgICAgICAgICAgLy8gICAgYW5ndWxhclZlbG9jaXR5LnkgKz0gKGFuZ3VsYXJCb29zdEZhY3RvciAqIHRoaXMuZHJpZnRpbmdJbmZsdWVuY2UpO1xuICAgICAgICAgICAgICAgIC8vICAgIHRoaXMuX3JpZ2lkYm9keS5zZXRBbmd1bGFyVmVsb2NpdHkoYW5ndWxhclZlbG9jaXR5KTtcbiAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgLy90aGlzLm1fZnJvbnRMZWZ0V2hlZWwuc2V0X21fZnJpY3Rpb25TbGlwKDApO1xuICAgICAgICAgICAgICAgIC8vdGhpcy5tX2Zyb250UmlnaHRXaGVlbC5zZXRfbV9mcmljdGlvblNsaXAoMCk7XG4gICAgICAgICAgICAgICAgLy90aGlzLm1fYmFja0xlZnRXaGVlbC5zZXRfbV9mcmljdGlvblNsaXAoMC4wKTtcbiAgICAgICAgICAgICAgICAvL3RoaXMubV9iYWNrUmlnaHRXaGVlbC5zZXRfbV9mcmljdGlvblNsaXAoMC4wKTtcblxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ3VycmVudEZyaWN0aW9uU2xpcChkZWx0YVRpbWUpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJheWNhc3RWZWhpY2xlLmxvY2tlZFdoZWVsSW5kZXhlcyAhPSBudWxsKSB0aGlzLnJheWNhc3RWZWhpY2xlLmxvY2tlZFdoZWVsSW5kZXhlcyA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5yYXljYXN0VmVoaWNsZS5zZXRTdGVlcmluZ0FuZ2xlKHRoaXMudmVoaWNsZVN0ZWVyLCB0aGlzLkZST05UX0xFRlQpO1xuICAgICAgICAgICAgICAgIHRoaXMucmF5Y2FzdFZlaGljbGUuc2V0U3RlZXJpbmdBbmdsZSh0aGlzLnZlaGljbGVTdGVlciwgdGhpcy5GUk9OVF9SSUdIVCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMud2hlZWxEcml2ZVR5cGUgPT09IDEgfHwgdGhpcy53aGVlbERyaXZlVHlwZSA9PT0gMikgeyAvLyBGUk9OVCBPUiBBTEwgV0hFRUwgRFJJVkVcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYXljYXN0VmVoaWNsZS5zZXRFbmdpbmVGb3JjZSh0aGlzLmVuZ2luZUZvcmNlLCB0aGlzLkZST05UX0xFRlQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJheWNhc3RWZWhpY2xlLnNldEVuZ2luZUZvcmNlKHRoaXMuZW5naW5lRm9yY2UsIHRoaXMuRlJPTlRfUklHSFQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy53aGVlbERyaXZlVHlwZSA9PT0gMCB8fCB0aGlzLndoZWVsRHJpdmVUeXBlID09PSAyKSB7IC8vIFJFQVIgT1IgQUxMIFdIRUVMIERSSVZFXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmF5Y2FzdFZlaGljbGUuc2V0RW5naW5lRm9yY2UodGhpcy5lbmdpbmVGb3JjZSwgdGhpcy5CQUNLX0xFRlQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJheWNhc3RWZWhpY2xlLnNldEVuZ2luZUZvcmNlKHRoaXMuZW5naW5lRm9yY2UsIHRoaXMuQkFDS19SSUdIVCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucmF5Y2FzdFZlaGljbGUuc2V0QnJha2luZ0ZvcmNlKHRoaXMuYnJha2luZ0ZvcmNlICogMC41LCB0aGlzLkZST05UX0xFRlQpO1xuICAgICAgICAgICAgICAgIHRoaXMucmF5Y2FzdFZlaGljbGUuc2V0QnJha2luZ0ZvcmNlKHRoaXMuYnJha2luZ0ZvcmNlICogMC41LCB0aGlzLkZST05UX1JJR0hUKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJheWNhc3RWZWhpY2xlLnNldEJyYWtpbmdGb3JjZSh0aGlzLmJyYWtpbmdGb3JjZSwgdGhpcy5CQUNLX0xFRlQpO1xuICAgICAgICAgICAgICAgIHRoaXMucmF5Y2FzdFZlaGljbGUuc2V0QnJha2luZ0ZvcmNlKHRoaXMuYnJha2luZ0ZvcmNlLCB0aGlzLkJBQ0tfUklHSFQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gVHJhY2UgQ3VycmVudCBTcGVlZFxuICAgICAgICAgICAgLy8gY29uc3QgbXNnOnN0cmluZyA9IChcIlNwZWVkOiBcIiArIHRoaXMuYW1lcmljYW5TcGVlZC50b0ZpeGVkKDEpICsgXCIgLS0+IFR1cm4gQW5nbGU6IFwiICsgdGhpcy5hbGxvd2VkVHVybmluZ0FuZ2xlLnRvRml4ZWQoNCkgKyBcIiAtLT4gVHVybiBJbmNyZW1lbnQ6IFwiICsgdGhpcy5zdGVlcmluZ0luY3JlbWVudC50b0ZpeGVkKDQpKTtcbiAgICAgICAgICAgIC8vIGNvbnN0IG1zZzpzdHJpbmcgPSAoXCJNUEg6IFwiICsgdGhpcy5hbWVyaWNhblNwZWVkLnRvRml4ZWQoMSkgKyBcIiAtLT4gR2VhciBJbmRleDogXCIgKyB0aGlzLmdlYXJJbmRleC50b0ZpeGVkKDApICsgXCIgLS0+IEVuZ2luZSBSUE06IFwiICsgdGhpcy5lbmdpbmVSUE0udG9GaXhlZCgwKSArIFwiIC0tLT4gRW5naW5lIFBpdGNoOiBcIiArIHRoaXMuZ2V0Q3VycmVudEVuZ2luZVBpdGNoKCkudG9GaXhlZCgyKSArIFwiIC0tLT4gQ2x1dGNoIFNsaXA6IFwiICsgdGhpcy5jbHV0Y2hTbGlwLnRvRml4ZWQoNCkgKyBcIiAtLS0+IFJhdyBLUEg6IFwiICsgdGhpcy5hYnNvbHV0ZVNwZWVkLnRvRml4ZWQoMSkpO1xuICAgICAgICAgICAgLy9jb25zdCBtc2c6c3RyaW5nID0gKFwiQ2FyIFNwZWVkOiBcIiArIHRoaXMuYW1lcmljYW5TcGVlZC50b0ZpeGVkKDEpICsgXCIgLS0+IEdlYXIgSW5kZXg6IFwiICsgdGhpcy5nZWFySW5kZXgudG9GaXhlZCgwKSArIFwiIC0tPiBFbmdpbmUgUlBNOiBcIiArIHRoaXMuZW5naW5lUlBNLnRvRml4ZWQoMCkgKyBcIiAtLS0+IEVuZ2luZSBUb3J1cWU6IFwiICsgZW5naW5lTW90b3JUb3JxdWUudG9GaXhlZCgyKSsgXCIgLS0tPiBFbmdpbmUgUG93ZXI6IFwiICsgYWxsb3dlZEVuZ2luZVBvd2VyLnRvRml4ZWQoMikpO1xuICAgICAgICAgICAgLy9CQUJZTE9OLlV0aWxpdGllcy5QcmludFRvU2NyZWVuKG1zZywgXCIjMDA4MDAwXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHByaXZhdGUgZ2V0VmVoaWNsZUVuZ2luZVRvcnF1ZShycG06bnVtYmVyKTogbnVtYmVyIHtcbiAgICAgICAgbGV0IHJlc3VsdDpudW1iZXIgPSAyMDAwO1xuICAgICAgICAvL2lmICh0aGlzLmVuZ2luZVRvcnF1ZUN1cnZlICE9IG51bGwpIHtcbiAgICAgICAgLy8gICAgcmVzdWx0ID0gMTAwMDsgLy8gVE9ETzogU2FtcGxlIEFuaW1hdGlvbiBDdXJ2ZVxuICAgICAgICAvL31cbiAgICAgICAgLy9pZiAocmVzdWx0IDw9IDApIHtcbiAgICAgICAgLy8gICAgcmVzdWx0ID0gMTAwO1xuICAgICAgICAvL31cbiAgICAgICAgcmV0dXJuIHJlc3VsdDsgXG4gICAgfVxuICAgIHByaXZhdGUgdXBkYXRlQ3VycmVudEZyaWN0aW9uU2xpcChkZWx0YVRpbWU6bnVtYmVyKTp2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMubV9mcm9udExlZnRXaGVlbCAhPSBudWxsICYmIHRoaXMubV9mcm9udExlZnRXaGVlbC5kZWZhdWx0RnJpY3Rpb24gIT0gbnVsbCkge1xuICAgICAgICAgICAgbGV0IGZyb250TGVmdEZyaWN0aW9uOm51bWJlciA9IHRoaXMubV9mcm9udExlZnRXaGVlbC5nZXRfbV9mcmljdGlvblNsaXAoKTtcbiAgICAgICAgICAgIGlmIChmcm9udExlZnRGcmljdGlvbiAhPT0gdGhpcy5tX2Zyb250TGVmdFdoZWVsLmRlZmF1bHRGcmljdGlvbikge1xuICAgICAgICAgICAgICAgIGZyb250TGVmdEZyaWN0aW9uID0gQkFCWUxPTi5TY2FsYXIuTGVycChmcm9udExlZnRGcmljdGlvbiwgdGhpcy5tX2Zyb250TGVmdFdoZWVsLmRlZmF1bHRGcmljdGlvbiwgZGVsdGFUaW1lKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1fZnJvbnRMZWZ0V2hlZWwuc2V0X21fZnJpY3Rpb25TbGlwKGZyb250TGVmdEZyaWN0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tX2Zyb250UmlnaHRXaGVlbCAhPSBudWxsICYmIHRoaXMubV9mcm9udFJpZ2h0V2hlZWwuZGVmYXVsdEZyaWN0aW9uICE9IG51bGwpIHtcbiAgICAgICAgICAgIGxldCBmcm9udFJpZ2h0RnJpY3Rpb246bnVtYmVyID0gdGhpcy5tX2Zyb250UmlnaHRXaGVlbC5nZXRfbV9mcmljdGlvblNsaXAoKTtcbiAgICAgICAgICAgIGlmIChmcm9udFJpZ2h0RnJpY3Rpb24gIT09IHRoaXMubV9mcm9udFJpZ2h0V2hlZWwuZGVmYXVsdEZyaWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgZnJvbnRSaWdodEZyaWN0aW9uID0gQkFCWUxPTi5TY2FsYXIuTGVycChmcm9udFJpZ2h0RnJpY3Rpb24sIHRoaXMubV9mcm9udFJpZ2h0V2hlZWwuZGVmYXVsdEZyaWN0aW9uLCBkZWx0YVRpbWUpO1xuICAgICAgICAgICAgICAgIHRoaXMubV9mcm9udFJpZ2h0V2hlZWwuc2V0X21fZnJpY3Rpb25TbGlwKGZyb250UmlnaHRGcmljdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9iYWNrTGVmdFdoZWVsICE9IG51bGwgJiYgdGhpcy5tX2JhY2tMZWZ0V2hlZWwuZGVmYXVsdEZyaWN0aW9uICE9IG51bGwpIHtcbiAgICAgICAgICAgIGxldCBiYWNrTGVmdEZyaWN0aW9uOm51bWJlciA9IHRoaXMubV9iYWNrTGVmdFdoZWVsLmdldF9tX2ZyaWN0aW9uU2xpcCgpO1xuICAgICAgICAgICAgaWYgKGJhY2tMZWZ0RnJpY3Rpb24gIT09IHRoaXMubV9iYWNrTGVmdFdoZWVsLmRlZmF1bHRGcmljdGlvbikge1xuICAgICAgICAgICAgICAgIGJhY2tMZWZ0RnJpY3Rpb24gPSBCQUJZTE9OLlNjYWxhci5MZXJwKGJhY2tMZWZ0RnJpY3Rpb24sIHRoaXMubV9iYWNrTGVmdFdoZWVsLmRlZmF1bHRGcmljdGlvbiwgZGVsdGFUaW1lKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1fYmFja0xlZnRXaGVlbC5zZXRfbV9mcmljdGlvblNsaXAoYmFja0xlZnRGcmljdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubV9iYWNrUmlnaHRXaGVlbCAhPSBudWxsICYmIHRoaXMubV9iYWNrUmlnaHRXaGVlbC5kZWZhdWx0RnJpY3Rpb24gIT0gbnVsbCkge1xuICAgICAgICAgICAgbGV0IGJhY2tSaWdodEZyaWN0aW9uOm51bWJlciA9IHRoaXMubV9iYWNrUmlnaHRXaGVlbC5nZXRfbV9mcmljdGlvblNsaXAoKTtcbiAgICAgICAgICAgIGlmIChiYWNrUmlnaHRGcmljdGlvbiAhPT0gdGhpcy5tX2JhY2tSaWdodFdoZWVsLmRlZmF1bHRGcmljdGlvbikge1xuICAgICAgICAgICAgICAgIGJhY2tSaWdodEZyaWN0aW9uID0gQkFCWUxPTi5TY2FsYXIuTGVycChiYWNrUmlnaHRGcmljdGlvbiwgdGhpcy5tX2JhY2tSaWdodFdoZWVsLmRlZmF1bHRGcmljdGlvbiwgZGVsdGFUaW1lKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1fYmFja1JpZ2h0V2hlZWwuc2V0X21fZnJpY3Rpb25TbGlwKGJhY2tSaWdodEZyaWN0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsIi8qKlxuICogQmFieWxvbiBTY3JpcHQgQ29tcG9uZW50XG4gKiBAY2xhc3MgVmVoaWNsZUlucHV0Q29udHJvbGxlclxuICovXG5jbGFzcyBWZWhpY2xlSW5wdXRDb250cm9sbGVyIGV4dGVuZHMgQkFCWUxPTi5TY3JpcHRDb21wb25lbnQge1xuICAgIHByaXZhdGUgcGxheWVyRGVsdGFYOm51bWJlciA9IDA7XG4gICAgcHJpdmF0ZSBwbGF5ZXJEZWx0YVk6bnVtYmVyID0gMDtcbiAgICBwcml2YXRlIHBsYXllck1vdXNlWDpudW1iZXIgPSAwO1xuICAgIHByaXZhdGUgcGxheWVyTW91c2VZOm51bWJlciA9IDA7XG5cbiAgICBwdWJsaWMgZ2V0UGxheWVyRGVsdGFYKCk6bnVtYmVyIHsgcmV0dXJuIHRoaXMucGxheWVyRGVsdGFYIH07XG4gICAgcHVibGljIGdldFBsYXllckRlbHRhWSgpOm51bWJlciB7IHJldHVybiB0aGlzLnBsYXllckRlbHRhWSB9O1xuICAgIHB1YmxpYyBnZXRQbGF5ZXJNb3VzZVgoKTpudW1iZXIgeyByZXR1cm4gdGhpcy5wbGF5ZXJNb3VzZVggfTtcbiAgICBwdWJsaWMgZ2V0UGxheWVyTW91c2VZKCk6bnVtYmVyIHsgcmV0dXJuIHRoaXMucGxheWVyTW91c2VZIH07XG5cbiAgICBwdWJsaWMgZW5hYmxlSW5wdXQ6Ym9vbGVhbiA9IGZhbHNlO1xuICAgIHB1YmxpYyBhdHRhY2hDYW1lcmE6Ym9vbGVhbiA9IGZhbHNlO1xuICAgIHB1YmxpYyBmb2xsb3dCZWhpbmQ6Ym9vbGVhbiA9IHRydWU7XG4gICAgcHVibGljIHBsYXllck51bWJlcjpCQUJZTE9OLlBsYXllck51bWJlciA9IEJBQllMT04uUGxheWVyTnVtYmVyLk9uZTtcbiAgICBwdWJsaWMgdHJpZ2dlckZvcndhcmQ6bnVtYmVyID0gQkFCWUxPTi5YYm94MzYwVHJpZ2dlci5SaWdodDtcbiAgICBwdWJsaWMga2V5Ym9hcmRGb3Jhd3JkOm51bWJlciA9IEJBQllMT04uVXNlcklucHV0S2V5Llc7XG4gICAgcHVibGljIGF1eEtleWJvYXJkRm9yYXdyZDpudW1iZXIgPSBCQUJZTE9OLlVzZXJJbnB1dEtleS5VcEFycm93O1xuICAgIHB1YmxpYyB0cmlnZ2VyQmFja3dhcmRzOm51bWJlciA9IEJBQllMT04uWGJveDM2MFRyaWdnZXIuTGVmdDtcbiAgICBwdWJsaWMga2V5Ym9hcmRCYWNrd2FyZHM6bnVtYmVyID0gQkFCWUxPTi5Vc2VySW5wdXRLZXkuUztcbiAgICBwdWJsaWMgYXV4S2V5Ym9hcmRCYWNrd2FyZHM6bnVtYmVyID0gQkFCWUxPTi5Vc2VySW5wdXRLZXkuRG93bkFycm93O1xuICAgIHB1YmxpYyBidXR0b25IYW5kYnJha2U6bnVtYmVyID0gQkFCWUxPTi5YYm94MzYwQnV0dG9uLlg7XG4gICAgcHVibGljIGtleWJvYXJkSGFuZGJyYWtlOm51bWJlciA9IEJBQllMT04uVXNlcklucHV0S2V5LlNwYWNlQmFyO1xuXG4gICAgLy9wcm90ZWN0ZWQgbV9jdXJyZW50Rm9sbG93U3BlZWQ6bnVtYmVyID0gMC4xO1xuICAgIC8vcHJvdGVjdGVkIG1fZm9sbG93VGFyZ2V0TWFuYWdlcjpCQUJZTE9OLkZvbGxvd1RhcmdldE1hbmFnZXIgPSBudWxsO1xuICAgIHByb3RlY3RlZCBtX3N0YW5kYXJkQ2FyQ29udHJvbGxlcjpTdGFuZGFyZENhckNvbnRyb2xsZXIgPSBudWxsO1xuICAgIHB1YmxpYyBjb25zdHJ1Y3Rvcih0cmFuc2Zvcm06IEJBQllMT04uVHJhbnNmb3JtTm9kZSwgc2NlbmU6IEJBQllMT04uU2NlbmUsIHByb3BlcnRpZXM6IGFueSA9IHt9KSB7XG4gICAgICAgIHN1cGVyKHRyYW5zZm9ybSwgc2NlbmUsIHByb3BlcnRpZXMpO1xuICAgICAgICB0aGlzLmVuYWJsZUlucHV0ID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcImVuYWJsZUlucHV0XCIsIHRoaXMuZW5hYmxlSW5wdXQpO1xuICAgICAgICB0aGlzLnBsYXllck51bWJlciA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJwbGF5ZXJOdW1iZXJcIiwgdGhpcy5wbGF5ZXJOdW1iZXIpO1xuICAgICAgICB0aGlzLmF0dGFjaENhbWVyYSA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJhdHRhY2hDYW1lcmFcIiwgdGhpcy5hdHRhY2hDYW1lcmEpO1xuICAgICAgICB0aGlzLmZvbGxvd0JlaGluZCA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJmb2xsb3dCZWhpbmRcIiwgdGhpcy5mb2xsb3dCZWhpbmQpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBzdGFydCgpOnZvaWQgeyB0aGlzLmluaXRWZWhpY2xlQ29udHJvbGxlcigpOyB9XG4gICAgcHJvdGVjdGVkIHVwZGF0ZSgpIDp2b2lkIHsgIHRoaXMudXBkYXRlVmVoaWNsZUNvbnRyb2xsZXIoKTsgfVxuICAgIHByb3RlY3RlZCBhZnRlcigpIDp2b2lkIHsgIHRoaXMuYWZ0ZXJWZWhpY2xlQ29udHJvbGxlcigpOyB9XG4gICAgcHJvdGVjdGVkIGRlc3Ryb3koKTogdm9pZCB7IHRoaXMuZGVzdHJveVZlaGljbGVDb250cm9sbGVyKCk7IH1cblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLy8gUHJvdGVjdGVkIENoYXJhY3RlciBNb3ZlbWVudCBTdGF0ZSBGdW5jdGlvbnMgLy9cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgLy9wcm90ZWN0ZWQgbV9jYW1lcmFCb29tOkJBQllMT04uVHJhbnNmb3JtTm9kZSA9IG51bGw7XG4gICAgcHJvdGVjdGVkIGluaXRWZWhpY2xlQ29udHJvbGxlcigpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuYXR0YWNoQ2FtZXJhID09PSB0cnVlKSB7XG4gICAgICAgICAgICAvL3RoaXMubV9jYW1lcmFCb29tID0gQkFCWUxPTi5NZXNoLkNyZWF0ZUJveChcIkNhbWVyYSBCb29tXCIsIDAuNSwgdGhpcy5zY2VuZSk7XG4gICAgICAgICAgICAvL3RoaXMubV9jYW1lcmFCb29tLnBhcmVudCA9IHRoaXMudHJhbnNmb3JtO1xuICAgICAgICAgICAgLy90aGlzLm1fY2FtZXJhQm9vbS5wb3NpdGlvbi5zZXQoMCwxLjUsMCk7XG4gICAgICAgICAgICAvL3RoaXMubV9jYW1lcmFCb29tLnJvdGF0aW9uUXVhdGVybmlvbiA9IEJBQllMT04uVXRpbGl0aWVzLkZyb21FdWxlcigwLDAsMCk7XG4gICAgICAgICAgICAvL2NvbnN0IHRyYW5zZm9ybUNhbWVyYTpCQUJZTE9OLlRyYW5zZm9ybU5vZGUgPSBCQUJZTE9OLlNjZW5lTWFuYWdlci5HZXRUcmFuc2Zvcm1Ob2RlKHRoaXMuc2NlbmUsIFwiTWFpbiBDYW1lcmFcIik7XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAvL2NvbnN0IHRyYW5zZm9ybUNhbWVyYTpCQUJZTE9OLlRyYW5zZm9ybU5vZGUgPSBCQUJZTE9OLlVuaXZlcnNhbENhbWVyYVN5c3RlbS5HZXRQbGF5ZXJDYW1lcmFUcmFuc2Zvcm0odGhpcy5wbGF5ZXJOdW1iZXIpO1xuICAgICAgICAgICAgY29uc3QgdHJhbnNmb3JtQ2FtZXJhOkJBQllMT04uVHJhbnNmb3JtTm9kZSA9IEJBQllMT04uU2NlbmVNYW5hZ2VyLkdldFRyYW5zZm9ybU5vZGUodGhpcy5zY2VuZSwgXCJNYWluIENhbWVyYVwiKTtcbiAgICAgICAgICAgIHRoaXMubV9mb2xsb3dUYXJnZXRNYW5hZ2VyID0gbmV3IEJBQllMT04uRm9sbG93VGFyZ2V0TWFuYWdlcih0cmFuc2Zvcm1DYW1lcmEsIHRoaXMuZ2V0QWJzdHJhY3RNZXNoKCkpO1xuICAgICAgICAgICAgLy8gQWNjZWxlcmF0aW9uIG9mIGNhbWVyYSBpbiBtb3ZpbmcgZnJvbSBjdXJyZW50IHRvIGdvYWwgcG9zaXRpb25cbiAgICAgICAgICAgIHRoaXMubV9mb2xsb3dUYXJnZXRNYW5hZ2VyLmZvbGxvd0FjY2VsZXJhdGlvbiA9IHRoaXMubV9jdXJyZW50Rm9sbG93U3BlZWQ7XG4gICAgICAgICAgICAvLyBUaGUgZ29hbCBkaXN0YW5jZSBvZiBjYW1lcmEgZnJvbSB0YXJnZXRcbiAgICAgICAgICAgIHRoaXMubV9mb2xsb3dUYXJnZXRNYW5hZ2VyLmZvbGxvd0Rpc3RhbmNlID0gNjtcbiAgICAgICAgICAgIC8vIFRoZSBnb2FsIGhlaWdodCBvZiBjYW1lcmEgYWJvdmUgbG9jYWwgb3JpZ2luIChjZW50cmUpIG9mIHRhcmdldFxuICAgICAgICAgICAgdGhpcy5tX2ZvbGxvd1RhcmdldE1hbmFnZXIuaGVpZ2h0T2Zmc2V0ID0gMjtcbiAgICAgICAgICAgIC8vIFRoZSBnb2FsIHJvdGF0aW9uIG9mIGNhbWVyYSBhcm91bmQgbG9jYWwgb3JpZ2luIChjZW50cmUpIG9mIHRhcmdldCBpbiB4IHkgcGxhbmVcbiAgICAgICAgICAgIHRoaXMubV9mb2xsb3dUYXJnZXRNYW5hZ2VyLnJvdGF0aW9uT2Zmc2V0ID0gMTgwO1xuICAgICAgICAgICAgLy8gVGhlIHNwZWVkIGF0IHdoaWNoIGFjY2VsZXJhdGlvbiBpcyBoYWx0ZWRcbiAgICAgICAgICAgIHRoaXMubV9mb2xsb3dUYXJnZXRNYW5hZ2VyLm1heEZvbGxvd1NwZWVkID0gMTAwMDA7XG4gICAgICAgICAgICAvLyBUaGUgbG93ZXIgaGlnaHQgb2Zmc2V0IGxpbWl0IHZhbHVlXG4gICAgICAgICAgICB0aGlzLm1fZm9sbG93VGFyZ2V0TWFuYWdlci5sb3dlckhlaWdodE9mZnNldExpbWl0ID0gMTtcbiAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHRoaXMudHJhbnNmb3JtLnBvc2l0aW9uLmNsb25lKCk7XG4gICAgICAgICAgICBzdGFydFBvcy55ICs9IDI7XG4gICAgICAgICAgICBzdGFydFBvcy56ICs9IC02O1xuICAgICAgICAgICAgLy8gLi5cbiAgICAgICAgICAgIGNvbnN0IGZvbGxvd0NhbWVyYSA9IG5ldyBCQUJZTE9OLkZvbGxvd0NhbWVyYShcIkZvbGxvd0NhbVwiLCBzdGFydFBvcywgdGhpcy5zY2VuZSk7XG4gICAgICAgICAgICBmb2xsb3dDYW1lcmEuY2FtZXJhQWNjZWxlcmF0aW9uID0gMC4wNjtcbiAgICAgICAgICAgIGZvbGxvd0NhbWVyYS5tYXhDYW1lcmFTcGVlZCA9IDE4MDA7XG4gICAgICAgICAgICBmb2xsb3dDYW1lcmEucm90YXRpb25PZmZzZXQgPSAxODA7XG4gICAgICAgICAgICBmb2xsb3dDYW1lcmEuaGVpZ2h0T2Zmc2V0ID0gMi4wO1xuICAgICAgICAgICAgZm9sbG93Q2FtZXJhLmluZXJ0aWEgPSA0MC4wO1xuICAgICAgICAgICAgZm9sbG93Q2FtZXJhLnJhZGl1cyA9IDEwO1xuICAgICAgICAgICAgZm9sbG93Q2FtZXJhLmxvY2tlZFRhcmdldCA9IHRoaXMuZ2V0QWJzdHJhY3RNZXNoKCk7XG4gICAgICAgICAgICBmb2xsb3dDYW1lcmEubG93ZXJIZWlnaHRPZmZzZXRMaW1pdCA9IDE7XG4gICAgICAgICAgICB0aGlzLnNjZW5lLmFjdGl2ZUNhbWVyYSA9IGZvbGxvd0NhbWVyYTtcbiAgICAgICAgICAgIC8vXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tX3N0YW5kYXJkQ2FyQ29udHJvbGxlciA9IHRoaXMuZ2V0Q29tcG9uZW50KFwiU3RhbmRhcmRDYXJDb250cm9sbGVyXCIpO1xuICAgICAgICBpZiAodGhpcy5tX3N0YW5kYXJkQ2FyQ29udHJvbGxlciA9PSBudWxsKSBCQUJZTE9OLlRvb2xzLldhcm4oXCJOdWxsIHN0YW5kYXJkIGNhciBjb250cm9sbGVyIGZvcjogXCIgKyB0aGlzLnRyYW5zZm9ybS5uYW1lKTtcbiAgICB9XG4gICAgcHJvdGVjdGVkIHVwZGF0ZVZlaGljbGVDb250cm9sbGVyKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5tX3N0YW5kYXJkQ2FyQ29udHJvbGxlciAhPSBudWxsKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVJbnB1dCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyRGVsdGFYID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuR2V0VXNlcklucHV0KEJBQllMT04uVXNlcklucHV0QXhpcy5Ib3Jpem9udGFsLCB0aGlzLnBsYXllck51bWJlcik7XG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXJEZWx0YVkgPSBCQUJZTE9OLlNjZW5lTWFuYWdlci5HZXRVc2VySW5wdXQoQkFCWUxPTi5Vc2VySW5wdXRBeGlzLlZlcnRpY2FsLCB0aGlzLnBsYXllck51bWJlcik7XG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXJNb3VzZVggPSBCQUJZTE9OLlNjZW5lTWFuYWdlci5HZXRVc2VySW5wdXQoQkFCWUxPTi5Vc2VySW5wdXRBeGlzLk1vdXNlWCwgdGhpcy5wbGF5ZXJOdW1iZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyTW91c2VZID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuR2V0VXNlcklucHV0KEJBQllMT04uVXNlcklucHV0QXhpcy5Nb3VzZVksIHRoaXMucGxheWVyTnVtYmVyKTtcblxuICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyh0aGlzLnBsYXllckRlbHRhWCkgPD0gQkFCWUxPTi5Vc2VySW5wdXRPcHRpb25zLkdhbWVwYWREZWFkU3RpY2tWYWx1ZSkgdGhpcy5wbGF5ZXJEZWx0YVggPSAwO1xuICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyh0aGlzLnBsYXllckRlbHRhWSkgPD0gQkFCWUxPTi5Vc2VySW5wdXRPcHRpb25zLkdhbWVwYWREZWFkU3RpY2tWYWx1ZSkgdGhpcy5wbGF5ZXJEZWx0YVkgPSAwO1xuICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyh0aGlzLnBsYXllck1vdXNlWCkgPD0gQkFCWUxPTi5Vc2VySW5wdXRPcHRpb25zLkdhbWVwYWREZWFkU3RpY2tWYWx1ZSkgdGhpcy5wbGF5ZXJNb3VzZVggPSAwO1xuICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyh0aGlzLnBsYXllck1vdXNlWSkgPD0gQkFCWUxPTi5Vc2VySW5wdXRPcHRpb25zLkdhbWVwYWREZWFkU3RpY2tWYWx1ZSkgdGhpcy5wbGF5ZXJNb3VzZVkgPSAwO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgYXV4Rm9yd2FyZEtleWJvYXJkOmJvb2xlYW4gPSBCQUJZTE9OLlNjZW5lTWFuYWdlci5HZXRLZXlib2FyZElucHV0KHRoaXMuYXV4S2V5Ym9hcmRGb3Jhd3JkKTsgLy8gUGxheWVyIE9uZSBPbmx5XG4gICAgICAgICAgICAgICAgY29uc3QgZm9yd2FyZEtleWJvYXJkOmJvb2xlYW4gPSBCQUJZTE9OLlNjZW5lTWFuYWdlci5HZXRLZXlib2FyZElucHV0KHRoaXMua2V5Ym9hcmRGb3Jhd3JkKTsgLy8gUGxheWVyIE9uZSBPbmx5XG4gICAgICAgICAgICAgICAgY29uc3QgZm9yd2FyZFRyaWdnZXI6bnVtYmVyID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuR2V0R2FtZXBhZFRyaWdnZXJJbnB1dCh0aGlzLnRyaWdnZXJGb3J3YXJkLCB0aGlzLnBsYXllck51bWJlcik7XG4gICAgICAgICAgICAgICAgY29uc3QgYXV4QmFja3dhcmRLZXlib2FyZDpib29sZWFuID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuR2V0S2V5Ym9hcmRJbnB1dCh0aGlzLmF1eEtleWJvYXJkQmFja3dhcmRzKTsgLy8gUGxheWVyIE9uZSBPbmx5XG4gICAgICAgICAgICAgICAgY29uc3QgYmFja3dhcmRLZXlib2FyZDpib29sZWFuID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuR2V0S2V5Ym9hcmRJbnB1dCh0aGlzLmtleWJvYXJkQmFja3dhcmRzKTsgLy8gUGxheWVyIE9uZSBPbmx5XG4gICAgICAgICAgICAgICAgY29uc3QgYmFja3dhcmRUcmlnZ2VyOm51bWJlciA9IEJBQllMT04uU2NlbmVNYW5hZ2VyLkdldEdhbWVwYWRUcmlnZ2VySW5wdXQodGhpcy50cmlnZ2VyQmFja3dhcmRzLCB0aGlzLnBsYXllck51bWJlcik7XG4gICAgICAgICAgICAgICAgY29uc3QgaGFuZGJyYWtlS2V5Ym9hcmQ6Ym9vbGVhbiA9IEJBQllMT04uU2NlbmVNYW5hZ2VyLkdldEtleWJvYXJkSW5wdXQodGhpcy5rZXlib2FyZEhhbmRicmFrZSk7IC8vIFBsYXllciBPbmUgT25seVxuICAgICAgICAgICAgICAgIGNvbnN0IGhhbmRicmFrZUJ1dHRvbjpib29sZWFuID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuR2V0R2FtZXBhZEJ1dHRvbklucHV0KHRoaXMuYnV0dG9uSGFuZGJyYWtlLCB0aGlzLnBsYXllck51bWJlcik7XG5cbiAgICAgICAgICAgICAgICBsZXQgcGxheWVyTW92ZW1lbnQ6bnVtYmVyID0gMDtcbiAgICAgICAgICAgICAgICBsZXQgcGxheWVyU3RlZXJpbmc6bnVtYmVyID0gMDtcbiAgICAgICAgICAgICAgICBsZXQgcGxheWVySGFuZGJyYWtlOmJvb2xlYW4gPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIC8vIFByaW1hcnkgQWNjZWxlcmF0dGlvblxuICAgICAgICAgICAgICAgIGlmIChmb3J3YXJkVHJpZ2dlciA+IDAuMikgcGxheWVyTW92ZW1lbnQgPSBmb3J3YXJkVHJpZ2dlcjtcbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLnBsYXllck51bWJlciA9PT0gQkFCWUxPTi5QbGF5ZXJOdW1iZXIuT25lICYmIChmb3J3YXJkS2V5Ym9hcmQgPT09IHRydWUgfHwgYXV4Rm9yd2FyZEtleWJvYXJkID09PSB0cnVlKSkgcGxheWVyTW92ZW1lbnQgPSAxO1xuICAgICAgICAgICAgICAgIC8vIEJyYWtpbmcgVGFrZXMgUHJlY2VkZW5jZVxuICAgICAgICAgICAgICAgIGlmIChiYWNrd2FyZFRyaWdnZXIgPiAwLjIpIHBsYXllck1vdmVtZW50ID0gLWJhY2t3YXJkVHJpZ2dlcjtcbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLnBsYXllck51bWJlciA9PT0gQkFCWUxPTi5QbGF5ZXJOdW1iZXIuT25lICYmIChiYWNrd2FyZEtleWJvYXJkID09PSB0cnVlIHx8IGF1eEJhY2t3YXJkS2V5Ym9hcmQgPT09IHRydWUpKSBwbGF5ZXJNb3ZlbWVudCA9IC0xO1xuICAgICAgICAgICAgICAgIC8vIEluY2x1ZGVzIEFEIEFuZCBBcnJvdyBLZXlzXG4gICAgICAgICAgICAgICAgcGxheWVyU3RlZXJpbmcgPSB0aGlzLnBsYXllckRlbHRhWDsgXG4gICAgICAgICAgICAgICAgLy8gUHVsbCBIYXJkIEhhbmQgQnJha2UgTGV2ZXJcbiAgICAgICAgICAgICAgICBwbGF5ZXJIYW5kYnJha2UgPSAoaGFuZGJyYWtlS2V5Ym9hcmQgPT09IHRydWUgfHwgaGFuZGJyYWtlQnV0dG9uID09PSB0cnVlKTtcbiAgICAgICAgICAgICAgICAvLyBEcml2ZSBTdGFuZGFyZCBDYXIgQ29udHJvbGxlclxuICAgICAgICAgICAgICAgIHRoaXMubV9zdGFuZGFyZENhckNvbnRyb2xsZXIuZHJpdmUocGxheWVyTW92ZW1lbnQsIHBsYXllclN0ZWVyaW5nLCBwbGF5ZXJIYW5kYnJha2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByb3RlY3RlZCBhZnRlclZlaGljbGVDb250cm9sbGVyKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5hdHRhY2hDYW1lcmEgPT09IHRydWUpIHtcblxuICAgIFxuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgaWYgKHRoaXMubV9mb2xsb3dUYXJnZXRNYW5hZ2VyICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXREaXN0YW5jZTpudW1iZXIgPSB0aGlzLm1fZm9sbG93VGFyZ2V0TWFuYWdlci5nZXRUYXJnZXREaXN0YW5jZSgpO1xuICAgICAgICAgICAgICAgIC8vIC4uXG4gICAgICAgICAgICAgICAgLy8gVE9ETzogQ2FsY3VsYXRlIFNtb290aCBGb2xsb3cgQWNjZWxlcmF0aW9uIFNwZWVkXG4gICAgICAgICAgICAgICAgLy8gLi5cbiAgICAgICAgICAgICAgICB0aGlzLm1fZm9sbG93VGFyZ2V0TWFuYWdlci5mb2xsb3dBY2NlbGVyYXRpb24gPSB0aGlzLm1fY3VycmVudEZvbGxvd1NwZWVkO1xuICAgICAgICAgICAgICAgIHRoaXMubV9mb2xsb3dUYXJnZXRNYW5hZ2VyLnVwZGF0ZSh0aGlzLmZvbGxvd0JlaGluZCwgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBtc2c6c3RyaW5nID0gXCJUYXJnZXQgRGlzdGFuY2U6IFwiICsgdGFyZ2V0RGlzdGFuY2UudG9GaXhlZCgyKSArIFwiIC0tPiBGb2xsb3cgU3BlZWQ6IFwiICsgdGhpcy5tX2N1cnJlbnRGb2xsb3dTcGVlZC50b0ZpeGVkKDIpO1xuICAgICAgICAgICAgICAgIEJBQllMT04uVXRpbGl0aWVzLlByaW50VG9TY3JlZW4obXNnLCBcIiMwMEZGMDBcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAqL1xuICAgICAgICB9XG4gICAgfVxuICAgIHByb3RlY3RlZCBkZXN0cm95VmVoaWNsZUNvbnRyb2xsZXIoKTp2b2lkIHtcbiAgICAgICAgdGhpcy5tX3N0YW5kYXJkQ2FyQ29udHJvbGxlciA9IG51bGw7XG4gICAgICAgIC8qXG4gICAgICAgIGlmICh0aGlzLm1fZm9sbG93VGFyZ2V0TWFuYWdlciAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLm1fZm9sbG93VGFyZ2V0TWFuYWdlci5kaXNwb3NlKCk7XG4gICAgICAgICAgICB0aGlzLm1fZm9sbG93VGFyZ2V0TWFuYWdlciA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgKi9cbiAgICB9XG59IiwiLyoqXG4gKiBCYWJ5bG9uIFNjcmlwdCBDb21wb25lbnRcbiAqIEBjbGFzcyBJdGVtUm90YXRvclxuICovXG5jbGFzcyBJdGVtUm90YXRvciBleHRlbmRzIEJBQllMT04uU2NyaXB0Q29tcG9uZW50IHtcbiAgICBwcml2YXRlIHJvdGF0ZVNwZWVkOm51bWJlciA9IDEuMDtcbiAgICBwdWJsaWMgY29uc3RydWN0b3IodHJhbnNmb3JtOiBCQUJZTE9OLlRyYW5zZm9ybU5vZGUsIHNjZW5lOiBCQUJZTE9OLlNjZW5lLCBwcm9wZXJ0aWVzOiBhbnkgPSB7fSkge1xuICAgICAgICBzdXBlcih0cmFuc2Zvcm0sIHNjZW5lLCBwcm9wZXJ0aWVzKTtcbiAgICAgICAgdGhpcy5yb3RhdGVTcGVlZCA9IHRoaXMuZ2V0RWRpdG9yUHJvcGVydHkoXCJyb3RhdGVTcGVlZFwiLCB0aGlzLnJvdGF0ZVNwZWVkKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgc3RhcnQoKTogdm9pZCB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiPT09PiBTdGFydGluZyBpdGVtIHJvdGF0b3IgZm9yOiBcIiArIHRoaXMudHJhbnNmb3JtLm5hbWUpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCB1cGRhdGUoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGRlbHRhOm51bWJlciA9IHRoaXMuZ2V0RGVsdGFTZWNvbmRzKCk7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtLmFkZFJvdGF0aW9uKDAsICh0aGlzLnJvdGF0ZVNwZWVkICogZGVsdGEpLCAwKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZGVzdHJveSgpOiB2b2lke1xuICAgICAgICBjb25zb2xlLmxvZyhcIj09PT4gRGVzdHJveWluZyBpdGVtIHJvdGF0b3IgZm9yOiBcIiArIHRoaXMudHJhbnNmb3JtLm5hbWUpO1xuICAgIH1cbn0iLCIvKipcbiAqIEJhYnlsb24gU2NyaXB0IENvbXBvbmVudFxuICogQGNsYXNzIFRlc3RBbmltYXRpb25cbiAqL1xuY2xhc3MgVGVzdEFuaW1hdGlvbiBleHRlbmRzIEJBQllMT04uU2NyaXB0Q29tcG9uZW50IHtcbiAgICAvL3ByaXZhdGUgYW5pbWF0b3I6QkFCWUxPTi5BbmltYXRpb25TdGF0ZSA9IG51bGw7XG4gICAgcHJpdmF0ZSBhbmltYXRvcjphbnkgPSBudWxsO1xuICAgIHB1YmxpYyBjb25zdHJ1Y3Rvcih0cmFuc2Zvcm06IEJBQllMT04uVHJhbnNmb3JtTm9kZSwgc2NlbmU6IEJBQllMT04uU2NlbmUsIHByb3BlcnRpZXM6IGFueSA9IHt9KSB7XG4gICAgICAgIHN1cGVyKHRyYW5zZm9ybSwgc2NlbmUsIHByb3BlcnRpZXMpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBzdGFydCgpOiB2b2lkIHtcbiAgICAgICAgY29uc29sZS5sb2coXCI9PT0+IFN0YXJ0aW5nIGFuaW1hdGlvbiB0ZXN0IGZvcjogXCIgKyB0aGlzLnRyYW5zZm9ybS5uYW1lKTtcbiAgICAgICAgdGhpcy5hbmltYXRvciA9IHRoaXMuZ2V0Q29tcG9uZW50KFwiQkFCWUxPTi5BbmltYXRpb25TdGF0ZVwiKTtcbiAgICAgICAgaWYgKHRoaXMuYW5pbWF0b3IgPT0gbnVsbCkge1xuICAgICAgICAgICAgQkFCWUxPTi5Ub29scy5XYXJuKFwiRmFpbGVkIHRvIGdldCBhbmltYXRpb24gc3RhdGUgY29tcG9uZW50OiBcIiArIHRoaXMudHJhbnNmb3JtLm5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHVwZGF0ZSgpOiB2b2lkIHtcbiAgICAgICAgLy8gVXBkYXRlIHJlbmRlciBsb29wIGZ1bmN0aW9uXG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGFmdGVyKCk6IHZvaWQge1xuICAgICAgICAvLyBBZnRlciByZW5kZXIgbG9vcCBmdW5jdGlvblxuICAgIH1cblxuICAgIHByb3RlY3RlZCBkZXN0cm95KCk6IHZvaWQge1xuICAgICAgICAvLyBEZXN0cm95IGNvbXBvbmVudCBmdW5jdGlvblxuICAgIH1cbn0iLCIvKipcbiAqIEJhYnlsb24gU2NyaXB0IENvbXBvbmVudFxuICogQGNsYXNzIFRlc3RDb2xsaXNpb25cbiAqL1xuY2xhc3MgVGVzdENvbGxpc2lvbiBleHRlbmRzIEJBQllMT04uU2NyaXB0Q29tcG9uZW50IHtcblxuICAgIHByaXZhdGUgcmlnaWRib2R5OkJBQllMT04uUmlnaWRib2R5UGh5c2ljcyA9IG51bGw7XG5cbiAgICBwdWJsaWMgY29uc3RydWN0b3IodHJhbnNmb3JtOiBCQUJZTE9OLlRyYW5zZm9ybU5vZGUsIHNjZW5lOiBCQUJZTE9OLlNjZW5lLCBwcm9wZXJ0aWVzOiBhbnkgPSB7fSkge1xuICAgICAgICBzdXBlcih0cmFuc2Zvcm0sIHNjZW5lLCBwcm9wZXJ0aWVzKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgc3RhcnQoKTogdm9pZCB7XG4gICAgICAgIC8vIFN0YXJ0IHJlbmRlciBsb29wIGZ1bmN0aW9uXG4gICAgICAgIGNvbnNvbGUubG9nKFwiVGVzdCBjb2xsaXNpb24gZm9yOiBcIiArIHRoaXMudHJhbnNmb3JtLm5hbWUpO1xuICAgICAgICB0aGlzLnJpZ2lkYm9keSA9IHRoaXMuZ2V0Q29tcG9uZW50KFwiQkFCWUxPTi5SaWdpZGJvZHlQaHlzaWNzXCIpO1xuICAgICAgICBpZiAodGhpcy5yaWdpZGJvZHkgIT0gbnVsbCkge1xuXG4gICAgICAgICAgICB0aGlzLnJpZ2lkYm9keS5yZWdpc3Rlck9uQ29sbGlzaW9uRW50ZXIoKG1lc2g6QkFCWUxPTi5BYnN0cmFjdE1lc2gpPT57XG4gICAgICAgICAgICAgICAgY29uc3QgdGFnOnN0cmluZyA9IEJBQllMT04uU2NlbmVNYW5hZ2VyLkdldFRyYW5zZm9ybVRhZyhtZXNoKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIiMjIzogXCIgKyB0aGlzLnRyYW5zZm9ybS5uYW1lICsgXCI6IEJlZ2luIENvbnRhY3QgV2l0aDogXCIgKyBtZXNoLm5hbWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnJpZ2lkYm9keS5yZWdpc3Rlck9uQ29sbGlzaW9uU3RheSgobWVzaDpCQUJZTE9OLkFic3RyYWN0TWVzaCk9PntcbiAgICAgICAgICAgICAgICBjb25zdCB0YWc6c3RyaW5nID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuR2V0VHJhbnNmb3JtVGFnKG1lc2gpO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCIjIyM6IFwiICsgdGhpcy50cmFuc2Zvcm0ubmFtZSArIFwiOiBVcGRhdGUgQ29udGFjdCBXaXRoOiBcIiArIG1lc2gubmFtZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMucmlnaWRib2R5LnJlZ2lzdGVyT25Db2xsaXNpb25FeGl0KChtZXNoOkJBQllMT04uQWJzdHJhY3RNZXNoKT0+e1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhZzpzdHJpbmcgPSBCQUJZTE9OLlNjZW5lTWFuYWdlci5HZXRUcmFuc2Zvcm1UYWcobWVzaCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiIyMjOiBcIiArIHRoaXMudHJhbnNmb3JtLm5hbWUgKyBcIjogRW5kIENvbnRhY3QgV2l0aDogXCIgKyBtZXNoLm5hbWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkZhaWxlZCB0byBsb2NhdGUgcmlnaWRib2R5IGNvbXBvbmVudCBmb3I6IFwiICsgdGhpcy50cmFuc2Zvcm0ubmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgdXBkYXRlKCk6IHZvaWQge1xuICAgICAgICAvLyBVcGRhdGUgcmVuZGVyIGxvb3AgZnVuY3Rpb25cbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgYWZ0ZXIoKTogdm9pZCB7XG4gICAgICAgIC8vIEFmdGVyIHJlbmRlciBsb29wIGZ1bmN0aW9uXG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgICAgIC8vIERlc3Ryb3kgY29tcG9uZW50IGZ1bmN0aW9uXG4gICAgfVxufSIsIi8qKlxuICogQmFieWxvbiBTY3JpcHQgQ29tcG9uZW50XG4gKiBAY2xhc3MgVGVzdENvbnRyb2xsZXJcbiAqL1xuY2xhc3MgVGVzdENvbnRyb2xsZXIgZXh0ZW5kcyBCQUJZTE9OLlNjcmlwdENvbXBvbmVudCB7XG4gICAgcHJpdmF0ZSB0ZXN0VGV4dHVyZTphbnkgPSBudWxsO1xuICAgIHByaXZhdGUgbV9waHlzaWNzV29ybGQ6YW55ID0gbnVsbDtcbiAgICBwcm90ZWN0ZWQgbV9waHlzaWNzRW5naW5lOkJBQllMT04uSVBoeXNpY3NFbmdpbmUgPSBudWxsO1xuICAgIHB1YmxpYyBjb25zdHJ1Y3Rvcih0cmFuc2Zvcm06IEJBQllMT04uVHJhbnNmb3JtTm9kZSwgc2NlbmU6IEJBQllMT04uU2NlbmUsIHByb3BlcnRpZXM6IGFueSA9IHt9KSB7XG4gICAgICAgIHN1cGVyKHRyYW5zZm9ybSwgc2NlbmUsIHByb3BlcnRpZXMpO1xuICAgICAgICB0aGlzLnRlc3RUZXh0dXJlID0gdGhpcy5nZXRFZGl0b3JQcm9wZXJ0eShcInRlc3RUZXh0dXJlXCIsIHRoaXMudGVzdFRleHR1cmUpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBhc3luYyBzdGFydCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gU3RhcnQgcmVuZGVyIGxvb3AgZnVuY3Rpb25cbiAgICAgICAgY29uc29sZS5sb2coXCI9PT0+IFN0YXJ0aW5nIHRlc3QgY29udHJvbGxlci4uLlwiKTtcbiAgICAgICAgdGhpcy5tX3BoeXNpY3NXb3JsZCA9IEJBQllMT04uU2NlbmVNYW5hZ2VyLkdldFBoeXNpY3NXb3JsZCh0aGlzLnNjZW5lKTtcbiAgICAgICAgdGhpcy5tX3BoeXNpY3NFbmdpbmUgPSBCQUJZTE9OLlNjZW5lTWFuYWdlci5HZXRQaHlzaWNzRW5naW5lKHRoaXMuc2NlbmUpO1xuXG4gICAgICAgIC8qXG4gICAgICAgIGNvbnNvbGUubG9nKFwiPT09PiBUZXN0IFRleHR1cmVcIik7XG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMudGVzdFRleHR1cmUpO1xuICAgICAgICBjb25zdCBiYWJ5bG9uVGV4dHVyZTpCQUJZTE9OLlRleHR1cmUgPSBCQUJZTE9OLlV0aWxpdGllcy5QYXJzZVRleHR1cmUodGhpcy50ZXN0VGV4dHVyZSwgdGhpcy5zY2VuZSk7XG4gICAgICAgIGNvbnNvbGUubG9nKGJhYnlsb25UZXh0dXJlKTtcbiAgICAgICAgY29uc3QgdGVzdFByb2plY3RvcjpCQUJZTE9OLkFic3RyYWN0TWVzaCA9IEJBQllMT04uU2NlbmVNYW5hZ2VyLkdldEFic3RyYWN0TWVzaCh0aGlzLnNjZW5lLCBcIlRlc3RQcm9qZWN0b3JcIik7XG4gICAgICAgIGNvbnNvbGUud2FybihcIioqKiBGT1VORCBURVNUIFBST0pFQ1RPUiAqKipcIik7XG4gICAgICAgIGNvbnNvbGUubG9nKHRlc3RQcm9qZWN0b3IpO1xuICAgICAgICBsZXQgYW5nbGU6bnVtYmVyID0gTWF0aC5QSSAvIDM7XG4gICAgICAgIGxldCBsaWdodCA9IG5ldyBCQUJZTE9OLlNwb3RMaWdodChcbiAgICAgICAgICAgIFwiTGlnaHRcIixcbiAgICAgICAgICAgIHRlc3RQcm9qZWN0b3IucG9zaXRpb24uY2xvbmUoKSxcbiAgICAgICAgICAgIG5ldyBCQUJZTE9OLlZlY3RvcjMoMCwgLTEsIDApLFxuICAgICAgICAgICAgYW5nbGUsXG4gICAgICAgICAgICAxLFxuICAgICAgICAgICAgdGhpcy5zY2VuZVxuICAgICAgICApO1xuICAgICAgICBsaWdodC5kaWZmdXNlLmNvcHlGcm9tRmxvYXRzKDEsIDEsIDEpO1xuICAgICAgICBsaWdodC5zcGVjdWxhci5jb3B5RnJvbUZsb2F0cygwLjAxLCAwLjAxLCAwLjAxKTtcbiAgICAgICAgbGlnaHQuaW50ZW5zaXR5ID0gNTA7XG4gICAgICAgIGxpZ2h0LnByb2plY3Rpb25UZXh0dXJlID0gYmFieWxvblRleHR1cmU7XG4gICAgICAgIC8vbGV0IGR5blRleHR1cmUgPSBuZXcgQkFCWUxPTi5EeW5hbWljVGV4dHVyZShcIlRleHR1cmVcIiwge3dpZHRoOiA1MTIsIGhlaWdodDogNTEyfSwgdGhpcy5zY2VuZSwgdHJ1ZSk7XG4gICAgICAgIC8vZHluVGV4dHVyZS5kcmF3VGV4dChcIlRFU1RcIiwgODAsIDI1NiwgXCJib2xkIDEwMHB4IEFyaWFsXCIsIFwid2hpdGVcIiwgXCJibGFja1wiLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgLy9saWdodC5wcm9qZWN0aW9uVGV4dHVyZSA9IGR5blRleHR1cmU7ICAgIFxuICAgICAgICAqL1xuXG4gICAgICAgIC8vQkFCWUxPTi5TY2VuZUxvYWRlci5JbXBvcnRNZXNoKFwiXCIsIFwic2NlbmVzL1wiLCBcIkFCb3QuYmFieWxvblwiLCB0aGlzLnNjZW5lLCBmdW5jdGlvbiAobmV3TWVzaGVzOkJBQllMT04uQWJzdHJhY3RNZXNoW10pIHtcbiAgICAgICAgLy8gICAgY29uc29sZS53YXJuKFwiKioqIExPQURFRCBORVcgTUVTSEVTICoqKlwiKTtcbiAgICAgICAgLy8gICAgY29uc29sZS5sb2cobmV3TWVzaGVzKTtcbiAgICAgICAgLy99KTtcblxuICAgICAgICAvL3ZhciBwbTpCQUJZTE9OLlBCUk1hdGVyaWFsO1xuICAgICAgICAvL3ZhciBzbTpCQUJZTE9OLlN0YW5kYXJkTWF0ZXJpYWw7XG5cbiAgICAgICAgLypcbiAgICAgICAgY29uc29sZS5sb2coXCI9PT0+IENyZWF0ZSB0ZXN0IHByZWZhYnMuLi5cIik7XG4gICAgICAgIGNvbnN0IHJvb3Q6QkFCWUxPTi5UcmFuc2Zvcm1Ob2RlID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuR2V0TWVzaCh0aGlzLnNjZW5lLCBcIl9fcm9vdF9fXCIpO1xuICAgICAgICBCQUJZTE9OLlNjZW5lTWFuYWdlci5JbnN0YW50aWF0ZVByZWZhYih0aGlzLnNjZW5lLCBcIlJlbXkgMVwiLCBcIk5ldyBSZW15IDFcIiwgcm9vdCk7XG4gICAgICAgIEJBQllMT04uU2NlbmVNYW5hZ2VyLkluc3RhbnRpYXRlUHJlZmFiKHRoaXMuc2NlbmUsIFwiUmVteSAyXCIsIFwiTmV3IFJlbXkgMlwiLCByb290KTtcbiAgICAgICAgQkFCWUxPTi5TY2VuZU1hbmFnZXIuSW5zdGFudGlhdGVQcmVmYWIodGhpcy5zY2VuZSwgXCJDdWJlIDFcIiwgXCJOZXcgQ3ViZSAxXCIsIHJvb3QpO1xuICAgICAgICBCQUJZTE9OLlNjZW5lTWFuYWdlci5JbnN0YW50aWF0ZVByZWZhYih0aGlzLnNjZW5lLCBcIkN1YmUgMlwiLCBcIk5ldyBDdWJlIDJcIiwgcm9vdCk7XG4gICAgICAgIEJBQllMT04uU2NlbmVNYW5hZ2VyLkluc3RhbnRpYXRlUHJlZmFiKHRoaXMuc2NlbmUsIFwiU3BoZXJlIDFcIiwgXCJOZXcgU3BoZXJlIDFcIiwgcm9vdCk7XG4gICAgICAgIEJBQllMT04uU2NlbmVNYW5hZ2VyLkluc3RhbnRpYXRlUHJlZmFiKHRoaXMuc2NlbmUsIFwiU3BoZXJlIDJcIiwgXCJOZXcgU3BoZXJlIDJcIiwgcm9vdCk7XG4gICAgICAgIEJBQllMT04uU2NlbmVNYW5hZ2VyLkluc3RhbnRpYXRlUHJlZmFiKHRoaXMuc2NlbmUsIFwiQ2Fwc3VsZSAxXCIsIFwiTmV3IENhcHN1bGUgMVwiLCByb290KTtcbiAgICAgICAgQkFCWUxPTi5TY2VuZU1hbmFnZXIuSW5zdGFudGlhdGVQcmVmYWIodGhpcy5zY2VuZSwgXCJDYXBzdWxlIDJcIiwgXCJOZXcgQ2Fwc3VsZSAyXCIsIHJvb3QpO1xuICAgICAgICAqL1xuICAgICAgIFxuICAgICAgICAvLyBJbXBvcnQgYXV0aG9yZWQgc2NlbmVcbiAgICAgICAgLy92YXIgbmV3TWVzaGVzID0gKGF3YWl0IEJBQllMT04uU2NlbmVMb2FkZXIuSW1wb3J0TWVzaEFzeW5jKFwiXCIsIFwiaHR0cHM6Ly9tYWNrZXlrMjQuZ2l0aHViLmlvL3RlbXAvVGVzdFBoeXNpY3MuZ2xiXCIsIFwiXCIsIHRoaXMuc2NlbmUpKS5tZXNoZXM7XG4gICAgICAgIC8vY29uc29sZS53YXJuKFwiV1RGOiBUaGF0IFdvcmtlZFwiKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhuZXdNZXNoZXMpO1xuXG4gICAgICAgIC8vIExvYWQgVGVzdCBSZW15IE1lc2hlc1xuICAgICAgICAvL0JBQllMT04uU2NlbmVMb2FkZXIuSW1wb3J0TWVzaChcIlwiLCBcInNjZW5lcy9cIiwgXCJSZW15LmdsdGZcIiwgdGhpcy5zY2VuZSwgZnVuY3Rpb24gKG5ld01lc2hlczpCQUJZTE9OLkFic3RyYWN0TWVzaFtdKSB7XG4gICAgICAgIC8vICAgIGNvbnNvbGUud2FybihcIioqKiBMT0FERUQgTkVXIE1FU0hFUyAqKipcIik7XG4gICAgICAgIC8vICAgIGNvbnNvbGUubG9nKG5ld01lc2hlcyk7XG4gICAgICAgIC8vfSk7ICAgICAgIFxuICAgICAgICBcbiAgICAgICAgLy9sZXQgYm94ID0gQkFCWUxPTi5NZXNoLkNyZWF0ZUJveChcIlRlc3QgQm94XCIsIDEsIHRoaXMuc2NlbmUpO1xuICAgICAgICAvL2JveC5wb3NpdGlvbi54ICs9IDI7XG4gICAgICAgIC8vYm94LnBvc2l0aW9uLnkgKz0gMjtcblxuICAgICAgICAvKlxuICAgICAgICB2YXIgZm9udF9uYW1lczpzdHJpbmdbXSA9IFtcIkFyaWFsXCIsIFwiSGVsdmV0aWNhXCIsIFwiU2Fucy1TZXJpZlwiLCBcIkNvbWljU2Fuc1wiLCBcIkp1cmFcIiwgXCJIaXJ1a29Qcm8tQm9va1wiLCBcIldlYkdMLURpbmdzXCJdO1xuICAgICAgICB2YXIgbGluZV9oZWlnaHQ6bnVtYmVyID0gMTtcbiAgICAgICAgdmFyIHVwcGVyX29mZnNldDpudW1iZXIgPSAobGluZV9oZWlnaHQgKiAtMS4wKTtcbiAgICAgICAgdmFyIG1pZGRsZV9vZmZzZXQ6bnVtYmVyID0gKGxpbmVfaGVpZ2h0ICogLTAuMzMpO1xuICAgICAgICB2YXIgbG93ZXJfb2Zmc2V0Om51bWJlciA9IChsaW5lX2hlaWdodCAqIDAuMjUpO1xuICAgICAgICB2YXIgeV9wb3NpdGlvbjpudW1iZXIgPSB1cHBlcl9vZmZzZXQ7XG4gICAgICAgIHZhciB6X3Bvc2l0aW9uOm51bWJlciA9IDA7XG4gICAgICAgIFxuICAgICAgICB2YXIgd25kOmFueSA9IHdpbmRvdztcbiAgICAgICAgdmFyIFdyaXRlciA9IHduZC5CQUJZTE9OLk1lc2hXcml0ZXIodGhpcy5zY2VuZSwge3NjYWxlOiAxLjB9KTtcbiAgICAgICAgdmFyIHRleHQxICA9IG5ldyBXcml0ZXIoXCJIZWxsbyBXb3JsZFwiLCB7XG4gICAgICAgICAgICAgICAgXCJhbmNob3JcIjogXCJsZWZ0XCIsXG4gICAgICAgICAgICAgICAgXCJmb250LWZhbWlseVwiIDogXCJBcmlhbFwiLCBcbiAgICAgICAgICAgICAgICBcImxldHRlci1oZWlnaHRcIjogbGluZV9oZWlnaHQsXG4gICAgICAgICAgICAgICAgXCJsZXR0ZXItdGhpY2tuZXNzXCI6IDAuMDEsXG4gICAgICAgICAgICAgICAgXCJwb3NpdGlvblwiIDoge1xuICAgICAgICAgICAgICAgICAgICBcInlcIiA6IHlfcG9zaXRpb24sXG4gICAgICAgICAgICAgICAgICAgIFwielwiIDogel9wb3NpdGlvblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJhbHBoYVwiIDogMSxcbiAgICAgICAgICAgICAgICBcImNvbG9yc1wiIDoge1xuICAgICAgICAgICAgICAgICAgICBcImRpZmZ1c2VcIjogXCIjRjBGMEYwXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiYW1iaWVudFwiIDogXCIjRjBGMEYwXCIsXG4gICAgICAgICAgICAgICAgICAgIFwic3BlY3VsYXJcIiA6IFwiIzAwMDAwMFwiLCAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIFwiZW1pc3NpdmVcIjogXCIjODA4MDgwXCIsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICApOyBcbiAgICAgICAgdmFyIG5wOkJBQllMT04uQWJzdHJhY3RNZXNoID0gQkFCWUxPTi5TY2VuZU1hbmFnZXIuR2V0TWVzaCh0aGlzLnNjZW5lLCBcIk5ldyBUZXh0XCIpO1xuICAgICAgICB2YXIgbXg6QkFCWUxPTi5BYnN0cmFjdE1lc2ggPSB0ZXh0MS5nZXRNZXNoKCk7XG4gICAgICAgIG14LnJvdGF0aW9uID0gbmV3IEJBQllMT04uVmVjdG9yMygtTWF0aC5QSS8yLCBNYXRoLlBJLzIsIC1NYXRoLlBJLzIpO1xuICAgICAgICBteC5wYXJlbnQgPSBucDtcbiAgICAgICAgKi9cbiAgICB9XG5cbiAgICBwcml2YXRlIHJhbjpib29sZWFuID0gZmFsc2U7XG4gICAgcHJvdGVjdGVkIHVwZGF0ZSgpOiB2b2lkIHtcbiAgICAgICAgLy8gVXBkYXRlIHJlbmRlciBsb29wIGZ1bmN0aW9uXG4gICAgICAgIC8vIGNvbnN0IG51bV9tYW5pZm9sZHM6bnVtYmVyID0gdGhpcy5tX3BoeXNpY3NXb3JsZC5nZXRCcm9hZHBoYXNlKCkuZ2V0T3ZlcmxhcHBpbmdQYWlyQ2FjaGUoKS5nZXROdW1PdmVybGFwcGluZ1BhaXJzKCk7XG4gICAgICAgIC8vY29uc3QgbnVtX21hbmlmb2xkczpudW1iZXIgPSB0aGlzLm1fcGh5c2ljc1dvcmxkLmdldERpc3BhdGNoZXIoKS5nZXROdW1NYW5pZm9sZHMoKTtcbiAgICAgICAgLy9jb25zdCBtc2cgPSBcIlRvdGFsIE92ZXJsYXBwaW5nIFBhcmlzOiBcIiArIG51bV9tYW5pZm9sZHM7XG4gICAgICAgIC8vQkFCWUxPTi5VdGlsaXRpZXMuUHJpbnRUb1NjcmVlbihtc2cpOyAgIFxuICAgICAgICAvLyBUZXN0IFJ1bm5pbmcgTG9vcFxuICAgICAgICAvL2lmICh0aGlzLnJhbiA9PT0gZmFsc2UpIHtcbiAgICAgICAgLy8gICAgdGhpcy5yYW4gPSB0cnVlO1xuICAgICAgICAvLyAgICBcbiAgICAgICAgLy99XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGFmdGVyKCk6IHZvaWQge1xuICAgICAgICAvLyBBZnRlciByZW5kZXIgbG9vcCBmdW5jdGlvblxuICAgIH1cblxuICAgIHByb3RlY3RlZCBkZXN0cm95KCk6IHZvaWQge1xuICAgICAgICAvLyBEZXN0cm95IGNvbXBvbmVudCBmdW5jdGlvblxuICAgIH1cbn0iXX0=

// Project Data Store
if (navigator.dataStore == null) navigator.dataStore = {};

navigator.dataStore['manifest'] = JSON.parse(window.atob("ewogICJuYW1lIjogIiMjI1RJVExFIyMjIiwKICAic2hvcnRfbmFtZSI6ICIjIyNTSE9SVCMjIyIsCiAgInRoZW1lX2NvbG9yIjogIiMjI1NQTEFTSCMjIyIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiIyMjU1BMQVNIIyMjIiwKICAib3JpZW50YXRpb24iOiAiIyMjT1JJRU5UIyMjIiwgIAogICJkaXNwbGF5IjogIiMjI0RJU1BMQVkjIyMiLAogICJzdGFydF91cmwiOiAiIyMjU1RBUlQjIyMiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJpY29ucy9pY29uLTcyeDcyLnBuZyIsCiAgICAgICJzaXplcyI6ICI3Mng3MiIsCiAgICAgICJ0eXBlIjogImltYWdlL3BuZyIKICAgIH0sCiAgICB7CiAgICAgICJzcmMiOiAiaWNvbnMvaWNvbi05Nng5Ni5wbmciLAogICAgICAic2l6ZXMiOiAiOTZ4OTYiLAogICAgICAidHlwZSI6ICJpbWFnZS9wbmciCiAgICB9LAogICAgewogICAgICAic3JjIjogImljb25zL2ljb24tMTI4eDEyOC5wbmciLAogICAgICAic2l6ZXMiOiAiMTI4eDEyOCIsCiAgICAgICJ0eXBlIjogImltYWdlL3BuZyIKICAgIH0sCiAgICB7CiAgICAgICJzcmMiOiAiaWNvbnMvaWNvbi0xNDR4MTQ0LnBuZyIsCiAgICAgICJzaXplcyI6ICIxNDR4MTQ0IiwKICAgICAgInR5cGUiOiAiaW1hZ2UvcG5nIgogICAgfSwKICAgIHsKICAgICAgInNyYyI6ICJpY29ucy9pY29uLTE1MngxNTIucG5nIiwKICAgICAgInNpemVzIjogIjE1MngxNTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9wbmciCiAgICB9LAogICAgewogICAgICAic3JjIjogImljb25zL2ljb24tMTkyeDE5Mi5wbmciLAogICAgICAic2l6ZXMiOiAiMTkyeDE5MiIsCiAgICAgICJ0eXBlIjogImltYWdlL3BuZyIKICAgIH0sCiAgICB7CiAgICAgICJzcmMiOiAiaWNvbnMvaWNvbi0zODR4Mzg0LnBuZyIsCiAgICAgICJzaXplcyI6ICIzODR4Mzg0IiwKICAgICAgInR5cGUiOiAiaW1hZ2UvcG5nIgogICAgfSwKICAgIHsKICAgICAgInNyYyI6ICJpY29ucy9pY29uLTUxMng1MTIucG5nIiwKICAgICAgInNpemVzIjogIjUxMng1MTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9wbmciCiAgICB9CiAgXQp9"));


// Project Shader Store
// Project Shader Chunks
