var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),__decorate=this&&this.__decorate||function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var i=arguments[1],o=0;o<n;){var r=t[o];if(e.call(i,r,o,t))return r;o++}},configurable:!0,writable:!0}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){function n(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),o=i.length>>>0;if(0===o)return!1;for(var r=0|t,a=Math.max(r>=0?r:o-Math.abs(r),0);a<o;){if(n(i[a],e))return!0;a++}return!1}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.PointerEventsPolyfill=t()}(this,function(){"use strict";function e(e,t){t=t||Object.create(null);var n=document.createEvent("Event");n.initEvent(e,t.bubbles||!1,t.cancelable||!1);for(var i,o=2;o<p.length;o++)i=p[o],n[i]=t[i]||m[o];n.buttons=t.buttons||0;var r=0;return r=t.pressure&&n.buttons?t.pressure:n.buttons?.5:0,n.x=n.clientX,n.y=n.clientY,n.pointerId=t.pointerId||0,n.width=t.width||0,n.height=t.height||0,n.pressure=r,n.tiltX=t.tiltX||0,n.tiltY=t.tiltY||0,n.twist=t.twist||0,n.tangentialPressure=t.tangentialPressure||0,n.pointerType=t.pointerType||"",n.hwTimestamp=t.hwTimestamp||0,n.isPrimary=t.isPrimary||!1,n}function t(){this.array=[],this.size=0}function n(e,t,n,i){this.addCallback=e.bind(i),this.removeCallback=t.bind(i),this.changedCallback=n.bind(i),E&&(this.observer=new E(this.mutationWatcher.bind(this)))}function i(e){return"body /shadow-deep/ "+o(e)}function o(e){return'[touch-action="'+e+'"]'}function r(e){return"{ -ms-touch-action: "+e+"; touch-action: "+e+"; }"}function a(){if(I){k.forEach(function(e){String(e)===e?(M+=o(e)+r(e)+"\n",R&&(M+=i(e)+r(e)+"\n")):(M+=e.selectors.map(o)+r(e.rule)+"\n",R&&(M+=e.selectors.map(i)+r(e.rule)+"\n"))});var e=document.createElement("style");e.textContent=M,document.head.appendChild(e)}}function s(){if(!window.PointerEvent){if(window.PointerEvent=e,window.navigator.msPointerEnabled){var t=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:t,enumerable:!0}),C.registerSource("ms",Z)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),C.registerSource("mouse",B),void 0!==window.ontouchstart&&C.registerSource("touch",G);C.register(document)}}function l(e){if(!C.pointermap.has(e)){var t=new Error("InvalidPointerId");throw t.name="InvalidPointerId",t}}function u(e){for(var t=e.parentNode;t&&t!==e.ownerDocument;)t=t.parentNode;if(!t){var n=new Error("InvalidStateError");throw n.name="InvalidStateError",n}}function h(e){var t=C.pointermap.get(e);return 0!==t.buttons}function c(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:H},releasePointerCapture:{value:j},hasPointerCapture:{value:q}})}var p=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],m=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],f=window.Map&&window.Map.prototype.forEach,d=f?Map:t;t.prototype={set:function(e,t){return void 0===t?this["delete"](e):(this.has(e)||this.size++,void(this.array[e]=t))},has:function(e){return void 0!==this.array[e]},"delete":function(e){this.has(e)&&(delete this.array[e],this.size--)},get:function(e){return this.array[e]},clear:function(){this.array.length=0,this.size=0},forEach:function(e,t){return this.array.forEach(function(n,i){e.call(t,n,i,this)},this)}};var v=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],g=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],y={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},T="undefined"!=typeof SVGElementInstance,C={pointermap:new d,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(e,t){var n=t,i=n.events;i&&(i.forEach(function(e){n[e]&&(this.eventMap[e]=n[e].bind(n))},this),this.eventSources[e]=n,this.eventSourceList.push(n))},register:function(e){for(var t,n=this.eventSourceList.length,i=0;i<n&&(t=this.eventSourceList[i]);i++)t.register.call(t,e)},unregister:function(e){for(var t,n=this.eventSourceList.length,i=0;i<n&&(t=this.eventSourceList[i]);i++)t.unregister.call(t,e)},contains:function(e,t){try{return e.contains(t)}catch(n){return!1}},down:function(e){e.bubbles=!0,this.fireEvent("pointerdown",e)},move:function(e){e.bubbles=!0,this.fireEvent("pointermove",e)},up:function(e){e.bubbles=!0,this.fireEvent("pointerup",e)},enter:function(e){e.bubbles=!1,this.fireEvent("pointerenter",e)},leave:function(e){e.bubbles=!1,this.fireEvent("pointerleave",e)},over:function(e){e.bubbles=!0,this.fireEvent("pointerover",e)},out:function(e){e.bubbles=!0,this.fireEvent("pointerout",e)},cancel:function(e){e.bubbles=!0,this.fireEvent("pointercancel",e)},leaveOut:function(e){this.out(e),this.propagate(e,this.leave,!1)},enterOver:function(e){this.over(e),this.propagate(e,this.enter,!0)},eventHandler:function(e){if(!e._handledByPE){var t=e.type,n=this.eventMap&&this.eventMap[t];n&&n(e),e._handledByPE=!0}},listen:function(e,t){t.forEach(function(t){this.addEvent(e,t)},this)},unlisten:function(e,t){t.forEach(function(t){this.removeEvent(e,t)},this)},addEvent:function(e,t){e.addEventListener(t,this.boundHandler)},removeEvent:function(e,t){e.removeEventListener(t,this.boundHandler)},makeEvent:function(t,n){this.captureInfo[n.pointerId]&&(n.relatedTarget=null);var i=new e(t,n);return n.preventDefault&&(i.preventDefault=n.preventDefault),i._target=i._target||n.target,i},fireEvent:function(e,t){var n=this.makeEvent(e,t);return this.dispatchEvent(n)},cloneEvent:function(e){for(var t,n=Object.create(null),i=0;i<v.length;i++)t=v[i],n[t]=e[t]||g[i],!T||"target"!==t&&"relatedTarget"!==t||n[t]instanceof SVGElementInstance&&(n[t]=n[t].correspondingUseElement);return e.preventDefault&&(n.preventDefault=function(){e.preventDefault()}),n},getTarget:function(e){var t=this.captureInfo[e.pointerId];return t?e._target!==t&&e.type in y?void 0:t:e._target},propagate:function(e,t,n){for(var i=e.target,o=[];i!==document&&!i.contains(e.relatedTarget);)if(o.push(i),i=i.parentNode,!i)return;n&&o.reverse(),o.forEach(function(n){e.target=n,t.call(this,e)},this)},setCapture:function(t,n,i){this.captureInfo[t]&&this.releaseCapture(t,i),this.captureInfo[t]=n,this.implicitRelease=this.releaseCapture.bind(this,t,i),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var o=new e("gotpointercapture");o.pointerId=t,o._target=n,i||this.asyncDispatchEvent(o)},releaseCapture:function(t,n){var i=this.captureInfo[t];if(i){this.captureInfo[t]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var o=new e("lostpointercapture");o.pointerId=t,o._target=i,n||this.asyncDispatchEvent(o)}},dispatchEvent:function(e){var t=this.getTarget(e);if(t)return t.dispatchEvent(e)},asyncDispatchEvent:function(e){requestAnimationFrame(this.dispatchEvent.bind(this,e))}};C.boundHandler=C.eventHandler.bind(C);var b={shadow:function(e){if(e)return e.shadowRoot||e.webkitShadowRoot},canTarget:function(e){return e&&Boolean(e.elementFromPoint)},targetingShadow:function(e){var t=this.shadow(e);if(this.canTarget(t))return t},olderShadow:function(e){var t=e.olderShadowRoot;if(!t){var n=e.querySelector("shadow");n&&(t=n.olderShadowRoot)}return t},allShadows:function(e){for(var t=[],n=this.shadow(e);n;)t.push(n),n=this.olderShadow(n);return t},searchRoot:function(e,t,n){if(e){var i,o,r=e.elementFromPoint(t,n);for(o=this.targetingShadow(r);o;){if(i=o.elementFromPoint(t,n)){var a=this.targetingShadow(i);return this.searchRoot(a,t,n)||i}o=this.olderShadow(o)}return r}},owner:function(e){for(var t=e;t.parentNode;)t=t.parentNode;return t.nodeType!==Node.DOCUMENT_NODE&&t.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(t=document),t},findTarget:function(e){var t=e.clientX,n=e.clientY,i=this.owner(e.target);return i.elementFromPoint(t,n)||(i=document),this.searchRoot(i,t,n)}},S=Array.prototype.forEach.call.bind(Array.prototype.forEach),w=Array.prototype.map.call.bind(Array.prototype.map),A=Array.prototype.slice.call.bind(Array.prototype.slice),P=Array.prototype.filter.call.bind(Array.prototype.filter),E=window.MutationObserver||window.WebKitMutationObserver,O="[touch-action]",x={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};n.prototype={watchSubtree:function(e){this.observer&&b.canTarget(e)&&this.observer.observe(e,x)},enableOnSubtree:function(e){this.watchSubtree(e),e===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(e)},installNewSubtree:function(e){S(this.findElements(e),this.addElement,this)},findElements:function(e){return e.querySelectorAll?e.querySelectorAll(O):[]},removeElement:function(e){this.removeCallback(e)},addElement:function(e){this.addCallback(e)},elementChanged:function(e,t){this.changedCallback(e,t)},concatLists:function(e,t){return e.concat(A(t))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(e){return e.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(e){var t=w(e,this.findElements,this);return t.push(P(e,this.isElement)),t.reduce(this.concatLists,[])},mutationWatcher:function(e){e.forEach(this.mutationHandler,this)},mutationHandler:function(e){if("childList"===e.type){var t=this.flattenMutationTree(e.addedNodes);t.forEach(this.addElement,this);var n=this.flattenMutationTree(e.removedNodes);n.forEach(this.removeElement,this)}else"attributes"===e.type&&this.elementChanged(e.target,e.oldValue)}};var k=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],M="",I=window.PointerEvent||window.MSPointerEvent,R=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,V=C.pointermap,_=25,N=[1,4,2,8,16],K=!1;try{K=1===new MouseEvent("test",{buttons:1}).buttons}catch(F){}var L,B={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(e){C.listen(e,this.events)},unregister:function(e){C.unlisten(e,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(e){for(var t,n=this.lastTouches,i=e.clientX,o=e.clientY,r=0,a=n.length;r<a&&(t=n[r]);r++){var s=Math.abs(i-t.x),l=Math.abs(o-t.y);if(s<=_&&l<=_)return!0}},prepareEvent:function(e){var t=C.cloneEvent(e),n=t.preventDefault;return t.preventDefault=function(){e.preventDefault(),n()},t.pointerId=this.POINTER_ID,t.isPrimary=!0,t.pointerType=this.POINTER_TYPE,t},prepareButtonsForMove:function(e,t){var n=V.get(this.POINTER_ID);0!==t.which&&n?e.buttons=n.buttons:e.buttons=0,t.buttons=e.buttons},mousedown:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=V.get(this.POINTER_ID),n=this.prepareEvent(e);K||(n.buttons=N[n.button],t&&(n.buttons|=t.buttons),e.buttons=n.buttons),V.set(this.POINTER_ID,e),t&&0!==t.buttons?C.move(n):C.down(n)}},mousemove:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=this.prepareEvent(e);K||this.prepareButtonsForMove(t,e),t.button=-1,V.set(this.POINTER_ID,e),C.move(t)}},mouseup:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=V.get(this.POINTER_ID),n=this.prepareEvent(e);if(!K){var i=N[n.button];n.buttons=t?t.buttons&~i:0,e.buttons=n.buttons}V.set(this.POINTER_ID,e),n.buttons&=~N[n.button],0===n.buttons?C.up(n):C.move(n)}},mouseover:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=this.prepareEvent(e);K||this.prepareButtonsForMove(t,e),t.button=-1,V.set(this.POINTER_ID,e),C.enterOver(t)}},mouseout:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=this.prepareEvent(e);K||this.prepareButtonsForMove(t,e),t.button=-1,C.leaveOut(t)}},cancel:function(e){var t=this.prepareEvent(e);C.cancel(t),this.deactivateMouse()},deactivateMouse:function(){V["delete"](this.POINTER_ID)}},D=C.captureInfo,z=b.findTarget.bind(b),X=b.allShadows.bind(b),U=C.pointermap,Y=2500,J=200,W="touch-action",G={events:["touchstart","touchmove","touchend","touchcancel"],register:function(e){L.enableOnSubtree(e)},unregister:function(){},elementAdded:function(e){var t=e.getAttribute(W),n=this.touchActionToScrollType(t);n&&(e._scrollType=n,C.listen(e,this.events),X(e).forEach(function(e){e._scrollType=n,C.listen(e,this.events)},this))},elementRemoved:function(e){e._scrollType=void 0,C.unlisten(e,this.events),X(e).forEach(function(e){e._scrollType=void 0,C.unlisten(e,this.events)},this)},elementChanged:function(e,t){var n=e.getAttribute(W),i=this.touchActionToScrollType(n),o=this.touchActionToScrollType(t);i&&o?(e._scrollType=i,X(e).forEach(function(e){e._scrollType=i},this)):o?this.elementRemoved(e):i&&this.elementAdded(e)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(e){var t=e,n=this.scrollTypes;return"none"===t?"none":t===n.XSCROLLER?"X":t===n.YSCROLLER?"Y":n.SCROLLER.exec(t)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(e){return this.firstTouch===e.identifier},setPrimaryTouch:function(e){(0===U.size||1===U.size&&U.has(1))&&(this.firstTouch=e.identifier,this.firstXY={X:e.clientX,Y:e.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(e){e.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var e=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(e,J)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(e){var t=0;return"touchstart"!==e&&"touchmove"!==e||(t=1),t},touchToPointer:function(e){var t=this.currentTouchEvent,n=C.cloneEvent(e),i=n.pointerId=e.identifier+2;n.target=D[i]||z(n),n.bubbles=!0,n.cancelable=!0,n.detail=this.clickCount,n.button=0,n.buttons=this.typeToButtons(t.type),n.width=2*(e.radiusX||e.webkitRadiusX||0),n.height=2*(e.radiusY||e.webkitRadiusY||0),n.pressure=e.force||e.webkitForce||.5,n.isPrimary=this.isPrimaryTouch(e),n.pointerType=this.POINTER_TYPE,n.altKey=t.altKey,n.ctrlKey=t.ctrlKey,n.metaKey=t.metaKey,n.shiftKey=t.shiftKey;var o=this;return n.preventDefault=function(){o.scrolling=!1,o.firstXY=null,t.preventDefault()},n},processTouches:function(e,t){var n=e.changedTouches;this.currentTouchEvent=e;for(var i,o=0;o<n.length;o++)i=n[o],t.call(this,this.touchToPointer(i))},shouldScroll:function(e){if(this.firstXY){var t,n=e.currentTarget._scrollType;if("none"===n)t=!1;else if("XY"===n)t=!0;else{var i=e.changedTouches[0],o=n,r="Y"===n?"X":"Y",a=Math.abs(i["client"+o]-this.firstXY[o]),s=Math.abs(i["client"+r]-this.firstXY[r]);t=a>=s}return this.firstXY=null,t}},findTouch:function(e,t){for(var n,i=0,o=e.length;i<o&&(n=e[i]);i++)if(n.identifier===t)return!0},vacuumTouches:function(e){var t=e.touches;if(U.size>=t.length){var n=[];U.forEach(function(e,i){if(1!==i&&!this.findTouch(t,i-2)){var o=e.out;n.push(o)}},this),n.forEach(this.cancelOut,this)}},touchstart:function(e){this.vacuumTouches(e),this.setPrimaryTouch(e.changedTouches[0]),this.dedupSynthMouse(e),this.scrolling||(this.clickCount++,this.processTouches(e,this.overDown))},overDown:function(e){U.set(e.pointerId,{target:e.target,out:e,outTarget:e.target}),C.enterOver(e),C.down(e)},touchmove:function(e){this.scrolling||(this.shouldScroll(e)?(this.scrolling=!0,this.touchcancel(e)):(e.preventDefault(),this.processTouches(e,this.moveOverOut)))},moveOverOut:function(e){var t=e,n=U.get(t.pointerId);if(n){var i=n.out,o=n.outTarget;C.move(t),i&&o!==t.target&&(i.relatedTarget=t.target,t.relatedTarget=o,i.target=o,t.target?(C.leaveOut(i),C.enterOver(t)):(t.target=o,t.relatedTarget=null,this.cancelOut(t))),n.out=t,n.outTarget=t.target}},touchend:function(e){this.dedupSynthMouse(e),this.processTouches(e,this.upOut)},upOut:function(e){this.scrolling||(C.up(e),C.leaveOut(e)),this.cleanUpPointer(e)},touchcancel:function(e){this.processTouches(e,this.cancelOut)},cancelOut:function(e){C.cancel(e),C.leaveOut(e),this.cleanUpPointer(e)},cleanUpPointer:function(e){U["delete"](e.pointerId),this.removePrimaryPointer(e)},dedupSynthMouse:function(e){var t=B.lastTouches,n=e.changedTouches[0];if(this.isPrimaryTouch(n)){var i={x:n.clientX,y:n.clientY};t.push(i);var o=function(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}.bind(null,t,i);setTimeout(o,Y)}}};L=new n(G.elementAdded,G.elementRemoved,G.elementChanged,G);var H,j,q,Q=C.pointermap,$=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,Z={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(e){C.listen(e,this.events)},unregister:function(e){C.unlisten(e,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(e){var t=e;return $&&(t=C.cloneEvent(e),t.pointerType=this.POINTER_TYPES[e.pointerType]),t},cleanup:function(e){Q["delete"](e)},MSPointerDown:function(e){Q.set(e.pointerId,e);var t=this.prepareEvent(e);C.down(t)},MSPointerMove:function(e){var t=this.prepareEvent(e);C.move(t)},MSPointerUp:function(e){var t=this.prepareEvent(e);C.up(t),this.cleanup(e.pointerId)},MSPointerOut:function(e){var t=this.prepareEvent(e);C.leaveOut(t)},MSPointerOver:function(e){var t=this.prepareEvent(e);C.enterOver(t)},MSPointerCancel:function(e){var t=this.prepareEvent(e);C.cancel(t),this.cleanup(e.pointerId)},MSLostPointerCapture:function(e){var t=C.makeEvent("lostpointercapture",e);C.dispatchEvent(t)},MSGotPointerCapture:function(e){var t=C.makeEvent("gotpointercapture",e);C.dispatchEvent(t)}},ee=window.navigator;ee.msPointerEnabled?(H=function(e){l(e),u(this),h(e)&&(C.setCapture(e,this,!0),this.msSetPointerCapture(e))},j=function(e){l(e),C.releaseCapture(e,!0),this.msReleasePointerCapture(e)}):(H=function(e){l(e),u(this),h(e)&&C.setCapture(e,this)},j=function(e){l(e),C.releaseCapture(e)}),q=function(e){return!!C.captureInfo[e]},a(),s(),c();var te={dispatcher:C,Installer:n,PointerEvent:e,PointerMap:d,targetFinding:b};return te}),pc.Scene.prototype.metadata=null,pc.Entity.prototype.metadata=null,pc.Entity.prototype.animations=null;var AnimationKeyableType={NUM:0,VEC:1,QUAT:2},AnimationKeyable=function(e,t,n){this.init(e,t,n)};AnimationKeyable.prototype.init=function(e,t,n){if(this.type=e||AnimationKeyableType.NUM,this.time=t||0,n)this.value=n;else switch(e){case AnimationKeyableType.NUM:this.value=0;break;case AnimationKeyableType.VEC:this.value=new pc.Vec3;break;case AnimationKeyableType.QUAT:this.value=new pc.Quat}return this},AnimationKeyable.prototype.copy=function(e){if(!e)return this;var t=e.value;return(e.value instanceof pc.Vec3||e.value instanceof pc.Quat)&&(t=e.value.clone()),this.init(e.type,e.time,t),this},AnimationKeyable.prototype.clone=function(){var e=this.value;(this.value instanceof pc.Vec3||this.value instanceof pc.Quat)&&(e=this.value.clone());var t=new AnimationKeyable(this.type,this.time,e);return t},AnimationKeyable.sum=function(e,t){if(!e||!t||e.type!=t)return null;var n=new AnimationKeyable(e.type);switch(e.type){case AnimationKeyableType.NUM:n.value=e.value+t.value;break;case AnimationKeyableType.VEC:n.value.add2(e.value,t.value);break;case AnimationKeyableType.QUAT:n.value.x=e.value.x+t.value.x,n.value.y=e.value.y+t.value.y,n.value.z=e.value.z+t.value.z,n.value.w=e.value.w+t.value.w}return n},AnimationKeyable.minus=function(e,t){if(!e||!t||e.type!=t)return null;var n=new AnimationKeyable(e.type);switch(e.type){case AnimationKeyableType.NUM:n.value=e.value-t.value;break;case AnimationKeyableType.VEC:n.value.sub2(e.value,t.value);break;case AnimationKeyableType.QUAT:n.value.x=e.value.x-t.value.x,n.value.y=e.value.y-t.value.y,n.value.z=e.value.z-t.value.z,n.value.w=e.value.w-t.value.w}return n},AnimationKeyable.mul=function(e,t){if(!e)return null;var n=new AnimationKeyable;switch(n.copy(e),e.type){case AnimationKeyableType.NUM:n.value*=t;break;case AnimationKeyableType.VEC:n.value.scale(t);break;case AnimationKeyableType.QUAT:n.value.x*=t,n.value.y*=t,n.value.z*=t,n.value.w*=t}return n},AnimationKeyable.div=function(e,t){return 0===t?null:AnimationKeyable.mul(e,1/t)},AnimationKeyable.linearBlend=function(e,t,n){if(!e||!t||e.type!==t.type)return null;var i=new AnimationKeyable(e.type);if(0===n)return i.copy(e),i;if(1===n)return i.copy(t),i;switch(e.type){case AnimationKeyableType.NUM:i.value=(1-n)*e.value+n*t.value;break;case AnimationKeyableType.VEC:i.value.lerp(e.value,t.value,n);break;case AnimationKeyableType.QUAT:i.value.slerp(e.value,t.value,n)}return i},AnimationKeyable.linearBlendValue=function(e,t,n){var i;return"number"==typeof e&&"number"==typeof t?(1-n)*e+n*t:e instanceof pc.Vec3&&t instanceof pc.Vec3||e instanceof pc.Vec2&&t instanceof pc.Vec2||e instanceof pc.Vec4&&t instanceof pc.Vec4?(i=e.clone(),i.lerp(e,t,n),i):e instanceof pc.Quat&&t instanceof pc.Quat?(i=e.clone(),i.slerp(e,t,n),i):null};var AnimationTarget=function(e,t,n){this.targetNode=e,this.targetPath=t,this.targetProp=n};AnimationTarget.prototype.toString=function(){var e="";return this.targetNode&&(e+=this.targetNode.name),this.targetPath&&(e+="_"+this.targetPath),this.targetProp&&(e+="_"+this.targetProp),e},AnimationTarget.prototype.copy=function(e){return e&&(this.targetNode=e.targetNode,this.targetPath=e.targetPath,this.targetProp=e.targetProp),this},AnimationTarget.prototype.clone=function(){var e=new AnimationTarget(this.targetNode,this.targetPath,this.targetProp);return e},AnimationTarget.prototype.blendToTarget=function(e,t){if(!("undefined"==typeof e||t>1||t<=0)){if("localPosition"===this.targetPath&&this.vScale instanceof pc.Vec3&&(e instanceof pc.Vec3?(e.x*=this.vScale.x,e.y*=this.vScale.y,e.z*=this.vScale.z):"number"==typeof e&&"number"==typeof this.vScale[this.targetProp]&&(e*=this.vScale[this.targetProp])),1===t)return void this.updateToTarget(e);if(this.targetNode&&void 0!==this.targetNode[this.targetPath]){var n;if(this.targetProp&&this.targetProp in this.targetNode[this.targetPath]?(n=AnimationKeyable.linearBlendValue(this.targetNode[this.targetPath][this.targetProp],e,t),this.targetNode[this.targetPath][this.targetProp]=n):(n=AnimationKeyable.linearBlendValue(this.targetNode[this.targetPath],e,t),this.targetNode[this.targetPath]=n),"localEulerAngles"==this.targetPath){var i=new pc.Vec3;"x"===this.targetProp||"y"===this.targetProp||"z"===this.targetProp?i[this.targetProp]=n:i=n,this.targetNode.setLocalEulerAngles(i)}"function"==typeof this.targetNode._dirtifyLocal&&this.targetNode._dirtifyLocal()}}},AnimationTarget.prototype.updateToTarget=function(e){if("undefined"!=typeof e){if("localPosition"===this.targetPath&&this.vScale instanceof pc.Vec3&&(e instanceof pc.Vec3?(e.x*=this.vScale.x,e.y*=this.vScale.y,e.z*=this.vScale.z):"number"==typeof e&&"number"==typeof this.vScale[this.targetProp]&&(e*=this.vScale[this.targetProp])),this.targetNode&&void 0!==this.targetNode[this.targetPath]){if(this.targetProp&&this.targetProp in this.targetNode[this.targetPath]?this.targetNode[this.targetPath][this.targetProp]=e:this.targetNode[this.targetPath]=e,"localEulerAngles"==this.targetPath){var t=new pc.Vec3;"x"===this.targetProp||"y"===this.targetProp||"z"===this.targetProp?t[this.targetProp]=e:t=e,this.targetNode.setLocalEulerAngles(t)}"function"==typeof this.targetNode._dirtifyLocal&&this.targetNode._dirtifyLocal()}if(this.targetNode&&"weights"===this.targetPath&&this.targetNode.model)for(var n=this.targetNode.model.meshInstances,i=0;i<n.length;i++){var o=n[i].morphInstance;o&&o.setWeight(this.targetProp,e)}}},AnimationTarget.constructTargetNodes=function(e,t,n){if(e){var i=t||new pc.Vec3(1,1,1),o=new AnimationTarget(e);e.localScale&&(o.vScale=new pc.Vec3(e.localScale.x*i.x,e.localScale.y*i.y,e.localScale.z*i.z)),n[o.targetNode.name]=o;for(var r=0;r<e.children.length;r++)AnimationTarget.constructTargetNodes(e.children[r],o.vScale,n)}},AnimationTarget.getLocalScale=function(e){if(e){for(var t=new pc.Vec3(1,1,1),n=e;n;)n.localScale&&(t.x*=n.localScale.x,t.y*=n.localScale.y,t.z*=n.localScale.z),n=n.parent;return t}};var AnimationCurveType={LINEAR:0,STEP:1,CUBIC:2,CUBICSPLINE_GLTF:3},AnimationCurve=function e(){e.count++,this.name="curve"+e.count.toString(),this.type=AnimationCurveType.LINEAR,this.keyableType=AnimationKeyableType.NUM,this.tension=.5,this.animTargets=[],this.duration=0,this.animKeys=[],this.session=new AnimationSession(this)};AnimationCurve.count=0,Object.defineProperty(AnimationCurve.prototype,"isPlaying",{get:function(){return this.session.isPlaying},set:function(e){this.session.isPlaying=e}}),Object.defineProperty(AnimationCurve.prototype,"loop",{get:function(){return this.session.loop},set:function(e){this.session.loop=e}}),Object.defineProperty(AnimationCurve.prototype,"bySpeed",{get:function(){return this.session.bySpeed},set:function(e){this.session.bySpeed=e}}),AnimationCurve.prototype.copy=function(e){var t;for(this.name=e.name,this.type=e.type,this.keyableType=e.keyableType,this.tension=e.tension,this.duration=e.duration,this.animTargets=[],t=0;t<e.animTargets.length;t++)this.animTargets.push(e.animTargets[t].clone());for(this.animKeys=[],t=0;t<e.animKeys.length;t++){var n=new AnimationKeyable;n.copy(e.animKeys[t]),this.animKeys.push(n)}return this},AnimationCurve.prototype.clone=function(){return(new AnimationCurve).copy(this)},AnimationCurve.prototype.addTarget=function(e,t,n){var i=new AnimationTarget(e,t,n);this.animTargets.push(i)},AnimationCurve.prototype.setTarget=function(e,t,n){this.animTargets=[],this.addTarget(e,t,n)},AnimationCurve.prototype.clearTargets=function(){this.animTargets=[]},AnimationCurve.prototype.resetSession=function(){this.session.playable=this,this.session.animTargets=this.getAnimTargets(),this.session.isPlaying=!0,this.session.begTime=0,this.session.endTime=this.duration,this.session.curTime=0,this.session.bySpeed=1,this.session.loop=!0},AnimationCurve.prototype.blendToTarget=function(e,t){this.session.blendToTarget(e,t)},AnimationCurve.prototype.updateToTarget=function(e){this.session.updateToTarget(e)},AnimationCurve.prototype.getAnimTargets=function(){var e={};return e[this.name]=this.animTargets,e},AnimationCurve.prototype.on=function(e,t,n,i,o){return this.session&&this.session.on(e,t,n,i,o),this},AnimationCurve.prototype.off=function(e,t,n){return this.session&&this.session.off(e,t,n),this},AnimationCurve.prototype.removeAllEvents=function(){return this.session&&this.session.removeAllEvents(),this},AnimationCurve.prototype.fadeIn=function(e){this.session.fadeIn(e,this)},AnimationCurve.prototype.fadeOut=function(e){this.session.fadeOut(e)},AnimationCurve.prototype.play=function(){this.session.play(this)},AnimationCurve.prototype.resume=function(){this.session.resume()},AnimationCurve.prototype.stop=function(){this.session.stop()},AnimationCurve.prototype.pause=function(){this.session.pause()},AnimationCurve.prototype.showAt=function(e,t,n,i,o){this.session.showAt(e,t,n,i,o)},AnimationCurve.prototype.setAnimKeys=function(e){this.animKeys=e},AnimationCurve.prototype.insertKey=function(e,t,n){if(this.keyableType==e){for(var i=0;i<this.animKeys.length&&this.animKeys[i].time<t;)i++;if(i<this.animKeys.length&&this.animKeys[i].time==t)return void(this.animKeys[i].value=n);var o=new AnimationKeyable(e,t,n);return i>=this.animKeys.length?(this.animKeys.push(o),void(this.duration=t)):void this.animKeys.splice(i,0,o)}},AnimationCurve.prototype.insertKeyable=function(e){if(e&&this.keyableType==e.type){for(var t=e.time,n=0;n<this.animKeys.length&&this.animKeys[n].time<t;)n++;return n<this.animKeys.length&&this.animKeys[n].time==t?void(this.animKeys[n]=e):n>=this.animKeys.length?(this.animKeys.push(e),void(this.duration=t)):void this.animKeys.splice(n,0,e)}},AnimationCurve.prototype.removeKey=function(e){e<=this.animKeys.length&&(e==this.animKeys.length-1&&(this.duration=e-1>=0?this.animKeys[e-1].time:0),this.animKeys.splice(e,1))},AnimationCurve.prototype.removeAllKeys=function(){this.animKeys=[],this.duration=0},AnimationCurve.prototype.shiftKeyTime=function(e){for(var t=0;t<this.animKeys.length;t++)this.animKeys[t].time+=e},AnimationCurve.prototype.getSubCurve=function(e,t){var n,i=new AnimationCurve;for(i.type=this.type,i.name=this.name+"_sub",i.keyableType=this.keyableType,i.animTargets=this.animTargets,i.tension=this.tension,i.animTargets=[],n=0;n<this.animTargets.length;n++)i.animTargets.push(this.animTargets[n].clone());var o=-1;for(n=0;n<this.animKeys.length;n++)if(this.animKeys[n].time>=e&&this.animKeys[n].time<=t){o<0&&(o=this.animKeys[n].time);var r=(new AnimationKeyable).copy(this.animKeys[n]);r.time-=o,i.animKeys.push(r)}return i.duration=o===-1?0:t-o,i},AnimationCurve.prototype.evalLINEAR=function(e){if(!this.animKeys||0===this.animKeys.length)return null;for(var t,n,i=new AnimationKeyable,o=0;o<this.animKeys.length;o++){if(this.animKeys[o].time===e)return i.copy(this.animKeys[o]),i;if(this.animKeys[o].time>e){n=this.animKeys[o];break}t=this.animKeys[o]}if(!t||!n)return i.copy(t?t:n),i.time=e,i;var r=(e-t.time)/(n.time-t.time);return i=AnimationKeyable.linearBlend(t,n,r),i.time=e,i},AnimationCurve.prototype.evalSTEP=function(e){if(!this.animKeys||0===this.animKeys.length)return null;for(var t=this.animKeys[0],n=1;n<this.animKeys.length&&this.animKeys[n].time<=e;n++)t=this.animKeys[n];var i=new AnimationKeyable;return i.copy(t),i.time=e,i},AnimationCurve.prototype.evalCUBIC=function(e){if(!this.animKeys||0===this.animKeys.length)return null;for(var t,n,i,o,r=new AnimationKeyable,a=0;a<this.animKeys.length;a++){if(this.animKeys[a].time===e)return r.copy(this.animKeys[a]),r;if(this.animKeys[a].time>e){i=this.animKeys[a],a+1<this.animKeys.length&&(o=this.animKeys[a+1]);break}n=this.animKeys[a],a-1>=0&&(t=this.animKeys[a-1])}return n&&i?n.type==AnimationKeyableType.NUM||n.type==AnimationKeyableType.VEC?(r=AnimationCurve.cubicCardinal(t,n,i,o,e,this.tension),r.time=e,r):null:(r.copy(n?n:i),r.time=e,r)},AnimationCurve.prototype.evalCUBICSPLINE_GLTF=function(e){if(!this.animKeys||0===this.animKeys.length)return null;for(var t,n,i=new AnimationKeyable,o=0;o<this.animKeys.length;o++){if(this.animKeys[o].time===e)return i.copy(this.animKeys[o]),i;if(this.animKeys[o].time>e){n=this.animKeys[o];break}t=this.animKeys[o]}if(!t||!n)return i.copy(t?t:n),
i.time=e,i;var r=(e-t.time)/(n.time-t.time),a=n.time-t.time;return this.keyableType===AnimationKeyableType.NUM?i.value=AnimationCurve.cubicHermite(a*t.outTangent,t.value,a*n.inTangent,n.value,r):this.keyableType===AnimationKeyableType.VEC?(i.value=new pc.Vec3,i.value.x=AnimationCurve.cubicHermite(a*t.outTangent.x,t.value.x,a*n.inTangent.x,n.value.x,r),i.value.y=AnimationCurve.cubicHermite(a*t.outTangent.y,t.value.y,a*n.inTangent.y,n.value.y,r),i.value.z=AnimationCurve.cubicHermite(a*t.outTangent.z,t.value.z,a*n.inTangent.z,n.value.z,r)):this.keyableType===AnimationKeyableType.QUAT&&(i.value=new pc.Quat,i.value.w=AnimationCurve.cubicHermite(a*t.outTangent.w,t.value.w,a*n.inTangent.w,n.value.w,r),i.value.x=AnimationCurve.cubicHermite(a*t.outTangent.x,t.value.x,a*n.inTangent.x,n.value.x,r),i.value.y=AnimationCurve.cubicHermite(a*t.outTangent.y,t.value.y,a*n.inTangent.y,n.value.y,r),i.value.z=AnimationCurve.cubicHermite(a*t.outTangent.z,t.value.z,a*n.inTangent.z,n.value.z,r),i.normalize()),i.time=e,i},AnimationCurve.prototype.eval=function(e){if(!this.animKeys||0===this.animKeys.length)return null;switch(this.type){case AnimationCurveType.LINEAR:return this.evalLINEAR(e);case AnimationCurveType.STEP:return this.evalSTEP(e);case AnimationCurveType.CUBIC:return this.keyableType==AnimationKeyableType.QUAT?this.evalLINEAR(e):this.evalCUBIC(e);case AnimationCurveType.CUBICSPLINE_GLTF:return this.evalCUBICSPLINE_GLTF(e)}return null},AnimationCurve.cubicHermite=function(e,t,n,i,o){var r=o*o,a=r*o,s=2*a-3*r+1,l=-2*a+3*r,u=a-2*r+o,h=a-r;return t*s+i*l+e*u+n*h},AnimationCurve.cubicCardinal=function(e,t,n,i,o,r){var a,s;if(!t||!n||t.type!=n.type)return null;if(t.type!=AnimationKeyableType.NUM&&t.type!=AnimationKeyableType.VEC)return null;var l=(o-t.time)/(n.time-t.time),u=new AnimationKeyable;u.type=t.type;var h=r*(n.time-t.time);if(t.type===AnimationKeyableType.NUM&&(a=h*(n.value-t.value)/(n.time-t.time),e&&(a=2*h*(n.value-e.value)/(n.time-e.time)),s=h*(n.value-t.value)/(n.time-t.time),i&&(s=2*h*(i.value-t.value)/(i.time-t.time)),u.value=AnimationCurve.cubicHermite(a,t.value,s,n.value,l)),t.type===AnimationKeyableType.VEC){u.value=t.value.clone();for(var c=0;c<u.value.data.length;c++)a=h*(n.value.data[c]-t.value.data[c])/(n.time-t.time),e&&(a=2*h*(n.value.data[c]-e.value.data[c])/(n.time-e.time)),s=h*(n.value.data[c]-t.value.data[c])/(n.time-t.time),i&&(s=2*h*(i.value.data[c]-t.value.data[c])/(i.time-t.time)),u.value.data[c]=AnimationCurve.cubicHermite(a,t.value.data[c],s,n.value.data[c],l)}return u};var AnimationClipSnapshot=function(){this.curveKeyable={}};AnimationClipSnapshot.prototype.copy=function(e){if(!e)return this;this.curveKeyable={};for(var t=Object.keys(e.curveKeyable),n=0;n<t.length;n++){var i=t[n];this.curveKeyable[i]=(new AnimationKeyable).copy(e.curveKeyable[i])}return this},AnimationClipSnapshot.prototype.clone=function(){var e=(new AnimationClipSnapshot).copy(this);return e},AnimationClipSnapshot.linearBlend=function(e,t,n){if(!e||!t)return null;if(0===n)return e;if(1===n)return t;var i=new AnimationClipSnapshot;i.copy(e);for(var o=Object.keys(t.curveKeyable),r=0;r<o.length;r++){var a=o[r];if(e.curveKeyable[a]&&t.curveKeyable[a]){var s=AnimationKeyable.linearBlend(e.curveKeyable[a],t.curveKeyable[a],n);i.curveKeyable[a]=s}else e.curveKeyable[a]?i.curveKeyable[a]=e.curveKeyable[a]:t.curveKeyable[a]&&(i.curveKeyable[a]=t.curveKeyable[a])}return i},AnimationClipSnapshot.linearBlendExceptStep=function(e,t,n,i){if(!e||!t)return null;if(0===n)return e;if(1===n)return t;var o=new AnimationClipSnapshot;o.copy(e);for(var r=Object.keys(t.curveKeyable),a=0;a<r.length;a++){var s=r[a];if(e.curveKeyable[s]&&t.curveKeyable[s])if(i[s]&&i[s].type===AnimationCurveType.STEP)n>.5?o.curveKeyable[s]=t.curveKeyable[s]:o.curveKeyable[s]=e.curveKeyable[s];else{var l=AnimationKeyable.linearBlend(e.curveKeyable[s],t.curveKeyable[s],n);o.curveKeyable[s]=l}else e.curveKeyable[s]?o.curveKeyable[s]=e.curveKeyable[s]:t.curveKeyable[s]&&(o.curveKeyable[s]=t.curveKeyable[s])}return o};var AnimationClip=function t(e){t.count++,this.name="clip"+t.count.toString(),this.duration=0,this.animCurvesMap={},this.animCurves=[],this.root=null,e&&(this.root=e,this.constructFromRoot(e)),this.session=new AnimationSession(this)};AnimationClip.count=0,Object.defineProperty(AnimationClip.prototype,"isPlaying",{get:function(){return this.session.isPlaying},set:function(e){this.session.isPlaying=e}}),Object.defineProperty(AnimationClip.prototype,"loop",{get:function(){return this.session.loop},set:function(e){this.session.loop=e}}),Object.defineProperty(AnimationClip.prototype,"bySpeed",{get:function(){return this.session.bySpeed},set:function(e){this.session.bySpeed=e}}),AnimationClip.prototype.copy=function(e){this.name=e.name,this.duration=e.duration,this.animCurves.length=0,this.animCurvesMap={};for(var t=0,n=e.animCurves.length;t<n;t++){var i=e.animCurves[t];this.addCurve(i.clone())}return this},AnimationClip.prototype.clone=function(){return(new AnimationClip).copy(this)},AnimationClip.prototype.updateDuration=function(){this.duration=0;for(var e=0,t=this.animCurves.length;e<t;e++){var n=this.animCurves[e];this.duration=Math.max(this.duration,n.duration)}},AnimationClip.prototype.showAt=function(e,t,n,i,o){this.session.showAt(e,t,n,i,o)},AnimationClip.prototype.blendToTarget=function(e,t){this.session.blendToTarget(e,t)},AnimationClip.prototype.updateToTarget=function(e){this.session.updateToTarget(e)},AnimationClip.prototype.getAnimTargets=function(){for(var e={},t=0,n=this.animCurves.length;t<n;t++){var i=this.animCurves[t],o=i.getAnimTargets();e[i.name]=o[i.name]}return e},AnimationClip.prototype.resetSession=function(){this.session.playable=this,this.session.animTargets=this.getAnimTargets(),this.session.isPlaying=!0,this.session.begTime=0,this.session.endTime=this.duration,this.session.curTime=0,this.session.bySpeed=1,this.session.loop=!0},AnimationClip.prototype.play=function(){this.session.play(this)},AnimationClip.prototype.stop=function(){this.session.stop()},AnimationClip.prototype.pause=function(){this.session.pause()},AnimationClip.prototype.resume=function(){this.session.resume()},AnimationClip.prototype.fadeIn=function(e){this.session.fadeIn(e,this)},AnimationClip.prototype.fadeOut=function(e){this.session.fadeOut(e)},AnimationClip.prototype.fadeTo=function(e,t){this.session.fadeTo(e,t)},AnimationClip.prototype.addCurve=function(e){e&&e.name&&(this.animCurves.push(e),this.animCurvesMap[e.name]=e,e.duration>this.duration&&(this.duration=e.duration))},AnimationClip.prototype.removeCurve=function(e){if(e){var t=this.animCurvesMap[e];if(t){var n=this.animCurves.indexOf(t);n!==-1&&this.animCurves.splice(n,1),delete this.animCurvesMap[e],this.updateDuration()}}},AnimationClip.prototype.removeAllCurves=function(){this.animCurves.length=0,this.animCurvesMap={},this.duration=0},AnimationClip.prototype.on=function(e,t,n,i,o){return this.session&&this.session.on(e,t,n,i,o),this},AnimationClip.prototype.off=function(e,t,n){return this.session&&this.session.off(e,t,n),this},AnimationClip.prototype.removeAllEvents=function(){return this.session&&this.session.removeAllEvents(),this},AnimationClip.prototype.getSubClip=function(e,t){var n=new AnimationClip;n.name=this.name+"_sub",n.root=this.root;for(var i=0,o=this.animCurves.length;i<o;i++){var r=this.animCurves[i],a=r.getSubCurve(e,t);n.addCurve(a)}return n},AnimationClip.prototype.eval=function(e){var t=new AnimationClipSnapshot;t.time=e;for(var n=0,i=this.animCurves.length;n<i;n++){var o=this.animCurves[n],r=o.eval(e);t.curveKeyable[o.name]=r}return t},AnimationClip.prototype.constructFromRoot=function(e){if(e){var t=new AnimationCurve;t.keyableType=AnimationKeyableType.VEC,t.name=e.name+".localScale",t.setTarget(e,"localScale"),this.addCurve(t);var n=new AnimationCurve;n.keyableType=AnimationKeyableType.VEC,n.name=e.name+".localPosition",n.setTarget(e,"localPosition"),this.addCurve(n);var i=new AnimationCurve;i.name=e.name+".localRotation.quat",i.keyableType=AnimationKeyableType.QUAT,i.setTarget(e,"localRotation"),this.addCurve(i);for(var o=0;o<e.children.length;o++)e.children[o]&&this.constructFromRoot(e.children[o])}},AnimationClip.prototype.transferToRoot=function(e){var t={};AnimationTarget.constructTargetNodes(e,null,t);for(var n=0,i=this.animCurves.length;n<i;n++){var o=this.animCurves[n],r=o.animTargets[0];if(0!==o.animTargets.length){var a=t[r.targetNode.name];if(a){var s=AnimationTarget.getLocalScale(r.targetNode);r.targetNode=a.targetNode,s&&a.vScale&&(r.vScale=new pc.Vec3(s.x,s.y,s.z),a.vScale.x&&(r.vScale.x/=a.vScale.x),a.vScale.y&&(r.vScale.y/=a.vScale.y),a.vScale.z&&(r.vScale.z/=a.vScale.z))}else console.warn("transferToRoot: "+r.targetNode.name+"in animation clip "+this.name+" has no transferred target under "+e.name)}}},AnimationClip.prototype.updateCurveNameFromTarget=function(){for(var e=0,t=this.animCurves.length;e<t;e++){var n=this.animCurves[e];if(n.animTargets&&!(n.animTargets.length<1)){var i=n.name,o=n.animTargets[0].toString();i!=o&&(n.name=o,delete this.animCurvesMap[i],this.animCurvesMap[o]=n)}}},AnimationClip.prototype.removeEmptyCurves=function(){for(var e=0,t=this.animCurves.length;e<t;e++){var n=this.animCurves[e];n&&n.animKeys&&0!==n.animKeys.length||this.removeCurve(n.name)}},AnimationClip.prototype.setInterpolationType=function(e){for(var t=0,n=this.animCurves.length;t<n;t++){var i=this.animCurves[t];i&&(i.type=e)}};var AnimationEvent=function(e,t,n,i,o){this.name=e,this.triggerTime=t,this.fnCallback=n,this.context=i||this,this.parameter=o,this.triggered=!1};AnimationEvent.prototype.invoke=function(){this.fnCallback&&(this.fnCallback.call(this.context,this.parameter),this.triggered=!0)};var AnimationSession=function(e,t){this.begTime=-1,this.endTime=-1,this.curTime=0,this.accTime=0,this.bySpeed=1,this.isPlaying=!1,this.loop=!1,this.fadeBegTime=-1,this.fadeEndTime=-1,this.fadeTime=-1,this.fadeDir=0,this.fadeSpeed=1,this.playable=null,this.animTargets={},e&&(this.playable=e,t||(this.animTargets=e.getAnimTargets())),t&&(this.animTargets=t),this.animEvents=[],this.blendables={},this.blendWeights={};var n=this;this.onTimer=function(e){if(n.curTime+=n.bySpeed*e,n.accTime+=n.bySpeed*e,!n.isPlaying||!n.loop&&(n.curTime<n.begTime||n.curTime>n.endTime))return n.invokeByTime(n.curTime),n.stop(),void n.invokeByName("stop");var t=n.endTime-n.begTime;if(n.curTime>n.endTime){n.invokeByTime(n.curTime),n.curTime-=t;for(var i=0;i<n.animEvents.length;i++)n.animEvents[i].triggered=!1}if(n.curTime<n.begTime&&(n.curTime+=t),n.fadeDir&&(n.fadeTime+=e,n.fadeTime>=n.fadeEndTime))if(1===n.fadeDir)n.fadeDir=0,n.fadeBegTime=-1,n.fadeEndTime=-1,n.fadeTime=-1;else if(n.fadeDir===-1)return void n.stop();n.showAt(n.curTime,n.fadeDir,n.fadeBegTime,n.fadeEndTime,n.fadeTime),n.invokeByTime(n.curTime)}};AnimationSession.app=null,AnimationSession.prototype.clone=function(){var e,t,n=new AnimationSession;n.begTime=this.begTime,n.endTime=this.endTime,n.curTime=this.curTime,n.accTime=this.accTime,n.speed=this.speed,n.loop=this.loop,n.isPlaying=this.isPlaying,n.fadeBegTime=this.fadeBegTime,n.fadeEndTime=this.fadeEndTime,n.fadtTime=this.fadeTime,n.fadeDir=this.fadeDir,n.fadeSpeed=this.fadeSpeed,n.playable=this.playable,n.animTargets={};for(t in this.animTargets)if(this.animTargets.hasOwnProperty(t)){var i=this.animTargets[t],o=[];for(e=0;e<i.length;e++)o.push(i[e].clone());n.animTargets[t]=o}for(n.animEvents=[],e=0;e<this.animEvents.length;e++)n.animEvents.push(this.animEvents[e].clone());n.blendables={};for(t in this.blendables)this.blendables.hasOwnProperty(t)&&(n.blendables[t]=this.blendables[t]);n.blendWeights={};for(t in this.blendWeights)this.blendWeights.hasOwnProperty(t)&&(n.blendWeights[t]=this.blendWeights[t]);return n},AnimationSession.prototype.setBlend=function(e,t,n){if(e instanceof AnimationClip)return n&&""!==n||(n="__default__"),this.blendables[n]=e,void(this.blendWeights[n]=t);var i;"number"==typeof e?i=AnimationKeyableType.NUM:e instanceof pc.Vec3?i=AnimationKeyableType.VEC:e instanceof pc.Quat&&(i=AnimationKeyableType.QUAT),n&&""!==n&&"undefined"!=typeof i&&(this.blendWeights[n]=t,this.blendables[n]=new AnimationKeyable(i,0,e))},AnimationSession.prototype.unsetBlend=function(e){e&&""!==e||(e="__default__"),this.blendables[e]&&(delete this.blendables[e],delete this.blendWeights[e])},AnimationSession.prototype.on=function(e,t,n,i,o){if(e&&n){for(var r=new AnimationEvent(e,t,n,i,o),a=0;a<this.animEvents.length&&!(this.animEvents[a].triggerTime>t);a++);a>=this.animEvents.length?this.animEvents.push(r):this.animEvents.splice(a,0,r)}},AnimationSession.prototype.off=function(e,t,n){for(var i=0;i<this.animEvents.length;i++){var o=this.animEvents[i];if(o){if(o.name===e&&o.fnCallback===n)break;if(o.triggerTime===t&&o.fnCallback===n)break}}i<this.animEvents.length&&this.animEvents.splice(i,1)},AnimationSession.prototype.removeAllEvents=function(){this.animEvents=[]},AnimationSession.prototype.invokeByName=function(e){for(var t=0;t<this.animEvents.length;t++)this.animEvents[t]&&this.animEvents[t].name===e&&this.animEvents[t].invoke()},AnimationSession.prototype.invokeByTime=function(e){for(var t=0;t<this.animEvents.length;t++)if(this.animEvents[t]){if(this.animEvents[t].triggerTime>e)break;this.animEvents[t].triggered||this.animEvents[t].invoke()}},AnimationSession.prototype.blendToTarget=function(e,t){var n,i,o,r,a,s={PARTIAL_BLEND:0,FULL_UPDATE:1,NONE:2};if(!(!e||t>1||t<=0)){if(1===t)return void this.updateToTarget(e);if(this.playable instanceof AnimationCurve&&e instanceof AnimationKeyable){if(o=this.playable.name,r=this.animTargets[o],!r)return;for(a=s.PARTIAL_BLEND,this.playable.type===AnimationCurveType.STEP&&this.fadeDir&&(a=this.fadeDir==-1&&t<=.5||1==this.fadeDir&&t>.5?s.FULL_UPDATE:s.NONE),i=0;i<r.length;i++)a===s.PARTIAL_BLEND?r[i].blendToTarget(e.value,t):a===s.FULL_UPDATE&&r[i].updateToTarget(e.value)}else if(this.playable instanceof AnimationClip&&e instanceof AnimationClipSnapshot){var l=Object.keys(e.curveKeyable);for(n=0;n<l.length;n++)if(o=l[n],o&&(a=s.PARTIAL_BLEND,this.playable.animCurvesMap[o]&&this.playable.animCurvesMap[o].type===AnimationCurveType.STEP&&this.fadeDir&&(a=this.fadeDir==-1&&t<=.5||1==this.fadeDir&&t>.5?s.FULL_UPDATE:s.NONE),r=this.animTargets[o]))for(i=0;i<r.length;i++)a===s.PARTIAL_BLEND?r[i].blendToTarget(e.curveKeyable[o].value,t):a===s.FULL_UPDATE&&r[i].updateToTarget(e.value)}}},AnimationSession.prototype.updateToTarget=function(e){var t,n,i,o;if(e)if(this.playable instanceof AnimationCurve&&e instanceof AnimationKeyable){if(i=this.playable.name,o=this.animTargets[i],!o)return;for(n=0;n<o.length;n++)o[n].updateToTarget(e.value)}else if(this.playable instanceof AnimationClip&&e instanceof AnimationClipSnapshot){var r=Object.keys(e.curveKeyable);for(t=0;t<r.length;t++)if(i=r[t],i&&(o=this.animTargets[i]))for(n=0;n<o.length;n++)e.curveKeyable[i]&&o[n].updateToTarget(e.curveKeyable[i].value)}},AnimationSession.prototype.showAt=function(e,t,n,i,o){var r,a,s=this.playable.eval(e),l=Object.keys(this.blendables);for(r=0;r<l.length;r++){var u=l[r];a=this.blendWeights[u];var h=this.blendables[u];if(h&&h instanceof AnimationClip&&"number"==typeof a){var c=h.eval(this.accTime%h.duration);s=AnimationClipSnapshot.linearBlendExceptStep(s,c,a,this.playable.animCurvesMap)}}for(r=0;r<l.length;r++){var p=l[r];a=this.blendWeights[p];var m=this.blendables[p];if(m&&s.curveKeyable[p]&&!(m instanceof AnimationClip)){var f=AnimationKeyable.linearBlend(s.curveKeyable[p],m,a);s.curveKeyable[p]=f}}0===t||o<n||o>i?this.updateToTarget(s):(a=(o-n)/(i-n),t===-1&&(a=1-a),this.fadeSpeed<1&&t===-1&&(a*=this.fadeSpeed),this.blendToTarget(s,a))},AnimationSession.prototype.play=function(e,t){var n;if(e&&(this.playable=e),!(this.playable instanceof AnimationClip||this.playable instanceof AnimationCurve))return this;if(this.isPlaying)return this;for(this.begTime=0,this.endTime=this.playable.duration,this.curTime=0,this.accTime=0,this.isPlaying=!0,e&&this!==e.session&&(this.bySpeed=e.bySpeed,this.loop=e.loop),!t&&e&&"function"==typeof e.getAnimTargets?this.animTargets=e.getAnimTargets():t&&(this.animTargets=t),n=0;n<this.animEvents.length;n++)this.animEvents[n].triggered=!1;for(n=0;n<this.animEvents.length;n++)this.animEvents[n].triggered=!1;var i=pc.Application.getApplication();return i.on("update",this.onTimer),this},AnimationSession.prototype.stop=function(){var e=pc.Application.getApplication();return e.off("update",this.onTimer),this.curTime=0,this.isPlaying=!1,this.fadeBegTime=-1,this.fadeEndTime=-1,this.fadeTime=-1,this.fadeDir=0,this.fadeSpeed=1,this},AnimationSession.prototype.pause=function(){return AnimationSession.app&&AnimationSession.app.off("update",this.onTimer),this.isPlaying=!1,this},AnimationSession.prototype.resume=function(){if(!this.isPlaying){this.isPlaying=!0;var e=pc.Application.getApplication();e.on("update",this.onTimer)}},AnimationSession.prototype.fadeOut=function(e){if(0===this.fadeDir)this.fadeSpeed=1;else{if(1!==this.fadeDir)return;this.fadeSpeed=(this.fadeTime-this.fadeBegTime)/(this.fadeEndTime-this.fadeBegTime)}"number"!=typeof e&&(e=0),this.fadeBegTime=this.curTime,this.fadeTime=this.fadeBegTime,this.fadeEndTime=this.fadeBegTime+e,this.fadeDir=-1},AnimationSession.prototype.fadeIn=function(e,t){this.isPlaying&&this.stop(),this.fadeSpeed=0,this.curTime=0,"number"!=typeof e&&(e=0),this.fadeBegTime=this.curTime,this.fadeTime=this.fadeBegTime,this.fadeEndTime=this.fadeBegTime+e,this.fadeDir=1,t&&(this.playable=t),this.play(t)},AnimationSession.prototype.fadeTo=function(e,t){this.fadeOut(t);var n=new AnimationSession;return n.fadeIn(t,e),n},AnimationSession.prototype.fadeToSelf=function(e){var t=this.clone();AnimationSession.app&&AnimationSession.app.on("update",t.onTimer),t.fadeOut(e),this.stop(),this.fadeIn(e)};var AnimationComponent=function(){this.name="",this.animClipsMap={},this.animClips=[],this.curClip="",this.animSessions={}};AnimationComponent.prototype.clipCount=function(){return this.animClips.length},AnimationComponent.prototype.getCurrentClip=function(){return this.animClipsMap[this.curClip]},AnimationComponent.prototype.clipAt=function(e){return this.animClips.length<=e?null:this.animClips[e]},AnimationComponent.prototype.addClip=function(e){e&&e.name&&(this.animClips.push(e),this.animClipsMap[e.name]=e)},AnimationComponent.prototype.removeClip=function(e){var t=this.animClipsMap[e];if(t){var n=this.animClips.indexOf(t);n!==-1&&this.animClips.splice(n,1),delete this.animClipsMap[e]}this.curClip===e&&(this.curClip="")},AnimationComponent.prototype.playClip=function(e){var t=this.animClipsMap[e];t&&(this.curClip=e,t.play())},AnimationComponent.prototype.stopClip=function(){var e=this.animClipsMap[this.curClip];e&&(e.stop(),this.curClip="")},AnimationComponent.prototype.crossFadeToClip=function(e,t){var n=this.animClipsMap[this.curClip],i=this.animClipsMap[e];n&&i?(n.fadeOut(t),i.fadeIn(t),this.curClip=e):n?(n.fadeOut(t),this.curClip=""):i&&(i.fadeIn(t),this.curClip=e)},AnimationComponent.prototype.setBlend=function(e,t,n){var i=this.getCurrentClip();i&&i.session&&i.session.setBlend(e,t,n)},AnimationComponent.prototype.unsetBlend=function(e){var t=this.getCurrentClip();t&&t.session&&t.session.unsetBlend(e)},AnimationComponent.prototype.getCurrentSession=function(){return this.animSessions[this.curClip]},AnimationComponent.prototype.playSession=function(e){var t=this.animSessions[e];t&&(t.play(),this.curClip=e)},AnimationComponent.prototype.stopSession=function(){var e=this.animSessions[this.curClip];e&&(e.stop(),this.curClip="")},AnimationComponent.prototype.crossFadeToSession=function(e,t){var n=this.animSessions[this.curClip],i=this.animSessions[e];n&&this.animSessions[e]?(n.fadeOut(t),i.fadeIn(t),this.curClip=e):n?(n.fadeOut(t),this.curClip=""):i&&(i.fadeIn(t),this.curClip=e)},AnimationComponent.prototype.setBlendSession=function(e,t,n){var i=this.animSessions[this.curClip];i&&i.setBlend(e,t,n)},AnimationComponent.prototype.unsetBlendSession=function(e){var t=this.animSessions[this.curClip];t&&t.unsetBlend(e)},AnimationComponent.prototype.playSubstring=function(e){for(var t=this.animClips.length,n=0;n<t;n++){var i=this.animClips[n];i.isPlaying&&i.pause(),i.name.indexOf(e)!==-1&&i.play()}},AnimationComponent.prototype.pauseAll=function(){for(var e=this.animClips.length,t=0;t<e;t++){var n=this.animClips[t];n.isPlaying&&n.pause()}},function(){function e(e){return Math.pow(2,Math.round(Math.log(e)/Math.log(2)))}function t(e){return e&&0===(e&e-1)}function n(e){var t=pc.PRIMITIVE_TRIANGLES;if(e.hasOwnProperty("mode"))switch(e.mode){case 0:t=pc.PRIMITIVE_POINTS;break;case 1:t=pc.PRIMITIVE_LINES;break;case 2:t=pc.PRIMITIVE_LINELOOP;break;case 3:t=pc.PRIMITIVE_LINESTRIP;break;case 4:t=pc.PRIMITIVE_TRIANGLES;break;case 5:t=pc.PRIMITIVE_TRISTRIP;break;case 6:t=pc.PRIMITIVE_TRIFAN}return t}function i(e){var t=3;switch(e){case"SCALAR":t=1;break;case"VEC2":t=2;break;case"VEC3":t=3;break;case"VEC4":t=4;break;case"MAT2":t=4;break;case"MAT3":t=9;break;case"MAT4":t=16}return t}function o(e){var t=pc.FILTER_LINEAR;switch(e){case 9728:t=pc.FILTER_NEAREST;break;case 9729:t=pc.FILTER_LINEAR;break;case 9984:t=pc.FILTER_NEAREST_MIPMAP_NEAREST;break;case 9985:t=pc.FILTER_LINEAR_MIPMAP_NEAREST;break;case 9986:t=pc.FILTER_NEAREST_MIPMAP_LINEAR;break;case 9987:t=pc.FILTER_LINEAR_MIPMAP_LINEAR}return t}function r(e){var t=pc.ADDRESS_REPEAT;switch(e){case 33071:t=pc.ADDRESS_CLAMP_TO_EDGE;break;case 33648:t=pc.ADDRESS_MIRRORED_REPEAT;break;case 10497:t=pc.ADDRESS_REPEAT}return t}function a(e){return/^data:.*,.*$/i.test(e)}function s(e,t,n){var o=e.bufferViews[t.bufferView],r=n[o.buffer],a=t.hasOwnProperty("byteOffset")?t.byteOffset:0,s=o.hasOwnProperty("byteOffset")?o.byteOffset:0,l=a+s,u=t.count*i(t.type),h=null;switch(t.componentType){case 5120:h=new Int8Array(r,l,u);break;case 5121:h=new Uint8Array(r,l,u);break;case 5122:h=new Int16Array(r,l,u);break;case 5123:h=new Uint16Array(r,l,u);break;case 5125:h=new Uint32Array(r,l,u);break;case 5126:h=new Float32Array(r,l,u)}return h}function l(e,t){var n=new AnimationClip;n.loop=!0,e.hasOwnProperty("name")&&(n.name=e.name);var i=t.gltf;return e.hasOwnProperty("extras")&&e.extras.hasOwnProperty("metadata")&&(n.metadata=e.extras.metadata),e.channels.forEach(function(o){var r,a,l,u,h,c,p=e.samplers[o.sampler],m=s(i,i.accessors[p.input],t.buffers),f=s(i,i.accessors[p.output],t.buffers),d=o.target,v=d.path,g=t.nodes[d.node];if("weights"===v){var y=f.length/m.length;for(h=0;h<y;h++){for(l=new AnimationCurve,u=AnimationKeyableType.NUM,l.keyableType=u,l.addTarget("model",v,h),"CUBIC"===p.interpolation?l.type=AnimationCurveType.CUBIC:"STEP"===p.interpolation&&(l.type=AnimationCurveType.STEP),c=0;c<m.length;c++)r=m[c],a=f[y*c+h],l.insertKey(u,r,a);n.addCurve(l)}}else{u=AnimationKeyableType.NUM;var T=v;switch(v){case"translation":u=AnimationKeyableType.VEC,T="localPosition";break;case"scale":u=AnimationKeyableType.VEC,T="localScale";break;case"rotation":u=AnimationKeyableType.QUAT,T="localRotation"}if(l=new AnimationCurve,l.keyableType=u,l.setTarget(g,T),"CUBICSPLINE"!==p.interpolation){for("CUBIC"===p.interpolation?l.type=AnimationCurveType.CUBIC:"STEP"===p.interpolation&&(l.type=AnimationCurveType.STEP),h=0;h<m.length;h++)r=m[h],a="translation"===v||"scale"===v?new pc.Vec3(f[3*h+0],f[3*h+1],f[3*h+2]):"rotation"===v?new pc.Quat(f[4*h+0],f[4*h+1],f[4*h+2],f[4*h+3]):f[h],l.insertKey(u,r,a);n.addCurve(l)}else{for(console.log(n.name,l.name,v,"CUBICSPLINE"),l.type=AnimationCurveType.CUBICSPLINE_GLTF,h=0;h<m.length;h++){r=m[h];var C=new AnimationKeyable(u,r,null);"translation"===v||"scale"===v?(C.inTangent=new pc.Vec3(f[9*h+0],f[9*h+1],f[9*h+2]),C.value=new pc.Vec3(f[9*h+3],f[9*h+4],f[9*h+5]),C.outTangent=new pc.Vec3(f[9*h+6],f[9*h+7],f[9*h+8])):"rotation"===v?(C.inTangent=new pc.Quat(f[12*h+0],f[12*h+1],f[12*h+2],f[12*h+3]),C.value=new pc.Quat(f[12*h+4],f[12*h+5],f[12*h+6],f[12*h+7]),C.outTangent=new pc.Quat(f[12*h+8],f[12*h+9],f[12*h+10],f[12*h+11])):(C.inTangent=f[3*h],C.value=f[3*h+1],C.outTangent=a[3*h+2]),l.insertKeyable(C)}n.addCurve(l)}}}),e.hasOwnProperty("extras")&&t.processAnimationExtras&&t.processAnimationExtras(n,e.extras),n}function u(t){var n=t.width,i=t.height,o=e(n),r=e(i),a=document.createElement("canvas");a.width=o,a.height=r;var s=a.getContext("2d");return s.drawImage(t,0,0,n,i,0,0,o,r),a.toDataURL()}function h(e,n,i){var o=new Image,r=function(){o.removeEventListener("load",r,!1);var e=n.gltf,a=n.images.indexOf(o);e.textures.forEach(function(e,i){if(e.hasOwnProperty("source")&&e.source===a){var r=n.textures[i];if(t(o.width)&&t(o.width)||r.addressU!==pc.ADDRESS_REPEAT&&r.addressU!==pc.ADDRESS_MIRRORED_REPEAT&&r.addressV!==pc.ADDRESS_REPEAT&&r.addressV!==pc.ADDRESS_MIRRORED_REPEAT&&r.minFilter!==pc.FILTER_LINEAR_MIPMAP_LINEAR&&r.minFilter!==pc.FILTER_NEAREST_MIPMAP_LINEAR&&r.minFilter!==pc.FILTER_LINEAR_MIPMAP_NEAREST&&r.minFilter!==pc.FILTER_NEAREST_MIPMAP_NEAREST)r.setSource(o);else{var s=new Image;s.addEventListener("load",function(){r.setSource(s)}),s.src=u(o)}}}),n.imagesLoaded++,n.imagesLoaded===e.images.length&&i()};if(o.addEventListener("load",r,!1),e.hasOwnProperty("uri")&&(a(e.uri)?o.src=e.uri:n.processUri?n.processUri(e.uri,function(e){o.crossOrigin="anonymous",o.src=e}):(o.crossOrigin="anonymous",o.src=n.basePath+e.uri)),e.hasOwnProperty("bufferView")){var s=n.gltf,l=n.buffers,h=s.bufferViews[e.bufferView],c=l[h.buffer],p=h.hasOwnProperty("byteOffset")?h.byteOffset:0,m=c.slice(p,p+h.byteLength),f=new Blob([m],{type:e.mimeType});o.src=URL.createObjectURL(f)}return o}function c(e,t){var n=new pc.StandardMaterial;n.occludeSpecular=!0,n.diffuseTint=!0,n.diffuseVertexColor=!0,n.specularTint=!0,n.specularVertexColor=!0,e.hasOwnProperty("name")&&(n.name=e.name),e.hasOwnProperty("extensions")&&e.extensions.hasOwnProperty("KHR_materials_unlit")&&(n.useLighting=!1);var i,o;if(e.hasOwnProperty("extensions")&&e.extensions.hasOwnProperty("KHR_materials_pbrSpecularGlossiness")){var r=e.extensions.KHR_materials_pbrSpecularGlossiness;if(r.hasOwnProperty("diffuseFactor")?(i=r.diffuseFactor,n.diffuse.set(Math.pow(i[0],1/2.2),Math.pow(i[1],1/2.2),Math.pow(i[2],1/2.2)),n.opacity=null!=i[3]?i[3]:1):(n.diffuse.set(1,1,1),n.opacity=1),r.hasOwnProperty("diffuseTexture")){var a=r.diffuseTexture;if(o=t.textures[a.index],n.diffuseMap=o,n.diffuseMapChannel="rgb",n.opacityMap=o,n.opacityMapChannel="a",a.hasOwnProperty("texCoord")&&(n.diffuseMapUv=a.texCoord,n.opacityMapUv=a.texCoord),a.hasOwnProperty("extensions")&&a.extensions.hasOwnProperty("KHR_texture_transform")){var s=a.extensions.KHR_texture_transform;s.hasOwnProperty("scale")&&(n.diffuseMapTiling=new pc.Vec2(s.scale[0],s.scale[1]),n.opacityMapTiling=new pc.Vec2(s.scale[0],s.scale[1])),s.hasOwnProperty("offset")&&(n.diffuseMapOffset=new pc.Vec2(s.offset[0],s.offset[1]),n.opacityMapOffset=new pc.Vec2(s.offset[0],s.offset[1]))}}if(n.useMetalness=!1,r.hasOwnProperty("specularFactor")?(i=r.specularFactor,n.specular.set(Math.pow(i[0],1/2.2),Math.pow(i[1],1/2.2),Math.pow(i[2],1/2.2))):n.specular.set(1,1,1),r.hasOwnProperty("glossinessFactor")?n.shininess=100*r.glossinessFactor:n.shininess=100,r.hasOwnProperty("specularGlossinessTexture")){var l=r.specularGlossinessTexture;if(n.specularMap=t.textures[l.index],n.specularMapChannel="rgb",n.glossMap=t.textures[l.index],n.glossMapChannel="a",l.hasOwnProperty("texCoord")&&(n.glossMapUv=l.texCoord,n.metalnessMapUv=l.texCoord),l.hasOwnProperty("extensions")&&l.extensions.hasOwnProperty("KHR_texture_transform")){var u=l.extensions.KHR_texture_transform;u.hasOwnProperty("scale")&&(n.glossMapTiling=new pc.Vec2(u.scale[0],u.scale[1]),n.metalnessMapTiling=new pc.Vec2(u.scale[0],u.scale[1])),u.hasOwnProperty("offset")&&(n.glossMapOffset=new pc.Vec2(u.offset[0],u.offset[1]),n.metalnessMapOffset=new pc.Vec2(u.offset[0],u.offset[1]))}}n.chunks.specularPS=x}else if(e.hasOwnProperty("pbrMetallicRoughness")){var h=e.pbrMetallicRoughness;if(h.hasOwnProperty("baseColorFactor")?(i=h.baseColorFactor,n.diffuse.set(Math.pow(i[0],1/2.2),Math.pow(i[1],1/2.2),Math.pow(i[2],1/2.2)),n.opacity=i[3]):(n.diffuse.set(1,1,1),n.opacity=1),h.hasOwnProperty("baseColorTexture")){var c=h.baseColorTexture;if(o=t.textures[c.index],n.diffuseMap=o,n.diffuseMapChannel="rgb",n.opacityMap=o,n.opacityMapChannel="a",c.hasOwnProperty("texCoord")&&(n.diffuseMapUv=c.texCoord,n.opacityMapUv=c.texCoord),c.hasOwnProperty("extensions")&&c.extensions.hasOwnProperty("KHR_texture_transform")){var p=c.extensions.KHR_texture_transform;p.hasOwnProperty("scale")&&(n.diffuseMapTiling=new pc.Vec2(p.scale[0],p.scale[1]),n.opacityMapTiling=new pc.Vec2(p.scale[0],p.scale[1])),p.hasOwnProperty("offset")&&(n.diffuseMapOffset=new pc.Vec2(p.offset[0],p.offset[1]),n.opacityMapOffset=new pc.Vec2(p.offset[0],p.offset[1]))}}n.useMetalness=!0,h.hasOwnProperty("metallicFactor")?n.metalness=h.metallicFactor:n.metalness=1;var m=0;if(h.hasOwnProperty("roughnessFactor")){var f=1-h.roughnessFactor;m=100*f}else m=0;if(n.shininess=100-m,h.hasOwnProperty("metallicRoughnessTexture")){var d=h.metallicRoughnessTexture;if(n.metalnessMap=t.textures[d.index],n.metalnessMapChannel="b",n.glossMap=t.textures[d.index],n.glossMapChannel="g",d.hasOwnProperty("texCoord")&&(n.glossMapUv=d.texCoord,n.metalnessMapUv=d.texCoord),d.hasOwnProperty("extensions")&&d.extensions.hasOwnProperty("KHR_texture_transform")){var v=d.extensions.KHR_texture_transform;v.hasOwnProperty("scale")&&(n.glossMapTiling=new pc.Vec2(v.scale[0],v.scale[1]),n.metalnessMapTiling=new pc.Vec2(v.scale[0],v.scale[1])),v.hasOwnProperty("offset")&&(n.glossMapOffset=new pc.Vec2(v.offset[0],v.offset[1]),n.metalnessMapOffset=new pc.Vec2(v.offset[0],v.offset[1]))}}n.chunks.glossPS=O}if(e.hasOwnProperty("commonConstant")&&e.commonConstant.hasOwnProperty("lightmapTexture")){var g=e.commonConstant.lightmapTexture;if(n.lightMap=t.textures[g.index],n.lightMapChannel="rgb",g.hasOwnProperty("texCoord")?n.lightMapUv=g.texCoord:n.lightMapUv=1,g.hasOwnProperty("extensions")&&g.extensions.hasOwnProperty("KHR_texture_transform")){var y=g.extensions.KHR_texture_transform;y.hasOwnProperty("scale")&&(n.lightMapTiling=new pc.Vec2(y.scale[0],y.scale[1])),y.hasOwnProperty("offset")&&(n.lightMapOffset=new pc.Vec2(y.offset[0],y.offset[1]))}}if(e.hasOwnProperty("normalTexture")){var T=e.normalTexture;if(n.normalMap=t.textures[T.index],T.hasOwnProperty("texCoord")&&(n.normalMapUv=T.texCoord),T.hasOwnProperty("extensions")&&T.extensions.hasOwnProperty("KHR_texture_transform")){var C=T.extensions.KHR_texture_transform;C.hasOwnProperty("scale")&&(n.normalMapTiling=new pc.Vec2(C.scale[0],C.scale[1])),C.hasOwnProperty("offset")&&(n.normalMapOffset=new pc.Vec2(C.offset[0],C.offset[1]))}T.hasOwnProperty("scale")&&(n.bumpiness=T.scale)}if(e.hasOwnProperty("occlusionTexture")){var b=e.occlusionTexture;if(n.aoMap=t.textures[b.index],n.aoMapChannel="r",b.hasOwnProperty("texCoord")&&(n.aoMapUv=b.texCoord),b.hasOwnProperty("extensions")&&b.extensions.hasOwnProperty("KHR_texture_transform")){var S=b.extensions.KHR_texture_transform;S.hasOwnProperty("scale")&&(n.aoMapTiling=new pc.Vec2(S.scale[0],S.scale[1])),S.hasOwnProperty("offset")&&(n.aoMapOffset=new pc.Vec2(S.offset[0],S.offset[1]))}}if(e.hasOwnProperty("emissiveFactor")?(i=e.emissiveFactor,n.emissive.set(Math.pow(i[0],1/2.2),Math.pow(i[1],1/2.2),Math.pow(i[2],1/2.2)),n.emissiveTint=!0):(n.emissive.set(0,0,0),n.emissiveTint=!1),e.hasOwnProperty("emissiveTexture")){var w=e.emissiveTexture;if(n.emissiveMap=t.textures[w.index],w.hasOwnProperty("texCoord")&&(n.emissiveMapUv=w.texCoord),w.hasOwnProperty("extensions")&&w.extensions.hasOwnProperty("KHR_texture_transform")){var A=w.extensions.KHR_texture_transform;A.hasOwnProperty("scale")&&(n.emissiveMapTiling=new pc.Vec2(A.scale[0],A.scale[1])),A.hasOwnProperty("offset")&&(n.emissiveMapOffset=new pc.Vec2(A.offset[0],A.offset[1]))}}if(e.hasOwnProperty("alphaMode"))switch(e.alphaMode){case"MASK":n.blendType=pc.BLEND_NONE,e.hasOwnProperty("alphaCutoff")?n.alphaTest=e.alphaCutoff:n.alphaTest=.5;break;
case"BLEND":n.blendType=pc.BLEND_NORMAL;break;default:case"OPAQUE":n.blendType=pc.BLEND_NONE}else n.blendType=pc.BLEND_NONE;return e.hasOwnProperty("doubleSided")?(n.twoSidedLighting=e.doubleSided,n.cull=e.doubleSided?pc.CULLFACE_NONE:pc.CULLFACE_BACK):(n.twoSidedLighting=!1,n.cull=pc.CULLFACE_BACK),e.hasOwnProperty("extras")&&t.processMaterialExtras&&t.processMaterialExtras(n,e.extras),null!=t&&null!=t.app&&void 0!==typeof CanvasTools&&void 0!==typeof CanvasTools.TranslateMaterial&&CanvasTools.TranslateMaterial(t.app,n,e,t),n.update(),n}function p(e,t){var i=t.gltf,o=[];return e.primitives.forEach(function(r){var a,l=r.attributes,u=null,h=null,c=null,p=null,m=null,f=null,d=null,v=null,g=null;if(r.hasOwnProperty("extensions")){var y=r.extensions;if(y.hasOwnProperty("KHR_draco_mesh_compression")){var T=y.KHR_draco_mesh_compression,C=i.bufferViews[T.bufferView],b=t.buffers[C.buffer],S=C.hasOwnProperty("byteOffset")?C.byteOffset:0,w=new Int8Array(b,S,C.byteLength),A=t.decoderModule,P=new A.DecoderBuffer;P.Init(w,w.length);var E,O,x=new A.Decoder,k=x.GetEncodedGeometryType(P);switch(k){case A.INVALID_GEOMETRY_TYPE:console.error("Invalid geometry type");break;case A.POINT_CLOUD:E=new A.PointCloud,O=x.DecodeBufferToPointCloud(P,E);break;case A.TRIANGULAR_MESH:E=new A.Mesh,O=x.DecodeBufferToMesh(P,E)}if(!O.ok()||0==E.ptr){var M=O.error_msg();console.error(M)}var I=E.num_points(),R=E.num_faces();if(T.hasOwnProperty("attributes")){var V=function(e){var t=x.GetAttributeByUniqueId(E,e),n=new A.DracoFloat32Array;x.GetAttributeFloatForAllPoints(E,t,n);var i=I*t.num_components(),o=new Float32Array(i);for(a=0;a<i;a++)o[a]=n.GetValue(a);return A.destroy(n),o},_=T.attributes;_.hasOwnProperty("POSITION")&&(u=V(_.POSITION)),_.hasOwnProperty("NORMAL")&&(h=V(_.NORMAL)),_.hasOwnProperty("TANGENT")&&(c=V(_.TANGENT)),_.hasOwnProperty("TEXCOORD_0")&&(p=V(_.TEXCOORD_0)),_.hasOwnProperty("TEXCOORD_1")&&(m=V(_.TEXCOORD_1)),_.hasOwnProperty("COLOR_0")&&(f=V(_.COLOR_0)),_.hasOwnProperty("JOINTS_0")&&(d=V(_.JOINTS_0)),_.hasOwnProperty("WEIGHTS_0")&&(v=V(_.WEIGHTS_0))}if(k==A.TRIANGULAR_MESH){var N=new A.DracoInt32Array;for(g=I>65535?new Uint32Array(3*R):new Uint16Array(3*R),a=0;a<R;++a)x.GetFaceFromMesh(E,a,N),g[3*a]=N.GetValue(0),g[3*a+1]=N.GetValue(1),g[3*a+2]=N.GetValue(2);A.destroy(N)}A.destroy(E),A.destroy(x),A.destroy(P)}}var K;l.hasOwnProperty("POSITION")&&null===u&&(K=i.accessors[r.attributes.POSITION],u=s(i,K,t.buffers)),l.hasOwnProperty("NORMAL")&&null===h&&(K=i.accessors[r.attributes.NORMAL],h=s(i,K,t.buffers)),l.hasOwnProperty("TANGENT")&&null===c&&(K=i.accessors[r.attributes.TANGENT],c=s(i,K,t.buffers)),l.hasOwnProperty("TEXCOORD_0")&&null===p&&(K=i.accessors[r.attributes.TEXCOORD_0],p=s(i,K,t.buffers)),l.hasOwnProperty("TEXCOORD_1")&&null===m&&(K=i.accessors[r.attributes.TEXCOORD_1],m=s(i,K,t.buffers)),l.hasOwnProperty("COLOR_0")&&null===f&&(K=i.accessors[r.attributes.COLOR_0],f=s(i,K,t.buffers)),l.hasOwnProperty("JOINTS_0")&&null===d&&(K=i.accessors[r.attributes.JOINTS_0],d=s(i,K,t.buffers)),l.hasOwnProperty("WEIGHTS_0")&&null===v&&(K=i.accessors[r.attributes.WEIGHTS_0],v=s(i,K,t.buffers)),r.hasOwnProperty("indices")&&null===g&&(K=i.accessors[r.indices],g=s(i,K,t.buffers));var F=u.length/3,L=function(){var e=new Uint16Array(F);for(a=0;a<F;a++)e[a]=a;return e};null!==u&&null===h&&(h=pc.calculateNormals(u,null===g?L():g));var B=[];u&&B.push({semantic:pc.SEMANTIC_POSITION,components:3,type:pc.TYPE_FLOAT32}),h&&B.push({semantic:pc.SEMANTIC_NORMAL,components:3,type:pc.TYPE_FLOAT32}),c&&B.push({semantic:pc.SEMANTIC_TANGENT,components:4,type:pc.TYPE_FLOAT32}),p&&B.push({semantic:pc.SEMANTIC_TEXCOORD0,components:2,type:pc.TYPE_FLOAT32}),m&&B.push({semantic:pc.SEMANTIC_TEXCOORD1,components:2,type:pc.TYPE_FLOAT32}),f&&B.push({semantic:pc.SEMANTIC_COLOR,components:4,type:pc.TYPE_UINT8,normalize:!0}),d&&B.push({semantic:pc.SEMANTIC_BLENDINDICES,components:4,type:pc.TYPE_UINT8}),v&&B.push({semantic:pc.SEMANTIC_BLENDWEIGHT,components:4,type:pc.TYPE_FLOAT32});var D,z,X,U,Y,J=new pc.VertexFormat(t.device,B),W=new pc.VertexBuffer(t.device,J,F,pc.BUFFER_STATIC),G=W.lock(),H=new Float32Array(G),j=new Uint8Array(G),q=function(e){return J.elements.find(function(t){return t.name===e})};if(null!==u)for(X=q(pc.SEMANTIC_POSITION),U=X.offset/4,Y=X.stride/4,a=0;a<F;a++)D=U+a*Y,z=3*a,H[D]=u[z],H[D+1]=u[z+1],H[D+2]=u[z+2];if(null!==h)for(X=q(pc.SEMANTIC_NORMAL),U=X.offset/4,Y=X.stride/4,a=0;a<F;a++)D=U+a*Y,z=3*a,H[D]=h[z],H[D+1]=h[z+1],H[D+2]=h[z+2];if(null!==c)for(X=q(pc.SEMANTIC_TANGENT),U=X.offset/4,Y=X.stride/4,a=0;a<F;a++)D=U+a*Y,z=4*a,H[D]=c[z],H[D+1]=c[z+1],H[D+2]=c[z+2],H[D+3]=c[z+3];if(null!==p)for(X=q(pc.SEMANTIC_TEXCOORD0),U=X.offset/4,Y=X.stride/4,a=0;a<F;a++)D=U+a*Y,z=2*a,H[D]=p[z],H[D+1]=p[z+1];if(null!==m)for(X=q(pc.SEMANTIC_TEXCOORD1),U=X.offset/4,Y=X.stride/4,a=0;a<F;a++)D=U+a*Y,z=2*a,H[D]=m[z],H[D+1]=m[z+1];if(null!==f)for(X=q(pc.SEMANTIC_COLOR),U=X.offset,Y=X.stride,K=i.accessors[r.attributes.COLOR_0],a=0;a<F;a++){D=U+a*Y,z="VEC4"===K.type?4*a:3*a;var Q=f[z],$=f[z+1],Z=f[z+2],ee=f[z+3];j[D]=Math.round(255*pc.math.clamp(Q,0,1)),j[D+1]=Math.round(255*pc.math.clamp($,0,1)),j[D+2]=Math.round(255*pc.math.clamp(Z,0,1)),j[D+3]="VEC4"===K.type?Math.round(255*pc.math.clamp(ee,0,1)):255}if(null!==d)for(X=q(pc.SEMANTIC_BLENDINDICES),U=X.offset,Y=X.stride,a=0;a<F;a++)D=U+a*Y,z=4*a,j[D]=d[z],j[D+1]=d[z+1],j[D+2]=d[z+2],j[D+3]=d[z+3];if(null!==v)for(X=q(pc.SEMANTIC_BLENDWEIGHT),U=X.offset/4,Y=X.stride/4,a=0;a<F;a++)D=U+a*Y,z=4*a,H[D]=v[z],H[D+1]=v[z+1],H[D+2]=v[z+2],H[D+3]=v[z+3];W.unlock();var te=new pc.Mesh;if(te.vertexBuffer=W,te.primitive[0].type=n(r),te.primitive[0].base=0,te.primitive[0].indexed=null!==g,null!==g){var ne;ne=g instanceof Uint8Array?pc.INDEXFORMAT_UINT8:g instanceof Uint16Array?pc.INDEXFORMAT_UINT16:pc.INDEXFORMAT_UINT32;var ie=g.length,oe=new pc.IndexBuffer(t.device,ne,ie,pc.BUFFER_STATIC,g);te.indexBuffer[0]=oe,te.primitive[0].count=g.length}else te.primitive[0].count=F;te.materialIndex=r.material,K=i.accessors[r.attributes.POSITION];var re=K.min,ae=K.max,se=new pc.BoundingBox(new pc.Vec3((ae[0]+re[0])/2,(ae[1]+re[1])/2,(ae[2]+re[2])/2),new pc.Vec3((ae[0]-re[0])/2,(ae[1]-re[1])/2,(ae[2]-re[2])/2));if(te.aabb=se,e.hasOwnProperty("weights")&&(te.weights=e.weights),r.hasOwnProperty("targets")){var le=[];r.targets.forEach(function(e){var n={};e.hasOwnProperty("POSITION")&&(K=i.accessors[e.POSITION],n.deltaPositions=s(i,K,t.buffers)),e.hasOwnProperty("NORMAL")&&(K=i.accessors[e.NORMAL],n.deltaNormals=s(i,K,t.buffers)),e.hasOwnProperty("TANGENT")&&(K=i.accessors[e.TANGENT],n.deltaTangents=s(i,K,t.buffers)),le.push(new pc.MorphTarget(n))}),te.morph=new pc.Morph(le)}o.push(te)}),o}function m(e,t){var n=new pc.GraphNode;if(e.hasOwnProperty("name")?n.name=e.name:n.name="Node "+t.nodeCounter,e.hasOwnProperty("matrix")&&(k.data.set(e.matrix),k.getTranslation(M),n.setLocalPosition(M),k.getEulerAngles(M),n.setLocalEulerAngles(M),k.getScale(M),n.setLocalScale(M)),e.hasOwnProperty("rotation")){var i=e.rotation;n.setLocalRotation(i[0],i[1],i[2],i[3])}if(e.hasOwnProperty("translation")){var o=e.translation;n.setLocalPosition(o[0],o[1],o[2])}if(e.hasOwnProperty("scale")){var r=e.scale;n.setLocalScale(r[0],r[1],r[2])}return t.nodeCounter++,n}function f(e,t){var n=new pc.Entity;if(e.hasOwnProperty("name")?n.name=e.name:n.name="Node "+t.nodeCounter,e.hasOwnProperty("matrix")&&(k.data.set(e.matrix),k.getTranslation(M),n.setLocalPosition(M),k.getEulerAngles(M),n.setLocalEulerAngles(M),k.getScale(M),n.setLocalScale(M)),e.hasOwnProperty("rotation")){var i=e.rotation;n.setLocalRotation(i[0],i[1],i[2],i[3])}if(e.hasOwnProperty("translation")){var o=e.translation;n.setLocalPosition(o[0],o[1],o[2])}if(e.hasOwnProperty("scale")){var r=e.scale;n.setLocalScale(r[0],r[1],r[2])}return t.nodeCounter++,n.animations=null,void 0!==typeof CanvasTools&&void 0!==typeof CanvasTools.TranslateNode&&CanvasTools.TranslateNode(t.app,n,e,t),n}function d(e,t){var n,i,o=t.gltf,r=e.joints,a=r.length,l=[];if(e.hasOwnProperty("inverseBindMatrices")){var u=e.inverseBindMatrices,h=s(o,o.accessors[u],t.buffers);for(n=0;n<a;n++)i=new pc.Mat4,i.set(h.slice(16*n,16*n+16)),l.push(i)}else for(n=0;n<a;n++)i=new pc.Mat4,l.push(i);var c=[];for(n=0;n<a;n++)c[n]=t.nodes[r[n]].name;var p=e.skeleton,m=new pc.Skin(t.device,l,c);for(m.skeleton=t.nodes[p],m.bones=[],n=0;n<r.length;n++)m.bones[n]=t.nodes[r[n]];return m}function v(e,t){var n=new pc.Texture(t.device,{flipY:!1});if(e.hasOwnProperty("name")&&(n.name=e.name),n.anisotropy=2,e.hasOwnProperty("sampler")){var i=t.gltf,a=i.samplers[e.sampler];a.hasOwnProperty("minFilter")&&(n.minFilter=o(a.minFilter)),a.hasOwnProperty("magFilter")&&(n.magFilter=o(a.magFilter)),a.hasOwnProperty("wrapS")&&(n.addressU=r(a.wrapS)),a.hasOwnProperty("wrapT")&&(n.addressV=r(a.wrapT)),a.hasOwnProperty("extras")&&null!=a.extras.metadata&&a.extras.metadata.hasOwnProperty("anisolevel")&&(n.anisotropy=a.extras.metadata.anisolevel)}return n}function g(e,t){if(e.buffers)return void t();var n=e.gltf;if(e.buffers=[],n.hasOwnProperty("buffers")){var i=0;n.buffers.forEach(function(o,r){if(o.hasOwnProperty("uri"))if(a(o.uri)){var s=atob(o.uri.split(",")[1]);e.buffers[r]=new ArrayBuffer(s.length);for(var l=new Uint8Array(e.buffers[r]),u=0;u<s.length;u++)l[u]=s.charCodeAt(u);n.buffers.length===++i&&t()}else if(e.processUri)e.processUri(o.uri,function(o){e.buffers[r]=o,n.buffers.length===++i&&t()});else{var h=new XMLHttpRequest;h.open("GET",e.basePath+o.uri,!0),h.responseType="arraybuffer",h.onload=function(o){e.buffers[r]=this.response,n.buffers.length===++i&&t()},h.send()}})}}function y(e,t,n,i){if(i){if(!n.gltf.hasOwnProperty(e))return void i();if(0===n.gltf[e].length)return void i()}n.gltf.hasOwnProperty(e)&&(n[e]=n.gltf[e].map(function(e){return t(e,n,i)}))}function T(e){var t=e.gltf;t.nodes.forEach(function(t,n){t.hasOwnProperty("children")&&t.children.forEach(function(t){var i=e.nodes[t];i.parent&&i.parent.removeChild(i);var o=e.nodes[n];o.addChild(i)})})}function C(e){var t=e.gltf,n=[];if(t.hasOwnProperty("scenes")){var i=0;t.hasOwnProperty("scene")&&(i=t.scene);for(var o=t.scenes[i].nodes,r=0;r<o.length;r++)n.push(e.nodes[o[r]])}else n.push(e.nodes[0]);return n}function b(e){var t=e.gltf,n=[],i=[],o=[];t.nodes.forEach(function(t,r){if(t.hasOwnProperty("mesh")){var a=e.meshes[t.mesh];a.forEach(function(a){var s;s=void 0===a.materialIndex?e.defaultMaterial:e.materials[a.materialIndex];var l=new pc.MeshInstance(e.nodes[r],a,s);if(n.push(l),window.hasOwnProperty("chunks")&&null!=window.chunks&&(window.hasOwnProperty("meshes")&&null!=window.meshes||(window.meshes=[]),window.meshes.push(l)),a.morph){var u=new pc.MorphInstance(a.morph);l.morphInstance=u,u.updateBounds(l.mesh),a.weights&&a.weights.forEach(function(e,t){u.setWeight(t,e)}),o.push(u)}if(t.hasOwnProperty("skin")){var h=e.skins[t.skin];a.skin=h;var c=new pc.SkinInstance(h);c.bones=h.bones,l.skinInstance=c,i.push(c)}})}});var r=new pc.Model,a=C(e);return 1===a.length?r.graph=a[0]:(r.graph=new pc.GraphNode,a.forEach(function(e){r.graph.addChild(e)})),r.meshInstances=n,r.morphInstances=o,r.skinInstances=i,r}function S(e){e.gltf.nodes.forEach(function(t,n){if(t.hasOwnProperty("mesh")){var i=e.meshes[t.mesh];if(i.length>0){for(var o=new pc.Entity,r=[],a=[],s=[],l=0;l<i.length;l++){var u;u=void 0===i[l].materialIndex?e.defaultMaterial:e.materials[i[l].materialIndex];var h=new pc.MeshInstance(o,i[l],u);if(r.push(h),window.hasOwnProperty("chunks")&&null!=window.chunks&&(window.hasOwnProperty("meshes")&&null!=window.meshes||(window.meshes=[]),window.meshes.push(h)),i[l].morph){var c=new pc.MorphInstance(i[l].morph);h.morphInstance=c,c.updateBounds(h.mesh),i[l].weights&&i[l].weights.forEach(function(e,t){c.setWeight(t,e)}),s.push(c)}if(t.hasOwnProperty("skin")){var p=e.skins[t.skin];i[l].skin=p;var m=new pc.SkinInstance(p);m.bones=p.bones,h.skinInstance=m,a.push(m)}}var f=new pc.Model;f.graph=o,f.meshInstances=r,f.morphInstances=s,f.skinInstances=a,o=e.nodes[n],o.addComponent("model"),o.model.model=f,f.castShadows=!1,f.receiveShadows=!1,void 0!==typeof CanvasTools&&void 0!==typeof CanvasTools.TranslateModel&&CanvasTools.TranslateModel(e.app,o,e)}}})}function w(e,t){var n=null;if(null!=e.nodes)for(index=0;index<e.nodes.length;index++){var i=e.nodes[index];if(i.hasOwnProperty("metadata")&&null!=i.metadata&&null!=i.metadata.hasOwnProperty("id")&&i.metadata.id===t){n=i;break}}return n}function A(e){null!=e.animations&&e.animations.forEach(function(t){if(t.hasOwnProperty("metadata")){var n=t.metadata.hasOwnProperty("owner")?t.metadata.owner:null;if(null!=n){var i=w(e,n);null!=i&&(null==i.animations&&(i.animations=new AnimationComponent),i.animations.addClip(t))}var o=t.metadata.hasOwnProperty("target")?t.metadata.target:null;if(null!=o){var r=w(e,o);if(null!=r)for(var a=0;a<t.animCurves.length;a++){var s=t.animCurves[a];"model"===s.animTargets[0].targetNode&&(s.animTargets[0].targetNode=r)}}}})}function P(e,t,n,i){var o=i?i.appid:void 0,r=i&&i.hasOwnProperty("buffers")?i.buffers:void 0,a=i&&i.hasOwnProperty("basePath")?i.basePath:void 0,s=i&&i.hasOwnProperty("sceneFile")?i.sceneFile:void 0,u=i&&i.hasOwnProperty("processUri")?i.processUri:void 0,w=i&&i.hasOwnProperty("processAnimationExtras")?i.processAnimationExtras:void 0,P=i&&i.hasOwnProperty("processMaterialExtras")?i.processMaterialExtras:void 0,E={app:pc.Application.getApplication(o),basePath:a,sceneFile:s,buffers:r,device:t,defaultMaterial:null,gltf:e,imagesLoaded:0,nodeCounter:0,processUri:u,processAnimationExtras:w,processMaterialExtras:P};E.defaultMaterial=c({},E),e.hasOwnProperty("extensionsUsed")&&e.extensionsUsed.indexOf("KHR_draco_mesh_compression")!==-1&&(E.decoderModule=i.decoderModule);var O=function(){y("textures",v,E),y("images",h,E,function(){y("materials",c,E),y("meshes",p,E),y("nodes",s===!0?f:m,E),y("skins",d,E),y("animations",l,E),T(E),A(E),s===!0?(S(E),n(C(E),E.textures,E.animations)):n(b(E),E.textures,E.animations),e.hasOwnProperty("extensionsUsed")&&e.extensionsUsed.indexOf("KHR_draco_mesh_compression")!==-1&&(E.decoderModule=null)})};s===!0&&void 0!==typeof CanvasTools&&void 0!==typeof CanvasTools.TranslateScene?CanvasTools.TranslateScene(E.app,E,function(){g(E,O)}):g(E,O)}function E(e,t,n,i){var o=new DataView(e),r=o.getUint32(0,!0);if(1179937895!==r)return console.error("Invalid magic number found in glb header. Expected 0x46546C67, found 0x"+r.toString(16)),null;var a=o.getUint32(4,!0);if(2!==a)return console.error("Invalid version number found in glb header. Expected 2, found "+a),null;var s=o.getUint32(8,!0),l=o.getUint32(12,!0),u=o.getUint32(16,!0);if(1313821514!==u)return console.error("Invalid chunk type found in glb file. Expected 0x4E4F534A, found 0x"+u.toString(16)),null;var h=new Uint8Array(e,20,l),c=new TextDecoder("utf-8"),p=c.decode(h);p=JSON.parse(p);for(var m=[],f=20+l;f<s;){if(l=o.getUint32(f,!0),u=o.getUint32(f+4,!0),5130562!==u)return console.error("Invalid chunk type found in glb file. Expected 0x004E4942, found 0x"+u.toString(16)),null;var d=e.slice(f+8,f+8+l);m.push(d),f+=l+8}i=i||{},i.buffers=m,P(p,t,n,i)}var O=["#ifdef MAPFLOAT","uniform float material_shininess;","#endif","","#ifdef MAPTEXTURE","uniform sampler2D texture_glossMap;","#endif","","void getGlossiness() {","    dGlossiness = 1.0;","","#ifdef MAPFLOAT","    dGlossiness *= material_shininess;","#endif","","#ifdef MAPTEXTURE","    dGlossiness *= texture2D(texture_glossMap, $UV).$CH;","#endif","","#ifdef MAPVERTEX","    dGlossiness *= saturate(vVertexColor.$VC);","#endif","","    dGlossiness = 1.0 - dGlossiness;","","    dGlossiness += 0.0000001;","}"].join("\n"),x=["#ifdef MAPCOLOR","uniform vec3 material_specular;","#endif","","#ifdef MAPTEXTURE","uniform sampler2D texture_specularMap;","#endif","","void getSpecularity() {","    dSpecularity = vec3(1.0);","","    #ifdef MAPCOLOR","        dSpecularity *= material_specular;","    #endif","","    #ifdef MAPTEXTURE","        vec3 srgb = texture2D(texture_specularMap, $UV).$CH;","        dSpecularity *= vec3(pow(srgb.r, 2.2), pow(srgb.g, 2.2), pow(srgb.b, 2.2));","    #endif","","    #ifdef MAPVERTEX","        dSpecularity *= saturate(vVertexColor.$VC);","    #endif","}"].join("\n"),k=new pc.Mat4,M=new pc.Vec3;window.loadGltf=P,window.loadGlb=E}(),function(e,t){function n(e,t){for(var n in t)try{e.style[n]=t[n]}catch(i){}return e}function i(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?Object.prototype.toString.call(e).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof e}function o(e,t){if("array"!==i(t))return-1;if(t.indexOf)return t.indexOf(e);for(var n=0,o=t.length;n<o;n++)if(t[n]===e)return n;return-1}function r(){var e,t=arguments;for(e in t[1])if(t[1].hasOwnProperty(e))switch(i(t[1][e])){case"object":t[0][e]=r({},t[0][e],t[1][e]);break;case"array":t[0][e]=t[1][e].slice(0);break;default:t[0][e]=t[1][e]}return 2<t.length?r.apply(null,[t[0]].concat(Array.prototype.slice.call(t,2))):t[0]}function a(e){return e=Math.round(255*e).toString(16),1===e.length?"0"+e:e}function s(e,t,n,i){e.addEventListener?e[i?"removeEventListener":"addEventListener"](t,n,!1):e.attachEvent&&e[i?"detachEvent":"attachEvent"]("on"+t,n)}function l(e,h){function m(e,t,n,i){return A[0|e][Math.round(Math.min((t-n)/(i-n)*K,K))]}function f(){_.legend.fps!==Y&&(_.legend.fps=Y,_.legend[v]=Y?"FPS":"ms"),k=Y?R.fps:R.duration,_.count[v]=999<k?"999+":k.toFixed(99<k?0:V.decimals)}function d(){for(P=u(),z<P-V.threshold&&(R.fps-=R.fps/Math.max(1,60*V.smoothing/V.interval),R.duration=1e3/R.fps),M=V.history;M--;)X[M]=0===M?R.fps:X[M-1],U[M]=0===M?R.duration:U[M-1];if(f(),V.heat){if(F.length)for(M=F.length;M--;)F[M].el.style[w[F[M].name].heatOn]=Y?m(w[F[M].name].heatmap,R.fps,0,V.maxFps):m(w[F[M].name].heatmap,R.duration,V.threshold,0);if(_.graph&&w.column.heatOn)for(M=N.length;M--;)N[M].style[w.column.heatOn]=Y?m(w.column.heatmap,X[M],0,V.maxFps):m(w.column.heatmap,U[M],V.threshold,0)}if(_.graph)for(I=0;I<V.history;I++)N[I].style.height=(Y?X[I]?Math.round(x/V.maxFps*Math.min(X[I],V.maxFps)):0:U[I]?Math.round(x/V.threshold*Math.min(U[I],V.threshold)):0)+"px"}function T(){20>V.interval?(E=p(T),d()):(E=setTimeout(T,V.interval),O=p(d))}function C(e){e=e||window.event,e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.returnValue=!1,e.cancelBubble=!0),R.toggle()}function b(){V.toggleOn&&s(_.container,V.toggleOn,C,1),e.removeChild(_.container)}function S(){if(_.container&&b(),w=l.theme[V.theme],A=w.compiledHeatmaps||[],!A.length&&w.heatmaps.length){for(I=0;I<w.heatmaps.length;I++)for(A[I]=[],M=0;M<=K;M++){var t,i=A[I],o=M;t=.33/K*M;var r=w.heatmaps[I].saturation,u=w.heatmaps[I].lightness,h=void 0,c=void 0,p=void 0,m=p=void 0,d=h=c=void 0,d=void 0,p=.5>=u?u*(1+r):u+r-u*r;0===p?t="#000":(m=2*u-p,c=(p-m)/p,t*=6,h=Math.floor(t),d=t-h,d*=p*c,0===h||6===h?(h=p,c=m+d,p=m):1===h?(h=p-d,c=p,p=m):2===h?(h=m,c=p,p=m+d):3===h?(h=m,c=p-d):4===h?(h=m+d,c=m):(h=p,c=m,p-=d),t="#"+a(h)+a(c)+a(p)),i[o]=t}w.compiledHeatmaps=A}_.container=n(document.createElement("div"),w.container),_.count=_.container.appendChild(n(document.createElement("div"),w.count)),_.legend=_.container.appendChild(n(document.createElement("div"),w.legend)),_.graph=V.graph?_.container.appendChild(n(document.createElement("div"),w.graph)):0,F.length=0;for(var v in _)_[v]&&w[v].heatOn&&F.push({name:v,el:_[v]});if(N.length=0,_.graph)for(_.graph.style.width=V.history*w.column.width+(V.history-1)*w.column.spacing+"px",M=0;M<V.history;M++)N[M]=_.graph.appendChild(n(document.createElement("div"),w.column)),N[M].style.position="absolute",N[M].style.bottom=0,N[M].style.right=M*w.column.width+M*w.column.spacing+"px",N[M].style.width=w.column.width+"px",N[M].style.height="0px";n(_.container,V),f(),e.appendChild(_.container),_.graph&&(x=_.graph.clientHeight),V.toggleOn&&("click"===V.toggleOn&&(_.container.style.cursor="pointer"),s(_.container,V.toggleOn,C))}"object"===i(e)&&e.nodeType===t&&(h=e,e=document.body),e||(e=document.body);var w,A,P,E,O,x,k,M,I,R=this,V=r({},l.defaults,h||{}),_={},N=[],K=100,F=[],L=0,B=V.threshold,D=0,z=u()-B,X=[],U=[],Y="fps"===V.show;R.options=V,R.fps=0,R.duration=0,R.isPaused=0,R.tickStart=function(){D=u()},R.tick=function(){P=u(),L=P-z,B+=(L-B)/V.smoothing,R.fps=1e3/B,R.duration=D<z?B:P-D,z=P},R.pause=function(){return E&&(R.isPaused=1,clearTimeout(E),c(E),c(O),E=O=0),R},R.resume=function(){return E||(R.isPaused=0,T()),R},R.set=function(e,t){return V[e]=t,Y="fps"===V.show,-1!==o(e,g)&&S(),-1!==o(e,y)&&n(_.container,V),R},R.showDuration=function(){return R.set("show","ms"),R},R.showFps=function(){return R.set("show","fps"),R},R.toggle=function(){return R.set("show",Y?"ms":"fps"),R},R.hide=function(){return R.pause(),_.container.style.display="none",R},R.show=function(){return R.resume(),_.container.style.display="block",R},R.destroy=function(){R.pause(),b(),R.tick=R.tickStart=function(){}},S(),T()}var u,h=e.performance;u=h&&(h.now||h.webkitNow)?h[h.now?"now":"webkitNow"].bind(h):function(){return+new Date};for(var c=e.cancelAnimationFrame||e.cancelRequestAnimationFrame,p=e.requestAnimationFrame,h=["moz","webkit","o"],m=0,f=0,d=h.length;f<d&&!c;++f)p=(c=e[h[f]+"CancelAnimationFrame"]||e[h[f]+"CancelRequestAnimationFrame"])&&e[h[f]+"RequestAnimationFrame"];c||(p=function(t){var n=u(),i=Math.max(0,16-(n-m));return m=n+i,e.setTimeout(function(){t(n+i)},i)},c=function(e){clearTimeout(e)});var v="string"===i(document.createElement("div").textContent)?"textContent":"innerText";l.extend=r,window.FPSMeter=l,l.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var g=["toggleOn","theme","heat","graph","history"],y="position zIndex left top right bottom margin".split(" ")}(window),function(e,t){t.theme={};var n=t.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};t.theme.dark=t.extend({},n,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),t.theme.light=t.extend({},n,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),t.theme.colorful=t.extend({},n,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),t.theme.transparent=t.extend({},n,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter);var VStickJS=VStickJS||{};VStickJS.Global={},VStickJS.Core={},VStickJS.Controls={},VStickJS.Skins={},VStickJS.Styles={},VStickJS.Styles.VSComponent={actualPixelWidth:50,actualPixelHeight:50,backgroundColor:"#F26422",fontSize:"30px",fontFamily:"Arial",color:"#ffffff",textStrokeColor:"#ffffff",strokeColor:"#eeeeee",borderColor:"#333333",shadowColor:"#999999",shadowBlur:2,textShadowColor:"#999999",textShadowBlur:2,borderShadowColor:"#999999",borderShadowBlur:2},VStickJS.Skins.vstickJSCage=function(e){return e.moveTo(25,0),e.bezierCurveTo(39,0,50,11,50,25),e.bezierCurveTo(50,39,39,50,25,50),e.bezierCurveTo(11,50,0,39,0,25),e.bezierCurveTo(0,11,11,0,25,0),e},VStickJS.Skins.vstickJSKnob=function(e){return e.moveTo(30,179),e.lineTo(0,104),e.lineTo(31,30),e.lineTo(105,0),e.lineTo(179,31),e.lineTo(210,105),e.lineTo(179,179),e.lineTo(104,210),e.lineTo(30,179),e},VStickJS.Skins.vstickJSButton=function(e){return e.moveTo(25,0),e.bezierCurveTo(39,0,50,11,50,25),e.bezierCurveTo(50,39,39,50,25,50),e.bezierCurveTo(11,50,0,39,0,25),e.bezierCurveTo(0,11,11,0,25,0),e},VStickJS.Skins.vstickJSArrows1=function(e){return e.moveTo(226,1),e.bezierCurveTo(226,1,232,7,235,13),e.bezierCurveTo(238,18,239,23,239,24),e.bezierCurveTo(240,25,239,26,238,26),e.bezierCurveTo(237,26,231,25,225,25),e.bezierCurveTo(218,25,212,26,211,26),e.bezierCurveTo(210,26,209,25,210,24),e.bezierCurveTo(210,23,211,18,214,13),e.bezierCurveTo(217,7,222,2,223,1),e.bezierCurveTo(224,0,225,0,226,1),e.moveTo(226,449),e.bezierCurveTo(227,449,232,443,236,438),e.bezierCurveTo(239,432,239,427,240,427),e.bezierCurveTo(240,425,240,424,238,424),e.bezierCurveTo(238,424,231,425,225,425),e.bezierCurveTo(219,425,213,424,212,424),e.bezierCurveTo(210,424,210,426,210,427),e.bezierCurveTo(211,427,211,433,214,438),e.bezierCurveTo(218,443,223,449,223,449),e.bezierCurveTo(224,450,226,450,226,449),e.moveTo(383,384),e.bezierCurveTo(382,384,374,384,368,383),e.bezierCurveTo(362,381,357,378,357,377),e.bezierCurveTo(356,377,355,376,356,375),e.bezierCurveTo(357,374,362,371,366,366),e.bezierCurveTo(371,362,374,357,375,356),e.bezierCurveTo(376,355,377,356,378,357),e.bezierCurveTo(378,358,381,362,383,368),e.bezierCurveTo(384,374,384,381,385,382),e.bezierCurveTo(385,383,384,385,383,384),e.moveTo(65,68),e.bezierCurveTo(65,68,65,76,67,82),e.bezierCurveTo(68,88,72,93,72,93),e.bezierCurveTo(72,94,74,95,75,94),e.bezierCurveTo(75,93,79,88,83,84),e.bezierCurveTo(87,79,93,76,93,75),e.bezierCurveTo(94,74,94,73,93,72),e.bezierCurveTo(92,72,88,69,82,67),e.bezierCurveTo(76,66,68,66,67,66),e.bezierCurveTo(66,65,65,66,65,68),e.moveTo(1,224),e.bezierCurveTo(1,224,7,218,13,215),e.bezierCurveTo(18,212,23,211,24,211),e.bezierCurveTo(25,210,26,211,26,212),e.bezierCurveTo(26,213,25,219,25,225),e.bezierCurveTo(25,231,26,237,26,238),e.bezierCurveTo(26,240,25,240,24,240),e.bezierCurveTo(23,239,18,239,13,236),e.bezierCurveTo(7,233,2,227,1,227),e.bezierCurveTo(0,226,0,225,1,224),e.moveTo(449,224),e.bezierCurveTo(449,223,443,218,438,214),e.bezierCurveTo(432,211,427,211,426,210),e.bezierCurveTo(425,210,424,210,424,212),e.bezierCurveTo(424,212,425,219,425,225),e.bezierCurveTo(425,231,424,237,424,238),e.bezierCurveTo(424,239,425,240,427,239),e.bezierCurveTo(427,239,432,238,438,235),e.bezierCurveTo(443,232,448,227,449,226),e.bezierCurveTo(450,226,450,224,449,224),e.moveTo(66,383),e.bezierCurveTo(66,382,66,374,68,368),e.bezierCurveTo(69,362,73,358,73,357),e.bezierCurveTo(73,356,75,356,76,357),e.bezierCurveTo(76,357,80,362,84,367),e.bezierCurveTo(88,371,93,374,94,375),e.bezierCurveTo(95,376,94,378,93,378),e.bezierCurveTo(92,378,88,381,82,383),e.bezierCurveTo(76,385,69,385,68,385),e.bezierCurveTo(67,385,65,384,66,383),e.moveTo(382,66),e.bezierCurveTo(382,66,374,66,368,67),e.bezierCurveTo(362,69,357,72,357,72),e.bezierCurveTo(356,73,355,74,356,75),e.bezierCurveTo(357,75,362,79,366,83),e.bezierCurveTo(371,88,374,93,375,93),e.bezierCurveTo(376,94,377,94,378,93),e.bezierCurveTo(378,92,381,88,383,82),e.bezierCurveTo(384,76,384,68,384,68),e.bezierCurveTo(385,66,384,65,382,66),e},VStickJS.Core.VSComponent=function(){this.BORDER_WIDTH_PAD=2,this.style=VStickJS.Styles.VSComponent,this.id=createjs.UID.get(),this.name="VSComponent_"+this.id,this.width=0,this.height=0,this.actualWidth=0,this.actualHeight=0,this.scaleX=0,this.scaleY=0,this.posX=0,this.posY=0,this.backgroundColor="",this.text="",this.color="",this.fontSize="",this.fontFamily="",this.regX=0,this.regY=0,this.skewX=0,this.skewY=0,this.rotation=0,this.linearGradient=[],this.radialGradient=[],this.textStrokeWidth=0,this.textStrokeColor="#dddddd",this.displayShadow=!1,this.shadowColor="#000000",this.shadowPosX=1,this.shadowPosY=1,this.shadowBlur=5,this.borderWidth=0,this.borderColor="#000000",this.displayBorderShadow=!1,this.borderShadowColor="#000000",this.borderShadowPosX=1,this.borderShadowPosY=1,this.borderShadowBlur=5,this.strokeStyle=[],this.strokeDash=[],this.strokeColor="#000000",this.graphics="",this.displayTextShadow=!1,this.textShadowColor="",this.textShadowPosX=1,this.textShadowPosY=1,this.textShadowBlur=5,this.textPosX=0,this.textPosY=0,this.textAlign="",this.image="",this.maskImage=!1,this.alpha=1,this.filters=[]},VStickJS.Core.VSComponent.prototype.getId=function(){return this.id},VStickJS.Core.VSComponent.prototype.getName=function(){return this.name},VStickJS.Core.VSComponent.prototype.getActualWidth=function(){return this.actualWidth>0?this.actualWidth:this.style.actualPixelWidth},VStickJS.Core.VSComponent.prototype.getActualHeight=function(){return this.actualHeight>0?this.actualHeight:this.style.actualPixelHeight},VStickJS.Core.VSComponent.prototype.getScaleX=function(){return this.scaleX>0?this.width>0?this.width/this.getActualWidth()*this.scaleX:this.scaleX:this.width>0?this.width/this.getActualWidth():1},VStickJS.Core.VSComponent.prototype.getScaleY=function(){return this.scaleY>0?this.height>0?this.height/this.getActualHeight()*this.scaleY:this.scaleY:this.height>0?this.height/this.getActualHeight():1},VStickJS.Core.VSComponent.prototype.getWidth=function(){return this.width>0?this.scaleX>0?this.width*this.scaleX:this.width:this.scaleX>0?this.getActualWidth()*this.scaleX:this.getActualWidth()},VStickJS.Core.VSComponent.prototype.getHeight=function(){return this.height>0?this.scaleY>0?this.height*this.scaleY:this.height:this.scaleY>0?this.getActualHeight()*this.scaleY:this.getActualHeight()},VStickJS.Core.VSComponent.prototype.getPosX=function(){return this.posX},VStickJS.Core.VSComponent.prototype.getPosY=function(){return this.posY},VStickJS.Core.VSComponent.prototype.getFillColor=function(){return""!==this.backgroundColor?this.backgroundColor:this.style.backgroundColor},VStickJS.Core.VSComponent.prototype.getText=function(){return this.text},VStickJS.Core.VSComponent.prototype.getColor=function(){return""!==this.color?this.color:this.style.color},VStickJS.Core.VSComponent.prototype.getFontSize=function(){return""!==this.fontSize?this.fontSize:this.style.fontSize},VStickJS.Core.VSComponent.prototype.getFontFamily=function(){return""!==this.fontFamily?this.fontFamily:this.style.fontFamily},VStickJS.Core.VSComponent.prototype.getRegX=function(){return"center"===this.regX?this.getWidth()/2:this.regX},VStickJS.Core.VSComponent.prototype.getRegY=function(){return"center"===this.regY?this.getHeight()/2:this.regY},VStickJS.Core.VSComponent.prototype.getTextStrokeWidth=function(){return this.textStrokeWidth},VStickJS.Core.VSComponent.prototype.getTextStrokeColor=function(){return""!==this.textStrokeColor?this.textStrokeColor:this.style.textStrokeColor},VStickJS.Core.VSComponent.prototype.getBorderColor=function(){return""!==this.borderColor?this.borderColor:this.style.borderColor},VStickJS.Core.VSComponent.prototype.getDisplayShadow=function(){return this.displayShadow},VStickJS.Core.VSComponent.prototype.getShadowColor=function(){return""!==this.shadowColor?this.shadowColor:this.style.shadowColor},VStickJS.Core.VSComponent.prototype.getShadowPosX=function(){return this.shadowPosX},VStickJS.Core.VSComponent.prototype.getShadowPosY=function(){return this.shadowPosY},VStickJS.Core.VSComponent.prototype.getShadowBlur=function(){return""!==this.shadowBlur?this.shadowBlur:this.style.shadowBlur},VStickJS.Core.VSComponent.prototype.getRotation=function(){return this.rotation},VStickJS.Core.VSComponent.prototype.getSkewX=function(){
return this.skewX},VStickJS.Core.VSComponent.prototype.getSkewY=function(){return this.skewY},VStickJS.Core.VSComponent.prototype.getDisplayTextShadow=function(){return this.displayTextShadow},VStickJS.Core.VSComponent.prototype.getTextShadowColor=function(){return""!==this.textShadowColor?this.textShadowColor:this.style.textShadowColor},VStickJS.Core.VSComponent.prototype.getTextShadowPosX=function(){return this.textShadowPosX},VStickJS.Core.VSComponent.prototype.getTextShadowPosY=function(){return this.textShadowPosY},VStickJS.Core.VSComponent.prototype.getTextShadowBlur=function(){return""!==this.textShadowBlur?this.textShadowBlur:this.style.textShadowBlur},VStickJS.Core.VSComponent.prototype.getDisplayBorderShadow=function(){return this.displayBorderShadow},VStickJS.Core.VSComponent.prototype.getBorderShadowColor=function(){return""!==this.borderShadowColor?this.borderShadowColor:this.style.borderShadowColor},VStickJS.Core.VSComponent.prototype.getBorderShadowPosX=function(){return this.borderShadowPosX},VStickJS.Core.VSComponent.prototype.getBorderShadowPosY=function(){return this.borderShadowPosY},VStickJS.Core.VSComponent.prototype.getBorderShadowBlur=function(){return""!==this.borderShadowBlur?this.borderShadowBlur:this.style.borderShadowBlur},VStickJS.Core.VSComponent.prototype.getPixelBorder=function(){return this.borderWidth>0?this.borderWidth*this.BORDER_WIDTH_PAD:0},VStickJS.Core.VSComponent.prototype.getBorderWidth=function(){var e=this.getPixelBorder();return this.borderWidth>0?this.width>0?this.scaleX>0?this.width+e*this.scaleX:this.width+e:this.scaleX>0?(this.getActualWidth()+e)*this.scaleX:this.getActualWidth()+e:0},VStickJS.Core.VSComponent.prototype.getBorderHeight=function(){var e=this.getPixelBorder();return this.borderWidth>0?this.height>0?this.scaleY>0?(this.height+e)*this.scaleY:this.height+e:this.scaleY>0?(this.getActualHeight()+e)*this.scaleY:this.getActualHeight()+e:0},VStickJS.Core.VSComponent.prototype.getBorderScaleX=function(){var e=this.getPixelBorder();return this.borderWidth>0?this.scaleX>0?this.width>0?(this.width+e)/this.getActualWidth()*this.scaleX:this.scaleX:this.width>0?(this.width+e)/this.getActualWidth():1:1},VStickJS.Core.VSComponent.prototype.getBorderScaleY=function(){var e=this.getPixelBorder();return this.borderWidth>0?this.scaleY>0?this.height>0?(this.height+e)/this.getActualHeight()*this.scaleY:this.scaleY:this.height>0?(this.height+e)/this.getActualHeight():1:1},VStickJS.Core.VSComponent.prototype.getLinearGradient=function(){return this.linearGradient},VStickJS.Core.VSComponent.prototype.getRadialGradient=function(){return this.radialGradient},VStickJS.Core.VSComponent.prototype.getTextPosX=function(){return this.textPosX},VStickJS.Core.VSComponent.prototype.getTextPosY=function(){return this.textPosY},VStickJS.Core.VSComponent.prototype.getTextAlign=function(){return this.textAlign},VStickJS.Core.VSComponent.prototype.getFilters=function(){return this.filters},VStickJS.Core.VSComponent.prototype.getStrokeStyle=function(){return this.strokeStyle},VStickJS.Core.VSComponent.prototype.getStrokeDash=function(){return this.strokeDash},VStickJS.Core.VSComponent.prototype.getStrokeColor=function(){return""!==this.strokeColor?this.strokeColor:this.style.strokeColor},VStickJS.Core.VSComponent.prototype.getAlpha=function(){return this.alpha},VStickJS.Core.VSComponent.prototype.getImage=function(){return""!==this.image?this.image:null},VStickJS.Core.VSComponent.prototype.getImageScaleX=function(e){return this.scaleX>0?this.width>0?this.width/e*this.scaleX:this.scaleX:this.width>0?this.width/e:1},VStickJS.Core.VSComponent.prototype.getImageScaleY=function(e){return this.scaleY>0?this.height>0?this.height/e*this.scaleY:this.scaleY:this.height>0?this.height/e:1},VStickJS.Core.VSComponent.prototype.getGraphics=function(e){return""!==this.graphics?window.VStickJS.Skins[this.graphics](e):void 0},VStickJS.Core.VSComponent.prototype.getBorderShape=function(){var e=new createjs.Shape;this.getGraphics(e.graphics.beginFill(this.getBorderColor())),e.rotation=this.getRotation(),e.skewX=this.getSkewX(),e.skewY=this.getSkewY(),this.getDisplayBorderShadow()===!0&&this.getPixelBorder()>0&&(e.shadow=new createjs.Shadow(this.getBorderShadowColor(),this.getBorderShadowPosX(),this.getBorderShadowPosY(),this.getBorderShadowBlur()));var t=this.getPixelBorder()/2;return e.setBounds(this.getPosX()-t,this.getPosY()-t,this.getBorderWidth(),this.getBorderHeight()),e.setTransform(this.getPosX()-t,this.getPosY()-t,this.getBorderScaleX(),this.getBorderScaleY()),e},VStickJS.Core.VSComponent.prototype.draw=function(){function e(){var e=event.target;s=new createjs.Bitmap(e),s.rotation=u.getRotation(),s.skewX=u.getSkewX(),s.skewY=u.getSkewY(),s.setBounds(u.getPosX(),u.getPosY(),u.getWidth(),u.getHeight()),s.setTransform(u.getPosX(),u.getPosY(),u.getImageScaleX(s.image.width),u.getImageScaleY(s.image.height)),s.regX=u.getRegX(),s.regY=u.getRegY(),u.maskImage===!0&&(s.mask=n),t.addChild(s)}var t=new createjs.Container,n=new createjs.Shape,i=this.getLinearGradient(),o=this.getRadialGradient();if(3===i.length&&0===o.length&&this.getGraphics(n.graphics.beginLinearGradientFill(i[0],i[1],i[2][0],i[2][1],i[2][2],i[2][3])),3===o.length&&0===i.length&&this.getGraphics(n.graphics.beginRadialGradientFill(o[0],o[1],o[2][0],o[2][1],o[2][2],o[2][3],o[2][4],o[2][5])),0===o.length&&0===i.length){var r=this.getStrokeStyle(),a=this.getStrokeDash();r.length>0?a.length>0?this.getGraphics(n.graphics.setStrokeStyle(r[0]?r[0]:0,r[1]?r[1]:0,r[2]?r[2]:0,r[3]?r[3]:0,r[4]?r[4]:0).beginStroke(this.getStrokeColor()).setStrokeDash([a[0]?a[0]:5,a[1]?a[1]:5],a[2]?a[2]:0).beginFill(this.getFillColor())):this.getGraphics(n.graphics.setStrokeStyle(r[0]?r[0]:0,r[1]?r[1]:0,r[2]?r[2]:0,r[3]?r[3]:0,r[4]?r[4]:0).beginStroke(this.getStrokeColor()).beginFill(this.getFillColor())):this.getGraphics(n.graphics.beginFill(this.getFillColor()))}this.getFilters().length>0&&(n.filters=this.getFilters());var s,l=this.getImage(),u=this;if(null!==l){var h=new Image;h.src=l,h.onload=e}if(""!==this.getAlpha()&&(n.alpha=this.getAlpha()),n.rotation=this.getRotation(),n.skewX=this.getSkewX(),n.skewY=this.getSkewY(),this.getDisplayShadow()===!0&&(n.shadow=new createjs.Shadow(this.getShadowColor(),this.getShadowPosX(),this.getShadowPosY(),this.getShadowBlur())),n.setBounds(this.getPosX(),this.getPosY(),this.getWidth(),this.getHeight()),n.setTransform(this.getPosX(),this.getPosY(),this.getScaleX(),this.getScaleY()),n.regX=this.getRegX(),n.regY=this.getRegY(),n.name=this.name,""!==this.getText()){var c=new createjs.Container,p=this.getFontSize()+" "+this.getFontFamily(),m=this.getTextStrokeWidth()>0?this.getTextStrokeColor():this.getColor(),f=this.getTextStrokeWidth()>0&&this.getTextStrokeWidth(),d=new createjs.Text(this.getText(),p,m);if(d.outline=f,"center"===this.getTextAlign()?(d.x=(this.getWidth()-d.getBounds().width)/2,d.y=(this.getHeight()-d.getBounds().height)/2):""===this.getTextAlign()&&(d.x=this.getTextPosX(),d.y=this.getTextPosY()),d.maxWidth=1e3,this.getDisplayTextShadow()===!0&&f===!1&&(d.shadow=new createjs.Shadow(this.getTextShadowColor(),this.getTextShadowPosX(),this.getTextShadowPosY(),this.getTextShadowBlur())),f>0){var v=d.clone();v.outline=!1,v.color=this.getColor(),this.getDisplayTextShadow()===!0&&(d.shadow=new createjs.Shadow(this.getTextShadowColor(),this.getTextShadowPosX(),this.getTextShadowYosY(),this.getTextShadowBlur()))}f>0?c.addChild(d,v):c.addChild(d)}return this.getPixelBorder()>0?""!==this.getText()?t.addChild(this.getBorderShape(),n,c):t.addChild(this.getBorderShape(),n):""!==this.getText()?t.addChild(n,c):t.addChild(n),t},VStickJS.Global.JoystickProperty={isDragging:!1,joyStickMouseX:0},VStickJS.Controls.JoyStick=function(e){this.stage=e,this.enableMouseEvent=!1,this.enableTouchEvent=!1,this.cage=null,this.knob=null,this.cageContainer=null,this.knobContainer=null,this.joystick=null,this.joystickPosX=150,this.joystickPosY=150,this.moveX=0,this.moveY=0,this.vertical=0,this.horizontal=0,this.startX=0,this.startY=0,this.angle=0,this.delay=.6,this.speedX=5,this.radius=50,this.tension=.5,this.moveSpeed=10,this.isMoving=!1},VStickJS.Controls.JoyStick.prototype.setCage=function(e){this.cage=e},VStickJS.Controls.JoyStick.prototype.setKnob=function(e){this.knob=e},VStickJS.Controls.JoyStick.prototype.setCageContainer=function(e){this.cageContainer=e},VStickJS.Controls.JoyStick.prototype.setKnobContainer=function(e){this.knobContainer=e},VStickJS.Controls.JoyStick.prototype.draw=function(){null!==this.cage&&null!==this.knob&&(null!==this.cageContainer&&(this.cageContainer.x=this.joystickPosX,this.cageContainer.y=this.joystickPosY,this.stage.addChild(this.cageContainer)),null!==this.knobContainer&&(this.knobContainer.x=this.joystickPosX,this.knobContainer.y=this.joystickPosY,this.stage.addChild(this.knobContainer)),this.joystick=new createjs.Container,this.joystick.x=this.joystickPosX,this.joystick.y=this.joystickPosY,this.joystick.addChild(this.cage,this.knob),this.stage.addChild(this.joystick),this.startX=this.joystick.x,this.startY=this.joystick.y,this.enableMouseEvent===!0&&(this.joystick.addEventListener("mousedown",this.mouseDownHandler),this.joystick.addEventListener("pressup",this.pressUpHandler),this.joystick.addEventListener("pressmove",this.pressMoveHandler)),this.enableTouchEvent===!0)},VStickJS.Controls.JoyStick.prototype.mouseDownHandler=function(){VStickJS.Global.JoystickProperty.isDragging=!0},VStickJS.Controls.JoyStick.prototype.pressUpHandler=function(){VStickJS.Global.JoystickProperty.isDragging=!1},VStickJS.Controls.JoyStick.prototype.pressMoveHandler=function(e){VStickJS.Global.JoystickProperty.joyStickMouseX=e.localX},VStickJS.Controls.JoyStick.prototype.update=function(){null!==this.cage&&null!==this.knob&&(VStickJS.Global.JoystickProperty.isDragging===!0?(this.isMoving=!0,this.angle=Math.atan2(this.stage.mouseY-this.startY,this.stage.mouseX-this.startX)/(Math.PI/180),this.joystick.rotation=this.angle,this.knob.rotation=-this.angle,this.knob.x=VStickJS.Global.JoystickProperty.joyStickMouseX,this.knob.x>this.radius&&(this.knob.x=this.radius),this.moveX+=Math.cos(this.angle*(Math.PI/180))*(this.knob.x/this.moveSpeed),this.moveY+=Math.sin(this.angle*(Math.PI/180))*(this.knob.x/this.moveSpeed),this.horizontal=Math.cos(this.angle*(Math.PI/180)),this.vertical=Math.sin(this.angle*(Math.PI/180))):(this.isMoving=!1,this.speedX=-this.knob.x*this.tension+this.speedX*this.delay,this.knob.x+=this.speedX,this.horizontal=0,this.vertical=0))},console.log("Register canvas scene loader...");var createScript=function(e){return function(t){var n=new t;if(n&&n.constructor&&n.constructor.name){var i=n.constructor.name,o=pc.createScript(i,e),r=[];if(n.attributes)for(var a in n.attributes)r.push(a),o.attributes.add(a,n.attributes[a]);for(var s in n)"attributes"===s||"name"===s||r.includes(s)||(o.prototype[s]=n[s]);for(var s in t)o[s]=t[s]}else console.warn("Failed instantiate a PlayCanvas script class constructor.")}},CanvasScript=function(){function e(){this._properties=null}return e.prototype.setProperty=function(e,t){null!=this._properties&&(this._properties[e]=t)},e.prototype.getProperty=function(e,t){void 0===t&&(t=null);var n=null;return null!=this._properties&&(n=this._properties[e]),null==n&&(n=t),null!=n?n:null},e.prototype.getMetadata=function(){return this.entity.metadata},e}(),SceneManager=function(){function e(){}return e.GetVersion=function(){return"1.0.0"},e.IsWindows=function(){return"undefined"!=typeof Windows&&"undefined"!=typeof Windows.UI&&"undefined"!=typeof Windows.System&&"undefined"!=typeof Windows.Foundation},e.IsCordova=function(){return null!=window.cordova},e.IsOculusBrowser=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/OculusBrowser/i)&&(e=!0),e},e.IsSamsungBrowser=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/SamsungBrowser/i)&&(e=!0),e},e.IsWindowsPhone=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/Windows Phone/i)&&(e=!0),e},e.IsBlackBerry=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/BlackBerry/i)&&(e=!0),e},e.IsOperaMini=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/Opera Mini/i)&&(e=!0),e},e.IsAndroid=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/Android/i)&&(e=!0),e},e.IsWebOS=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/webOS/i)&&(e=!0),e},e.IsIOS=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/iPhone|iPad|iPod/i)&&(e=!0),e},e.IsIPHONE=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/iPhone/i)&&(e=!0),e},e.IsIPAD=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/iPad/i)&&(e=!0),e},e.IsIPOD=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/iPod/i)&&(e=!0),e},e.IsIE11=function(){return void 0!==navigator.msMaxTouchPoints},e.IsMobile=function(){var e=!1;if(null!=navigator&&null!=navigator.userAgent){var t=navigator.userAgent;(t.match(/Android/i)||t.match(/webOS/i)||t.match(/iPhone|iPad|iPod/i)||t.match(/BlackBerry/i)||t.match(/Opera Mini/i)||t.match(/Windows Phone/i))&&(e=!0)}return e},e.IsPlaystation=function(){var e=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/Playstation/i)&&(e=!0),e},e.IsXboxOne=function(){var t=!1;if(e.IsWindows()&&"undefined"!=typeof Windows.System.Profile&&"undefined"!=typeof Windows.System.Profile.AnalyticsInfo&&"undefined"!=typeof Windows.System.Profile.AnalyticsInfo.versionInfo&&"undefined"!=typeof Windows.System.Profile.AnalyticsInfo.versionInfo.deviceFamily){var n=Windows.System.Profile.AnalyticsInfo.versionInfo.deviceFamily;n.match(/Xbox/i)&&(t=!0)}return t},e.IsXboxLive=function(){return e.IsWindows()&&"undefined"!=typeof Microsoft&&"undefined"!=typeof Microsoft.Xbox&&"undefined"!=typeof Microsoft.Xbox.Services},e.CreateGenericPromise=function(e){return window.createGenericPromise?window.createGenericPromise(e):null},e.ResolveGenericPromise=function(e){return window.resolveGenericPromise?window.resolveGenericPromise(e):null},e.GetQueryStringParam=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},e.AlertMessage=function(t,n){void 0===n&&(n="PlayCanvas");var i=null;return e.IsWindows()?i=new Windows.UI.Popups.MessageDialog(t,n).showAsync():window.alert(t),i},e.LoadAssets=function(e,t,n){var i=0,o=0,r=(t.length,function(){return o++,console.log("*** GOT PROGRESS: "+o.toString()+" of "+t.length.toString()),o>=t.length&&(console.log("*** LOAD COMPLETE ***"),null!=n&&n()),null});for(i=0;i<t.length;i++){var a=t[i];a.once("load",r,null),e.assets.add(a),e.assets.load(a)}},e.OnExecuteReady=function(e){null!=e&&(window.ontoolkitready=e)},e.prototype.delay=function(e,t){var n=this,i=null;return i=TimerPlugin.requestTimeout(function(){null!=i&&n.cancelDelay(i),null!=e&&e()},t)},e.prototype.cancelDelay=function(e){TimerPlugin.clearRequestTimeout(e)},e.prototype.repeat=function(e,t){return TimerPlugin.requestInterval(e,t)},e.prototype.cancelRepeat=function(e){TimerPlugin.clearRequestInterval(e)},e}(),TimerPlugin=window;TimerPlugin.requestAnimFrame=function(){return TimerPlugin.requestAnimationFrame||TimerPlugin.webkitRequestAnimationFrame||TimerPlugin.mozRequestAnimationFrame||TimerPlugin.oRequestAnimationFrame||TimerPlugin.msRequestAnimationFrame||function(e,t){TimerPlugin.setTimeout(e,1e3/60)}}(),TimerPlugin.requestInterval=function(e,t){function n(){var r=TimerPlugin.getTimeMilliseconds(),a=r-i;a>=t&&(e.call(),i=TimerPlugin.getTimeMilliseconds()),o.value=TimerPlugin.requestAnimFrame(n)}if(!(TimerPlugin.requestAnimationFrame||TimerPlugin.webkitRequestAnimationFrame||TimerPlugin.mozRequestAnimationFrame&&TimerPlugin.mozCancelRequestAnimationFrame||TimerPlugin.oRequestAnimationFrame||TimerPlugin.msRequestAnimationFrame))return TimerPlugin.setInterval(e,t);var i=TimerPlugin.getTimeMilliseconds(),o=new Object;return o.value=TimerPlugin.requestAnimFrame(n),o},TimerPlugin.clearRequestInterval=function(e){TimerPlugin.cancelAnimationFrame?TimerPlugin.cancelAnimationFrame(e.value):TimerPlugin.webkitCancelAnimationFrame?TimerPlugin.webkitCancelAnimationFrame(e.value):TimerPlugin.webkitCancelRequestAnimationFrame?TimerPlugin.webkitCancelRequestAnimationFrame(e.value):TimerPlugin.mozCancelRequestAnimationFrame?TimerPlugin.mozCancelRequestAnimationFrame(e.value):TimerPlugin.oCancelRequestAnimationFrame?TimerPlugin.oCancelRequestAnimationFrame(e.value):TimerPlugin.msCancelRequestAnimationFrame?TimerPlugin.msCancelRequestAnimationFrame(e.value):clearInterval(e),e=null},TimerPlugin.requestTimeout=function(e,t){function n(){var r=TimerPlugin.getTimeMilliseconds(),a=r-i;a>=t?e.call():o.value=TimerPlugin.requestAnimFrame(n)}if(!(TimerPlugin.requestAnimationFrame||TimerPlugin.webkitRequestAnimationFrame||TimerPlugin.mozRequestAnimationFrame&&TimerPlugin.mozCancelRequestAnimationFrame||TimerPlugin.oRequestAnimationFrame||TimerPlugin.msRequestAnimationFrame))return TimerPlugin.setTimeout(e,t);var i=TimerPlugin.getTimeMilliseconds(),o=new Object;return o.value=TimerPlugin.requestAnimFrame(n),o},TimerPlugin.clearRequestTimeout=function(e){TimerPlugin.cancelAnimationFrame?TimerPlugin.cancelAnimationFrame(e.value):TimerPlugin.webkitCancelAnimationFrame?TimerPlugin.webkitCancelAnimationFrame(e.value):TimerPlugin.webkitCancelRequestAnimationFrame?TimerPlugin.webkitCancelRequestAnimationFrame(e.value):TimerPlugin.mozCancelRequestAnimationFrame?TimerPlugin.mozCancelRequestAnimationFrame(e.value):TimerPlugin.oCancelRequestAnimationFrame?TimerPlugin.oCancelRequestAnimationFrame(e.value):TimerPlugin.msCancelRequestAnimationFrame?TimerPlugin.msCancelRequestAnimationFrame(e.value):clearTimeout(e),e=null},TimerPlugin.getTimeMilliseconds=function(){return(performance||Date).now()},SceneManager.IsWindows()&&"undefined"!=typeof Windows.UI.ViewManagement&&"undefined"!=typeof Windows.UI.ViewManagement.ApplicationViewBoundsMode&&"undefined"!=typeof Windows.UI.ViewManagement.ApplicationViewBoundsMode.useCoreWindow&&Windows.UI.ViewManagement.ApplicationView.getForCurrentView().setDesiredBoundsMode(Windows.UI.ViewManagement.ApplicationViewBoundsMode.useCoreWindow),SceneManager.IsXboxOne()&&navigator.gamepadInputEmulation&&(navigator.gamepadInputEmulation="gamepad");var Constants;!function(e){e[e.Deg2Rad=.0174532924]="Deg2Rad",e[e.Rad2Deg=57.29578]="Rad2Deg",e[e.MinimumTimeout=.5]="MinimumTimeout"}(Constants||(Constants={})),pc.Application.prototype.manager=new SceneManager,pc.Application.prototype.inline=function(e,t){if(null!=e){var n=document.head||document.getElementsByTagName("head")[0],i=document.createTextNode(e),o=document.createElement("script");null!=t&&(o.id=t),o.setAttribute("type","text/javascript"),o.appendChild(i),n.appendChild(o)}else console.warn("Null required script libraries specfied for the pc.Application.inline prototype.")},pc.Application.prototype.require=function(e,t){var n=function(e,t,i){var o=document.head||document.getElementsByTagName("head")[0];if(e[t]){var r=e[t],a=document.createElement("script");a.id=r.indexOf("/")>=0?r.substring(r.lastIndexOf("/")+1):r,a.setAttribute("type","text/javascript"),a.setAttribute("src",r),a.onerror=function(o){console.warn("Failed to load PlayCanvas script tag for "+r+". "+o.message),t+=1,n(e,t,i)},a.onload=function(){t+=1,n(e,t,i)},o.appendChild(a)}else null!=i&&i()};null!=e?e instanceof Array?n(e,0,t):n([e],0,t):console.warn("Null required script libraries specfied for the pc.Application.require prototype.")};